window.__require=function t(e,i,o){function a(r,s){if(!i[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){return a(e[r][1][t]||t)},h,h.exports,t,e,i,o)}return i[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<o.length;r++)a(o[r]);return a}({AchievementData:[function(t,e,i){"use strict";cc._RF.push(e,"6a835W88Z5L36Zxiky/P1I6","AchievementData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){this.index=0,this.monsters={},this.playerLifes=0},cc._RF.pop()},{}],Achievement:[function(t,e,i){"use strict";cc._RF.push(e,"5607byYvNBEQ4yBaPsgf0sF","Achievement");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Utils/AudioPlayer"),s=t("./Utils/LocalStorage"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MONSTER_SIZE=31,e.BOSS_SIZE=9,e.content=null,e.contentBottom=null,e.prefab=null,e.lifesLabel=null,e.coinLabel=null,e.goldLabel=null,e.spriteFrames=null,e.bossSpriteFrames=null,e.iconList=new Array,e.isMonsterLoaded=!1,e.isBossLoaded=!1,e}return a(e,t),e.prototype.onLoad=function(){this.content.removeAllChildren(),this.contentBottom.removeAllChildren();for(var t=0;t<this.MONSTER_SIZE+this.BOSS_SIZE;t++){var e=cc.instantiate(this.prefab);t>this.MONSTER_SIZE-1?this.contentBottom.addChild(e):this.content.addChild(e);var i=e.getChildByName("sprite");i.color=cc.color(0,0,0),this.iconList.push(i.getComponent(cc.Sprite))}this.loadSpriteFrames(),this.loadBossSpriteFrames();var o=s.default.getAchievementData();if(this.lifesLabel&&o.playerLifes&&(this.lifesLabel.string="DIE "+o.playerLifes),this.coinLabel){var a=s.default.getValueFromData(s.default.KEY_COIN);this.coinLabel.string=""+(a?parseInt(a):0)}},e.prototype.loadSpriteFrames=function(){var t=this;this.spriteFrames?this.isMonsterLoaded=!0:cc.resources.load("Texture/npc",cc.SpriteAtlas,function(e,i){t.spriteFrames={};for(var o=0,a=i.getSpriteFrames();o<a.length;o++){var n=a[o];t.spriteFrames[n.name]=n}t.isMonsterLoaded=!0,cc.log("npc spriteatlas loaded")})},e.prototype.loadBossSpriteFrames=function(){var t=this;this.bossSpriteFrames?this.isBossLoaded=!0:cc.resources.load("OtherTexture/bossicons",cc.SpriteAtlas,function(e,i){t.bossSpriteFrames={};for(var o=0,a=i.getSpriteFrames();o<a.length;o++){var n=a[o];t.bossSpriteFrames[n.name]=n}t.isBossLoaded=!0,cc.log("bossicons spriteatlas loaded")})},e.prototype.show=function(){if(this.iconList)for(var t=["#ffffff","#00ff00","#0000ff","#800080","#ffa500"],e=s.default.getAchievementData(),i=0;i<this.iconList.length;i++){var o="monster"+(i<10?"00"+i:"0"+i),a=this.spriteFrames[o+"anim000"];if(i>this.MONSTER_SIZE-1&&(o="iconboss00"+(i-this.MONSTER_SIZE),a=this.bossSpriteFrames[o]),a){this.iconList[i].node.width=96,this.iconList[i].node.height=96,this.spriteFrames[o+"anim000"]&&(this.iconList[i].spriteFrame=this.spriteFrames[o+"anim000"]),i>this.MONSTER_SIZE-1&&this.bossSpriteFrames[o]&&(this.iconList[i].spriteFrame=this.bossSpriteFrames[o]);var n=this.iconList[i].node.parent.getComponentInChildren(cc.Label);if(n.string="",e&&e.monsters&&e.monsters[o]&&e.monsters[o]>0){this.iconList[i].node.color=cc.color(255,255,255),n.node.color=cc.color(255,255,255),n.string=""+e.monsters[o];var r=0;if(e.monsters[o]&&e.monsters[o]>0&&(r=e.monsters[o]),n.string="",r>0){var l=r%20;r>100&&(l=20);for(var c="",h=0;h<l;h+=4)c+="\u2605";n.string=c;var p=Math.floor(r/20);p>t.length-1&&(p=t.length-1),n.node.color=cc.Color.WHITE.fromHEX(t[p])}}else this.iconList[i].node.color=cc.color(0,0,0)}}},e.prototype.start=function(){},e.prototype.backToHome=function(){cc.director.loadScene("start"),r.default.play(r.default.SELECT)},e.addMonsterKillAchievement=function(t){var e=s.default.getAchievementData();e.monsters[t]?e.monsters[t]=e.monsters[t]+1:e.monsters[t]=1,s.default.saveAchievementData(e)},e.addPlayerDiedLifesAchievement=function(){var t=s.default.getAchievementData();t.playerLifes?t.playerLifes=t.playerLifes+1:t.playerLifes=1,s.default.saveAchievementData(t)},e.prototype.update=function(){this.isBossLoaded&&this.isMonsterLoaded&&(this.isBossLoaded=!0,this.isMonsterLoaded=!0,this.show())},n([h(cc.Node)],e.prototype,"content",void 0),n([h(cc.Node)],e.prototype,"contentBottom",void 0),n([h(cc.Prefab)],e.prototype,"prefab",void 0),n([h(cc.Label)],e.prototype,"lifesLabel",void 0),n([h(cc.Label)],e.prototype,"coinLabel",void 0),n([h(cc.Label)],e.prototype,"goldLabel",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Utils/AudioPlayer":"AudioPlayer","./Utils/LocalStorage":"LocalStorage"}],ActorAttackBox:[function(t,e,i){"use strict";cc._RF.push(e,"c5bd3A3tgpJso8uoa83DjVW","ActorAttackBox");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/FromData"),s=t("../Base/Actor"),l=t("../Utils/ActorUtils"),c=cc._decorator,h=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isEnemy=!1,e.attackType=0,e.isAttacking=!1,e.hv=cc.v3(1,0),e.isSpecial=!1,e.isLarge=!1,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.node.opacity=0,this.collider=this.getComponent(cc.BoxCollider)},e.prototype.init=function(t,e,i){this.isEnemy=i,this.nonPlayer=t,this.dungeon=e},e.prototype.start=function(){},e.prototype.show=function(t,e,i,o){this.nonPlayer&&(this.isLarge=i,this.isSpecial=e,this.attackType=t,this.changeBoxSize(t),this.node.opacity=80,this.setHv(o))},e.prototype.changeBoxSize=function(t){var e=80,o=cc.v2(e/2,0);switch(this.node.anchorX=0,this.node.width=this.isLarge?1.5*e:e,this.node.height=e,this.node.position=cc.v3(-16,32),this.collider.offset=o,this.collider.size.width=this.isLarge?1.5*e:e,this.collider.size.height=e,t){case i.ATTACK_NORMAL:break;case i.ATTACK_STAB:this.node.width=this.isSpecial?400:200,this.collider.offset=cc.v2(0,0);break;case i.ATTACK_AREA:this.node.anchorX=.5,e=160,this.isLarge&&(e=320),this.node.width=e,this.node.height=e,this.node.position=cc.v3(0,32),this.collider.size.width=e,this.collider.size.height=e,this.collider.offset=cc.v2(0,0)}},e.prototype.hide=function(t){this.isAttacking=!t,this.node.opacity=0},e.prototype.finish=function(){this.node.opacity=0,this.isAttacking=!1,this.isSpecial=!1},e.prototype.onCollisionStay=function(t){if(this.isAttacking&&this.nonPlayer){var e=t.getComponent(s.default),i=this.nonPlayer;if(l.default.getEnemyCollisionTarget(t,!this.isEnemy)){this.isAttacking=!1;var o=r.default.getClone(i.data.nameCn,i.data.resName+"anim000"),a=i.data.getAttackPoint();a.isBackAttack=i.isFaceTargetBehind(e)&&i.data.FinalCommon.damageBack>0,a.isBackAttack&&(a.realDamage+=i.data.FinalCommon.damageBack),a.isMelee=!0,this.isSpecial&&(a.physicalDamage=2*a.physicalDamage),e.takeDamage(a,o,this.nonPlayer)&&i.addPlayerStatus(e,o),this.isSpecial=!1}}},e.prototype.setHv=function(t){if(this.hv=t.normalizeSelf(),0!=this.hv.x||0!=this.hv.y){var e=cc.v3(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(e)}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.02&&(this.checkTimeDelay=0,!0)},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),i=360/(2*Math.PI),o=360-Math.atan2(e.x,e.y)*i;this.node.scaleX=this.nonPlayer.node.scaleX>0?1:-1,o+=90,this.node.angle=-1==this.node.scaleX?o-180:o},e.ATTACK_NORMAL=0,e.ATTACK_STAB=1,e.ATTACK_AREA=2,i=n([h],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/FromData":"FromData","../Utils/ActorUtils":"ActorUtils"}],ActorUtils:[function(t,e,i){"use strict";cc._RF.push(e,"01700dV3iVC1p7rezKVnsyV","ActorUtils");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Actor/ColliderTag"),n=t("../Base/Actor"),r=t("../Boss/Boss"),s=t("../Logic"),l=t("../NonPlayer"),c=t("../Player"),h=cc._decorator,p=h.ccclass,u=(h.property,function(){function t(){}var e;return e=t,t.getEnemyCollisionTarget=function(t,e){if(e){if(t.tag==a.ColliderTag.NONPLAYER||t.tag==a.ColliderTag.BOSS)return t.node.getComponent(n.default)}else if(t.tag==a.ColliderTag.PLAYER||t.tag==a.ColliderTag.GOODNONPLAYER)return t.node.getComponent(n.default);return null},t.getEnemyActorByNode=function(t,e){if(e){if((o=t.getComponent(l.default))&&o.data.isEnemy>0)return o;var i=t.getComponent(r.default);if(i)return i}else{var o,a=t.getComponent(c.default);if(a)return a;if((o=t.getComponent(l.default))&&o.data.isEnemy<1)return o}return null},t.getPlayerPosition=function(t,i,o){return e.getNearestTargetPosition(t,[n.default.TARGET_PLAYER],i,!0,o)},t.getNearestEnemyPosition=function(t,i,o,a,r){return e.getNearestTargetPosition(t,i?[n.default.TARGET_PLAYER,n.default.TARGET_NONPLAYER]:[n.default.TARGET_MONSTER,n.default.TARGET_NONPLAYER_ENEMY,n.default.TARGET_BOSS],o,a,r)},t.getNearestTargetPosition=function(t,i,o,a,n){var r=e.getNearestTargetActor(t,i,o,n||999999);return r?r.node.position:a?t.node.position.addSelf(cc.v3(s.default.getRandomNum(0,600)-300,s.default.getRandomNum(0,600)-300)):cc.Vec3.ZERO},t.getNearestEnemyActor=function(t,i,o){return e.getNearestTargetActor(t,i?[n.default.TARGET_PLAYER,n.default.TARGET_NONPLAYER]:[n.default.TARGET_MONSTER,n.default.TARGET_NONPLAYER_ENEMY,n.default.TARGET_BOSS],o)},t.getNearestTargetActor=function(t,e,i,o){for(var a,r=o||999999,l=[],c=0,h=e;c<h.length;c++){var p=h[c];if(p==n.default.TARGET_PLAYER)l.push(i.player);else if(p==n.default.TARGET_MONSTER)for(var u=0,d=i.monsterManager.monsterList;u<d.length;u++){var f=d[u];l.push(f)}else if(p==n.default.TARGET_BOSS)for(var g=0,y=i.monsterManager.bossList;g<y.length;g++){var m=y[g];l.push(m)}else if(p==n.default.TARGET_NONPLAYER)for(var v=0,E=i.nonPlayerManager.nonPlayerList;v<E.length;v++)(S=E[v]).data.isEnemy<1&&l.push(S);else if(p==n.default.TARGET_NONPLAYER_ENEMY)for(var _=0,D=i.nonPlayerManager.nonPlayerList;_<D.length;_++){var S;(S=D[_]).data.isEnemy>0&&l.push(S)}}for(var R=0,T=l;R<T.length;R++){var O=T[R];if(O.isValid&&!O.sc.isDied&&O.sc.isShow){var C=s.default.getDistance(t.node.position,O.getCenterPosition());C<r&&(r=C,a=O)}}return a||null},t.getNearestTargetDistance=function(t,e){return e?s.default.getDistance(t.node.position,e.node.position):999999},t.isTargetAlive=function(t){return!(!t||t.invisible||t.sc.isDied||!t.sc.isShow)},e=o([p],t)}());i.default=u,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Base/Actor":"Actor","../Boss/Boss":"Boss","../Logic":"Logic","../NonPlayer":"NonPlayer","../Player":"Player"}],Actor:[function(t,e,i){"use strict";cc._RF.push(e,"d1527FzjXVGUp0qJt0LJYgx","Actor");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./StateContext"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.invisible=!1,e.isFaceRight=!0,e.isFaceUp=!0,e.lights=[],e.sc=new r.default,e.seed=0,e}return a(e,t),e.TARGET_PLAYER=0,e.TARGET_MONSTER=1,e.TARGET_BOSS=2,e.TARGET_NONPLAYER=3,e.TARGET_NONPLAYER_ENEMY=4,n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"./StateContext":"StateContext"}],AirExit:[function(t,e,i){"use strict";cc._RF.push(e,"091edkNmgRCZq+fEAizpd4W","AirExit");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Player"),s=t("../Logic"),l=t("./Building"),c=t("../Utils/IndexZ"),h=t("../Dungeon"),p=t("../Actor/ColliderTag"),u=cc._decorator,d=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.dir=0,e.status=i.STATUS_CLOSE,e.sprite=null,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.sprite=this.getComponent(cc.Sprite),this.collider=this.getComponent(cc.PhysicsBoxCollider),this.node.zIndex=c.default.FLOOR},e.prototype.init=function(t,e){switch(this.dir=t,t){case 0:break;case 1:this.node.scaleY=-8;break;case 2:this.node.angle=90;break;case 3:this.node.angle=90,this.node.scaleY=-8}this.node.opacity=60,this.node.width=h.default.TILE_SIZE/8*e,this.collider||(this.collider=this.getComponent(cc.PhysicsBoxCollider)),this.getComponent(cc.BoxCollider).size=cc.size(this.node.width,this.node.height),this.collider.size=cc.size(this.node.width,this.node.height),this.collider.apply(),this.node.zIndex=c.default.OVERHEAD,this.changeStatus(i.STATUS_CLOSE)},e.prototype.changeStatus=function(t){this.status=t;var e="";switch(this.status){case i.STATUS_CLOSE:e="outertips3";break;case i.STATUS_WAIT:e="outertips2";break;case i.STATUS_OPEN:e="outertips1"}this.status==i.STATUS_OPEN?this.collider.sensor||(this.collider.sensor=!0,this.collider.apply()):this.collider.sensor&&(this.collider.sensor=!1,this.collider.apply()),this.sprite.spriteFrame=s.default.spriteFrameRes(e)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){var e=this;if(t.tag==p.ColliderTag.PLAYER){var o=t.node.getComponent(r.default);o&&this.status==i.STATUS_OPEN&&this.scheduleOnce(function(){s.default.playerData=o.data.clone(),s.default.loadingNextRoom(e.dir)},.1)}},e.STATUS_CLOSE=0,e.STATUS_WAIT=1,e.STATUS_OPEN=2,i=n([d],e)}(l.default));i.default=f,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../Logic":"Logic","../Player":"Player","../Utils/IndexZ":"IndexZ","./Building":"Building"}],AreaDetector:[function(t,e,i){"use strict";cc._RF.push(e,"77810+lX7JF67u57+eViJLm","AreaDetector");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Item/Bullet"),s=t("../NonPlayer"),l=t("../Utils/NextStep"),c=t("../Utils/Random"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.step=new l.default,e}return a(e,t),e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){var e=this;this.step.next(function(){var i=t.getComponent(r.default),o=e.node.parent.getComponent(s.default);if(i&&(i.isFromPlayer&&o.data.isEnemy>0||!i.isFromPlayer&&o.data.isEnemy<1)){var a=e.getRoate90Point(i.node.position,o.node.position,c.default.getHalfChance());a=a.sub(o.node.position),o.dodge(a)}},3)},e.prototype.getRoate90Point=function(t,e,i){return i?cc.v3(e.x+t.y-e.y,e.y-t.x+e.x):cc.v3(e.x-t.y+e.y,e.y+t.x-e.x)},n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../Item/Bullet":"Bullet","../NonPlayer":"NonPlayer","../Utils/NextStep":"NextStep","../Utils/Random":"Random"}],AreaOfEffectData:[function(t,e,i){"use strict";cc._RF.push(e,"33991eUauZNwoZkS4LCMfg4","AreaOfEffectData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Utils/IndexZ"),a=t("./DamageData"),n=t("./FromData"),r=function(){function t(){this.duration=0,this.interval=.1,this.delay=0,this.scale=0,this.zIndex=o.default.ACTOR,this.isRotate=!1,this.isFromEnemy=!1,this.canBreakBuilding=!1,this.canBreakBullet=!1,this.canBeatBack=!1,this.damage=new a.default,this.from=new n.default,this.statusList=[]}return t.prototype.init=function(t,e,i,o,a,n,r,s,l,c,h,p,u){return this.duration=t,this.delay=i,this.interval=e,this.scale=o,this.zIndex=a,this.isFromEnemy=n,this.canBreakBuilding=r,this.canBreakBullet=s,this.canBeatBack=l,this.isRotate=c,this.damage=h,this.from=p,this.statusList=u,this},t.prototype.valueCopy=function(t){t&&(this.duration=t.duration?t.duration:0,this.interval=t.interval?t.interval:.1,this.delay=t.delay?t.delay:0,this.scale=t.scale?t.scale:0,this.zIndex=t.zIndex?t.zIndex:o.default.ACTOR,this.isFromEnemy=!!t.isFromEnemy&&t.isFromEnemy,this.canBreakBuilding=!!t.canBreakBuilding&&t.canBreakBuilding,this.canBreakBullet=!!t.canBreakBullet&&t.canBreakBullet,this.isRotate=!!t.isRotate&&t.isRotate,this.canBeatBack=!!t.canBeatBack&&t.canBeatBack,this.statusList=t.statusList?t.statusList:[],this.damage.valueCopy(t.damage),this.from.valueCopy(t.from))},t.prototype.clone=function(){var e=new t;return e.duration=this.duration,e.interval=this.interval,e.delay=this.delay,e.scale=this.scale,e.isFromEnemy=this.isFromEnemy,e.canBreakBuilding=this.canBreakBuilding,e.canBreakBullet=this.canBreakBullet,e.canBeatBack=this.canBeatBack,e.damage=this.damage.clone(),e.from=this.from.clone(),e.statusList=this.statusList,e.zIndex=this.zIndex,e.isRotate=this.isRotate,e},t}();i.default=r,cc._RF.pop()},{"../Utils/IndexZ":"IndexZ","./DamageData":"DamageData","./FromData":"FromData"}],AreaOfEffect:[function(t,e,i){"use strict";cc._RF.push(e,"6a73blWLNVEw7zhXpbo521b","AreaOfEffect");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Boss/Boss"),s=t("../Data/DamageData"),l=t("../Utils/IndexZ"),c=t("../Building/HitBuilding"),h=t("../Data/AreaOfEffectData"),p=t("./ColliderTag"),u=t("../Utils/ActorUtils"),d=t("../Building/InteractBuilding"),f=cc._decorator,g=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasTargetMap={},e.isAttacking=!1,e.data=new h.default,e.usePool=!1,e.checkTimeDelay=0,e}return a(e,t),Object.defineProperty(e.prototype,"IsAttacking",{get:function(){return this.isAttacking},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.onEnable=function(){this.hasTargetMap={},this.isAttacking=!1},e.prototype.start=function(){},e.prototype.AnimFinish=function(){this.close()},e.prototype.close=function(){var t=this;this.scheduleOnce(function(){t.node&&t.node.isValid&&!t.usePool&&t.node.destroy(),t.destoryCallBack&&t.usePool&&t.destoryCallBack(t.node)},1),this.isAttacking=!1},e.prototype.show=function(t,e,i,o,a,n,r,s){var c=this;if(this.data.valueCopy(a),this.node.active=!0,this.node.parent=t,this.usePool=r,this.isAttacking=!0,this.killCallBack=n,this.destoryCallBack=s,this.node.setPosition(e),this.data.scale>0&&(this.node.scale=this.data.scale),this.data.isRotate){var h=this.getHv(i,o),p=cc.v2(h.x,h.y).signAngle(cc.v2(1,0)),u=cc.misc.radiansToDegrees(p);this.node.angle=360-u}this.node.zIndex=this.data.zIndex?this.data.zIndex:l.default.ACTOR,this.scheduleOnce(function(){c.isAttacking=!0},this.data.delay),this.data.duration>0&&this.scheduleOnce(function(){c.close()},this.data.duration);var d=this.getComponent(cc.Animation);d&&!d.playOnLoad&&d.play()},e.prototype.getHv=function(t,e){return cc.v3(cc.v2(t).rotateSelf(e*Math.PI/180)).normalizeSelf()},e.prototype.onCollisionStay=function(t,e){if(e.isValid&&this.isAttacking)if(this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0)this.hasTargetMap[t.node.uuid]++;else{this.hasTargetMap[t.node.uuid]=1;var i=!0;this.data.isFromEnemy||t.tag!=p.ColliderTag.GOODNONPLAYER&&t.tag!=p.ColliderTag.PLAYER||(i=!1),!this.data.isFromEnemy||t.tag!=p.ColliderTag.NONPLAYER&&t.tag!=p.ColliderTag.BOSS||(i=!1),i&&this.attacking(t.node,t.tag)}},e.prototype.attacking=function(t,e){if(t){var i=new s.default;if(i.valueCopy(this.data.damage),i.isRemote=!0,e==p.ColliderTag.PLAYER||e==p.ColliderTag.NONPLAYER||e==p.ColliderTag.GOODNONPLAYER||e==p.ColliderTag.BOSS){var o=t.convertToWorldSpaceAR(cc.Vec3.ZERO).subSelf(this.node.convertToWorldSpaceAR(cc.Vec3.ZERO)).normalizeSelf(),a=u.default.getEnemyActorByNode(t,!this.data.isFromEnemy);if(a&&!a.sc.isDied){a.takeDamage(i,this.data.from)&&(a.data.currentHealth<=0&&this.killCallBack&&this.killCallBack(a),this.data.canBeatBack&&!a.getComponent(r.default)&&this.beatBack(a,o));for(var n=0,l=this.data.statusList;n<l.length;n++){var h=l[n];a.addStatus(h,this.data.from)}}}else if(e==p.ColliderTag.BUILDING){var f=t.getComponent(d.default);if(this.data.canBreakBuilding&&f)return void f.takeDamage(i);var g=t.getComponent(c.default);this.data.canBreakBuilding&&g&&g.takeDamage(i)}}},e.prototype.beatBack=function(t,e){var i=t.getComponent(cc.RigidBody),o=e.clone();o.equals(cc.Vec3.ZERO)&&(o=cc.v3(1,0)),o=o.normalizeSelf().mul(300),this.scheduleOnce(function(){i.applyLinearImpulse(cc.v2(o.x,o.y),i.getLocalCenter(),!0)},.1)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>this.data.interval&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&(this.hasTargetMap={})},n([g],e)}(cc.Component));i.default=y,cc._RF.pop()},{"../Boss/Boss":"Boss","../Building/HitBuilding":"HitBuilding","../Building/InteractBuilding":"InteractBuilding","../Data/AreaOfEffectData":"AreaOfEffectData","../Data/DamageData":"DamageData","../Utils/ActorUtils":"ActorUtils","../Utils/IndexZ":"IndexZ","./ColliderTag":"ColliderTag"}],AttributeData:[function(t,e,i){"use strict";cc._RF.push(e,"3df7eU5e+9JzoOx3mUEhHmJ","AttributeData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(t,e,i,o,a,n){this.name="",this.id=0,this.resName="",this.desc="",this.name1="",this.desc1="",this.id=t,this.name=e,this.resName=i,this.desc=o,this.desc1=n,this.name1=a},cc._RF.pop()},{}],AttributeSelector:[function(t,e,i){"use strict";cc._RF.push(e,"1ba37UErLJKsamr/CQR4tOg","AttributeSelector");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arrowLeft=null,e.arrowRight=null,e.label=null,e.title=null,e.nameList=[],e.currentIndex=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.arrowLeft.on(cc.Node.EventType.TOUCH_START,function(){t.currentIndex--,t.updateAttribute()}),this.arrowRight.on(cc.Node.EventType.TOUCH_START,function(){t.currentIndex++,t.updateAttribute()})},e.prototype.selectRandom=function(){this.currentIndex=r.default.getRandomNum(0,this.nameList.length-1),this.updateAttribute()},e.prototype.selectNext=function(t){t?this.currentIndex--:this.currentIndex++,this.updateAttribute()},e.prototype.init=function(t,e,i){this.title.string=t,this.nameList=e,this.currentIndex=i||0,this.updateAttribute()},e.prototype.updateAttribute=function(){this.currentIndex<0?this.currentIndex=this.nameList.length-1:this.currentIndex>this.nameList.length-1&&(this.currentIndex=0),this.label.string=this.nameList[this.currentIndex].name,this.selectorCallback&&this.selectorCallback(this.nameList[this.currentIndex])},n([c(cc.Node)],e.prototype,"arrowLeft",void 0),n([c(cc.Node)],e.prototype,"arrowRight",void 0),n([c(cc.Label)],e.prototype,"label",void 0),n([c(cc.Label)],e.prototype,"title",void 0),n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../Logic":"Logic"}],AudioPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"76c8da4ThVB/L/QkXaZyrPc","AudioPlayer");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("../Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monsterHit=null,e.pickUp=null,e.playerHit=null,e.remoteLaser=null,e.shoot=null,e.coin=null,e.boom=null,e.dash=null,e.die=null,e.exit=null,e.pickItem=null,e.melee=null,e.walk=null,e.blink=null,e.select=null,e.bossicedemonattack=null,e.meleereflect=null,e.raindrop=null,e.skillfireball=null,e.skillicethron=null,e.skillmagicball=null,e.skillmagicball1=null,e.bossicedemondash=null,e.bossicedemondefend=null,e.bossicedemonhit=null,e.bossicedemonthron=null,e.wentlineopen=null,e.wentlineshow=null,e.zombieattack=null,e.zombiespitting=null,e.swordshow=null,e.electricattack=null,e.punch=null,e.fist=null,e.swordattack=null,e.swordhit=null,e.bleeding=null,e.cashiering=null,e.chicken=null,e.closestool=null,e.fireball=null,e.mutant=null,e.reload=null,e.scarabcrawl=null,e.shoot001=null,e.shoot002=null,e.shoot003=null,e.shoot004=null,e.takephoto=null,e.transportship=null,e.tvcolor=null,e.tvwhite=null,e.welcome=null,e.iceboom=null,e.levelup=null,e.complete=null,e.oilgold=null,e.dog=null,e.bg01=null,e.bg02=null,e.lastName="",e.isSoundNeedPause=!1,e.audioList={},e.lastBgmIndex=-1,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;r.EventHelper.on(r.EventHelper.PLAY_AUDIO,function(e){t.playSound(e.name,e.bgm,e.loop)}),r.EventHelper.on(r.EventHelper.STOP_ALL_AUDIO_EFFECT,function(){t.stopAllEffect()}),cc.audioEngine.setMusicVolume(.2),cc.audioEngine.setEffectsVolume(.3),this.audioList[i.MONSTER_HIT]=this.monsterHit,this.audioList[i.PICK_UP]=this.pickUp,this.audioList[i.PLAYER_HIT]=this.playerHit,this.audioList[i.REMOTE_LASER]=this.remoteLaser,this.audioList[i.SHOOT]=this.shoot,this.audioList[i.BOOM]=this.boom,this.audioList[i.COIN]=this.coin,this.audioList[i.MELEE]=this.melee,this.audioList[i.WALK]=this.walk,this.audioList[i.EXIT]=this.exit,this.audioList[i.DASH]=this.dash,this.audioList[i.DIE]=this.die,this.audioList[i.PICK_ITEM]=this.pickItem,this.audioList[i.SELECT]=this.select,this.audioList[i.BLINK]=this.blink,this.audioList[i.BOSS_ICEDEMON_DASH]=this.bossicedemondash,this.audioList[i.BOSS_ICEDEMON_DEFEND]=this.bossicedemondefend,this.audioList[i.BOSS_ICEDEMON_HIT]=this.bossicedemonhit,this.audioList[i.BOSS_ICEDEMON_THRON]=this.bossicedemonthron,this.audioList[i.BOOS_ICEDEMON_ATTACK]=this.bossicedemonattack,this.audioList[i.MELEE_PARRY]=this.meleereflect,this.audioList[i.RAINDROP]=this.raindrop,this.audioList[i.SKILL_FIREBALL]=this.skillfireball,this.audioList[i.SKILL_ICETHRON]=this.skillicethron,this.audioList[i.SKILL_MAGICBALL]=this.skillmagicball,this.audioList[i.SKILL_MAGICBALL1]=this.skillmagicball1,this.audioList[i.WENTLINE_OPEN]=this.wentlineopen,this.audioList[i.WENTLINE_SHOW]=this.wentlineshow,this.audioList[i.ZOMBIE_ATTACK]=this.zombieattack,this.audioList[i.ZOMBIE_SPITTING]=this.zombiespitting,this.audioList[i.SWORD_SHOW]=this.swordshow,this.audioList[i.ELECTRIC_ATTACK]=this.electricattack,this.audioList[i.PUNCH]=this.punch,this.audioList[i.SWORD_ATTACK]=this.swordattack,this.audioList[i.SWORD_HIT]=this.swordhit,this.audioList[i.FIST]=this.fist,this.audioList[i.BLEEDING]=this.bleeding,this.audioList[i.CASHIERING]=this.cashiering,this.audioList[i.CHICKEN]=this.chicken,this.audioList[i.CLOSESTOOL]=this.closestool,this.audioList[i.FIREBALL]=this.fireball,this.audioList[i.MUTANT]=this.mutant,this.audioList[i.RELOAD]=this.reload,this.audioList[i.SCARABCRAWL]=this.scarabcrawl,this.audioList[i.SHOOT001]=this.shoot001,this.audioList[i.SHOOT002]=this.shoot002,this.audioList[i.SHOOT003]=this.shoot003,this.audioList[i.SHOOT004]=this.shoot004,this.audioList[i.TAKEPHOTO]=this.takephoto,this.audioList[i.TRANSPORTSHIP]=this.transportship,this.audioList[i.TVCOLOR]=this.tvcolor,this.audioList[i.TVWHITE]=this.tvwhite,this.audioList[i.WELCOME]=this.welcome,this.audioList[i.ICEBOOM]=this.iceboom,this.audioList[i.LEVELUP]=this.levelup,this.audioList[i.COMPLETE]=this.complete,this.audioList[i.OILGOLD]=this.oilgold,this.audioList[i.DOG]=this.dog},e.prototype.playbg=function(){var t=[this.bg01,this.bg02][s.default.lastBgmIndex];!t||cc.audioEngine.isMusicPlaying()&&this.lastBgmIndex==s.default.lastBgmIndex||(cc.audioEngine.stopMusic(),cc.audioEngine.playMusic(t,!0),this.lastBgmIndex=s.default.lastBgmIndex)},e.prototype.stopAllEffect=function(){cc.audioEngine.stopAllEffects()},e.prototype.playSound=function(t,e,o){var a=this;if(t!=this.lastName||!this.isSoundNeedPause){if(e)switch(t){case i.STOP_BG:cc.audioEngine.stopMusic();break;case i.PLAY_BG:this.playbg()}else this.audioList[t]&&cc.audioEngine.playEffect(this.audioList[t],o);this.lastName=t,this.isSoundNeedPause=!0,this.scheduleOnce(function(){a.isSoundNeedPause=!1},.1)}},e.play=function(t,e,i){r.EventHelper.emit(r.EventHelper.PLAY_AUDIO,{name:t,bgm:e,loop:i})},e.stopAllEffect=function(){r.EventHelper.emit(r.EventHelper.STOP_ALL_AUDIO_EFFECT,{})},e.MONSTER_HIT="MONSTER_HIT",e.PICK_UP="PICK_UP",e.PLAYER_HIT="PLAYER_HIT",e.REMOTE_LASER="REMOTE_LASER",e.SHOOT="SHOOT",e.BOOM="BOOM",e.COIN="COIN",e.MELEE="MELEE",e.WALK="WALK",e.DASH="DASH",e.DIE="DIE",e.PICK_ITEM="PICK_ITEM",e.EXIT="EXIT",e.STOP_BG="STOP_BG",e.PLAY_BG="PLAY_BG",e.SELECT="SELECT",e.BLINK="BLINK",e.BOSS_ICEDEMON_DASH="BOSS_ICEDEMON_DASH",e.BOSS_ICEDEMON_DEFEND="BOSS_ICEDEMON_DEFEND",e.BOSS_ICEDEMON_HIT="BOSS_ICEDEMON_HIT",e.BOSS_ICEDEMON_THRON="BOSS_ICEDEMON_THRON",e.BOOS_ICEDEMON_ATTACK="BOOS_ICEDEMON_ATTACK",e.MELEE_PARRY="MELEE_PARRY",e.RAINDROP="RAINDROP",e.SKILL_FIREBALL="SKILL_FIREBALL",e.SKILL_ICETHRON="SKILL_ICETHRON",e.SKILL_MAGICBALL="SKILL_MAGICBALL",e.SKILL_MAGICBALL1="SKILL_MAGICBALL",e.WENTLINE_OPEN="WENTLINE_OPEN",e.WENTLINE_SHOW="WENTLINE_SHOW",e.ZOMBIE_ATTACK="ZOMBIE_ATTACK",e.ZOMBIE_SPITTING="ZOMBIE_SPITTING",e.SWORD_SHOW="SWORD_SHOW",e.ELECTRIC_ATTACK="ELECTRIC_ATTACK",e.PUNCH="PUNCH",e.FIST="FIST",e.SWORD_ATTACK="SWORD_ATTACK",e.SWORD_HIT="SWORD_HIT",e.BLEEDING="BLEEDING",e.CASHIERING="CASHIERING",e.CHICKEN="CHICKEN",e.CLOSESTOOL="CLOSESTOOL",e.FIREBALL="FIREBALL",e.MUTANT="MUTANT ",e.RELOAD="RELOAD ",e.SCARABCRAWL="SCARABCRAWL",e.SHOOT001="SHOOT001",e.SHOOT002="SHOOT002",e.SHOOT003="SHOOT003",e.SHOOT004="SHOOT004",e.TAKEPHOTO="TAKEPHOTO ",e.TRANSPORTSHIP="TRANSPORTSHIP",e.TVCOLOR="TVCOLOR",e.TVWHITE="TVWHITE",e.WELCOME="WELCOME",e.ICEBOOM="ICEBOOM",e.LEVELUP="LEVELUP",e.COMPLETE="COMPLETE",e.OILGOLD="OILGOLD",e.DOG="DOG",n([h({type:cc.AudioClip})],e.prototype,"monsterHit",void 0),n([h({type:cc.AudioClip})],e.prototype,"pickUp",void 0),n([h({type:cc.AudioClip})],e.prototype,"playerHit",void 0),n([h({type:cc.AudioClip})],e.prototype,"remoteLaser",void 0),n([h({type:cc.AudioClip})],e.prototype,"shoot",void 0),n([h({type:cc.AudioClip})],e.prototype,"coin",void 0),n([h({type:cc.AudioClip})],e.prototype,"boom",void 0),n([h({type:cc.AudioClip})],e.prototype,"dash",void 0),n([h({type:cc.AudioClip})],e.prototype,"die",void 0),n([h({type:cc.AudioClip})],e.prototype,"exit",void 0),n([h({type:cc.AudioClip})],e.prototype,"pickItem",void 0),n([h({type:cc.AudioClip})],e.prototype,"melee",void 0),n([h({type:cc.AudioClip})],e.prototype,"walk",void 0),n([h({type:cc.AudioClip})],e.prototype,"blink",void 0),n([h({type:cc.AudioClip})],e.prototype,"select",void 0),n([h({type:cc.AudioClip})],e.prototype,"bossicedemonattack",void 0),n([h({type:cc.AudioClip})],e.prototype,"meleereflect",void 0),n([h({type:cc.AudioClip})],e.prototype,"raindrop",void 0),n([h({type:cc.AudioClip})],e.prototype,"skillfireball",void 0),n([h({type:cc.AudioClip})],e.prototype,"skillicethron",void 0),n([h({type:cc.AudioClip})],e.prototype,"skillmagicball",void 0),n([h({type:cc.AudioClip})],e.prototype,"skillmagicball1",void 0),n([h({type:cc.AudioClip})],e.prototype,"bossicedemondash",void 0),n([h({type:cc.AudioClip})],e.prototype,"bossicedemondefend",void 0),n([h({type:cc.AudioClip})],e.prototype,"bossicedemonhit",void 0),n([h({type:cc.AudioClip})],e.prototype,"bossicedemonthron",void 0),n([h({type:cc.AudioClip})],e.prototype,"wentlineopen",void 0),n([h({type:cc.AudioClip})],e.prototype,"wentlineshow",void 0),n([h(cc.AudioClip)],e.prototype,"zombieattack",void 0),n([h(cc.AudioClip)],e.prototype,"zombiespitting",void 0),n([h(cc.AudioClip)],e.prototype,"swordshow",void 0),n([h(cc.AudioClip)],e.prototype,"electricattack",void 0),n([h(cc.AudioClip)],e.prototype,"punch",void 0),n([h(cc.AudioClip)],e.prototype,"fist",void 0),n([h(cc.AudioClip)],e.prototype,"swordattack",void 0),n([h(cc.AudioClip)],e.prototype,"swordhit",void 0),n([h(cc.AudioClip)],e.prototype,"bleeding",void 0),n([h(cc.AudioClip)],e.prototype,"cashiering",void 0),n([h(cc.AudioClip)],e.prototype,"chicken",void 0),n([h(cc.AudioClip)],e.prototype,"closestool",void 0),n([h(cc.AudioClip)],e.prototype,"fireball",void 0),n([h(cc.AudioClip)],e.prototype,"mutant",void 0),n([h(cc.AudioClip)],e.prototype,"reload",void 0),n([h(cc.AudioClip)],e.prototype,"scarabcrawl",void 0),n([h(cc.AudioClip)],e.prototype,"shoot001",void 0),n([h(cc.AudioClip)],e.prototype,"shoot002",void 0),n([h(cc.AudioClip)],e.prototype,"shoot003",void 0),n([h(cc.AudioClip)],e.prototype,"shoot004",void 0),n([h(cc.AudioClip)],e.prototype,"takephoto",void 0),n([h(cc.AudioClip)],e.prototype,"transportship",void 0),n([h(cc.AudioClip)],e.prototype,"tvcolor",void 0),n([h(cc.AudioClip)],e.prototype,"tvwhite",void 0),n([h(cc.AudioClip)],e.prototype,"welcome",void 0),n([h(cc.AudioClip)],e.prototype,"iceboom",void 0),n([h(cc.AudioClip)],e.prototype,"levelup",void 0),n([h(cc.AudioClip)],e.prototype,"complete",void 0),n([h(cc.AudioClip)],e.prototype,"oilgold",void 0),n([h(cc.AudioClip)],e.prototype,"dog",void 0),n([h(cc.AudioClip)],e.prototype,"bg01",void 0),n([h(cc.AudioClip)],e.prototype,"bg02",void 0),i=n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../EventHelper":"EventHelper","../Logic":"Logic"}],AvatarData:[function(t,e,i){"use strict";cc._RF.push(e,"78b51+ej+hHW50Cw1oQcuRl","AvatarData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ProfessionData"),a=function(){function t(){this.organizationIndex=0,this.professionData=new o.default,this.skinColor="#ffe1c5",this.hairResName="avatarhair000anim00",this.hairColor="#000000",this.eyesResName="avatareyes000",this.eyesColor="#000000",this.faceResName="avatarface000",this.faceColor="#FBA1DE"}return t.prototype.valueCopy=function(t){t&&(this.organizationIndex=t.organizationIndex?t.organizationIndex:this.organizationIndex,this.professionData.valueCopy(t.professionData),this.skinColor=t.skinColor?t.skinColor:this.skinColor,this.hairResName=t.hairResName?t.hairResName:this.hairResName,this.hairColor=t.hairColor?t.hairColor:this.hairColor,this.eyesResName=t.eyesResName?t.eyesResName:this.eyesResName,this.eyesColor=t.eyesColor?t.eyesColor:this.eyesColor,this.faceResName=t.faceResName?t.faceResName:this.faceResName,this.faceColor=t.faceColor?t.faceColor:this.faceColor)},t.prototype.clone=function(){var e=new t;return e.organizationIndex=this.organizationIndex,e.professionData=this.professionData,e.skinColor=this.skinColor,e.hairResName=this.hairResName,e.hairColor=this.hairColor,e.eyesResName=this.eyesResName,e.eyesColor=this.eyesColor,e.faceResName=this.faceResName,e.faceColor=this.faceColor,e},t.FOLLOWER=0,t.HUNTER=1,t.GURAD=2,t.TECH=3,t.ORGANIZATION=["\u5f25\u4e16\u9010\u6d41","\u5b9d\u85cf\u730e\u4eba","\u5e7d\u5149\u5b88\u62a4","\u7fe0\u91d1\u79d1\u6280"],t}();i.default=a,cc._RF.pop()},{"./ProfessionData":"ProfessionData"}],BaseData:[function(t,e,i){"use strict";cc._RF.push(e,"104f7mgC6BFIYLmzL4FKFUV","BaseData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Utils/Random"),a=function(){function t(){}return t.prototype.genNonDuplicateID=function(){return Number(o.default.rand().toString().substr(3,16)+Date.now()).toString(36)},t}();i.default=a,cc._RF.pop()},{"../Utils/Random":"Random"}],BaseDialog:[function(t,e,i){"use strict";cc._RF.push(e,"5de11HhcHdDHbXLJONfG55W","BaseDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.dialogBg=null,e.cancelOutSide=!0,e._isAniming=!1,e}return a(e,t),Object.defineProperty(e.prototype,"isAniming",{get:function(){return this._isAniming},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return 1==this.node.active},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;this.bg=this.node.getChildByName("bg"),this.dialogBg=this.node.getChildByName("dialogbg"),this.bg.on(cc.Node.EventType.TOUCH_END,function(){t.cancelOutSide&&t.dismiss()},this)},e.prototype.start=function(){},e.prototype.setCanceledOnTouchOutside=function(t){this.cancelOutSide=t},e.prototype.show=function(){var t=this;this._isAniming||(this._isAniming=!0,this.node.active=!0,this.node.opacity=255,this.node.scale=0,cc.tween(this.node).to(.1,{scale:.1}).to(.1,{scaleX:1}).to(.1,{scaleY:1}).call(function(){t._isAniming=!1}).start())},e.prototype.dismiss=function(){var t=this;this._isAniming||(this._isAniming=!0,cc.tween(this.node).to(.1,{scaleY:.1}).to(.1,{scaleX:0}).to(.1,{opacity:0}).call(function(){t.node.active=!1,t._isAniming=!1,t.dismissCallBack&&t.dismissCallBack()}).start())},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],BaseManager:[function(t,e,i){"use strict";cc._RF.push(e,"c0fb6uxoAJAR6KX1Qx/juNE","BaseManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],BaseNonPlayerActorState:[function(t,e,i){"use strict";cc._RF.push(e,"920bbZwmdhLNqox7T/WQBj5","BaseNonPlayerActorState");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,n=a.ccclass,r=(a.property,function(){function t(){this._isRunnig=!1,this.showLog=!0}return Object.defineProperty(t.prototype,"isRunnig",{get:function(){return this._isRunnig},enumerable:!1,configurable:!0}),t.prototype.enter=function(){this._isRunnig=!0},t.prototype.update=function(){},t.prototype.exit=function(){this._isRunnig=!1},t.prototype.event=function(){return this._isRunnig=!0,!0},t.prototype.log=function(t){this.showLog&&cc.log(t)},o([n],t)}());i.default=r,cc._RF.pop()},{}],BlockLight:[function(t,e,i){"use strict";cc._RF.push(e,"200a5VPMNZOQ7QKn+qhQpb0","BlockLight");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.show=function(){var t=this;this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play(),this.scheduleOnce(function(){cc.director.emit(r.EventHelper.POOL_DESTORY_WALKSMOKE,{detail:{targetNode:t.node}})},.5)},n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"../EventHelper":"EventHelper"}],BossAttackCollider:[function(t,e,i){"use strict";cc._RF.push(e,"955f3FE6OVI9rSVX2x0s/2h","BossAttackCollider");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/FromData"),l=t("../Base/Actor"),c=t("../Utils/ActorUtils"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=9,e.parentNode=null,e.from=new s.default,e.isShow=!1,e}return a(e,t),e.prototype.start=function(){this.isShow=!1},e.prototype.showCollider=function(t,e){var i=this,o=e||0;this.scheduleOnce(function(){i.isShow=!0},o),this.scheduleOnce(function(){i.isShow=!1},t)},e.prototype.onCollisionEnter=function(t){var e=c.default.getEnemyCollisionTarget(t);if(e&&this.isShow&&this.node.active&&this.parentNode){this.isShow=!1;var i=new r.default;i.physicalDamage=this.damage,e.takeDamage(i,this.from,this.parentNode.getComponent(l.default))}},n([u],e.prototype,"damage",void 0),n([u(cc.Node)],e.prototype,"parentNode",void 0),n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Utils/ActorUtils":"ActorUtils"}],Boss:[function(t,e,i){"use strict";cc._RF.push(e,"27ef0INO8BDnrQF5OkIl5aV","Boss");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Dungeon"),l=t("../Manager/StatusManager"),c=t("../EventHelper"),h=t("../Base/Actor"),p=t("../Item/Item"),u=t("../Utils/IndexZ"),d=t("../Data/NonPlayerData"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statusManager=null,e.healthBar=null,e.pos=cc.v3(0,0),e.data=new d.default,e}return a(e,t),e.prototype.addStatus=function(t,e){this.node&&!this.sc.isDied&&this.statusManager&&this.statusManager.addStatus(t,e)},e.prototype.getNearPlayerDistance=function(t,e){var i=this.node.position.clone();return e&&i.addSelf(e),r.default.getDistance(this.node.position,t.position)},e.prototype.getCenterPosition=function(){return this.node.position.clone().addSelf(cc.v3(0,32*this.node.scaleY))},e.prototype.playHit=function(t){t&&(t.stopAllActions(),t.position=cc.v3(0,0),cc.tween(t).to(.1,{position:cc.v3(2,0)}).to(.1,{position:cc.v3(-2,0)}).to(.1,{position:cc.v3(2,0)}).to(.1,{position:cc.v3(-2,0)}).to(.1,{position:cc.v3(2,0)}).to(.1,{position:cc.v3(-2,0)}).to(.1,{position:cc.v3(2,0)}).to(.1,{position:cc.v3(0,0)}).start())},e.prototype.updatePlayerPos=function(){this.node.position=s.default.getPosInMap(this.pos)},e.prototype.transportBoss=function(t,e){this.pos.x=t,this.pos.y=e,this.changeZIndex(),this.updatePlayerPos()},e.prototype.changeZIndex=function(){this.node.zIndex=u.default.getActorZIndex(this.node.position)},e.prototype.start=function(){var t=this;this.changeZIndex(),this.scheduleOnce(function(){t.healthBar&&t.healthBar.refreshHealth(t.data.currentHealth,t.data.Common.maxHealth)},.1)},e.prototype.getLoot=function(t){if(this.dungeon){var e=r.default.mapManager.getRandom4Save(this.seed);c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_COIN,{pos:this.node.position,count:t?9:19}),t||c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_OILGOLD,{pos:this.node.position,count:100}),(r.default.getHalfChance()&&t||!t)&&(c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_ITEM,{pos:this.node.position,res:p.default.HEART}),c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_ITEM,{pos:this.node.position,res:p.default.DREAM})),this.dungeon.addEquipment(r.default.getRandomEquipType(e),s.default.getPosInMap(this.pos),null,t?0:3)}},e.prototype.showBoss=function(){},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a)},e.prototype.takeDizz=function(){},e.prototype.updateStatus=function(t,e){this.data.StatusTotalData.valueCopy(e)},e.prototype.hideSelf=function(){},e.prototype.updateDream=function(){return 0},e.prototype.setLinearVelocity=function(){},n([y(l.default)],e.prototype,"statusManager",void 0),n([g],e)}(h.default);i.default=m,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/NonPlayerData":"NonPlayerData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Item/Item":"Item","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Utils/IndexZ":"IndexZ"}],Box:[function(t,e,i){"use strict";cc._RF.push(e,"84b7dB47rlIALRzq2ZvOGc3","Box");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("./Building"),c=t("../EventHelper"),h=t("../Utils/AudioPlayer"),p=t("../Utils/IndexZ"),u=cc._decorator,d=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isBreaking=!1,e.boxType=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.anim.play("BoxShow")},e.prototype.start=function(){var t="box";switch(this.boxType){case i.BOX:t="box";break;case i.PLANT:t="plant";break;case i.BOXBREAKABLE:t="box"}switch(s.default.chapterIndex){case s.default.CHAPTER00:this.changeRes(t+"000");break;case s.default.CHAPTER01:this.changeRes(t+"001");break;case s.default.CHAPTER02:this.changeRes(t+"002");break;case s.default.CHAPTER03:this.changeRes(t+"003");break;case s.default.CHAPTER04:case s.default.CHAPTER05:this.changeRes(t+"004");break;case s.default.CHAPTER099:this.changeRes(t+"000")}},e.prototype.changeRes=function(t){var e=this.node.getChildByName("sprite").getComponent(cc.Sprite),i=s.default.spriteFrameRes(t);e.spriteFrame=i},e.prototype.setDefaultPos=function(t){this.data.defaultPos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=p.default.getActorZIndex(this.node.position)},e.prototype.BreakingFinish=function(){this.reset()},e.prototype.breakBox=function(){this.isBreaking||(cc.director.emit(c.EventHelper.PLAY_AUDIO,{detail:{name:h.default.MONSTER_HIT}}),this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("BoxBroken"),this.isBreaking=!0)},e.prototype.reset=function(){this.node.position=r.default.getPosInMap(this.data.defaultPos),this.isBreaking=!1},e.prototype.update=function(t){if(this.timeDelay+=t,this.timeDelay>.2){this.data.position=this.node.position;var e=s.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);e&&(e.position=this.data.position),this.node.zIndex=p.default.getActorZIndex(this.node.position)}},e.BOX=0,e.PLANT=1,e.BOXBREAKABLE=2,i=n([d],e)}(l.default));i.default=f,cc._RF.pop()},{"../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],BrightnessBar:[function(t,e,i){"use strict";cc._RF.push(e,"cd2d8XSihFHJ5/ASmPsHcdm","BrightnessBar");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slider=null,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){},e.prototype.init=function(){},e.prototype.setSelectorCallback=function(t){this.selectorCallback=t,this.updateAttribute()},e.prototype.selectRandom=function(){this.slider.progress=r.default.getRandomNum(0,10)/10,this.updateAttribute()},e.prototype.updateAttribute=function(){if(this.selectorCallback){var t=i.SKIN_COLORS,e=Math.floor(10*this.slider.progress);this.selectorCallback(cc.Color.WHITE.fromHEX(t[e]))}},e.SKIN=0,e.SKIN_COLORS=["#ffe8d2","#ffe1c5","#ebcaac","#e0c1a4","#ccad8f","#ad9075","#997E5B","#664e38","#473524","#291404","#1f1711"],n([c(cc.Slider)],e.prototype,"slider",void 0),i=n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../Logic":"Logic"}],BuildingData:[function(t,e,i){"use strict";cc._RF.push(e,"78dc5pt0FFGDaglLh5AJv4K","BuildingData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./EquipmentData"),a=t("./ItemData"),n=function(){function t(){this.isOpen=!1,this.quality=1,this.price=60,this.shopType=0,this.isSaled=!1,this.maxHealth=1,this.currentHealth=1,this.generatorList=[],this.generatorCount=0,this.generatorInterval=0,this.interact=0,this.rollover=0}return t.prototype.valueCopy=function(t){this.defaultPos=t.defaultPos?cc.v3(t.defaultPos.x,t.defaultPos.y):cc.v3(0,0),this.position=t.position?cc.v3(t.position.x,t.position.y):cc.v3(0,0),t.equipdata&&(this.equipdata=new o.default,this.equipdata.valueCopy(t.equipdata)),t.itemdata&&(this.itemdata=new a.default,this.itemdata.valueCopy(t.itemdata)),this.price=t.price,this.isSaled=t.isSaled,this.shopType=t.shopType,this.quality=t.quality?t.quality:1,this.isOpen=t.isOpen,this.maxHealth=t.maxHealth?t.maxHealth:0,this.currentHealth=t.currentHealth?t.currentHealth:0,this.generatorList=[],t.generatorList&&(this.generatorList=t.generatorList),this.generatorCount=t.generatorCount?t.generatorCount:0,this.generatorInterval=t.generatorInterval?t.generatorInterval:0,this.interact=t.interact?t.interact:0,this.rollover=t.rollover?t.rollover:0},t.prototype.clone=function(){var e=new t;return e.defaultPos=this.defaultPos,e.position=this.position,e.isOpen=this.isOpen,e.quality=this.quality,this.equipdata&&(e.equipdata=new o.default,e.equipdata.valueCopy(this.equipdata)),this.itemdata&&(e.itemdata=new a.default,e.itemdata.valueCopy(this.itemdata)),e.price=this.price,e.shopType=this.shopType,e.isSaled=this.isSaled,e.maxHealth=this.maxHealth,e.currentHealth=this.currentHealth,e.generatorInterval=this.generatorInterval,e.generatorCount=this.generatorCount,e.generatorList=this.generatorList,e.interact=this.interact,e.rollover=this.rollover,e},t}();i.default=n,cc._RF.pop()},{"./EquipmentData":"EquipmentData","./ItemData":"ItemData"}],BuildingManager:[function(t,e,i){"use strict";cc._RF.push(e,"ac92cjzIYlNDKOIneo1Pkvl","BuildingManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("../Building/FootBoard"),c=t("../Utils/IndexZ"),h=t("../Building/Saw"),p=t("../Building/Emplacement"),u=t("../Building/DecorationFloor"),d=t("../Building/Chest"),f=t("../Building/Box"),g=t("../Building/ShopTable"),y=t("../Building/FallStone"),m=t("../Building/MagicLightening"),v=t("../Building/HitBuilding"),E=t("../Building/ExitDoor"),_=t("../Building/Door"),D=t("../Building/Wall"),S=t("../Building/AirExit"),R=t("../Building/Portal"),T=t("../Building/RoomBed"),O=t("../Building/Building"),C=t("../Data/ExitData"),A=t("./BaseManager"),L=t("../Boss/DryadGrass"),P=t("../Utils/Utils"),b=t("../Effect/ShadowOfSight"),I=t("./LightManager"),M=t("../Building/SavePoint"),N=t("../Building/MartShelves"),x=t("./NonPlayerManager"),H=t("./MonsterManager"),B=t("../Building/MgWentLine"),w=t("../Building/RoomStool"),k=t("../Building/MgCrack"),F=t("../Building/InteractBuilding"),U=t("../Building/EnergyShield"),j=cc._decorator,G=j.ccclass,W=(j.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.footboards=new Array,e.exitdoors=new Array,e.portals=new Array,e.doors=new Array,e.airExits=new Array,e.monsterGeneratorList=new Array,e.coastColliderList=["128,128,0,0","128,128,0,0","128,128,0,0","128,128,0,0","128,64,0,-32","128,64,0,32","64,128,32,0","64,128,-32,0","64,64,-32,32","64,64,32,32","64,64,-32,-32","64,64,32,-32"],e.shelvesFoodIndex=0,e.drinkList=[],e.foodList=[],e.interactBuildings=[],e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.clear=function(){P.default.clearComponentArray(this.footboards),P.default.clearComponentArray(this.exitdoors),P.default.clearComponentArray(this.portals),P.default.clearComponentArray(this.doors),P.default.clearComponentArray(this.airExits),P.default.clearComponentArray(this.interactBuildings),this.footboards=new Array,this.exitdoors=new Array,this.portals=new Array,this.doors=new Array,this.airExits=new Array,this.drinkList=new Array,this.foodList=new Array,this.interactBuildings=new Array,this.shelvesFoodIndex=0},e.prototype.isThe=function(t,e){return-1!=t.indexOf(e)},e.prototype.isFirstEqual=function(t,e){return t[0]==e},e.prototype.addBuilding=function(t,e){var i=cc.instantiate(t);i.parent=this.node,i.position=r.default.getPosInMap(e),i.zIndex=c.default.getActorZIndex(i.position);var o=i.getComponent(O.default);return o&&(o.seed=s.default.mapManager.getSeedFromRoom(),o.data.defaultPos=e.clone(),o.lights=o.getComponentsInChildren(b.default),o.lights&&I.default.registerLight(o.lights)),i},e.prototype.addBuildingsFromMap=function(t,e,o,a,n){if(this.isFirstEqual(e,"*")){var y=cc.v3(0,0);o.x==r.default.WIDTH_SIZE-1?y=cc.v3(1,0):0==o.x?y=cc.v3(-1,0):o.y==r.default.HEIGHT_SIZE-1?y=cc.v3(0,1):0==o.y&&(y=cc.v3(0,-1)),0!=y.x||y.y}else if(this.isFirstEqual(e,"#"))this.addDirWalls(e,o,a,!1);else if(this.isFirstEqual(e,"-"))(S=this.addBuilding(s.default.getBuildings(i.DARKNESS),o)).zIndex=c.default.DARKNESS,"-0"==e&&(S.zIndex=c.default.ROOF);else if(this.isFirstEqual(e,"~")){var m=parseInt(e[1]);if(m>=0&&m<=9||"~a"==e||"~b"==e){var v=this.addBuilding(s.default.getBuildings(i.COAST),o),E=v.getComponent(cc.PhysicsBoxCollider),_=m;"~a"==e?_=10:"~b"==e&&(_=11),v.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=s.default.spriteFrameRes("coast00"+_);var D=this.coastColliderList[_].split(",");E.size=cc.size(parseInt(D[0]),parseInt(D[1])),E.offset=cc.v2(parseInt(D[2]),parseInt(D[3])),E.apply(),v.zIndex=c.default.WATER}else{var S;(S=this.addBuilding(s.default.getBuildings("~#"==e?i.WATERCOLLIDER:i.WATER),o)).zIndex=c.default.WATER}}else if("T0"==e)this.addBuilding(s.default.getBuildings(i.TRAP),o);else if("X0"==e)this.addBuilding(s.default.getBuildings(i.SAW),o).getComponent(h.default).setPos(o);else if(this.isFirstEqual(e,"G")){var O=this.addBuilding(s.default.getBuildings(i.EMPLACEMENT),o).getComponent(p.default);O.setDirType(e),O.dungeon=t}else if("F0"==e)this.addFallStone(r.default.getPosInMap(o),!1);else if("F1"==e)this.addLighteningFall(r.default.getPosInMap(o),!0,!0,!0);else if(this.isFirstEqual(e,"+"))if("+0"==e){var C=this.addBuilding(s.default.getBuildings(i.CAMPFIRE),o);C.parent=this.node;var A=C.getChildByName("sprite").getChildByName("shadow");A.position=r.default.getPosInMap(o),A.position=cc.v3(A.position.x,A.position.y+40),A.parent=this.node,A.zIndex=c.default.FLOOR;var L=C.getChildByName("sprite").getChildByName("fallentree");L.position=r.default.getPosInMap(o),L.position=cc.v3(A.position.x,A.position.y+40),L.parent=this.node,L.zIndex=c.default.getActorZIndex(L.position),L.setScale(6,4)}else if("+1"==e){if(0==s.default.level){var P=this.addBuilding(s.default.getBuildings(i.BED),o);P.scale=6,P.zIndex=c.default.OVERHEAD}}else if("+2"==e){var b=this.addBuilding(s.default.getBuildings(i.DECORATIONFLOOR),o);b.zIndex=c.default.FLOOR,b.getComponent(u.default).changeRes("exitarrow")}else if("+3"==e)this.addBuilding(s.default.getBuildings(i.AIRTRANSPORTMODEL),o);else if("+a"==e)this.addBuilding(s.default.getBuildings(i.GRASS01),o);else if("+b"==e)this.addBuilding(s.default.getBuildings(i.GRASS02),o);else if("+c"==e)this.addBuilding(s.default.getBuildings(i.GRASS03),o);else if("+d"==e)this.addBuilding(s.default.getBuildings(i.GRASS04),o);else{var I=this.addBuilding(s.default.getBuildings(i.DECORATIONFLOOR),o);I.zIndex=c.default.FLOOR;var N=I.getComponent(u.default);"++"==e?N.changeRes("exitarrow"):N.changeRes("dev")}else if(this.isFirstEqual(e,"O")){var w=this.addBuilding(s.default.getBuildings(i.DECORATIONOVERHEAD),o);"O1"==e&&(w.angle=90),w.opacity=80,w.zIndex=c.default.ROOF}else if("@@"==e){var U=this.addBuilding(s.default.getBuildings(i.FOOTBOARD),o);U.zIndex=c.default.FLOOR,this.footboards.push(U.getComponent(l.default))}else if("Q0"==e)this.addBuilding(s.default.getBuildings(i.TAROTTABLE),o);else if("C0"==e){var j=this.addBuilding(s.default.getBuildings(i.CHEST),o).getComponent(d.default);j.seDefaultPos(o);var G=(X=s.default.mapManager.getRandom4Save(j.seed)).rand(),W=1;G>.5&&G<.7?W=2:G>.7&&G<.8?W=3:G>.8&&G<.85&&(W=4),j.setQuality(W,!1);var q=s.default.mapManager.getCurrentMapBuilding(j.data.defaultPos);q?j.setQuality(q.quality,q.isOpen):s.default.mapManager.setCurrentBuildingData(j.data.clone())}else if(this.isFirstEqual(e,"B")){var Y=this.addBuilding(s.default.getBuildings(i.BOX),o).getComponent(f.default);Y.setDefaultPos(o),"B1"==e&&(Y.boxType=f.default.PLANT),(V=s.default.mapManager.getCurrentMapBuilding(Y.data.defaultPos))?Y.node.position=V.position.clone():s.default.mapManager.setCurrentBuildingData(Y.data.clone())}else if(this.isFirstEqual(e,"W")){var Z,V=s.default.mapManager.getCurrentMapBuilding(o),z=s.default.mapManager.getCurrentRoom().isReborn;V?(V.currentHealth>0||z)&&((Z=this.addBuilding(s.default.getBuildings(i.INTERACTBUILDING),o).getComponent(F.default)).node.position=V.position.clone(),Z.data.valueCopy(V),z&&(Z.node.position=r.default.getPosInMap(Z.data.defaultPos),Z.data.currentHealth=Z.data.maxHealth),Z.init(!0,parseInt(e[1])),this.interactBuildings.push(Z)):((Z=this.addBuilding(s.default.getBuildings(i.INTERACTBUILDING),o).getComponent(F.default)).data.currentHealth=5,s.default.mapManager.setCurrentBuildingData(Z.data.clone()),Z.init(!0,parseInt(e[1])),this.interactBuildings.push(Z))}else if("S0"==e){var K=this.addBuilding(s.default.getBuildings(i.SHOPTABLE),o).getComponent(g.default);K.setDefaultPos(o),z=s.default.mapManager.getCurrentRoom().isReborn;var X=s.default.mapManager.getRandom4Save(K.seed);K.data.shopType=X.getRandomNum(0,100)>10?g.default.EQUIPMENT:g.default.ITEM;var Q=s.default.mapManager.getCurrentMapBuilding(K.data.defaultPos);Q?(z&&Q.isSaled&&(Q.isSaled=!1,Q.equipdata=null,Q.itemdata=null,X=s.default.mapManager.getRandom4Save(s.default.mapManager.getRebornSeed(K.seed)),Q.shopType=X.getRandomNum(0,100)>10?g.default.EQUIPMENT:g.default.ITEM),K.data.valueCopy(Q)):s.default.mapManager.setCurrentBuildingData(K.data.clone()),K.showItem()}else if("S1"==e)this.addBuilding(s.default.getBuildings(i.SHOP),o);else if("S2"==e)this.addBuilding(s.default.getBuildings(i.SHOPMART),o).zIndex+=10;else if("Sa"==e||"Sb"==e||"Sc"==e)this.addMartShelves(e,o);else if("Sd"==e){this.addBuilding(s.default.getBuildings(i.MARTCASHIER),o);var J=r.default.getPosInMap(o);t.nonPlayerManager.addNonPlayerFromData(x.default.SHOP_KEEPER,cc.v3(J.x-60,J.y+180),t)}else if("Se"==e)this.addBuilding(s.default.getBuildings(i.MARTTABLE),o);else if(this.isFirstEqual(e,"D")){var $=parseInt(e[1]);isNaN($)&&("Da"==e?$=8:"Db"==e?$=9:"Dc"==e?$=10:"Dd"==e&&($=11)),this.addDoor($,o)}else if(this.isFirstEqual(e,"E"))$=parseInt(e[1]),isNaN($)&&("Ea"==e?$=10:"Eb"==e&&($=11)),this.addExitDoor($,o,n);else if(this.isFirstEqual(e,"P")){var tt=this.addBuilding(s.default.getBuildings(i.PORTAL),o),et=parseInt(e[1]),it=tt.getComponent(R.default);it.isBackDream=et>0,this.portals.push(it)}else if(this.isFirstEqual(e,"Z"))0==parseInt(e[1])||1==parseInt(e[1])?(tt=this.addBuilding(s.default.getBuildings(i.ROOMBED),o)).getComponent(T.default).init(t,1==parseInt(e[1])):this.addHitBuilding(t,e,o);else if(this.isFirstEqual(e,"H"))this.addHitBuilding(t,e,o);else if("R0"==e)(ot=this.addBuilding(s.default.getBuildings(i.SHIPSTAIRS),o)).setScale(16),ot.zIndex=c.default.WALLINTERNAL;else if("R1"==e){var ot;(ot=this.addBuilding(s.default.getBuildings(i.SHIPSTAIRS),o)).setScale(-16,16),ot.getComponent(cc.PhysicsBoxCollider).offset=cc.v2(-8,0),ot.getComponent(cc.PhysicsBoxCollider).apply(),ot.zIndex=c.default.WALLINTERNAL}else if("@S"==e){var at=this.addBuilding(s.default.getBuildings(i.SAVEPOINT),o);this.savePointS=at.getComponent(M.default)}else this.isFirstEqual(e,"L")?this.addLamp(e,o):"I0"==e?((tt=this.addBuilding(s.default.getBuildings(i.WENTLINE),o).getComponent(B.default)).init(t,5,3,[H.default.MONSTER_ZOOMBIE,H.default.MONSTER_BITE_ZOMBIE]),this.monsterGeneratorList.push(tt)):"I6"==e&&((tt=this.addBuilding(s.default.getBuildings(i.CRACK),o).getComponent(k.default)).init(t,.5,15,[H.default.MONSTER_SCARAB]),this.monsterGeneratorList.push(tt))},e.prototype.addBuildingsFromSideMap=function(t,e,o){if(this.isFirstEqual(t,"#"))this.addDirWalls(t,e,o,!0);else if(this.isFirstEqual(t,"-"))(p=this.addBuilding(s.default.getBuildings(i.DARKNESS),e)).zIndex=c.default.DARKNESS,"-0"==t&&(p.zIndex=c.default.ROOF);else if(this.isFirstEqual(t,"~")){var a=parseInt(t[1]);if(a>=0&&a<=9||"~a"==t||"~b"==t){var n=this.addBuilding(s.default.getBuildings(i.COAST),e),r=n.getComponent(cc.PhysicsBoxCollider),l=a;"~a"==t?l=10:"~b"==t&&(l=11),n.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=s.default.spriteFrameRes("coast00"+l);var h=this.coastColliderList[l].split(",");r.size=cc.size(parseInt(h[0]),parseInt(h[1])),r.offset=cc.v2(parseInt(h[2]),parseInt(h[3])),r.apply(),n.zIndex=c.default.WATER}else{var p;(p=this.addBuilding(s.default.getBuildings("~#"==t?i.WATERCOLLIDER:i.WATER),e)).zIndex=c.default.WATER}}else"+3"==t&&this.addBuilding(s.default.getBuildings(i.AIRTRANSPORTMODEL),e)},e.prototype.addLamp=function(t,e){var o=i.LAMPLIGHT,a=!1;switch(t){case"L0":o=i.LAMPLIGHT;break;case"L1":o=i.LAMPSUN,a=!0;break;case"L2":o=i.LAMPSHIP,a=!0;break;case"L3":o=i.MUSHROOM01;break;case"L4":o=i.MUSHROOM02;break;case"L5":o=i.MUSHROOM03;break;case"L6":o=i.MUSHROOM04;break;case"L7":o=i.LAMPSEARCH,a=!0;break;case"L8":o=i.LAMPTORCH,a=!0;break;case"L9":o=i.LAMPFIREPAN;break;case"La":o=i.LAMPROAD;break;case"Lb":o=i.LAMPFIREFLY}var n=this.addBuilding(s.default.getBuildings(o),e);a&&(n.zIndex=c.default.OVERHEAD+100)},e.prototype.getGoodsList=function(t){if(this.foodList.length<1&&this.drinkList.length<1)for(var e=0,i=s.default.goodsNameList;e<i.length;e++){var o=i[e],a=o.substring("goods".length,"goods".length+1);"0"==a?this.drinkList.push(o):"1"==a&&this.foodList.push(o)}if(t==N.default.TYPE_FRIDGE)return this.drinkList;for(var n=[],r=this.shelvesFoodIndex;r<N.default.SIZE_NORMAL;r++)this.shelvesFoodIndex<this.foodList.length&&n.push(this.foodList[this.shelvesFoodIndex++]);return n},e.prototype.addMartShelves=function(t,e){this.addBuilding(t==N.default.TYPE_FRIDGE?s.default.getBuildings(i.MARTFRIDGE):s.default.getBuildings(i.MARTSHELVES),e).getComponent(N.default).init(t,this.getGoodsList(t))},e.prototype.addExitDoor=function(t,e,o){for(var a=C.default.getRealWorldExitDataFromDream(s.default.chapterIndex,s.default.level),n=0,r=o;n<r.length;n++){var l=r[n];if(l.fromPos.equals(e)&&l.fromRoomPos.equals(cc.v3(s.default.mapManager.getCurrentRoom().x,s.default.mapManager.getCurrentRoom().y))){a.valueCopy(l);break}}var c=this.addBuilding(s.default.getBuildings(i.EXITDOOR),e).getComponent(E.default);c.init(t,a),this.exitdoors.push(c)},e.prototype.addAirExit=function(t){var e=this.addBuilding(s.default.getBuildings(i.AIREXIT),cc.v3(Math.floor(t.length/2),t[0].length)).getComponent(S.default),o=this.addBuilding(s.default.getBuildings(i.AIREXIT),cc.v3(Math.floor(t.length/2),-1)).getComponent(S.default),a=this.addBuilding(s.default.getBuildings(i.AIREXIT),cc.v3(-1,Math.floor(t[0].length/2))).getComponent(S.default),n=this.addBuilding(s.default.getBuildings(i.AIREXIT),cc.v3(t.length,Math.floor(t[0].length/2))).getComponent(S.default);this.airExits.push(e),this.airExits.push(o),this.airExits.push(a),this.airExits.push(n);for(var r=0;r<this.airExits.length;r++)this.airExits[r].init(r,r<2?t.length+2:t[0].length+2)},e.prototype.addDoor=function(t,e){var o=this.addBuilding(s.default.getBuildings(i.DOOR),e).getComponent(_.default);o.isDoor=!0,o.dir=t%4,o.isEmpty=t>3&&t<8,o.isLock=t>7,this.doors.push(o)},e.prototype.setDoors=function(t,e){for(var i=0,o=this.doors;i<o.length;i++)o[i].setOpen(t,e);for(var a=0,n=this.airExits;a<n.length;a++)n[a].changeStatus(t?S.default.STATUS_OPEN:S.default.STATUS_CLOSE);if(this.exitdoors.length>0)for(var r=0,s=this.exitdoors;r<s.length;r++){var l=s[r];t?l.openGate():l.closeGate()}if(this.portals.length>0)for(var c=0,h=this.portals;c<h.length;c++)l=h[c],t?l.openGate():l.closeGate()},e.prototype.addDirWalls=function(t,e,o,a){this.addBuilding(s.default.getBuildings(i.WALL),e).getComponent(D.default).init(t,o,a)},e.prototype.addHitBuilding=function(t,e,o){var a;"Z3"==e?a=this.addBuilding(s.default.getBuildings(i.ROOMTV),o):"Z9"==e?(a=this.addBuilding(s.default.getBuildings(i.ROOMSTOOL),o)).getComponent(w.default).init(o,t):a=this.addBuilding(s.default.getBuildings(i.HITBUILDING),o);var n=a.getComponent(v.default);n.setDefaultPos(o);var r="car",l=[],c=[],h=9999,p=4,u=!1;switch(e){case"H0":r="car",l=["shield001"],c=[],h=5,p=8;break;case"Z2":r="roomdesk";break;case"Z3":r="roomtv",p=6;break;case"Z4":r="roomsofa",p=10,u=!0;break;case"Z5":r="roomtable",p=10,u=!0;break;case"Z6":r="roomfridge",p=6;break;case"Z7":r="roomwash";break;case"Z8":r="roomcupboard",l=["weapon007"],c=[],h=50,p=6;break;case"Z9":r="roomstool";break;case"Za":r="roomkitchentable",p=6;break;case"Zb":r="roomkitchentable1";break;case"Zc":r="roomkitchentable2";break;case"Zd":r="roomkitchentable3";break;case"Ze":r="roombath";break;case"Zf":r="roomlittletable";break;case"Zg":r="roomlittletable1";break;case"Zh":r="roomlittletable2"}n.init(t,r,c,l,h,h,p,u);var d=s.default.mapManager.getCurrentMapBuilding(n.data.defaultPos);d?n.init(t,r,c,l,h,d.currentHealth,p,u):s.default.mapManager.setCurrentBuildingData(n.data.clone())},e.prototype.addFallStone=function(t,e,o){if(this.node){var a=cc.instantiate(s.default.getBuildings(i.FALLSTONE)),n=a.getComponent(y.default);n.isAuto=e,a.parent=this.node,a.position=t,a.zIndex=c.default.FLOOR,n.isAuto&&n.fall(o)}},e.prototype.addLighteningFall=function(t,e,o,a,n){if(this.node){var r=cc.instantiate(s.default.getBuildings(i.LIGHTENINGFALL)),l=r.getComponent(m.default);r.parent=this.node,r.position=t,r.zIndex=c.default.FLOOR,l.isTrigger=e,l.isTrigger||l.fall(o,a,n)}},e.prototype.addTwineGrass=function(t,e){if(this.node){var o=cc.instantiate(s.default.getBuildings(i.DRYADTWINE)),a=o.getComponent(L.default);a.isAuto=e,o.parent=this.node,o.position=t,o.zIndex=c.default.getActorZIndex(t),a.isAuto&&a.fall()}},e.prototype.addEnergyShield=function(t){if(!this.node)return null;var e=this.addBuilding(s.default.getBuildings(i.ENERGYSHIELD),t.pos);e.position=t.node.position.clone();var o=e.getComponent(U.default),a=8+Math.floor(s.default.playerData.OilGoldData.level/5);return o.init(t,10+3*s.default.playerData.OilGoldData.level,a),o},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.updateLogic=function(t,e){if(this.isCheckTimeDelay(t)){for(var i=200,o=null,a=this.interactBuildings.length-1;a>=0;a--){var n=this.interactBuildings[a];if(n.highLight(!1),!(n.isTaken||!n.isValid||n.data.currentHealth<=0)){var r=s.default.getDistance(n.node.position,e.node.position);r<i&&(i=r,o=n)}}i<96&&o?(o.highLight(!0),this.lastInteractBuilding=o):this.lastInteractBuilding=null}},e.AIREXIT="AirExit",e.AIRTRANSPORT="AirTransport",e.AIRTRANSPORTMODEL="AirTransportModel",e.BED="Bed",e.BOX="Box",e.CAMPFIRE="CampFire",e.CHEST="Chest",e.COAST="Coast",e.DARKNESS="Darkness",e.INTERACTBUILDING="InteractBuilding",e.DECORATIONFLOOR="DecorationFloor",e.DECORATIONOVERHEAD="DecorationOverHead",e.DOOR="Door",e.DRYADTWINE="DryadTwine",e.EMPLACEMENT="Emplacement",e.EXITDOOR="ExitDoor",e.FALLSTONE="FallStone",e.FOOTBOARD="FootBoard",e.HITBUILDING="HitBuilding",e.ICEDEMONTHRON="IceDemonThron",e.LIGHTENINGFALL="LighteningFall",e.MARTCASHIER="MartCashier",e.MARTFRIDGE="MartFridge",e.MARTSHELVES="MartShelves",e.MARTTABLE="MartTable",e.MIST="Mist",e.PORTAL="Portal",e.ROOMBED="RoomBed",e.ROOMTV="RoomTv",e.ROOMSTOOL="RoomStool",e.SAVEPOINT="SavePoint",e.SAW="Saw",e.SHIPSTAIRS="Shipstairs",e.SHOP="Shop",e.SHOPMART="ShopMart",e.SHOPTABLE="ShopTable",e.TAROTTABLE="TarotTable",e.TRAP="Trap",e.WALL="Wall",e.WATER="Water",e.LAMPLIGHT="LampLight",e.LAMPSUN="LampSun",e.LAMPSHIP="LampShip",e.LAMPSEARCH="LampSearch",e.LAMPFIREPAN="LampFirePan",e.LAMPTORCH="LampTorch",e.LAMPROAD="LampRoad",e.LAMPFIREFLY="LampFireFly",e.MUSHROOM01="MushRoom01",e.MUSHROOM02="MushRoom02",e.MUSHROOM03="MushRoom03",e.MUSHROOM04="MushRoom04",e.GRASS01="Grass01",e.GRASS02="Grass02",e.GRASS03="Grass03",e.GRASS04="Grass04",e.WENTLINE="WentLine",e.CRACK="Crack",e.WATERCOLLIDER="WaterCollider",e.ENERGYSHIELD="EnergyShield",i=n([G],e)}(A.default));i.default=W,cc._RF.pop()},{"../Boss/DryadGrass":"DryadGrass","../Building/AirExit":"AirExit","../Building/Box":"Box","../Building/Building":"Building","../Building/Chest":"Chest","../Building/DecorationFloor":"DecorationFloor","../Building/Door":"Door","../Building/Emplacement":"Emplacement","../Building/EnergyShield":"EnergyShield","../Building/ExitDoor":"ExitDoor","../Building/FallStone":"FallStone","../Building/FootBoard":"FootBoard","../Building/HitBuilding":"HitBuilding","../Building/InteractBuilding":"InteractBuilding","../Building/MagicLightening":"MagicLightening","../Building/MartShelves":"MartShelves","../Building/MgCrack":"MgCrack","../Building/MgWentLine":"MgWentLine","../Building/Portal":"Portal","../Building/RoomBed":"RoomBed","../Building/RoomStool":"RoomStool","../Building/SavePoint":"SavePoint","../Building/Saw":"Saw","../Building/ShopTable":"ShopTable","../Building/Wall":"Wall","../Data/ExitData":"ExitData","../Dungeon":"Dungeon","../Effect/ShadowOfSight":"ShadowOfSight","../Logic":"Logic","../Utils/IndexZ":"IndexZ","../Utils/Utils":"Utils","./BaseManager":"BaseManager","./LightManager":"LightManager","./MonsterManager":"MonsterManager","./NonPlayerManager":"NonPlayerManager"}],Building:[function(t,e,i){"use strict";cc._RF.push(e,"255a9MnBFxLp4C3tatPRINn","Building");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Base/Actor"),s=t("../Data/BuildingData"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new s.default,e}return a(e,t),e.prototype.takeDamage=function(){return!1},e.prototype.addStatus=function(){},e.prototype.getCenterPosition=function(){return this.node.position.clone()},e.prototype.actorName=function(){return""},e.prototype.takeDizz=function(){},e.prototype.updateStatus=function(){},e.prototype.hideSelf=function(){},e.prototype.updateDream=function(){return 0},e.prototype.setLinearVelocity=function(){},n([c],e)}(r.default));i.default=h,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/BuildingData":"BuildingData"}],BulletData:[function(t,e,i){"use strict";cc._RF.push(e,"081a6xA9tZAiZxbsh2+6iXp","BulletData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./DamageData"),a=t("./FromData"),n=function(){function t(){this.speed=0,this.isRect=0,this.isRotate=0,this.rotateAngle=0,this.isLaser=0,this.isDecelerate=0,this.decelerateDelta=0,this.delayDecelerate=0,this.isBoom=0,this.isPhysical=0,this.delaytrack=0,this.isTracking=0,this.lifeTime=0,this.size=1,this.resName="",this.lightName="",this.resNameLaser="",this.lightColor="#ffffff",this.fixedRotation=0,this.statusType="",this.statusRate=0,this.canBreakBuilding=0,this.isInvincible=0,this.damage=new o.default,this.from=new a.default}return t.prototype.valueCopy=function(t){this.speed=t.speed?t.speed:0,this.isRect=t.isRect?t.isRect:0,this.isRotate=t.isRotate?t.isRotate:0,this.rotateAngle=t.rotateAngle?t.rotateAngle:0,this.isDecelerate=t.isDecelerate?t.isDecelerate:0,this.decelerateDelta=t.decelerateDelta?t.decelerateDelta:0,this.delayDecelerate=t.delayDecelerate?t.delayDecelerate:0,this.isLaser=t.isLaser?t.isLaser:0,this.isBoom=t.isBoom?t.isBoom:0,this.isTracking=t.isTracking?t.isTracking:0,this.isPhysical=t.isPhysical?t.isPhysical:0,this.delaytrack=t.delaytrack?t.delaytrack:0,this.fixedRotation=t.fixedRotation?t.fixedRotation:0,this.size=t.size?t.size:1,this.lifeTime=t.lifeTime?t.lifeTime:0,this.resName=t.resName?t.resName:"",this.resNameLaser=t.resNameLaser?t.resNameLaser:"",this.lightName=t.lightName?t.lightName:"",this.statusType=t.statusType?t.statusType:"",this.statusRate=t.statusRate?t.statusRate:0,this.canBreakBuilding=t.canBreakBuilding?t.canBreakBuilding:0,this.isInvincible=t.isInvincible?t.isInvincible:0,this.lightColor=t.lightColor?t.lightColor:"#ffffff",this.damage.valueCopy(t.damage),this.from.valueCopy(t.from)},t.prototype.clone=function(){var e=new t;return e.speed=this.speed,e.isRect=this.isRect,e.isRotate=this.isRotate,e.rotateAngle=this.rotateAngle,e.decelerateDelta=this.decelerateDelta,e.isDecelerate=this.isDecelerate,e.delayDecelerate=this.delayDecelerate,e.size=this.size,e.isLaser=this.isLaser,e.isBoom=this.isBoom,e.isTracking=this.isTracking,e.resName=this.resName,e.resNameLaser=this.resNameLaser,e.lightName=this.lightName,e.lightColor=this.lightColor,e.lifeTime=this.lifeTime,e.isPhysical=this.isPhysical,e.delaytrack=this.delaytrack,e.fixedRotation=this.fixedRotation,e.statusType=this.statusType,e.statusRate=this.statusRate,e.canBreakBuilding=this.canBreakBuilding,e.isInvincible=this.isInvincible,e.damage=this.damage.clone(),e.from=this.from.clone(),e},t}();i.default=n,cc._RF.pop()},{"./DamageData":"DamageData","./FromData":"FromData"}],Bullet:[function(t,e,i){"use strict";cc._RF.push(e,"d243aeNu+tEJJbz1ng6i61f","Bullet");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("../NonPlayer"),l=t("../Player"),c=t("../MeleeWeapon"),h=t("../Data/DamageData"),p=t("../Logic"),u=t("../Boss/Boss"),d=t("../Data/BulletData"),f=t("../Manager/StatusManager"),g=t("../Utils/AudioPlayer"),y=t("../Data/FromData"),m=t("../Building/HitBuilding"),v=t("../Shield"),E=t("../Building/Wall"),_=t("../Actor/AreaOfEffect"),D=t("../Data/AreaOfEffectData"),S=t("../Utils/IndexZ"),R=t("../Actor/ColliderTag"),T=t("../Building/ExitDoor"),O=t("../Utils/ActorUtils"),C=t("../Building/InteractBuilding"),A=t("../Building/EnergyShield"),L=cc._decorator,P=L.ccclass,b=L.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boom=null,e.data=new d.default,e.dir=0,e.tagetPos=cc.v3(0,0),e.hv=cc.v3(0,0),e.isFromPlayer=!1,e.startPos=cc.v3(0,0),e.isTrackDelay=!1,e.isDecelerateDelay=!1,e.isHit=!1,e.isReserved=!1,e.skipTopwall=!1,e.aoeData=new D.default,e.currentLinearVelocity=cc.v2(0,0),e.timeDelay=0,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.rigidBody=this.getComponent(cc.RigidBody),this.circleCollider=this.getComponent(cc.CircleCollider),this.boxCollider=this.getComponent(cc.BoxCollider),this.circlePCollider=this.getComponent(cc.PhysicsCircleCollider),this.boxPCollider=this.getComponent(cc.PhysicsBoxCollider),this.sprite=this.node.getChildByName("sprite"),this.sprite.opacity=255,this.sprite.angle=0,this.light=this.node.getChildByName("light"),this.light.opacity=0,this.laserNode=this.node.getChildByName("laser"),this.laserSpriteNode=this.laserNode.getChildByName("sprite"),this.laserLightSprite=this.laserNode.getChildByName("light").getComponent(cc.Sprite),this.laserHeadSprite=this.laserNode.getChildByName("head").getComponent(cc.Sprite)},e.prototype.onEnable=function(){this.tagetPos=cc.v3(0,0),this.rigidBody.linearVelocity=cc.v2(0,0),this.currentLinearVelocity=cc.v2(0,0),this.sprite=this.node.getChildByName("sprite"),this.sprite.opacity=255,this.sprite.angle=0,this.light=this.node.getChildByName("light"),this.light.opacity=0,this.laserNode=this.node.getChildByName("laser"),this.laserSpriteNode=this.laserNode.getChildByName("sprite"),this.laserLightSprite=this.laserNode.getChildByName("light").getComponent(cc.Sprite),this.laserHeadSprite=this.laserNode.getChildByName("head").getComponent(cc.Sprite),this.isTrackDelay=!1,this.isDecelerateDelay=!1,this.isHit=!1,this.isReserved=!1},e.prototype.update=function(t){if(p.default.isGamePause)this.rigidBody.linearVelocity=cc.v2(0,0);else{if(this.checkTimeDelay+=t,this.checkTimeDelay>.5&&(this.checkTraking(),this.checkTimeDelay=0),1==this.data.fixedRotation&&(this.node.angle=0),1==this.data.isDecelerate&&this.isDecelerateDelay&&(this.timeDelay+=t,this.timeDelay>.016)){this.timeDelay=0;var e=this.data.decelerateDelta>0?this.data.decelerateDelta:1;this.currentLinearVelocity=this.currentLinearVelocity.lerp(cc.v2(0,0),e*t)}this.rigidBody.linearVelocity=this.currentLinearVelocity}},e.prototype.checkTraking=function(){if(1==this.data.isTracking&&1!=this.data.isLaser&&this.isTrackDelay&&!this.isHit){var t=this.hasNearEnemy();t.equals(cc.Vec3.ZERO)||(this.rotateColliderManager(cc.v3(this.node.position.x+t.x,this.node.position.y+t.y)),this.hv=t,this.currentLinearVelocity=cc.v2(this.data.speed*this.hv.x,this.data.speed*this.hv.y))}},e.prototype.changeBullet=function(t){this.data=t,this.changeRes(t.resName,t.lightName,t.lightColor),this.circleCollider.enabled=1!=t.isRect,this.boxCollider.enabled=1==t.isRect,this.circlePCollider.enabled=1!=t.isRect,this.boxPCollider.enabled=1==t.isRect,this.light.position=1==t.isRect?cc.v3(8,0):cc.v3(0,0),this.node.scale=t.size>0?t.size:1,t.size>1&&(this.circlePCollider.radius=this.circlePCollider.radius/this.node.scale,this.boxPCollider.size.width=this.boxPCollider.size.width/this.node.scale,this.boxPCollider.size.height=this.boxPCollider.size.height/this.node.scale),this.circlePCollider.enabled&&(this.circlePCollider.sensor=0==t.isPhysical,this.circlePCollider.apply()),this.boxPCollider.enabled&&(this.boxPCollider.sensor=0==t.isPhysical,this.boxPCollider.apply()),this.initLaser()},e.prototype.initLaser=function(){var t=this;this.laserNode.active=1==this.data.isLaser,1==this.data.isLaser&&(this.laserNode||(this.laserNode=this.node.getChildByName("laser")),this.sprite.opacity=0,this.sprite.getComponent(cc.Sprite).spriteFrame=null,this.sprite.angle=0,this.laserNode.opacity=0,this.laserSpriteNode.getComponent(cc.Sprite).spriteFrame=this.getSpriteFrameByName(this.data.resNameLaser),this.laserHeadSprite.spriteFrame=this.getSpriteFrameByName(this.data.resNameLaser,"head"),this.laserNode.stopAllActions(),cc.tween(this.laserLightSprite.node).repeatForever(cc.tween().delay(.05).call(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light001")}).delay(.05).call(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light002")}).delay(.05).call(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light003")})).start())},e.prototype.showLaser=function(){var t=this;if(1==this.data.isLaser){var e=this.node.convertToWorldSpaceAR(cc.v3(0,0)),i=p.default.getDistance(this.startPos,e),o=32;i<=0&&(i=0,o=0);var a=i-o;this.laserSpriteNode.width=a/this.node.scaleY,this.laserSpriteNode.setPosition(cc.v3(-a/this.node.scaleY,0)),this.laserHeadSprite.node.setPosition(cc.v3(-a/this.node.scaleY,0)),this.laserNode.opacity=255,this.sprite.opacity=0,this.laserNode.scaleX=1,this.laserNode.scaleY=1,this.laserLightSprite.node.setPosition(-16*this.node.scaleY,0),cc.tween(this.laserNode).to(.1,{scale:1}).to(.1,{scaleY:0}).start(),this.scheduleOnce(function(){t.shooter.destroyBullet(t.node)},.2),cc.director.emit(r.EventHelper.PLAY_AUDIO,{detail:{name:g.default.REMOTE_LASER}})}},e.prototype.changeRes=function(t,e,i,o){if(this.sprite||(this.sprite=this.node.getChildByName("sprite")),this.sprite&&!(t.length<1)){var a=this.getSpriteFrameByName(t,o),n=this.getSpriteFrameByName(e,o);if(a&&(this.sprite.getComponent(cc.Sprite).spriteFrame=a),n){this.light.getComponent(cc.Sprite).spriteFrame=n;var r=cc.color(255,255,255).fromHEX(i);this.light.color=r}}},e.prototype.getSpriteFrameByName=function(t,e,i){var o=p.default.spriteFrameRes(t+e);return o||(o=p.default.spriteFrameRes(i?t+"anim000":t)),o},e.prototype.MeleeFinish=function(){cc.director.emit("destorybullet",{detail:{bulletNode:this.node}})},e.prototype.showBullet=function(t){this.hv=t,this.rotateColliderManager(cc.v3(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y)),this.fire(this.hv.clone())},e.prototype.BulletDestory=function(){cc.director.emit("destorybullet",{detail:{bulletNode:this.node}})},e.prototype.fire=function(t){var e=this;this.rigidBody||(this.rigidBody=this.getComponent(cc.RigidBody)),this.currentLinearVelocity=cc.v2(this.data.speed*t.x,this.data.speed*t.y),this.rigidBody.linearVelocity=this.currentLinearVelocity,this.startPos=this.node.convertToWorldSpaceAR(cc.v3(0,0)),this.sprite.stopAllActions(),this.node.stopAllActions();var i=this.sprite.getComponent(cc.Sprite),o=cc.tween().delay(.1).call(function(){i.spriteFrame=e.getSpriteFrameByName(e.data.resName,"anim000",!0)}).delay(.1).call(function(){i.spriteFrame=e.getSpriteFrameByName(e.data.resName,"anim001",!0)}).delay(.1).call(function(){i.spriteFrame=e.getSpriteFrameByName(e.data.resName,"anim002",!0)}),a=cc.tween(this.sprite).parallel(o,cc.tween().by(.3,{angle:this.data.rotateAngle>0?this.data.rotateAngle:15}));this.data.isRotate>0?cc.tween(this.sprite).repeatForever(a).start():cc.tween(this.sprite).repeatForever(o).start(),this.data.lifeTime>0?this.scheduleOnce(function(){e.bulletHit()},this.data.lifeTime):this.scheduleOnce(function(){e.bulletHit()},30),this.isTrackDelay=!1,1==this.data.isTracking&&this.scheduleOnce(function(){e.isTrackDelay=!0},this.data.delaytrack),this.isDecelerateDelay=!1,1==this.data.isDecelerate&&this.scheduleOnce(function(){e.isDecelerateDelay=!0},this.data.delayDecelerate)},e.prototype.start=function(){},e.prototype.onBeginContact=function(t,e,i){var o=!0;(i.tag==R.ColliderTag.PLAYER||i.tag==R.ColliderTag.NONPLAYER||i.tag==R.ColliderTag.BOSS||i.tag==R.ColliderTag.BULLET||i.tag==R.ColliderTag.WARTER||i.sensor||i.tag==R.ColliderTag.WALL_TOP||this.data.isInvincible>0)&&(o=!1),o&&this.bulletHit()},e.prototype.onCollisionEnter=function(t){var e=!0;this.isFromPlayer||t.tag!=R.ColliderTag.NONPLAYER&&t.tag!=R.ColliderTag.BOSS||(e=!1),!this.isFromPlayer||t.tag!=R.ColliderTag.PLAYER&&t.tag!=R.ColliderTag.GOODNONPLAYER||(e=!1),t.tag==R.ColliderTag.BULLET&&(e=!1),e&&this.attacking(t.node,t.tag)},e.prototype.attacking=function(t,e){if(t&&!this.isHit){var i=new h.default,o=!1;i.valueCopy(this.data.damage),i.isRemote=!0;var a=!1;if(this.data.isInvincible>0)a=!1;else if(e==R.ColliderTag.NONPLAYER||e==R.ColliderTag.GOODNONPLAYER){var n=t.getComponent(s.default);n&&!n.sc.isDied&&((o=n.takeDamage(i))&&this.addTargetAllStatus(n,new y.default),a=!0)}else if(e==R.ColliderTag.PLAYER){var r=t.getComponent(l.default);if(r&&!r.sc.isDied){var p=!1;r.shield.Status==v.default.STATUS_PARRY&&1==r.shield.data.isReflect&&(p=this.revserseBullet(r.node.convertToWorldSpaceAR(cc.Vec2.ZERO))),p||((o=r.takeDamage(i,this.data.from))&&this.addTargetAllStatus(r,this.data.from),a=!0)}}else if(e==R.ColliderTag.AOE){var d=t.getComponent(_.default);d&&d.IsAttacking&&d.data.canBreakBullet&&(a=!0)}else if(e==R.ColliderTag.BOSS){var f=t.getComponent(u.default);f&&!f.sc.isDied&&((o=f.takeDamage(i))&&this.addTargetAllStatus(f,new y.default),a=!0)}else if(e==R.ColliderTag.MELEE){var g=t.getComponent(c.default);g&&g.IsAttacking&&!this.isFromPlayer&&(p=!1,g.IsReflect&&(p=this.revserseBullet(g.node.convertToWorldSpaceAR(cc.Vec2.ZERO))),p||(a=!0))}else if(e==R.ColliderTag.BUILDING||e==R.ColliderTag.WALL){var D=t.getComponent(C.default);if(1==this.data.canBreakBuilding&&D&&(o=!0,D.takeDamage(i)),!o){var S=t.getComponent(m.default);1==this.data.canBreakBuilding&&S&&(o=!0,S.takeDamage(i))}if(!o){var O=t.getComponent(E.default);O&&(a=O.isTop()?!this.skipTopwall:O.isSide()),a&&t.getComponent(T.default)&&(a=!1)}}else if(!this.isFromPlayer&&e==R.ColliderTag.ENERGY_SHIELD){var L=t.getComponent(A.default);L&&L.isValid&&(o=L.takeDamage(i)),o&&(a=!0)}a&&this.bulletHit()}},e.prototype.revserseBullet=function(){if(this.isReserved)return this.isReserved=!0,!1;if(1!=this.data.isLaser){var t=-180+p.default.getRandomNum(0,10)-20;return this.node.angle+=t,this.currentLinearVelocity=this.currentLinearVelocity.rotate(t*Math.PI/180),this.isFromPlayer=!0,this.data.isTracking=0,!0}return!1},e.prototype.bulletHit=function(){if(!this.isHit){if(this.isHit=!0,this.anim&&!this.anim.getAnimationState("Bullet001Hit").isPlaying&&(this.currentLinearVelocity=cc.v2(0,0),this.rigidBody.linearVelocity=cc.v2(0,0),1==this.data.isLaser?this.showLaser():this.anim.play("Bullet001Hit")),this.data.isBoom>0){var t=cc.instantiate(this.boom).getComponent(_.default);t&&(t.show(this.node.parent,this.node.position,this.hv,0,(new D.default).init(1,.2,0,0,S.default.OVERHEAD,!this.isFromPlayer,!0,!0,!1,!1,new h.default(2),y.default.getClone("\u7206\u70b8","boom000anim004"),[])),cc.director.emit(r.EventHelper.PLAY_AUDIO,{detail:{name:g.default.BOOM}}),cc.director.emit(r.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!0}}))}if(this.aoePrefab){var e=cc.instantiate(this.aoePrefab).getComponent(_.default);e&&e.show(this.node.parent,this.node.position,this.hv,0,this.aoeData)}}},e.prototype.hasNearEnemy=function(){if(1!=this.data.isTracking||1==this.data.isLaser||!this.dungeon)return cc.Vec3.ZERO;var t=1e3,e=cc.v3(0,0),i=O.default.getNearestEnemyActor(this.dungeon.player,!this.isFromPlayer,this.dungeon);if(i){var o=p.default.getDistance(this.node.position,i.node.position);if(o<500&&o<t&&!i.sc.isDied&&!i.sc.isDisguising&&!i.sc.isFalling&&!i.sc.isJumping){t=o;var a=this.node.position.clone();a.x=this.node.scaleX>0?a.x:-a.x,e=i.node.position.sub(a)}}return 1e3!=t&&(e=e.normalizeSelf()),e},e.prototype.rotateColliderManager=function(t){if(1!=this.data.fixedRotation){var e=t.sub(this.node.position),i=360/(2*Math.PI),o=360-Math.atan2(e.x,e.y)*i;o+=90,this.node.angle=this.node.scaleX<0?-o:o}},e.prototype.addTargetAllStatus=function(t,e){this.addTargetStatus(this.data.damage.iceRate,t,f.default.FROZEN,e),this.addTargetStatus(this.data.damage.fireRate,t,f.default.BURNING,e),this.addTargetStatus(this.data.damage.lighteningRate,t,f.default.DIZZ,e),this.addTargetStatus(this.data.damage.toxicRate,t,f.default.TOXICOSIS,e),this.addTargetStatus(this.data.damage.curseRate,t,f.default.CURSING,e),this.addTargetStatus(this.data.damage.realRate,t,f.default.BLEEDING,e),this.addTargetStatus(this.data.statusRate,t,this.data.statusType,e)},e.prototype.addTargetStatus=function(t,e,i,o){p.default.getRandomNum(0,100)<t&&e.addStatus(i,o)},n([b(cc.Prefab)],e.prototype,"boom",void 0),n([P],e)}(cc.Component);i.default=I,cc._RF.pop()},{"../Actor/AreaOfEffect":"AreaOfEffect","../Actor/ColliderTag":"ColliderTag","../Boss/Boss":"Boss","../Building/EnergyShield":"EnergyShield","../Building/ExitDoor":"ExitDoor","../Building/HitBuilding":"HitBuilding","../Building/InteractBuilding":"InteractBuilding","../Building/Wall":"Wall","../Data/AreaOfEffectData":"AreaOfEffectData","../Data/BulletData":"BulletData","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../MeleeWeapon":"MeleeWeapon","../NonPlayer":"NonPlayer","../Player":"Player","../Shield":"Shield","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ"}],CameraControl:[function(t,e,i){"use strict";cc._RF.push(e,"aaca098lw9M94SueX+ajVM7","CameraControl");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Dungeon"),s=t("./EventHelper"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dungeon=null,e.isShaking=!1,e.isHeavyShaking=!1,e.offsetIndex=0,e.offsetArr=[cc.v3(0,2),cc.v3(0,2),cc.v3(0,-3),cc.v3(0,-3),cc.v3(1,2),cc.v3(1,2),cc.v3(-1,-1),cc.v3(-1,-1)],e.offsetArr1=[cc.v3(0,3),cc.v3(0,3),cc.v3(0,-6),cc.v3(0,-6),cc.v3(3,6),cc.v3(3,6),cc.v3(-3,-3),cc.v3(-3,-3)],e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.camera=this.getComponent(cc.Camera),cc.director.on(s.EventHelper.CAMERA_SHAKE,function(e){t.shakeCamera(e.detail.isHeavyShaking)}),cc.director.on(s.EventHelper.CAMERA_LOOK,function(){t.followPlayer(!0)}),cc.director.on(s.EventHelper.HUD_CAMERA_ZOOM_IN,function(){t.dungeon&&(t.dungeon.CameraZoom=2)}),cc.director.on(s.EventHelper.HUD_CAMERA_ZOOM_OUT,function(){t.dungeon&&(t.dungeon.CameraZoom=t.dungeon.needZoomIn?.7:1)})},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.start=function(){},e.prototype.lateUpdate=function(){this.dungeon.player&&(this.followPlayer(!1),this.camera.zoomRatio=this.lerpNumber(this.camera.zoomRatio,this.dungeon.CameraZoom,.05))},e.prototype.followPlayer=function(t){if(this.dungeon&&this.dungeon.player){var e=r.default.getPosInMap(cc.v3(r.default.WIDTH_SIZE-4,0)).x,i=r.default.getPosInMap(cc.v3(3,0)).x,o=r.default.getPosInMap(cc.v3(0,r.default.HEIGHT_SIZE-3)).y,a=r.default.getPosInMap(cc.v3(0,2)).y,n=cc.v3(0,0);this.dungeon.player.node.x<i&&(n.x=i-this.dungeon.player.node.x),this.dungeon.player.node.x>e&&(n.x=e-this.dungeon.player.node.x),this.dungeon.player.node.y<a&&(n.y=a-this.dungeon.player.node.y),this.dungeon.player.node.y>o&&(n.y=o-this.dungeon.player.node.y);var s=this.dungeon.node.convertToWorldSpaceAR(this.dungeon.player.getCenterPosition().addSelf(n));this.node.position=t?this.node.parent.convertToNodeSpaceAR(s):this.lerp(this.node.position,this.node.parent.convertToNodeSpaceAR(s),.1),this.isShaking&&(this.offsetIndex>this.offsetArr.length-1&&(this.offsetIndex=0),this.node.position=this.node.position.addSelf(this.isHeavyShaking?this.offsetArr1[this.offsetIndex]:this.offsetArr[this.offsetIndex]),this.offsetIndex++)}},e.prototype.shakeCamera=function(t){var e=this;this.node&&(this.isHeavyShaking=t,this.isShaking=!0,this.scheduleOnce(function(){e.isShaking=!1},.2))},e.prototype.lerpNumber=function(t,e,i){return t+(e-t)*i},e.prototype.lerp=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},n([h(r.default)],e.prototype,"dungeon",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Dungeon":"Dungeon","./EventHelper":"EventHelper"}],CaptainSword:[function(t,e,i){"use strict";cc._RF.push(e,"e541b/KaoRBdL9VgXHoN6dM","CaptainSword");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/FromData"),l=t("./Captain"),c=t("../Utils/ActorUtils"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=3,e.parentNode=null,e.isShow=!1,e}return a(e,t),e.prototype.start=function(){this.isShow=!1},e.prototype.onCollisionEnter=function(t){var e=c.default.getEnemyCollisionTarget(t);if(e&&this.isShow&&this.node.active){this.isShow=!1;var i=new r.default;i.physicalDamage=this.damage,e.takeDamage(i,s.default.getClone(this.actorName(),"captain_head"),this.parentNode.getComponent(l.default))}},e.prototype.actorName=function(){return"\u90aa\u6076\u8239\u957f"},n([u],e.prototype,"damage",void 0),n([u(cc.Node)],e.prototype,"parentNode",void 0),n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Utils/ActorUtils":"ActorUtils","./Captain":"Captain"}],Captain:[function(t,e,i){"use strict";cc._RF.push(e,"6d826iFR+pBDJHGFIoYZ400","Captain");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./CaptainSword"),s=t("../Dungeon"),l=t("../EventHelper"),c=t("../Shooter"),h=t("../Data/DamageData"),p=t("./Boss"),u=t("../Utils/NextStep"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Actor/ColliderTag"),m=t("../Utils/ActorUtils"),v=t("../Logic"),E=cc._decorator,_=E.ccclass,D=E.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sword=null,e.healthBar=null,e.isFaceRight=!0,e.isMoving=!1,e.timeDelay=0,e.isFall=!1,e.shooter=null,e.exshooter=null,e.attackSkill=new u.default,e.fireSkill=new u.default,e.jumpSkill=new u.default,e}return a(e,t),e.prototype.onLoad=function(){this.attackSkill.IsExcuting=!1,this.sc.isDied=!1,this.anim=this.getComponent(cc.Animation),this.rigidbody=this.getComponent(cc.RigidBody),this.shooter=this.node.getChildByName("Shooter").getComponent(c.default),this.exshooter=this.node.getChildByName("ExShooter").getComponent(c.default),this.shooter.from.valueCopy(f.default.getClone(this.actorName(),"captain_head")),this.exshooter.from.valueCopy(f.default.getClone(this.actorName(),"captain_head")),this.updatePlayerPos()},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.AttackDamageStart=function(){this.sword.isShow=!0},e.prototype.AttackDamageFinish=function(){this.sword.isShow=!1},e.prototype.AttackStart=function(){this.attackSkill.IsExcuting=!0,cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MELEE}})},e.prototype.AttackFinish=function(){this.attackSkill.IsExcuting=!1},e.prototype.JumpStart=function(){this.jumpSkill.IsExcuting=!0,this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.getComponent(cc.PhysicsBoxCollider).apply()},e.prototype.FireSwordLight=function(){this.shooter.setHv(cc.v3(1,0)),this.shooter.dungeon=this.dungeon,this.shooter.data.bulletType="bullet043",this.shooter.fireBullet(0,cc.v3(16,0))},e.prototype.JumpFinish=function(){var t=this;if(this.jumpSkill.IsExcuting=!1,this.isFall=!0,this.scheduleOnce(function(){t.isFall=!1},.1),this.getComponent(cc.PhysicsBoxCollider).sensor=!1,this.getComponent(cc.PhysicsBoxCollider).apply(),this.dungeon&&this.exshooter){var e=this.dungeon.player.getCenterPosition().sub(this.node.position);e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf(),this.exshooter.setHv(e),this.exshooter.dungeon=this.dungeon,this.exshooter.data.bulletType="bullet033",this.exshooter.data.bulletArcExNum=99,this.exshooter.data.bulletLineInterval=1,this.data.currentHealth<this.data.Common.maxHealth/2&&(this.exshooter.data.bulletLineExNum=1),this.exshooter.fireBullet(0,cc.v3(16,0)))}},e.prototype.fireWithAngles=function(t){if(this.dungeon&&this.shooter){var e=this.dungeon.player.getCenterPosition().sub(this.node.position);if(!e.equals(cc.Vec3.ZERO)){e=e.normalizeSelf(),this.shooter.setHv(e),this.shooter.dungeon=this.dungeon,this.shooter.data.bulletType="bullet002";for(var i=0,o=t;i<o.length;i++){var a=o[i];this.shooter.fireBullet(a,cc.v3(16,0))}}}},e.prototype.OpenFire=function(){var t=this;if(this.dungeon&&this.shooter){var e=[5,10,-10],i=[-5,10,20,-10,-20,-30,-40,30,40];this.shooter.data.bulletArcExNum=0,this.fireWithAngles([0,10,15,-30,-40,-10,-15,30,40]),this.data.currentHealth<this.data.Common.maxHealth/2&&(this.scheduleOnce(function(){t.fireWithAngles(e)},.3),this.scheduleOnce(function(){t.fireWithAngles(i)},.5))}},e.prototype.onCollisionStay=function(t,e){var i=m.default.getEnemyCollisionTarget(t);if(i&&e.tag==y.ColliderTag.BOSS_ATTACK&&this.isFall&&!this.sc.isDied){this.isFall=!1;var o=new h.default;o.physicalDamage=2,i.takeDamage(o,f.default.getClone(this.actorName(),"captain_head"),this)}},e.prototype.updateLogic=function(t){v.default.isGamePause||(this.healthBar.node.active=!this.sc.isDied,this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,this.bossAction(),this.JumpMove()),this.dungeon&&this.getNearPlayerDistance(this.dungeon.player.node)<96&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.sc.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.healthBar.node.active=!this.sc.isDied,this.data.currentHealth<1&&this.killed(),this.node.scaleX=this.isFaceRight?1:-1)},e.prototype.takeDamage=function(t){var e=this.anim.getAnimationState("CaptainJump").isPlaying;return!this.sc.isDied&&!e&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.sc.isDied||(g.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.anim.play("CaptainDie"),this.getComponent("cc.PhysicsCollider").sensor=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){var t=this;if(!this.sc.isDied&&this.dungeon){this.node.position=s.default.fixOuterMap(this.node.position),this.pos=s.default.getIndexInMap(this.node.position),this.changeZIndex();var e=this.dungeon.player.pos.clone(),i=s.default.getPosInMap(e).sub(this.node.position),o=this.getNearPlayerDistance(this.dungeon.player.node),a=this.anim.getAnimationState("CaptainJump").isPlaying,n=this.anim.getAnimationState("CaptainFire").isPlaying,r=i.x,l=i.y;if(Math.abs(r),Math.abs(l),this.isFaceRight=r>0,!a&&!n){var c=200;a||this.fireSkill.next(function(){c=50,t.anim.play("CaptainFire")},5),o<140&&!this.dungeon.player.sc.isDied?this.attackSkill.next(function(){t.attackSkill.IsExcuting=!0,t.anim.play("CaptainAttack")},1):(o>300&&this.jumpSkill.next(function(){t.anim.play("CaptainJump"),a=!0},8),i.equals(cc.Vec3.ZERO)||a||this.attackSkill.IsExcuting||(i=i.normalizeSelf(),this.move(i,c)))}}},e.prototype.JumpMove=function(){if(this.dungeon&&this.jumpSkill.IsExcuting){var t=this.dungeon.player.pos.clone(),e=s.default.getPosInMap(t).sub(this.node.position);e.equals(cc.Vec3.ZERO)||(this.pos=s.default.getIndexInMap(this.node.position),e=e.normalizeSelf());var i=e.x,o=e.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o)),n=200;this.data.currentHealth<this.data.Common.maxHealth/2&&(n=240),a=a.mul(n),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o}},e.prototype.move=function(t,e){if(!this.sc.isDied){this.attackSkill.IsExcuting&&!t.equals(cc.Vec3.ZERO)&&(t=t.mul(.5)),t.equals(cc.Vec3.ZERO)||(this.pos=s.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.isMoving&&(this.isFaceRight=i>0),this.isMoving?this.anim.getAnimationState("CaptainMove").isPlaying||this.anim.playAdditive("CaptainMove"):this.anim.getAnimationState("CaptainMove").isPlaying&&this.anim.play("CaptainIdle"),this.changeZIndex()}},e.prototype.actorName=function(){return"\u90aa\u6076\u8239\u957f"},n([D(r.default)],e.prototype,"sword",void 0),n([_],e)}(p.default);i.default=S,cc._RF.pop()},{"../Achievement":"Achievement","../Actor/ColliderTag":"ColliderTag","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Shooter":"Shooter","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/NextStep":"NextStep","./Boss":"Boss","./CaptainSword":"CaptainSword"}],ChapterData:[function(t,e,i){"use strict";cc._RF.push(e,"fb6073McgVKOpRjZZ5su/Nf","ChapterData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(t){this.chapter=0,this.list=[],this.chapter=t},cc._RF.pop()},{}],Chapter:[function(t,e,i){"use strict";cc._RF.push(e,"e966c6tQ3FASbN1WCJi24PI","Chapter");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./Utils/AudioPlayer"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chapter00=null,e.chapter01=null,e.chapter02=null,e.chapter03=null,e.chapter04=null,e.timeDelay=0,e}return a(e,t),e.prototype.start=function(){},e.prototype.clickChapter=function(t,e){e&&(r.default.profileManager.clearData(),r.default.jumpChapter=parseInt(e),s.default.play(s.default.SELECT),cc.director.loadScene("pickavatar"))},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},n([h(cc.Button)],e.prototype,"chapter00",void 0),n([h(cc.Button)],e.prototype,"chapter01",void 0),n([h(cc.Button)],e.prototype,"chapter02",void 0),n([h(cc.Button)],e.prototype,"chapter03",void 0),n([h(cc.Button)],e.prototype,"chapter04",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer"}],Chest:[function(t,e,i){"use strict";cc._RF.push(e,"a259fOC11hFpJCy2hycs7kH","Chest");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../EventHelper"),l=t("../Logic"),c=t("./Building"),h=t("../Utils/AudioPlayer"),p=t("../Actor/ColliderTag"),u=t("../Utils/IndexZ"),d=cc._decorator,f=d.ccclass,g=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite")},e.prototype.start=function(){},e.prototype.setQuality=function(t,e){this.data.quality=t,this.data.isOpen=e,this.sprite||(this.sprite=this.node.getChildByName("sprite"));var i="chest001",o="chestopen001";switch(t){case 1:i="chest001",o="chestopen001";break;case 2:i="chest003",o="chestopen003";break;case 3:case 4:i="chest002",o="chestopen002"}var a=l.default.spriteFrameRes(i),n=l.default.spriteFrameRes(o);this.openSpriteFrame=a,this.closeSpriteFrame=n,this.sprite.getComponent(cc.Sprite).spriteFrame=this.openSpriteFrame,e&&(this.sprite.getComponent(cc.Sprite).spriteFrame=this.closeSpriteFrame)},e.prototype.seDefaultPos=function(t){this.data.defaultPos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=u.default.getActorZIndex(this.node.position)},e.prototype.openChest=function(){var t=this;if(!this.data.isOpen){this.data.isOpen=!0,cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:h.default.PICK_UP}}),cc.tween(this.sprite).to(.1,{position:cc.v3(5,16)}).to(.1,{position:cc.v3(-5,0)}).to(.1,{position:cc.v3(5,0)}).to(.1,{position:cc.v3(-5,0)}).to(.1,{position:cc.v3(0,0)}).call(function(){if(t.sprite.getComponent(cc.Sprite).spriteFrame=t.closeSpriteFrame,t.node.parent){var e=t.node.parent.getComponent(r.default);if(e){var i=l.default.mapManager.getRandom4Save(t.seed);e.addEquipment(l.default.getRandomEquipType(i),r.default.getPosInMap(t.data.defaultPos),null,t.data.quality)}}}).start();var e=l.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);e?(e.isOpen=this.data.isOpen,e.quality=this.data.quality):l.default.mapManager.setCurrentBuildingData(this.data.clone())}},e.prototype.onCollisionStay=function(t){t.tag==p.ColliderTag.PLAYER&&(this.data.isOpen||this.openChest())},n([g(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),n([g(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),n([f],e)}(c.default);i.default=y,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],ChunkData:[function(t,e,i){"use strict";cc._RF.push(e,"2e5707we6VLmaJfbSZnGeFv","ChunkData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],ChunkLookCamera:[function(t,e,i){"use strict";cc._RF.push(e,"86753OU1JJLlZ74OEo6fP9C","ChunkLookCamera");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.camera=this.getComponent(cc.Camera),cc.director.on(r.EventHelper.CAMERA_LOOK,function(e){t.lookAt(e.detail.position)})},e.prototype.lookAt=function(t){this.targetPosition=t},e.prototype.lateUpdate=function(){this.targetPosition,this.node.position=this.lerp(this.node.position,this.node.parent.convertToNodeSpaceAR(this.target.convertToWorldSpaceAR(cc.Vec3.ZERO)),.1)},e.prototype.lerp=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},n([c(cc.Node)],e.prototype,"target",void 0),n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../EventHelper":"EventHelper"}],ChunkWorld:[function(t,e,i){"use strict";cc._RF.push(e,"8888aikYhVNfJXCQphMoSyV","ChunkWorld");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Chunk"),s=t("../EventHelper"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chunkPrefab=null,e.worldMap=new Array,e.currentMap=new Array,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;Math.floor(i.SIZE/2),cc.director.on(s.EventHelper.CHUNK_LOAD,function(e){var o=e.detail.pos,a=i.getIndexInMap(o,t.currentMap[0][0].targetPosition);cc.log(a),t.changeMap(a.x,a.y)}),this.initMap()},e.prototype.initMap=function(){for(var t=0;t<i.SIZE;t++){this.currentMap[t]=new Array(t);for(var e=0;e<i.SIZE;e++){var o=cc.instantiate(this.chunkPrefab);o.parent=this.node,o.position=i.getPosInMap(cc.v3(t,e)),o.zIndex=100;var a=o.getComponent(r.default);a.data.x=t,a.data.y=e,this.currentMap[t][e]=a,a.targetPosition=o.position.clone(),a.loadMap()}}this.printMapIndex()},e.prototype.getTargetChunkPos=function(){cc.v3(this.currentMap[0][0].data.x,this.currentMap[0][0].data.y)},e.prototype.changeMap=function(t,e){var o=Math.floor(i.SIZE/2);if(t!=o||e!=o){for(var a=this.currentMap[t][e].targetPosition.clone(),n=new Array,r=0;r<i.SIZE;r++){n[r]=new Array(r);for(var s=0;s<i.SIZE;s++){var l=this.getCorrectIndex(cc.v3(t,e),cc.v3(r,s));if(n[r][s]=this.currentMap[l.x][l.y],n[r][s].data.x=r,n[r][s].data.y=s,1==l.z){var c=cc.v3(r,s).subSelf(cc.v3(o,o)),h=i.getPosInMap(c);n[r][s].targetPosition=a.clone().addSelf(h),n[r][s].loadMap()}}}this.printMapIndex(),this.currentMap=n}},e.prototype.printMapIndex=function(){for(var t=i.SIZE-1;t>=0;t--)for(var e=0;e<i.SIZE;e++)this.currentMap[e][t].data.x,this.currentMap[e][t].data.y},e.prototype.getCorrectIndex=function(t,e){var o=Math.floor(i.SIZE/2),a=e.clone(),n=t.x-o,r=t.y-o;a.x=a.x+n,a.y=a.y+r;var s=!1;return a.x<0?(a.x=a.x+i.SIZE,s=!0):a.x>=i.SIZE&&(a.x=a.x-i.SIZE,s=!0),a.y<0?(a.y=a.y+i.SIZE,s=!0):a.y>=i.SIZE&&(a.y=a.y-i.SIZE,s=!0),new cc.Vec3(a.x,a.y,s?1:0)},e.getPosInMap=function(t){var e=t.x*r.default.WIDTH*r.default.TILE_SCALE*r.default.TILE_SIZE,i=t.y*r.default.HEIGHT*r.default.TILE_SCALE*r.default.TILE_SIZE;return cc.v3(e,i)},e.fixOuterMap=function(t,e){var o=(t.x-e.x)/(r.default.WIDTH*r.default.TILE_SCALE*r.default.TILE_SIZE),a=(t.y-e.y)/(r.default.WIDTH*r.default.TILE_SCALE*r.default.TILE_SIZE);o=Math.round(o),a=Math.round(a);var n=!1;return o<0&&(o=0,n=!0),o>=i.SIZE&&(o=i.SIZE-1,n=!0),a<0&&(a=0,n=!0),a>=i.SIZE&&(a=i.SIZE-1,n=!0),n?i.getPosInMap(cc.v3(o,a)):t},e.getIndexInMap=function(t,e){var o=(t.x-e.x)/(r.default.WIDTH*r.default.TILE_SCALE*r.default.TILE_SIZE),a=(t.y-e.y)/(r.default.WIDTH*r.default.TILE_SCALE*r.default.TILE_SIZE);return o=Math.round(o),a=Math.round(a),o<0&&(o=0),o>=i.SIZE&&(o=i.SIZE-1),a<0&&(a=0),a>=i.SIZE&&(a=i.SIZE-1),cc.v3(o,a)},e.prototype.start=function(){},e.SIZE=5,n([h(cc.Prefab)],e.prototype,"chunkPrefab",void 0),i=n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../EventHelper":"EventHelper","./Chunk":"Chunk"}],Chunk:[function(t,e,i){"use strict";cc._RF.push(e,"f8d511RPE5CG7SWZpmVYfu9","Chunk");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/ChunkData"),s=t("../Utils/Random"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.floor=null,e.label=null,e.select=null,e.wall=null,e.data=new r.default,e.targetPosition=cc.v3(0,0),e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.layer=this.node.getChildByName("layer"),this.floor.scale=i.TILE_SCALE,this.floor.width=i.TILE_SIZE*i.WIDTH,this.floor.height=i.TILE_SIZE*i.HEIGHT,this.select.scale=i.TILE_SCALE,this.select.width=i.TILE_SIZE*i.WIDTH,this.select.height=i.TILE_SIZE*i.HEIGHT,this.node.width=i.TILE_SCALE*i.TILE_SIZE*i.WIDTH,this.node.height=i.TILE_SCALE*i.TILE_SIZE*i.HEIGHT},e.prototype.onClicked=function(){var t=this;this.floor.color=cc.Color.GREEN,this.scheduleOnce(function(){t.floor.color=cc.Color.WHITE},1)},e.prototype.loadMap=function(){this.label.node.position=cc.v3(this.node.width/2,this.node.height/2),this.label.string=this.targetPosition.x+","+this.targetPosition.y,this.node.position=this.targetPosition.clone(),this.layer.removeAllChildren();for(var t=0;t<2;t++){var e=cc.instantiate(this.wall);e.parent=this.layer,e.position=cc.v3(s.default.getRandomNum(0,this.node.width),s.default.getRandomNum(0,this.node.height)),e.zIndex=100}},e.prototype.lateUpdate=function(){},e.prototype.lerp=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},e.TYPE_EMPTY=0,e.TYPE_NORMAL=1,e.TYPE_WALL_VERTICAL=2,e.TYPE_WALL_HORIZONTAL=3,e.TYPE_WALL_CROSS=4,e.WIDTH=5,e.HEIGHT=5,e.TILE_SIZE=16,e.TILE_SCALE=4,n([h(cc.Node)],e.prototype,"floor",void 0),n([h(cc.Label)],e.prototype,"label",void 0),n([h(cc.Node)],e.prototype,"select",void 0),n([h(cc.Prefab)],e.prototype,"wall",void 0),i=n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../Data/ChunkData":"ChunkData","../Utils/Random":"Random"}],CoinCount:[function(t,e,i){"use strict";cc._RF.push(e,"91131vqXzhODZpby3U0hjQL","CoinCount");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./EventHelper"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),cc.director.on(s.EventHelper.HUD_ADD_COIN,function(e){t.addCount(e.detail.count)})},e.prototype.start=function(){},e.prototype.addCount=function(t){if(this.anim){var e=parseInt(t);r.default.coins+=e,e>0&&(r.default.coinDreamCount+=e,r.default.coinDreamCount>=1&&(r.default.coinDreamCount=0,s.EventHelper.emit(s.EventHelper.PLAYER_USEDREAM,{value:-1})))}},e.prototype.update=function(){this.label&&(this.label.string=""+r.default.coins)},n([h(cc.Label)],e.prototype,"label",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic"}],Coin:[function(t,e,i){"use strict";cc._RF.push(e,"586a7ZPuVJNUIhnMRyd39J4","Coin");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../EventHelper"),l=t("../Utils/Random"),c=t("../Utils/AudioPlayer"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e.valueRes=["gem01","gem02","gem03","gem04"],e.isReady=!1,e.soundPlaying=!1,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){},e.prototype.onEnable=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.rigidBody=this.getComponent(cc.RigidBody);var e=l.default.rand()*(r.default.getHalfChance()?1:-1)*1200,i=l.default.rand()*(r.default.getHalfChance()?1:-1)*1200;this.rigidBody.linearVelocity=cc.v2(e,i),this.rigidBody.linearDamping=10,this.isReady=!1,this.scheduleOnce(function(){t.isReady=!0},.5)},e.prototype.changeValue=function(t){this.value=t;var e=1;this.value==i.FACE_VALUE?(e=3,this.node.scale=1.2):(e=1,this.node.scale=1),this.node.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=r.default.spriteFrameRes(this.valueRes[e])},e.prototype.start=function(){},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,this.soundPlaying=!1,!0)},e.prototype.getNearPlayerDistance=function(t){return r.default.getDistance(this.node.position,t.position.clone().addSelf(cc.v3(0,32)))},e.prototype.update=function(t){if(this.isCheckTimeDelay(t)&&this.player&&this.getNearPlayerDistance(this.player.node)<400&&this.node.active&&this.isReady){var e=this.player.node.position.clone();e.y+=10;var i=e.sub(this.node.position);i.equals(cc.Vec3.ZERO)||(i=(i=i.normalizeSelf()).mul(800),this.rigidBody.linearVelocity=cc.v2(i),this.rigidBody.linearDamping=1)}this.player&&this.getNearPlayerDistance(this.player.node)<64&&this.node.active&&this.isReady&&(this.isReady=!1,this.soundPlaying||(this.soundPlaying=!0,cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:c.default.COIN}})),cc.director.emit(s.EventHelper.HUD_ADD_COIN,{detail:{count:this.value}}),cc.director.emit("destorycoin",{detail:{coinNode:this.node}}))},e.FACE_VALUE=10,i=n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/Random":"Random"}],ColliderTag:[function(t,e,i){"use strict";cc._RF.push(e,"30fe7gJEPJDaIQxIDcTlk/U","ColliderTag"),Object.defineProperty(i,"__esModule",{value:!0}),i.ColliderTag=void 0,function(t){t[t.DEFAULT=0]="DEFAULT",t[t.WALL=1]="WALL",t[t.WALL_TOP=2]="WALL_TOP",t[t.PLAYER=3]="PLAYER",t[t.NONPLAYER=4]="NONPLAYER",t[t.BOSS_ATTACK=5]="BOSS_ATTACK",t[t.BOSS=6]="BOSS",t[t.BULLET=7]="BULLET",t[t.BUILDING=8]="BUILDING",t[t.AOE=9]="AOE",t[t.ITEM=10]="ITEM",t[t.EQUIPMENT=11]="EQUIPMENT",t[t.COIN=12]="COIN",t[t.TIPS=13]="TIPS",t[t.MELEE=14]="MELEE",t[t.GOODNONPLAYER=15]="GOODNONPLAYER",t[t.WARTER=16]="WARTER",t[t.ENERGY_SHIELD=17]="ENERGY_SHIELD"}(i.ColliderTag||(i.ColliderTag={})),cc._RF.pop()},{}],CommonData:[function(t,e,i){"use strict";cc._RF.push(e,"b86e6PjawlOxqFoYPp0y0Jk","CommonData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.maxHealth=0,this.maxDream=0,this.damageMin=0,this.damageMax=0,this.damageBack=0,this.criticalStrikeRate=0,this.defence=0,this.blockPhysical=0,this.blockMagic=0,this.blockDamage=0,this.lifeDrain=0,this.moveSpeed=0,this.attackSpeed=0,this.dodge=0,this.remoteCooldown=0,this.remoteDamage=0,this.remoteCritRate=0,this.realDamage=0,this.realRate=0,this.magicDamage=0,this.magicDefence=0,this.iceRate=0,this.fireRate=0,this.lighteningRate=0,this.toxicRate=0,this.curseRate=0}return t.prototype.valueCopy=function(t){t&&(this.maxHealth=t.maxHealth?t.maxHealth:0,this.maxDream=t.maxDream?t.maxDream:0,this.damageMin=t.damageMin?t.damageMin:0,this.damageMax=t.damageMax?t.damageMax:0,this.remoteDamage=t.remoteDamage?t.remoteDamage:0,this.criticalStrikeRate=t.criticalStrikeRate?t.criticalStrikeRate:0,this.remoteCritRate=t.remoteCritRate?t.remoteCritRate:0,this.defence=t.defence?t.defence:0,this.lifeDrain=t.lifeDrain?t.lifeDrain:0,this.damageBack=t.damageBack?t.damageBack:0,this.moveSpeed=t.moveSpeed?t.moveSpeed:0,this.attackSpeed=t.attackSpeed?t.attackSpeed:0,this.remoteCooldown=t.remoteCooldown?t.remoteCooldown:0,this.dodge=t.dodge?t.dodge:0,this.realDamage=t.realDamage?t.realDamage:0,this.realRate=t.realRate?t.realRate:0,this.magicDefence=t.magicDefence?t.magicDefence:0,this.iceRate=t.iceRate?t.iceRate:0,this.magicDamage=t.magicDamage?t.magicDamage:0,this.fireRate=t.fireRate?t.fireRate:0,this.lighteningRate=t.lighteningRate?t.lighteningRate:0,this.toxicRate=t.toxicRate?t.toxicRate:0,this.curseRate=t.curseRate?t.curseRate:0,this.blockPhysical=t.blockPhysical?t.blockPhysical:0,this.blockMagic=t.blockMagic?t.blockMagic:0,this.blockDamage=t.blockDamage?t.blockDamage:0)},t.prototype.clone=function(){var e=new t;return e.maxHealth=this.maxHealth,e.maxDream=this.maxDream,e.damageMin=this.damageMin,e.damageMax=this.damageMax,e.criticalStrikeRate=this.criticalStrikeRate,e.defence=this.defence,e.lifeDrain=this.lifeDrain,e.damageBack=this.damageBack,e.moveSpeed=this.moveSpeed,e.attackSpeed=this.attackSpeed,e.remoteCooldown=this.remoteCooldown,e.dodge=this.dodge,e.realDamage=this.realDamage,e.realRate=this.realRate,e.magicDefence=this.magicDefence,e.iceRate=this.iceRate,e.fireRate=this.fireRate,e.lighteningRate=this.lighteningRate,e.toxicRate=this.toxicRate,e.curseRate=this.curseRate,e.remoteDamage=this.remoteDamage,e.remoteCritRate=this.remoteCritRate,e.blockPhysical=this.blockPhysical,e.blockMagic=this.blockMagic,e.blockDamage=this.blockDamage,e},t.prototype.add=function(e){return this.maxHealth+=e.maxHealth?e.maxHealth:0,this.maxDream+=e.maxDream?e.maxDream:0,this.damageMin+=e.damageMin?e.damageMin:0,this.damageMax+=e.damageMax?e.damageMax:0,this.remoteDamage+=e.remoteDamage?e.remoteDamage:0,this.criticalStrikeRate=e.criticalStrikeRate?t.addPercent(this.criticalStrikeRate,e.criticalStrikeRate):this.criticalStrikeRate,this.remoteCritRate=e.remoteCritRate?t.addPercent(this.remoteCritRate,e.remoteCritRate):this.remoteCritRate,this.lifeDrain=e.lifeDrain?t.addPercent(this.lifeDrain,e.lifeDrain):this.lifeDrain,this.dodge=e.dodge?t.addPercent(this.dodge,e.dodge):this.dodge,this.defence+=e.defence?e.defence:0,this.damageBack+=e.damageBack?e.damageBack:0,this.moveSpeed+=e.moveSpeed?e.moveSpeed:0,this.attackSpeed+=e.attackSpeed?e.attackSpeed:0,this.remoteCooldown+=e.remoteCooldown?e.remoteCooldown:0,this.realDamage+=e.realDamage?e.realDamage:0,this.realRate+=e.realRate?e.realRate:0,this.magicDefence=e.magicDefence?e.magicDefence:0,this.magicDamage+=e.magicDamage?e.magicDamage:0,this.iceRate+=e.iceRate?e.iceRate:0,this.fireRate+=e.fireRate?e.fireRate:0,this.lighteningRate+=e.lighteningRate?e.lighteningRate:0,this.toxicRate+=e.toxicRate?e.toxicRate:0,this.curseRate+=e.curseRate?e.curseRate:0,this.blockPhysical+=e.blockPhysical?e.blockPhysical:0,this.blockMagic+=e.blockMagic?e.blockMagic:0,this.blockDamage+=e.blockDamage?e.blockDamage:0,this.iceRate=t.fixRateRange(this.iceRate),this.fireRate=t.fixRateRange(this.fireRate),this.lighteningRate=t.fixRateRange(this.lighteningRate),this.toxicRate=t.fixRateRange(this.toxicRate),this.curseRate=t.fixRateRange(this.curseRate),this.blockPhysical=t.fixRateRange(this.blockPhysical),this.blockMagic=t.fixRateRange(this.blockMagic),this.magicDefence=t.fixRateRange(this.magicDefence),this.realRate=t.fixRateRange(this.realRate),this.lifeDrain=t.fixRateRange(this.lifeDrain),this.dodge=t.fixRateRange(this.dodge),this.remoteCritRate=t.fixRateRange(this.remoteCritRate),this.criticalStrikeRate=t.fixRateRange(this.criticalStrikeRate),this.iceRate=t.fixRateRange(this.iceRate),this},t.addPercent=function(t,e){var i=1;return 100*(1-(i*=1-t/100)*(1-e/100))},t.getPercentRate=function(t){return t/100},t.fixRateRange=function(t){return(t=t<0?0:t)>100?100:t},t}();i.default=o,cc._RF.pop()},{}],Controller:[function(t,e,i){"use strict";cc._RF.push(e,"12f66EVamVPmoXVKYdoGHk5","Controller");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=t("./EventHelper"),h=t("./Logic"),p=t("./UI/CoolDownView"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackAction=null,e.attackActionTouched=!1,e.shootAction=null,e.shootActionTouched=!1,e.interactAction=null,e.interactActionTouched=!1,e.skillAction=null,e.skillAction1=null,e.coolDown=null,e.coolDown1=null,e.skillActionTouched=!1,e.skillActionTouched1=!1,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.coolDown.init(p.default.PROFESSION),this.coolDown1.init(p.default.ORGANIZATION),this.attackAction.on(cc.Node.EventType.TOUCH_START,function(){t.attackActionTouched=!0},this),this.attackAction.on(cc.Node.EventType.TOUCH_END,function(){t.attackActionTouched=!1},this),this.attackAction.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.attackActionTouched=!1},this),this.shootAction.on(cc.Node.EventType.TOUCH_START,function(){t.shootActionTouched=!0},this),this.shootAction.on(cc.Node.EventType.TOUCH_END,function(){t.shootActionTouched=!1,cc.director.emit(c.EventHelper.PLAYER_REMOTEATTACK_CANCEL)},this),this.shootAction.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.shootActionTouched=!1,cc.director.emit(c.EventHelper.PLAYER_REMOTEATTACK_CANCEL)},this),this.skillAction.on(cc.Node.EventType.TOUCH_START,function(){t.skillActionTouched=!0},this),this.skillAction.on(cc.Node.EventType.TOUCH_END,function(){t.skillActionTouched=!1},this),this.skillAction.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.skillActionTouched=!1},this),this.skillAction1.on(cc.Node.EventType.TOUCH_START,function(){t.skillActionTouched1=!0},this),this.skillAction1.on(cc.Node.EventType.TOUCH_END,function(){t.skillActionTouched1=!1},this),this.skillAction1.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.skillActionTouched1=!1},this);var e=!1,i=!1;this.interactAction.on(cc.Node.EventType.TOUCH_START,function(){t.interactActionTouched=!0,i=!0,t.scheduleOnce(function(){i&&(e=!0,c.EventHelper.emit(c.EventHelper.PLAYER_TRIGGER,{isLongPress:!0}))},.3)},this),this.interactAction.on(cc.Node.EventType.TOUCH_END,function(){t.interactActionTouched=!1,e||c.EventHelper.emit(c.EventHelper.PLAYER_TRIGGER),i=!1,e=!1},this),this.interactAction.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.interactActionTouched=!1,i=!1,e=!1},this),cc.director.on(c.EventHelper.HUD_CHANGE_CONTROLLER_SHIELD,function(e){t.node&&t.changeRes(e.detail.isShield)}),cc.director.on(c.EventHelper.HUD_CONTROLLER_UPDATE_GAMEPAD,function(){t.node&&t.updateGamepad()}),this.updateGamepad()},e.prototype.updateGamepad=function(){cc.sys.isMobile||h.default.settings.showGamepad?(this.interactAction.active=!0,this.attackAction.active=!0,this.shootAction.active=!0,this.skillAction.active=!0,this.skillAction1.active=!0,this.coolDown.node.position=this.skillAction.position.clone(),this.coolDown1.node.position=this.skillAction1.position.clone()):(this.interactAction.active=!1,this.attackAction.active=!1,this.shootAction.active=!1,this.skillAction.active=!1,this.skillAction1.active=!1,this.coolDown.node.position=cc.v3(0,180),this.coolDown1.node.position=cc.v3(-96,180))},e.prototype.changeRes=function(t){if(this.shootAction){var e=this.shootAction.getComponent(cc.Button);e&&(e.normalSprite=h.default.spriteFrameRes(t?"uishield":"uiremote"),e.pressedSprite=h.default.spriteFrameRes(t?"uishieldpress":"uiremotepress"),e.hoverSprite=h.default.spriteFrameRes(t?"uishieldlight":"uiremotelight"),e.disabledSprite=h.default.spriteFrameRes(t?"uishieldpress":"uiremotepress"))}},e.prototype.drawSkillCoolDown=function(t,e,i,o,a,n,r){var s=this;if(r&&(r.string=e>0?""+e:""),!(t<0)&&a){o&&this.unschedule(o),0==t&&i&&i.clear();var l=cc.Vec3.ZERO,c=100,h=100/t*.1;o=function(){c-=h,i&&i.clear(),s.drawArc(360*c/100,l,i),n.node.opacity=200,c<0&&(n.node.opacity=0,i&&i.clear(),s.unschedule(o))},this.schedule(o,.1,cc.macro.REPEAT_FOREVER)}},e.prototype.drawArc=function(t,e,i){if(i&&(i.clear(),!(t<0))){var o=2*t*Math.PI/360;i.arc(e.x,e.y,48,2*Math.PI,2*Math.PI-o),i.stroke()}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&!h.default.isGamePause&&(this.attackActionTouched&&cc.director.emit(c.EventHelper.PLAYER_ATTACK),this.shootActionTouched&&cc.director.emit(c.EventHelper.PLAYER_REMOTEATTACK),this.skillActionTouched&&cc.director.emit(c.EventHelper.PLAYER_SKILL),this.skillActionTouched1&&cc.director.emit(c.EventHelper.PLAYER_SKILL1))},n([l(cc.Node)],e.prototype,"attackAction",void 0),n([l(cc.Node)],e.prototype,"shootAction",void 0),n([l(cc.Node)],e.prototype,"interactAction",void 0),n([l(cc.Node)],e.prototype,"skillAction",void 0),n([l(cc.Node)],e.prototype,"skillAction1",void 0),n([l(p.default)],e.prototype,"coolDown",void 0),n([l(p.default)],e.prototype,"coolDown1",void 0),n([s],e)}(cc.Component);i.default=u,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic","./UI/CoolDownView":"CoolDownView"}],CoolDownView:[function(t,e,i){"use strict";cc._RF.push(e,"58d32PM1/ZHL6BBvFTBgSIk","CoolDownView");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("../Logic"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=i.PROFESSION,e.skillIcon=null,e.graphics=null,e.coolDownFuc=null,e.label=null,e.secondCount=0,e.secondCountLerp=0,e.duration=0,e.storePoint=1,e.storePointMax=1,e.timeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.graphics=this.getComponent(cc.Graphics),this.label=this.getComponentInChildren(cc.Label),this.skillIcon=this.node.getChildByName("mask").getChildByName("sprite").getComponent(cc.Sprite),this.skillIcon.node.opacity=255,r.EventHelper.on(r.EventHelper.HUD_CONTROLLER_COOLDOWN,function(e){t.node&&e.id==t.id&&t.setData(e.duration,e.secondCount,e.storePoint,e.storePointMax)})},e.prototype.init=function(t){this.id=t,this.skillIcon||(this.skillIcon=this.node.getChildByName("mask").getChildByName("sprite").getComponent(cc.Sprite)),t==i.PROFESSION?this.setSkillIcon(s.default.playerData.AvatarData.professionData.talent):t==i.ORGANIZATION&&this.setSkillIcon("talent10"+s.default.playerData.AvatarData.organizationIndex)},e.prototype.setSkillIcon=function(t){this.skillIcon.spriteFrame=s.default.spriteFrameRes(t)},e.prototype.setData=function(t,e,i,o){this.node&&(e>t&&(e=t),t<=0&&(t=0),this.storePointMax=o,this.duration=t,this.secondCountLerp=e,this.secondCount=e,this.storePoint=i,this.drawSkillCoolDown())},e.prototype.drawSkillCoolDown=function(){if(!(this.duration<=0)&&(this.label.string=this.storePoint>0&&this.storePointMax>1?""+this.storePoint:"",this.graphics&&this.graphics.clear(),this.secondCountLerp>1&&(this.secondCount=s.default.lerp(this.secondCount,this.secondCountLerp-1,.1)),this.secondCount>0)){var t=cc.Vec3.ZERO,e=this.secondCount/this.duration;this.drawArc(360*e,t,this.graphics)}},e.prototype.drawArc=function(t,e,i){if(i&&(i.clear(),!(t<0))){var o=2*t*Math.PI/360;i.arc(e.x,e.y,48,2*Math.PI,2*Math.PI-o),i.stroke()}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.1&&(this.timeDelay=0,!0)},e.prototype.start=function(){},e.prototype.update=function(t){this.isTimeDelay(t)&&this.drawSkillCoolDown()},e.PROFESSION=0,e.ORGANIZATION=1,i=n([c],e)}(cc.Component));i.default=h,cc._RF.pop()},{"../EventHelper":"EventHelper","../Logic":"Logic"}],CutScene:[function(t,e,i){"use strict";cc._RF.push(e,"cb0c7YcdndBfpVkO+dBgo79","CutScene");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSkip=!1,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.skipNode=this.node.getChildByName("skip"),this.cut001=this.node.getChildByName("sprite").getChildByName("cut001"),this.cut002=this.node.getChildByName("sprite").getChildByName("cut002"),this.cut003=this.node.getChildByName("sprite").getChildByName("cut003"),this.cut004=this.node.getChildByName("sprite").getChildByName("cut004"),this.cut006=this.node.getChildByName("sprite").getChildByName("cut006"),this.cut007=this.node.getChildByName("sprite").getChildByName("cut007"),this.cut008=this.node.getChildByName("sprite").getChildByName("cut008"),this.cut009=this.node.getChildByName("sprite").getChildByName("cut009"),this.cutList=new Array,this.cutList.push(this.cut001),this.cutList.push(this.cut002),this.cutList.push(this.cut003),this.cutList.push(this.cut004),this.cutList.push(this.cut006),this.cutList.push(this.cut007),this.cutList.push(this.cut008),this.cutList.push(this.cut009),this.skipNode.opacity=0,this.node.opacity=0,this.hideAllCuts(),this.node.on(cc.Node.EventType.TOUCH_START,function(){255==t.skipNode.opacity&&(t.isSkip=!0),t.skipNode.opacity=255},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){},this)},e.prototype.playShow=function(){var t=this;this.node.opacity=255,this.getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.isSkip=!0},12)},e.prototype.unregisterClick=function(){this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_CANCEL),this.node.off(cc.Node.EventType.TOUCH_END)},e.prototype.hideAllCuts=function(){for(var t=0,e=this.cutList;t<e.length;t++)e[t].opacity=0},e.prototype.start=function(){},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],DamageData:[function(t,e,i){"use strict";cc._RF.push(e,"140ebm8pJ5CBb4RE4tI9c22","DamageData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t){this.realDamage=0,this.physicalDamage=0,this.magicDamage=0,this.realRate=0,this.iceRate=0,this.fireRate=0,this.lighteningRate=0,this.toxicRate=0,this.curseRate=0,this.stoneRate=0,this.isCriticalStrike=!1,this.isBackAttack=!1,this.isRemote=!1,this.isStab=!1,this.isFar=!1,this.isFist=!1,this.isBlunt=!1,this.isMelee=!1,this.comboType=0,this.realDamage=t||0}return t.prototype.valueCopy=function(t){this.realDamage=t.realDamage?t.realDamage:0,this.physicalDamage=t.physicalDamage?t.physicalDamage:0,this.magicDamage=t.magicDamage?t.magicDamage:0,this.realRate=t.realRate?t.realRate:0,this.iceRate=t.iceRate?t.iceRate:0,this.fireRate=t.fireRate?t.fireRate:0,this.lighteningRate=t.lighteningRate?t.lighteningRate:0,this.toxicRate=t.toxicRate?t.toxicRate:0,this.curseRate=t.curseRate?t.curseRate:0,this.stoneRate=t.stoneRate?t.stoneRate:0,this.isCriticalStrike=!!t.isCriticalStrike,this.isBackAttack=!!t.isBackAttack,this.isRemote=!!t.isRemote,this.isStab=!!t.isStab,this.isFar=!!t.isFar,this.isFist=!!t.isFist,this.isBlunt=!!t.isBlunt,this.isMelee=!!t.isMelee,this.comboType=t.comboType?t.comboType:0},t.prototype.clone=function(){var e=new t;return e.realDamage=this.realDamage,e.physicalDamage=this.physicalDamage,e.magicDamage=this.magicDamage,e.realRate=this.realRate,e.iceRate=this.iceRate,e.fireRate=this.fireRate,e.lighteningRate=this.lighteningRate,e.toxicRate=this.toxicRate,e.curseRate=this.curseRate,e.stoneRate=this.stoneRate,e.isCriticalStrike=this.isCriticalStrike,e.isBackAttack=this.isBackAttack,e.isRemote=this.isRemote,e.isBlunt=this.isBlunt,e.isFar=this.isFar,e.isFist=this.isFist,e.isStab=this.isStab,e.isMelee=this.isMelee,e.comboType=this.comboType,e},t.prototype.getTotalDamage=function(){var t=this.physicalDamage+this.magicDamage+this.realDamage;return isNaN(t)&&(console.log(t),t=0),t},t}();i.default=o,cc._RF.pop()},{}],DashShadow:[function(t,e,i){"use strict";cc._RF.push(e,"909e64n9VxBGoAX7rWiFEbf","DashShadow");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Dungeon"),l=t("../Talent/Talent"),c=t("../Shooter"),h=t("../Utils/IndexZ"),p=cc._decorator,u=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hv=cc.v3(1,0),e.shooter=null,e}return a(e,t),e.prototype.onLoad=function(){this.rigidBody=this.getComponent(cc.RigidBody),this.motionStreak=this.getComponent(cc.MotionStreak),this.sprite=this.node.getChildByName("sprite")},e.prototype.init=function(t){this.talentDash=t,this.shooter.dungeon=this.talentDash.player.node.parent.getComponent(s.default)},e.prototype.changeDashPerformance=function(t){this.motionStreak.color=cc.Color.BLACK;for(var e=0,i=t;e<i.length;e++)i[e]},e.prototype.onEnable=function(){},e.prototype.start=function(){},e.prototype.getPlayerPosition=function(){return this.talentDash.player.node.position.clone().addSelf(cc.v3(8,8))},e.prototype.getNearPlayerDistance=function(){return r.default.getDistance(this.node.position,this.getPlayerPosition())},e.prototype.show=function(){var t=this;this.node.active=!0,this.node.parent=this.talentDash.player.node.parent;var e=this.talentDash.player.isFaceRight;this.sprite.scaleX=e?1:-1,this.node.setPosition(this.getPlayerPosition());var i=1200;this.rigidBody.linearDamping=1,this.talentDash.hashTalent(l.default.DASH_14)&&(i=2e3,this.rigidBody.linearDamping=1);var o=this.hv.mul(i);this.rigidBody.linearVelocity=cc.v2(o.x,o.y),this.node.zIndex=h.default.OVERHEAD,this.fire(this.shooter),this.scheduleOnce(function(){t.hide()},.45)},e.prototype.hide=function(){this.talentDash.player.node.setPosition(s.default.fixOuterMap(this.node.position.clone())),this.node.active=!1,this.rigidBody.linearVelocity=cc.Vec2.ZERO},e.prototype.onBeginContact=function(t,e,i){this.talentDash&&this.talentDash.hashTalent(l.default.DASH_02)&&this.talentDash.attacking(i,this.node)},e.prototype.fire=function(t){t.data.bulletLineExNum=5,t.data.bulletLineInterval=.05,this.talentDash.hashTalent(l.default.DASH_11)&&(t.data.bulletLineExNum=10,t.data.bulletLineInterval=.03);var e=!1;this.talentDash.hashTalent(l.default.DASH_09)?(e=!0,t.data.bulletType="bullet025"):this.talentDash.hashTalent(l.default.DASH_10)&&(e=!0,t.data.bulletType="bullet026"),e&&t.fireBullet(0,cc.v3(0,0))},e.prototype.setHv=function(t){t.equals(cc.Vec3.ZERO)?this.hv=cc.v3(1,0):this.hv=t},n([d(c.default)],e.prototype,"shooter",void 0),n([u],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic","../Shooter":"Shooter","../Talent/Talent":"Talent","../Utils/IndexZ":"IndexZ"}],DecorationFloor:[function(t,e,i){"use strict";cc._RF.push(e,"c0e43WuUrFGu7HrB9h8NrBh","DecorationFloor");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("./Building"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.changeRes=function(t){var e=this.getComponent(cc.Sprite);e.spriteFrame=r.default.spriteFrameRes(t),this.node.width=e.spriteFrame.getRect().width,this.node.height=e.spriteFrame.getRect().height},n([c],e)}(s.default));i.default=h,cc._RF.pop()},{"../Logic":"Logic","./Building":"Building"}],DefaultStateMachine:[function(t,e,i){"use strict";cc._RF.push(e,"4327d7ykMVKAbwAJoU8o/85","DefaultStateMachine"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e,i){this.owner=t,this.setInitialState(e),this.setGlobalState(i)}return t.prototype.getOwner=function(){return this.owner},t.prototype.setOwner=function(t){this.owner=t},t.prototype.setInitialState=function(t){this.previousState=null,this.currentState=t},t.prototype.setGlobalState=function(t){this.globalState=t},t.prototype.getCurrentState=function(){return this.currentState},t.prototype.getGlobalState=function(){return this.globalState},t.prototype.getPreviousState=function(){return this.previousState},t.prototype.update=function(){this.globalState&&this.globalState.update(this.owner),this.currentState&&this.currentState.update(this.owner)},t.prototype.changeState=function(t){this.previousState=this.currentState,this.currentState&&this.currentState.exit(this.owner),this.currentState=t,this.currentState&&this.currentState.enter(this.owner)},t.prototype.revertToPreviousState=function(){return!!this.previousState&&(this.changeState(this.previousState),!0)},t.prototype.isInState=function(t){return this.currentState==t},t.prototype.handleEvent=function(t){return!(!this.currentState||!this.currentState.event(this.owner,t))||!(!this.globalState||!this.globalState.event(this.owner,t))},t}();i.default=o,cc._RF.pop()},{}],Door:[function(t,e,i){"use strict";cc._RF.push(e,"f14f52tIg1Ivb0Rnl80O8tL","Door");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("./Building"),l=t("../Utils/IndexZ"),c=t("../Actor/ColliderTag"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.isDoor=!0,e.isHidden=!1,e.isEmpty=!1,e.isLock=!1,e.dir=0,e.sprite=null,e.roof=null,e.lockInfo=null,e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.roof=this.node.getChildByName("roof").getComponent(cc.Sprite),this.lockInfo=this.node.getChildByName("info"),this.arrow=this.node.getChildByName("doorarrow"),this.arrow.opacity=0,this.boxCollider=this.getComponent(cc.PhysicsBoxCollider),this.node.zIndex=l.default.FLOOR},e.prototype.start=function(){this.sprite&&(this.sprite.spriteFrame=r.default.spriteFrameRes("door"+(this.dir>1?"side":"")+"0"+r.default.chapterIndex+"anim000"),this.sprite.node.width=128,this.sprite.node.height=this.dir>1?256:128),this.roof||(this.roof=this.node.getChildByName("roof").getComponent(cc.Sprite));var t=r.default.spriteFrameRes("roof"+r.default.worldLoader.getCurrentLevelData().wallRes1+"anim000");this.dir>1&&(t=null),this.roof.spriteFrame=t,this.roof.node.parent=this.node.parent;var e=this.node.convertToWorldSpaceAR(cc.v3(0,128));switch(this.roof.node.position=this.roof.node.parent.convertToNodeSpaceAR(e),this.roof.node.zIndex=l.default.OVERHEAD,this.dir){case 0:break;case 1:this.roof.node.angle=180;break;case 2:break;case 3:this.sprite.node.scaleX=-1}this.lockInfo&&this.isLock&&!r.default.mapManager.isNeighborRoomStateClear(this.dir)&&(this.lockInfo.opacity=255);var i=this.boxCollider;i.offset=cc.v2(0,7),i.size=cc.size(128,114),this.dir>1&&(i.offset=cc.v2(0,8),i.size=cc.size(64,128)),i.apply()},e.prototype.setOpen=function(t,e){this.isDoor&&(t?this.openGate(e):this.closeGate(e))},e.prototype.openGate=function(t){var e=this;if(this.lockInfo||(this.lockInfo=this.node.getChildByName("info")),!this.isLock||r.default.mapManager.isNeighborRoomStateClear(this.dir)){if(!this.isOpen){this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite)),this.lockInfo.opacity=0,this.isOpen=!0;var i=0;this.schedule(function(){e.sprite.spriteFrame=r.default.spriteFrameRes("door"+(e.dir>1?"side":"")+"0"+r.default.chapterIndex+"anim00"+i++),i>4&&(e.boxCollider.sensor=!0,e.boxCollider.apply())},t?0:.15,4)}}else this.lockInfo.opacity=255},e.prototype.closeGate=function(t){var e=this;if(this.isOpen&&!this.isEmpty){this.isOpen=!1;var i=4;this.schedule(function(){e.sprite.spriteFrame=r.default.spriteFrameRes("door"+(e.dir>1?"side":"")+"0"+r.default.chapterIndex+"anim00"+i--),i<0&&(e.boxCollider.sensor=!1,e.boxCollider.apply())},t?0:.1,4)}},e.prototype.onCollisionEnter=function(t){1!=this.dir||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.roof.node.opacity=180)},e.prototype.onCollisionStay=function(t){1!=this.dir||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.roof.node.opacity=180)},e.prototype.onCollisionExit=function(t){1!=this.dir||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.roof.node.opacity=255)},e.prototype.checkLock=function(){},n([p],e)}(s.default));i.default=u,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Logic":"Logic","../Utils/IndexZ":"IndexZ","./Building":"Building"}],Dragon:[function(t,e,i){"use strict";cc._RF.push(e,"a38f40rLRxEErH92pL9pLeC","Dragon");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../Data/DamageData"),l=t("../Shooter"),c=t("../Dungeon"),h=t("../Manager/StatusManager"),p=t("../Utils/NextStep"),u=t("../Utils/Random"),d=t("../EventHelper"),f=t("../Utils/AudioPlayer"),g=t("../Data/FromData"),y=t("../Achievement"),m=t("../Utils/IndexZ"),v=t("../Utils/ActorUtils"),E=cc._decorator,_=E.ccclass,D=(E.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.fireSkill=new p.default,e.rainSkill=new p.default,e.isRainReady=!1,e.actionCount=0,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(l.default),this.shooter01.from.valueCopy(g.default.getClone(this.actorName(),"dragonhead")),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default),this.physicBox=this.getComponent(cc.PhysicsBoxCollider)},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.sc.isDied||!this.sc.isShow||this.rainSkill.IsExcuting||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(y.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.fireFire=function(){var t=this;this.fireSkill.next(function(){t.fireSkill.IsExcuting=!0,t.anim.play("DragonFire"),t.scheduleOnce(function(){t.shooter01.setHv(cc.v3(0,-1)),t.shooter01.data.bulletLineInterval=.5,t.fireShooter(t.shooter01,"bullet200",2,5)},1.1),t.scheduleOnce(function(){t.fireSkill.IsExcuting=!1,t.anim.play("DragonIdle")},2)},5,!0)},e.prototype.fireRain=function(){var t=this;this.isRainReady&&this.rainSkill.next(function(){t.rainSkill.IsExcuting=!0,t.physicBox.sensor=!0,t.physicBox.apply(),t.rigidbody.linearVelocity=cc.v2(0,0),t.anim.stop(),t.anim.play("DragonFlyHigh"),t.scheduleOnce(function(){t.anim.play("DragonFlyLow"),t.physicBox.sensor=!1,t.physicBox.apply()},13),t.scheduleOnce(function(){t.rainSkill.IsExcuting=!1},15),t.schedule(function(){t.dungeon.addFallStone(t.dungeon.player.node.position,!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v3(u.default.getRandomNum(0,c.default.WIDTH_SIZE-1),u.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v3(u.default.getRandomNum(0,c.default.WIDTH_SIZE-1),u.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v3(u.default.getRandomNum(0,c.default.WIDTH_SIZE-1),u.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0)},.5,20,2)},30)},e.prototype.bossAction=function(){if(!this.sc.isDied&&this.sc.isShow&&this.dungeon){if(this.changeZIndex(),this.fireRain(),this.rainSkill.IsExcuting||this.fireFire(),!this.rainSkill.IsExcuting){this.actionCount++;var t=cc.v3(1,0);this.actionCount>10&&(t=cc.v3(-1,0)),this.actionCount>20&&(this.actionCount=0),t.equals(cc.Vec3.ZERO)||(t=t.normalizeSelf(),this.move(t,800))}}else this.actionCount=0},e.prototype.changeZIndex=function(){this.node.zIndex=m.default.OVERHEAD},e.prototype.move=function(t,e){if(!this.sc.isDied){t.equals(cc.Vec3.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=cc.v2(i,o);a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.changeZIndex()}},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.setHv(cc.v3(0,-1)),t.fireBullet(a,cc.Vec3.ZERO)},e.prototype.showBoss=function(){var t=this;this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied),this.scheduleOnce(function(){t.isRainReady=!0},10)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied},e.prototype.onCollisionEnter=function(t){var e=v.default.getEnemyCollisionTarget(t);if(e&&!this.sc.isDied&&!this.physicBox.sensor){var i=new s.default;i.physicalDamage=3,e.takeDamage(i,g.default.getClone(this.actorName(),"dragonhead"),this)}},e.prototype.actorName=function(){return"\u672b\u65e5\u9ed1\u9f99"},n([_],e)}(r.default));i.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","../Utils/NextStep":"NextStep","../Utils/Random":"Random","./Boss":"Boss"}],DryadGrass:[function(t,e,i){"use strict";cc._RF.push(e,"d7d90DMrjlILYsaGuEm//pn","DryadGrass");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Base/Actor"),l=t("../Manager/StatusManager"),c=t("../Data/FromData"),h=t("../Utils/ActorUtils"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUp=!1,e.isAuto=!0,e.isUping=!1,e}return a(e,t),e.prototype.onLoad=function(){this.isUp=!1},e.prototype.takeDamage=function(){return!1},e.prototype.fall=function(){this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isUping=!0},e.prototype.TwineUp=function(){var t=this;this.isUp=!0,this.scheduleOnce(function(){t.isUp=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},6)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){!h.default.getEnemyCollisionTarget(t)||this.isAuto||this.isUping||this.fall()},e.prototype.onCollisionStay=function(t){var e=h.default.getEnemyCollisionTarget(t);if(e&&this.isUp&&this.isValid){this.isUp=!1;var i=c.default.getClone(this.actorName(),"dryadtwine03");e.takeDamage(new r.default(2),i)&&e.addStatus(l.default.TWINE,i)}},e.prototype.addStatus=function(){},e.prototype.getCenterPosition=function(){return this.node.position.clone()},e.prototype.actorName=function(){return"\u6811\u6839\u7f20\u7ed5"},e.prototype.takeDizz=function(){},e.prototype.updateStatus=function(){},e.prototype.hideSelf=function(){},e.prototype.updateDream=function(){return 0},e.prototype.setLinearVelocity=function(){},n([u],e)}(s.default));i.default=d,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils"}],Dryad:[function(t,e,i){"use strict";cc._RF.push(e,"d1a62Oo+gRDI5+v2dxAMRw+","Dryad");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../Shooter"),l=t("../Dungeon"),c=t("../Logic"),h=t("../Manager/StatusManager"),p=t("../Utils/NextStep"),u=t("./BossAttackCollider"),d=t("../EventHelper"),f=t("../Utils/AudioPlayer"),g=t("../Data/FromData"),y=t("../Achievement"),m=cc._decorator,v=m.ccclass,E=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hand01=null,e.hand02=null,e.timeDelay=0,e.isMoving=!1,e.flower01=null,e.flower02=null,e.twoFlowerSkill=new p.default,e.twineGrassSkill=new p.default,e.meleeSkill=new p.default,e.stoneSkill=new p.default,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(s.default),this.shooter02=this.node.getChildByName("Shooter02").getComponent(s.default),this.shooter03=this.node.getChildByName("Shooter03").getComponent(s.default);var t=g.default.getClone(this.actorName(),"dryadflower04");this.shooter01.from.valueCopy(t),this.shooter02.from.valueCopy(t),this.shooter03.from.valueCopy(t),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default),this.hand01.from.valueCopy(t),this.hand02.from.valueCopy(t)},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.sc.isDied||!this.sc.isShow||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.playHit(this.node.getChildByName("sprite")),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(y.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){!this.sc.isDied&&this.sc.isShow&&this.dungeon&&(this.changeZIndex(),this.twoFlowerSkill.IsExcuting||this.stoneSkill.IsExcuting||this.attack(),this.meleeSkill.IsExcuting||this.stoneSkill.IsExcuting||this.twoFlowers(),this.meleeSkill.IsExcuting||this.twoFlowerSkill.IsExcuting||this.fireStone(),this.twineGrass())},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.MELEE}}),t.meleeSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),c.default.getHalfChance()?(t.anim.play("DryadAttack01"),t.hand01.showCollider(2,1)):(t.anim.play("DryadAttack02"),t.hand02.showCollider(2,1)),t.scheduleOnce(function(){t.anim.play("DryadIdle"),t.meleeSkill.IsExcuting=!1},1)},2,!0)},e.prototype.twineGrass=function(){var t=this;this.twineGrassSkill.next(function(){t.schedule(function(){t.dungeon.buildingManager.addTwineGrass(l.default.getPosInMap(t.dungeon.player.pos.clone()),!0)},1,2)},8,!0)},e.prototype.twoFlowers=function(){var t=this;this.twoFlowerSkill.next(function(){t.twoFlowerSkill.IsExcuting=!0,t.shooter02.setHv(cc.v3(0,-1)),t.shooter03.setHv(cc.v3(0,-1)),t.anim.play("DryadOpen"),t.flower01.getComponent(cc.Animation).play(),t.flower02.getComponent(cc.Animation).play(),t.scheduleOnce(function(){t.shooter02.data.bulletLineInterval=.5,t.shooter03.data.bulletLineInterval=.5,t.fireShooter(t.shooter02,"bullet021",99,2),t.fireShooter(t.shooter03,"bullet021",99,2)},2),t.scheduleOnce(function(){t.anim.play("DryadIdle"),t.twoFlowerSkill.IsExcuting=!1},4)},6,!0)},e.prototype.fireStone=function(){var t=this;this.stoneSkill.next(function(){t.stoneSkill.IsExcuting=!0,t.anim.play("DryadStone"),t.scheduleOnce(function(){var e=t.node.position.clone().add(t.shooter01.node.position),i=t.dungeon.player.getCenterPosition().sub(e);i.equals(cc.Vec3.ZERO)||(i=i.normalizeSelf(),t.shooter01.setHv(i),t.fireShooter(t.shooter01,"bullet022",0,0))},.55),t.scheduleOnce(function(){t.stoneSkill.IsExcuting=!1,t.anim.play("DryadIdle")},1)},4,!0)},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a,cc.Vec3.ZERO)},e.prototype.showBoss=function(){this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied,this.rigidbody.linearVelocity=cc.Vec2.ZERO},e.prototype.actorName=function(){return"\u8fdc\u53e4\u4e4b\u6811"},n([E(u.default)],e.prototype,"hand01",void 0),n([E(u.default)],e.prototype,"hand02",void 0),n([E(cc.Node)],e.prototype,"flower01",void 0),n([E(cc.Node)],e.prototype,"flower02",void 0),n([v],e)}(r.default);i.default=_,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/NextStep":"NextStep","./Boss":"Boss","./BossAttackCollider":"BossAttackCollider"}],DungeonStyleData:[function(t,e,i){"use strict";cc._RF.push(e,"6e0bc4Ume5FZZHLhQzz4NXv","DungeonStyleData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(t,e,i,o,a,n,r){this.background=t,this.topwall=e,this.doorframe=a,this.sidewall=i,this.door=o,this.bg02color=n,this.floor=r},cc._RF.pop()},{}],DungeonStyleManager:[function(t,e,i){"use strict";cc._RF.push(e,"96118QtbixO743MdRQKBctE","DungeonStyleManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Dungeon"),l=t("../Data/DungeonStyleData"),c=t("../UI/ParallaxBackground"),h=t("../Utils/IndexZ"),p=t("./BaseManager"),u=cc._decorator,d=u.ccclass,f=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background01=null,e.floor=null,e.parallaxBackground=null,e.darksides="darksides",e}return a(e,t),e.prototype.clear=function(){},e.prototype.runBackgroundAnim=function(t){if(this.background01){var e=r.default.spriteFrameRes(t),i=r.default.spriteFrameRes(t+"1");if(i||(i=r.default.spriteFrameRes(t)),e){this.background01.stopAllActions();var o=this.background01.getComponent(cc.Sprite);cc.tween(this.background01).repeatForever(cc.tween().delay(.4).call(function(){o.spriteFrame=e}).delay(.4).call(function(){o.spriteFrame=i})).start()}}},e.prototype.addDecorations=function(){switch(r.default.chapterIndex){case r.default.CHAPTER00:this.styleData=new l.default("pipeline","restwall1","restsides","restdoor","restdoorframe","#000000","tile_lab001");break;case r.default.CHAPTER01:this.styleData=new l.default("sea","shipwall1","shipsides","shipdoor","shipdoorframe","#000000","tile_deck001");break;case r.default.CHAPTER02:this.styleData=new l.default("grass","junglewall1","junglesides","jungledoor","jungledoorframe","#000000","tile_dirt001");break;case r.default.CHAPTER03:this.styleData=new l.default("sandsea","pyramidwall1","pyramidsides","pyramiddoor","pyramiddoorframe","#000000","tile003");break;case r.default.CHAPTER04:case r.default.CHAPTER05:this.styleData=new l.default("magmasea","dungeonwall1","dungeonsides","dungeondoor","dungeondoorframe","#000000","tile004");break;case r.default.CHAPTER099:this.styleData=new l.default("pipeline","restwall1","restsides","restdoor","restdoorframe","#000000","tile_lab001")}this.styleData&&(this.addFloor(),this.background01.getComponent(cc.Sprite).spriteFrame=null)},e.prototype.addDecorateBg=function(){var t=cc.instantiate(this.parallaxBackground);t.parent=this.node;var e=s.default.getPosInMap(cc.v3(s.default.WIDTH_SIZE/2,s.default.HEIGHT_SIZE/2));t.setPosition(e),t.zIndex=h.default.BACKGROUND;var i=t.getComponent(c.default);i.background.width=s.default.TILE_SIZE/2*s.default.WIDTH_SIZE,i.background.height=s.default.TILE_SIZE/2*(s.default.HEIGHT_SIZE+4),i.background.color=cc.Color.WHITE.fromHEX(this.styleData.bg02color),i.init()},e.prototype.addFloor=function(){var t=r.default.worldLoader.getCurrentLevelData(),e=r.default.mapManager.getCurrentRoom(),i=s.default.getPosInMap(cc.v3(-3,-3));0==e.x?(i=s.default.getPosInMap(cc.v3(0,-3)),0==e.y?i=s.default.getPosInMap(cc.v3(0,0)):e.y==t.height-1&&(i=s.default.getPosInMap(cc.v3(0,-6)))):e.x==t.width-1&&(i=s.default.getPosInMap(cc.v3(-6,-3)),0==e.y?i=s.default.getPosInMap(cc.v3(-6,-6)):e.y==t.height-1&&(i=s.default.getPosInMap(cc.v3(-6,0)))),0==e.x?(i=s.default.getPosInMap(cc.v3(0,-3)),0==e.y?i=s.default.getPosInMap(cc.v3(0,0)):e.y==t.height-1&&(i=s.default.getPosInMap(cc.v3(0,-6)))):e.x==t.width-1&&(i=s.default.getPosInMap(cc.v3(-6,-3)),0==e.y?i=s.default.getPosInMap(cc.v3(-6,-6)):e.y==t.height-1&&(i=s.default.getPosInMap(cc.v3(-6,0)))),0==e.y?(i=s.default.getPosInMap(cc.v3(-3,0)),0==e.x?i=s.default.getPosInMap(cc.v3(0,0)):e.x==t.width-1&&(i=s.default.getPosInMap(cc.v3(-6,-6)))):e.y==t.height-1&&(i=s.default.getPosInMap(cc.v3(-3,-6)),0==e.x?i=s.default.getPosInMap(cc.v3(0,-6)):e.x==t.width-1&&(i=s.default.getPosInMap(cc.v3(-6,0)))),this.floor.width=s.default.TILE_SIZE/4*(s.default.WIDTH_SIZE+6),this.floor.height=s.default.TILE_SIZE/4*(s.default.HEIGHT_SIZE+6),this.floor.position=cc.v3(i.x-s.default.TILE_SIZE/2,i.y-s.default.TILE_SIZE/2),this.floor.zIndex=h.default.BACKGROUNDFLOOR,this.floor.getComponent(cc.Sprite).spriteFrame=r.default.spriteFrameRes(t.floorRes+"001")},n([f(cc.Node)],e.prototype,"background01",void 0),n([f(cc.Node)],e.prototype,"floor",void 0),n([f(cc.Prefab)],e.prototype,"parallaxBackground",void 0),n([d],e)}(p.default);i.default=g,cc._RF.pop()},{"../Data/DungeonStyleData":"DungeonStyleData","../Dungeon":"Dungeon","../Logic":"Logic","../UI/ParallaxBackground":"ParallaxBackground","../Utils/IndexZ":"IndexZ","./BaseManager":"BaseManager"}],Dungeon:[function(t,e,i){"use strict";cc._RF.push(e,"6dd52klzMJJgafrk2kw2YVi","Dungeon");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Player"),s=t("./Tile"),l=t("./Logic"),c=t("./EventHelper"),h=t("./Manager/MonsterManager"),p=t("./Manager/EquipmentManager"),u=t("./Manager/DungeonStyleManager"),d=t("./Utils/AudioPlayer"),f=t("./Rect/RoomType"),g=t("./Utils/IndexZ"),y=t("./Manager/BuildingManager"),m=t("./Manager/NonPlayerManager"),v=t("./Manager/ItemManager"),E=t("./Utils/Utils"),_=t("./Manager/LightManager"),D=cc._decorator,S=D.ccclass,R=D.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tile=null,e.playerPrefab=null,e.fog=null,e.map=new Array,e.floorIndexmap=new Array,e.timeDelay=0,e.checkTimeDelay=0,e.player=null,e.monsterManager=null,e.nonPlayerManager=null,e.equipmentManager=null,e.dungeonStyleManager=null,e.itemManager=null,e.buildingManager=null,e.lightManager=null,e.CameraZoom=1,e.needZoomIn=!1,e.isInitFinish=!1,e.isClear=!1,e.currentPos=cc.v3(0,0),e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),c.EventHelper.on(c.EventHelper.PLAYER_MOVE,function(e){t.playerAction(e.dir,e.pos,e.dt)}),c.EventHelper.on(c.EventHelper.DUNGEON_SETEQUIPMENT,function(e){t.node&&t.addEquipment(e.equipmentData.img,e.pos,e.equipmentData)}),c.EventHelper.on(c.EventHelper.DUNGEON_ADD_COIN,function(e){t.addCoin(e.pos,e.count)}),c.EventHelper.on(c.EventHelper.DUNGEON_ADD_OILGOLD,function(e){t.addOilGold(e.pos,e.count)}),c.EventHelper.on(c.EventHelper.DUNGEON_ADD_ITEM,function(e){t.node&&t.addItem(e.pos,e.res,e.count)}),c.EventHelper.on(c.EventHelper.DUNGEON_ADD_FALLSTONE,function(e){t.addFallStone(e.pos,e.isAuto)}),c.EventHelper.on(c.EventHelper.DUNGEON_ADD_LIGHTENINGFALL,function(e){t.addLighteningFall(e.pos,!1,!1,e.showArea,e.damage)}),c.EventHelper.on(c.EventHelper.DUNGEON_SHAKEONCE,function(){t.anim&&t.anim.play("DungeonShakeOnce")}),c.EventHelper.on(c.EventHelper.BOSS_ADDSLIME,function(e){t.addBossSlime(e.slimeType,e.posIndex)}),this.monsterManager=this.getComponent(h.default),this.nonPlayerManager=this.getComponent(m.default),this.equipmentManager=this.getComponent(p.default),this.itemManager=this.getComponent(v.default),this.dungeonStyleManager=this.getComponent(u.default),this.buildingManager=this.getComponent(y.default),this.lightManager=this.getComponent(_.default),this.reset()},e.prototype.reset=function(){var t=this;l.default.lastBgmIndex=l.default.chapterIndex==l.default.CHAPTER099?1:0,d.default.play(d.default.PLAY_BG,!0),this.monsterManager.clear(),this.nonPlayerManager.clear(),this.equipmentManager.clear(),this.itemManager.clear(),this.dungeonStyleManager.clear(),this.buildingManager.clear(),this.lightManager.clear(),this.fog.zIndex=g.default.FOG,this.fog.scale=.6,this.fog.opacity=255,this.lightManager.shadow.node.zIndex=g.default.SHADOW,this.lightManager.ray.node.zIndex=g.default.SHADOW+10,this.currentPos=cc.v3(l.default.mapManager.getCurrentRoom().x,l.default.mapManager.getCurrentRoom().y);var e=l.default.mapManager.getCurrentMapStringArray(),o=l.default.worldLoader.getCurrentLevelData(),a=o.getExitList();l.default.changeDungeonSize(),this.dungeonStyleManager.addDecorations();for(var n=0,c=this.map;n<c.length;n++){var h=c[n];E.default.clearComponentArray(h)}this.map=new Array,this.floorIndexmap=new Array,this.addItemListOnGround(),this.addEquipmentListOnGround(),this.buildingManager.addAirExit(e);for(var p=0;p<i.WIDTH_SIZE;p++){this.map[p]=new Array(p);for(var u=0;u<i.HEIGHT_SIZE;u++){if(i.isFirstEqual(e[p][u],"*")&&"**"!=e[p][u]){var y=cc.instantiate(this.tile);y.parent=this.node,y.position=i.getPosInMap(cc.v3(p,u)),y.zIndex=g.default.BASE+10*(i.HEIGHT_SIZE-u),this.map[p][u]=y.getComponent(s.default),this.map[p][u].isAutoShow=!1,this.map[p][u].tileType=e[p][u],this.map[p][u].coverPrefix=o.floorCoverRes,this.map[p][u].floorPrefix=o.floorRes}i.isFirstEqual(e[p][u],"*")&&this.floorIndexmap.push(cc.v3(p,u)),this.buildingManager.addBuildingsFromMap(this,e[p][u],cc.v3(p,u),o,a),l.default.mapManager.isCurrentRoomStateClear()&&!l.default.mapManager.getCurrentRoomType().isEqual(f.default.TEST_ROOM)||this.itemManager.addItemFromMap(e[p][u],cc.v3(p,u)),(!l.default.mapManager.isCurrentRoomStateClear()||l.default.mapManager.getCurrentRoomType().isEqual(f.default.TEST_ROOM)||l.default.mapManager.getCurrentRoomType().isEqual(f.default.START_ROOM))&&(l.default.isTour||this.monsterManager.addMonstersAndBossFromMap(this,e[p][u],cc.v3(p,u))),this.nonPlayerManager.addNonPlayerFromMap(this,e[p][u],cc.v3(p,u))}}for(var m=0,v=[cc.v3(-1,-1,4),cc.v3(-1,0,2),cc.v3(-1,1,6),cc.v3(0,-1,0),cc.v3(0,1,1),cc.v3(1,-1,5),cc.v3(1,0,3),cc.v3(1,1,7)];m<v.length;m++){var _=v[m];this.addBuildingsFromSideMap(_)}this.player=cc.instantiate(this.playerPrefab).getComponent(r.default),this.player.node.parent=this.node,l.default.mapManager.isCurrentRoomStateClear()&&!l.default.mapManager.getCurrentRoom().isReborn||!f.default.isMonsterGenerateRoom(l.default.mapManager.getCurrentRoomType())||l.default.isTour||this.monsterManager.addRandomMonsters(this,l.default.mapManager.getCurrentRoom().reborn);var D=(new Array).concat(l.default.nonPlayerList);this.scheduleOnce(function(){t.nonPlayerManager.addNonPlayerListFromSave(t,D,t.player.node.position)},1),this.setDoors(!0,!0),cc.log("load finished"),this.scheduleOnce(function(){t.isInitFinish=!0,cc.tween(t.fog).to(.5,{scale:3}).start();var e=t.fog.getChildByName("sprite").getChildByName("blackcenter");cc.tween(e).delay(.1).to(.5,{opacity:0}).start();for(var i={},o="childrenCount:"+t.node.childrenCount+" children:\n",a=0,n=t.node.children;a<n.length;a++){var r=n[a];i[r.name]?i[r.name]++:i[r.name]=1}for(var s in i)o+=s+"("+i[s]+")\n";cc.log(o),t.addOilGoldOnGround()},.5)},e.prototype.addBuildingsFromSideMap=function(t){var e=l.default.mapManager.getCurrentSideMapStringArray(t),o=l.default.worldLoader.getCurrentLevelData();if(e[0])for(var a=0;a<i.WIDTH_SIZE;a++)for(var n=0;n<i.HEIGHT_SIZE;n++){var r=!1;switch(t.z){case 0:r=n>i.HEIGHT_SIZE-3;break;case 1:r=n<3;break;case 2:r=a>i.WIDTH_SIZE-3;break;case 3:r=a<3;break;case 4:r=a>i.WIDTH_SIZE-3&&n>i.HEIGHT_SIZE-3;break;case 5:r=a<3&&n>i.HEIGHT_SIZE-3;break;case 6:r=a>i.WIDTH_SIZE-3&&n<3;break;case 7:r=a<3&&n<3}r&&this.buildingManager.addBuildingsFromSideMap(e[a][n],cc.v3(a+i.WIDTH_SIZE*t.x,n+i.HEIGHT_SIZE*t.y),o)}},e.prototype.darkAfterKill=function(){cc.tween(this.fog).to(1,{scale:.6}).start();var t=this.fog.getChildByName("sprite").getChildByName("blackcenter");cc.tween(t).delay(.2).to(1,{opacity:255}).start()},e.isFirstEqual=function(t,e){return t[0]==e},e.prototype.addItem=function(t,e,i,o){this.itemManager&&(t||(t=this.player.node.position.clone()),this.itemManager.addItem(t,e,i,o))},e.prototype.addFallStone=function(t,e,i){this.buildingManager.addFallStone(t,e,i)},e.prototype.addLighteningFall=function(t,e,i,o,a){this.buildingManager&&this.buildingManager.addLighteningFall(t,e,i,o,a)},e.prototype.addCoin=function(t,e){this.itemManager&&this.itemManager.getValueCoin(e,t,this.node)},e.prototype.addOilGold=function(t,e){this.itemManager&&this.itemManager.getValueOilGold(e,t,this.node)},e.prototype.addEquipmentListOnGround=function(){var t=l.default.mapManager.getCurrentMapEquipments();if(t)for(var e=0,o=t;e<o.length;e++){var a=o[e];this.equipmentManager&&this.equipmentManager.getEquipment(a.img,i.getPosInMap(a.pos),this.node,a,null,null).data}},e.prototype.addItemListOnGround=function(){var t=l.default.mapManager.getCurrentMapItems();if(l.default.mapManager.setCurrentItemsArr(new Array),t)for(var e=0,o=t;e<o.length;e++){var a=o[e];a.isTaken||this.addItem(i.getPosInMap(a.pos),a.resName,a.count)}},e.prototype.addOilGoldOnGround=function(){this.scheduleOnce(function(){var t=l.default.groundOilGoldData.clone();t.chapter==l.default.chapterIndex&&t.level==l.default.level&&t.x==l.default.mapManager.rectDungeon.currentPos.x&&t.y==l.default.mapManager.rectDungeon.currentPos.y&&t.value>0&&(c.EventHelper.emit(c.EventHelper.HUD_ADD_OILGOLD,{count:t.value}),l.default.saveGroundOilGold(0),cc.director.emit(c.EventHelper.HUD_OILGOLD_RECOVERY_SHOW))},1)},e.prototype.addEquipment=function(t,e,i,o,a){if(this.equipmentManager){e||(e=this.player.node.position.clone());var n=this.equipmentManager.getEquipment(t,e,this.node,i,o,a).data;if(a)return;var r=l.default.mapManager.getCurrentMapEquipments();r?r.push(n):((r=new Array).push(n),l.default.mapManager.setCurrentEquipmentsArr(r))}},e.prototype.addBossSlime=function(t,e){this.monsterManager&&this.monsterManager.addBossSlime(t,e,this)},e.prototype.shakeForKraken=function(){var t=this;this.CameraZoom=.7,this.needZoomIn=!0,this.anim.playAdditive("DungeonShakeOnce"),this.scheduleOnce(function(){t.anim.playAdditive("DungeonShakeOnce")},1),this.scheduleOnce(function(){t.anim.playAdditive("DungeonShakeOnce")},2)},e.getPosInMap=function(t){var e=i.MAPX+t.x*i.TILE_SIZE,o=i.MAPY+t.y*i.TILE_SIZE;return cc.v3(e,o)},e.getIndexInMap=function(t,e){var o=(t.x-i.MAPX)/i.TILE_SIZE,a=(t.y-i.MAPY)/i.TILE_SIZE;return o=Math.round(o),a=Math.round(a),e||(o<0&&(o=0),o>=i.WIDTH_SIZE&&(o=i.WIDTH_SIZE-1),a<0&&(a=0),a>=i.HEIGHT_SIZE&&(a=i.HEIGHT_SIZE-1)),cc.v3(o,a)},e.fixOuterMap=function(t){var e=(t.x-i.MAPX)/i.TILE_SIZE,o=(t.y-i.MAPY)/i.TILE_SIZE;e=Math.round(e),o=Math.round(o);var a=!1;return e<0&&(e=0,a=!0),e>=i.WIDTH_SIZE&&(e=i.WIDTH_SIZE-1,a=!0),o<0&&(o=0,a=!0),o>=i.HEIGHT_SIZE&&(o=i.HEIGHT_SIZE-1,a=!0),a?i.getPosInMap(cc.v3(e,o)):t},e.prototype.start=function(){var t=this;this.scheduleOnce(function(){cc.director.emit(c.EventHelper.CHANGE_MINIMAP,{detail:{x:t.currentPos.x,y:t.currentPos.y}}),t.checkRoomClear()},.1)},e.prototype.breakTile=function(t){var e=this.map[t.x][t.y];e&&!e.isBroken&&e.breakTile()},e.prototype.playerAction=function(t,e,i){this.player&&this.player.playerAction(t,e,i,this)},e.prototype.getMonsterAliveNum=function(){for(var t=0,e=0,i=this.monsterManager.monsterList;e<i.length;e++){var o=i[e];(o.sc.isDied||o.data.isTest>0)&&t++}return this.monsterManager.monsterList.length-t},e.prototype.checkRoomClear=function(){var t=this.getMonsterAliveNum();if(this.isClear=t<=0,t<=0&&this.monsterManager.bossList.length>0){for(var e=0,i=this.monsterManager.bossList;e<i.length;e++)i[e].sc.isDied&&t++;this.isClear=t>=this.monsterManager.bossList.length}for(var o=0,a=this.buildingManager.footboards;o<a.length;o++){var n=a[o];n.isOpen||n.hasActive||(this.isClear=!1)}for(var r=0,s=this.buildingManager.monsterGeneratorList;r<s.length;r++)s[r].addFinish||(this.isClear=!1);l.default.mapManager.getCurrentRoomType().isEqual(f.default.TEST_ROOM)&&(this.isClear=!0),this.setDoors(this.isClear),this.isClear&&(this.monsterManager.isRoomInitWithEnemy&&l.default.mapManager.getCurrentRoomType().isNotEqual(f.default.TEST_ROOM)&&cc.director.emit(c.EventHelper.HUD_COMPLETE_SHOW),this.buildingManager.savePointS&&this.buildingManager.savePointS.open(),l.default.mapManager.setRoomClear(this.currentPos.x,this.currentPos.y))},e.prototype.setDoors=function(t,e){this.buildingManager&&this.buildingManager.setDoors(t,e)},e.prototype.checkPlayerPos=function(t){if(this.map&&this.player&&this.node){this.fog.setPosition(this.lerp(this.fog.position,this.player.node.position,3*t));var e=i.getIndexInMap(this.player.node.position);if(this.map[e.x]&&this.map[e.x][e.y]){var o=this.map[e.x][e.y];o&&o.isBroken&&this.player.fall(),o&&o.isAutoShow&&this.breakTile(e)}}},e.prototype.lerp=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},e.prototype.checkMonstersPos=function(){for(var t=0,e=this.monsterManager.monsterList;t<e.length;t++)if(e[t].sc.isDied)return},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isInitFinish&&!l.default.isGamePause&&(this.isTimeDelay(t)&&(this.checkPlayerPos(t),this.monsterManager.updateLogic(t),this.nonPlayerManager.updateLogic(t),this.buildingManager.updateLogic(t,this.player),this.equipmentManager.updateLogic(t,this.player),this.itemManager.updateLogic(t,this.player)),this.isCheckTimeDelay(t)&&this.checkRoomClear())},e.WIDTH_SIZE=7,e.HEIGHT_SIZE=7,e.MAPX=64,e.MAPY=64,e.TILE_SIZE=128,n([R(cc.Prefab)],e.prototype,"tile",void 0),n([R(cc.Prefab)],e.prototype,"playerPrefab",void 0),n([R(cc.Node)],e.prototype,"fog",void 0),i=n([S],e)}(cc.Component);i.default=T,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic","./Manager/BuildingManager":"BuildingManager","./Manager/DungeonStyleManager":"DungeonStyleManager","./Manager/EquipmentManager":"EquipmentManager","./Manager/ItemManager":"ItemManager","./Manager/LightManager":"LightManager","./Manager/MonsterManager":"MonsterManager","./Manager/NonPlayerManager":"NonPlayerManager","./Player":"Player","./Rect/RoomType":"RoomType","./Tile":"Tile","./Utils/AudioPlayer":"AudioPlayer","./Utils/IndexZ":"IndexZ","./Utils/Utils":"Utils"}],Emplacement:[function(t,e,i){"use strict";cc._RF.push(e,"78b9bpQ7+BAGrpzYzxR/1mq","Emplacement");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Shooter"),l=t("../Logic"),c=t("./Building"),h=t("../Data/FromData"),p=t("../Utils/IndexZ"),u=cc._decorator,d=u.ccclass,f=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shooterTop=null,e.shooterBottom=null,e.shooterLeft=null,e.shooterRight=null,e.isOpen=!1,e.pos=cc.v3(0,0),e.timeDelay=0,e.dirType=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.setShooterHv(this.shooterTop,cc.v3(0,1)),this.setShooterHv(this.shooterBottom,cc.v3(0,-1)),this.setShooterHv(this.shooterLeft,cc.v3(-1,0)),this.setShooterHv(this.shooterRight,cc.v3(1,0));var t=h.default.getClone("\u70ae\u53f0","emplacement");this.shooterTop.from.valueCopy(t),this.shooterBottom.from.valueCopy(t),this.shooterLeft.from.valueCopy(t),this.shooterRight.from.valueCopy(t)},e.prototype.setDirType=function(t){switch(t){case"G0":this.dirType=i.ALL;break;case"G1":this.dirType=i.TOP;break;case"G2":this.dirType=i.BOTTOM;break;case"G3":this.dirType=i.LEFT;break;case"G4":this.dirType=i.RIGHT;break;case"G5":this.dirType=i.TOPBOTTOM;break;case"G6":this.dirType=i.TOPLEFT;break;case"G7":this.dirType=i.TOPRIGHT;break;case"G8":this.dirType=i.BOTTOMLEFT;break;case"G9":this.dirType=i.BOTTOMRIGHT;break;case"Ga":this.dirType=i.LEFTRIGHT}},e.prototype.start=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.scheduleOnce(function(){t.fire()},1)},e.prototype.setPos=function(t){this.pos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=p.default.getActorZIndex(this.node.position)},e.prototype.OpenFire=function(){if(this.dungeon)switch(this.dirType){case i.ALL:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight);break;case i.TOP:this.fireShooter(this.shooterTop);break;case i.BOTTOM:this.fireShooter(this.shooterBottom);break;case i.LEFT:this.fireShooter(this.shooterLeft);break;case i.RIGHT:this.fireShooter(this.shooterRight);break;case i.TOPBOTTOM:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom);break;case i.TOPLEFT:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterLeft);break;case i.TOPRIGHT:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterRight);break;case i.BOTTOMLEFT:this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft);break;case i.BOTTOMRIGHT:this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterRight);break;case i.LEFTRIGHT:this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight);break;default:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight)}},e.prototype.fire=function(){this.anim&&this.anim.play()},e.prototype.fireShooter=function(t){if(!t.dungeon)switch(t.dungeon=this.dungeon,t.data.bulletType="bullet010",t.data.bulletLineExNum=0,l.default.chapterIndex){case l.default.CHAPTER00:t.data.bulletLineExNum=3,t.data.bulletType="laser001";break;case l.default.CHAPTER01:t.data.bulletType="bullet010";break;case l.default.CHAPTER02:t.data.bulletType="bullet013";break;case l.default.CHAPTER03:t.data.bulletType="bullet006",t.data.bulletLineExNum=1;break;case l.default.CHAPTER04:case l.default.CHAPTER05:t.data.bulletType="bullet024",t.data.bulletLineExNum=1;break;case l.default.CHAPTER099:t.data.bulletType="bullet010"}t.fireBullet()},e.prototype.setShooterHv=function(t,e){t.setHv(e)},e.prototype.update=function(t){l.default.isGamePause||(this.timeDelay+=t,this.timeDelay>3&&(this.timeDelay=0,this.fire()))},e.ALL=0,e.TOP=1,e.BOTTOM=2,e.LEFT=3,e.RIGHT=4,e.TOPBOTTOM=5,e.TOPLEFT=6,e.TOPRIGHT=7,e.BOTTOMLEFT=8,e.BOTTOMRIGHT=9,e.LEFTRIGHT=10,n([f(s.default)],e.prototype,"shooterTop",void 0),n([f(s.default)],e.prototype,"shooterBottom",void 0),n([f(s.default)],e.prototype,"shooterLeft",void 0),n([f(s.default)],e.prototype,"shooterRight",void 0),i=n([d],e)}(c.default);i.default=g,cc._RF.pop()},{"../Data/FromData":"FromData","../Dungeon":"Dungeon","../Logic":"Logic","../Shooter":"Shooter","../Utils/IndexZ":"IndexZ","./Building":"Building"}],EnergyShield:[function(t,e,i){"use strict";cc._RF.push(e,"b7ba1woN/lIqoplh/wf+2rX","EnergyShield");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Utils/AudioPlayer"),s=t("../Utils/IndexZ"),l=t("./Building"),c=cc._decorator,h=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.cover=this.node.getChildByName("sprite").getChildByName("cover"),this.element=this.node.getChildByName("sprite").getChildByName("cover").getChildByName("element"),this.anim=this.getComponent(cc.Animation),this.collider=this.getComponent(cc.BoxCollider)},e.prototype.init=function(t,e,i){this.player=t,this.data.currentHealth=e,this.data.maxHealth=e,this.node.scale=i,this.anim=this.getComponent(cc.Animation),this.node.zIndex=s.default.getActorZIndex(cc.v3(this.node.position.x,this.node.position.y-8*i));var o=this.node.getChildByName("base");o.parent=this.node.parent,o.position=this.node.position,cc.tween(o).to(1,{scale:i,opacity:255}).start(),o.zIndex=s.default.FLOOR},e.prototype.hitLight=function(t){this.mat||(this.mat=this.node.getChildByName("sprite").getChildByName("cover").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT)},e.prototype.ShowFinish=function(){this.isShow=!0,this.changeIdle()},e.prototype.changeIdle=function(){this.isShow&&(this.checkTargetIn(this.player.node)?this.anim.getAnimationState("EnergyShieldIdle").isPlaying||this.anim.play("EnergyShieldIdle"):this.anim.getAnimationState("EnergyShieldIdle1").isPlaying||this.anim.play("EnergyShieldIdle1"))},e.prototype.checkTargetIn=function(t){var e=this.node.position.x-this.collider.size.width/2*this.node.scale,i=this.node.position.y-(this.collider.size.width/2-this.collider.offset.y)*this.node.scale,o=this.collider.size.width*this.node.scale,a=this.collider.size.height*this.node.scale;return cc.rect(e,i,o,a).contains(cc.v2(t.position.x,t.position.y))},e.prototype.takeDamage=function(t){var e=this;return!(!this.isShow||this.data.currentHealth<=0||(r.default.play(r.default.BOSS_ICEDEMON_HIT),this.hitLight(!0),this.scheduleOnce(function(){e.hitLight(!1)},.15),this.data.currentHealth-=t.getTotalDamage(),this.changeColor(),this.data.currentHealth<=0&&(this.data.currentHealth=0,this.isShow=!1,this.node.active=!1,this.scheduleOnce(function(){e.node.destroy()},1)),0))},e.prototype.changeColor=function(){var t=Math.floor(255*this.data.currentHealth/this.data.maxHealth);t<0?t=0:t>255&&(t=255),this.cover.color=cc.color(255,t,t),this.element.color=cc.color(255,t,t)},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.changeIdle()},n([h],e)}(l.default));i.default=p,cc._RF.pop()},{"../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],EquipmentData:[function(t,e,i){"use strict";cc._RF.push(e,"a5970exQi1ISK2QZd4VAwv9","EquipmentData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./CommonData"),r=function(t){function e(){var e=t.call(this)||this;return e.uuid="",e.pos=cc.v3(0,0),e.nameCn="",e.nameEn="",e.equipmetType="empty",e.equipmetTypeCn="",e.prefix="",e.desc="",e.color="#ffffff",e.lightcolor="#ffffff",e.titlecolor="#ffffff",e.img="emptyequipment",e.level=0,e.stab=0,e.far=0,e.blunt=0,e.isLocked=0,e.isReflect=0,e.trouserslong=0,e.bulletType="",e.bulletSize=0,e.bulletArcExNum=0,e.bulletLineExNum=0,e.bulletLineInterval=0,e.bulletNets=0,e.showShooter=0,e.isHeavy=0,e.isLineAim=0,e.hideHair=0,e.bulletExSpeed=0,e.statusName="",e.statusInterval=0,e.statusNameParrySelf="",e.statusNameParryOther="",e.statusRateParry=0,e.statusNameBlockSelf="",e.statusNameBlockOther="",e.statusRateBlock=0,e.statusNameHurtSelf="",e.statusNameHurtOther="",e.statusRateHurt=0,e.exBulletTypeAttack="",e.exBulletTypeHurt="",e.exBulletTypeParry="",e.exBulletTypeBlock="",e.exBulletRate=0,e.exBulletCombo1=0,e.exBulletCombo2=0,e.exBulletCombo3=0,e.exBulletOffsetX=0,e.ignoreTrap=0,e.remoteAudio="",e.exBeatBack=0,e.price=0,e.info1="",e.info2="",e.info3="",e.extraInfo="",e.suitType="",e.suit1="",e.suit2="",e.suit3="",e.infobase="",e.infocolor1="#ffffff",e.infocolor2="#ffffff",e.infocolor3="#ffffff",e.suitcolor1="#ffffff",e.suitcolor2="#ffffff",e.suitcolor3="#ffffff",e.infobasecolor="#ffffff",e.common=new n.default,e}return a(e,t),Object.defineProperty(e.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),e.prototype.valueCopy=function(t){t&&(this.uuid=t.uuid?t.uuid:"",this.pos=t.pos?cc.v3(t.pos.x,t.pos.y):cc.v3(0,0),this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:"",this.nameEn=t.nameEn?t.nameEn:"",this.equipmetType=t.equipmetType?t.equipmetType:"",this.equipmetTypeCn=t.equipmetTypeCn?t.equipmetTypeCn:"",this.prefix=t.prefix?t.prefix:"",this.desc=t.desc?t.desc:"",this.color=t.color?t.color:"#ffffff",this.titlecolor=t.titlecolor?t.titlecolor:"#ffffff",this.lightcolor=t.lightcolor?t.lightcolor:"#ffffff",this.img=t.img?t.img:"emptyequipment",this.stab=t.stab?t.stab:0,this.far=t.far?t.far:0,this.blunt=t.blunt?t.blunt:0,this.isLocked=t.isLocked?t.isLocked:0,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.bulletNets=t.bulletNets?t.bulletNets:0,this.level=t.level?t.level:0,this.trouserslong=t.trouserslong?t.trouserslong:0,this.showShooter=t.showShooter?t.showShooter:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.bulletType=t.bulletType?t.bulletType:"",this.exBulletTypeAttack=t.exBulletTypeAttack?t.exBulletTypeAttack:"",this.exBulletTypeHurt=t.exBulletTypeHurt?t.exBulletTypeHurt:"",this.exBulletTypeParry=t.exBulletTypeParry?t.exBulletTypeParry:"",this.exBulletTypeBlock=t.exBulletTypeBlock?t.exBulletTypeBlock:"",this.isLineAim=t.isLineAim?t.isLineAim:0,this.hideHair=t.hideHair?t.hideHair:0,this.bulletSize=t.bulletSize?t.bulletSize:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0,this.statusName=t.statusName?t.statusName:"",this.statusNameParryOther=t.statusNameParryOther?t.statusNameParryOther:"",this.statusNameParrySelf=t.statusNameParrySelf?t.statusNameParrySelf:"",this.statusRateParry=t.statusRateParry?t.statusRateParry:0,this.statusNameBlockOther=t.statusNameBlockOther?t.statusNameBlockOther:"",this.statusNameBlockSelf=t.statusNameBlockSelf?t.statusNameBlockSelf:"",this.statusNameHurtSelf=t.statusNameHurtSelf?t.statusNameHurtSelf:"",this.statusNameHurtOther=t.statusNameHurtOther?t.statusNameHurtOther:"",this.statusRateHurt=t.statusRateHurt?t.statusRateHurt:0,this.statusRateBlock=t.statusRateBlock?t.statusRateBlock:0,this.statusInterval=t.statusInterval?t.statusInterval:0,this.isReflect=t.isReflect?t.isReflect:0,this.exBulletRate=t.exBulletRate?t.exBulletRate:0,this.exBulletCombo1=t.exBulletCombo1?t.exBulletCombo1:0,this.exBulletCombo2=t.exBulletCombo2?t.exBulletCombo2:0,this.exBulletCombo3=t.exBulletCombo3?t.exBulletCombo3:0,this.exBulletOffsetX=t.exBulletOffsetX?t.exBulletOffsetX:0,this.ignoreTrap=t.ignoreTrap?t.ignoreTrap:0,this.price=t.price?t.price:0,this.info1=t.info1?t.info1:"",this.info2=t.info2?t.info2:"",this.info3=t.info3?t.info3:"",this.extraInfo=t.extraInfo?t.extraInfo:"",this.suit1=t.suit1?t.suit1:"",this.suit2=t.suit2?t.suit2:"",this.suit3=t.suit3?t.suit3:"",this.suitType=t.suitType?t.suitType:"",this.infobase=t.infobase?t.infobase:"",this.infocolor1=t.infocolor1?t.infocolor1:"#ffffff",this.infocolor2=t.infocolor2?t.infocolor2:"#ffffff",this.infocolor3=t.infocolor3?t.infocolor3:"#ffffff",this.suitcolor1=t.suitcolor1?t.suitcolor1:"#ffffff",this.suitcolor2=t.suitcolor2?t.suitcolor2:"#ffffff",this.suitcolor3=t.suitcolor3?t.suitcolor3:"#ffffff",this.infobasecolor=t.infobasecolor?t.infobasecolor:"#ffffff",this.remoteAudio=t.remoteAudio?t.remoteAudio:"",this.exBeatBack=t.exBeatBack?t.exBeatBack:0)},e.prototype.clone=function(){var t=new e;return t.uuid=this.uuid,t.pos=this.pos,t.common=this.common.clone(),t.nameCn=this.nameCn,t.nameEn=this.nameEn,t.equipmetType=this.equipmetType,t.equipmetTypeCn=this.equipmetTypeCn,t.prefix=this.prefix,t.desc=this.desc,t.color=this.color,t.titlecolor=this.titlecolor,t.lightcolor=this.lightcolor,t.img=this.img,t.stab=this.stab,t.far=this.far,t.blunt=this.blunt,t.isLocked=this.isLocked,t.level=this.level,t.trouserslong=this.trouserslong,t.showShooter=this.showShooter,t.bulletType=this.bulletType,t.exBulletTypeAttack=this.exBulletTypeAttack,t.exBulletTypeHurt=this.exBulletTypeHurt,t.exBulletTypeParry=this.exBulletTypeParry,t.exBulletTypeBlock=this.exBulletTypeBlock,t.isHeavy=this.isHeavy,t.isLineAim=this.isLineAim,t.bulletArcExNum=this.bulletArcExNum,t.bulletLineExNum=this.bulletLineExNum,t.bulletLineInterval=this.bulletLineInterval,t.bulletNets=this.bulletNets,t.hideHair=this.hideHair,t.bulletSize=this.bulletSize,t.bulletExSpeed=this.bulletExSpeed,t.isReflect=this.isReflect,t.statusName=this.statusName,t.statusInterval=this.statusInterval,t.statusNameBlockOther=this.statusNameBlockOther,t.statusNameBlockSelf=this.statusNameBlockSelf,t.statusRateBlock=this.statusRateBlock,t.statusRateParry=this.statusRateParry,t.statusNameParryOther=this.statusNameParryOther,t.statusNameParrySelf=this.statusNameParrySelf,t.statusNameHurtSelf=this.statusNameHurtSelf,t.statusNameHurtOther=this.statusNameHurtOther,t.statusRateHurt=this.statusRateHurt,t.exBulletRate=this.exBulletRate,t.exBulletCombo1=this.exBulletCombo1,t.exBulletCombo2=this.exBulletCombo2,t.exBulletCombo3=this.exBulletCombo3,t.exBulletOffsetX=this.exBulletOffsetX,t.ignoreTrap=this.ignoreTrap,t.suitType=this.suitType,t.price=this.price,t.info1=this.info1,t.info2=this.info2,t.info3=this.info3,t.extraInfo=this.extraInfo,t.suit1=this.suit1,t.suit2=this.suit2,t.suit3=this.suit3,t.infobase=this.infobase,t.infocolor1=this.infocolor1,t.infocolor2=this.infocolor2,t.infocolor3=this.infocolor3,t.suitcolor1=this.suitcolor1,t.suitcolor2=this.suitcolor2,t.suitcolor3=this.suitcolor3,t.infobasecolor=this.infobasecolor,t.remoteAudio=this.remoteAudio,t.exBeatBack=this.exBeatBack,t},e.prototype.add=function(t){return this.common=this.common.clone().add(t.Common),this.ignoreTrap=this.ignoreTrap+t.ignoreTrap,this.exBeatBack=this.exBeatBack+t.exBeatBack,this},e}(t("./BaseData").default);i.default=r,cc._RF.pop()},{"./BaseData":"BaseData","./CommonData":"CommonData"}],EquipmentDescData:[function(t,e,i){"use strict";cc._RF.push(e,"d7742jFusdGiIE+18obcC2k","EquipmentDescData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./CommonData");i.default=function(){this.nameCn="",this.nameEn="",this.titlecolor="#ffffff",this.color="#ffffff",this.prefix="",this.level=0,this.common=new o.default,this.info1="",this.info2="",this.info3="",this.suit1="",this.suit2="",this.suit3="",this.infobase="",this.infocolor1="#ffffff",this.infocolor2="#ffffff",this.infocolor3="#ffffff",this.suitcolor1="#ffffff",this.suitcolor2="#ffffff",this.suitcolor3="#ffffff",this.infobasecolor="#ffffff"},cc._RF.pop()},{"./CommonData":"CommonData"}],EquipmentDialog:[function(t,e,i){"use strict";cc._RF.push(e,"9bf82hBG9BGv4V/KYPwSFw+","EquipmentDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTile=null,e.infoBase=null,e.info1=null,e.info2=null,e.info3=null,e.extraInfo=null,e.infoSuit1=null,e.infoSuit2=null,e.infoSuit3=null,e.infoDesc=null,e.isInventory=!1,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.opacity=0},e.prototype.refreshDialog=function(t){this.infoBase.node.active=!0,this.info1.node.active=!0,this.info2.node.active=!0,this.info3.node.active=!0,this.extraInfo.node.active=!0,this.infoSuit1.node.active=!0,this.infoSuit2.node.active=!0,this.infoSuit3.node.active=!0,this.labelTile.string=t.prefix+t.nameCn,this.labelTile.node.color=this.labelTile.node.color.fromHEX(t.titlecolor),this.infoBase.string="\u4ef7\u683c\uff1a"+t.price+"\n"+t.infobase,this.infoBase.node.color=this.infoBase.node.color.fromHEX(t.infobasecolor),this.info1.string=t.info1,this.info1.node.color=this.info1.node.color.fromHEX(t.infocolor1),this.info2.string=t.info2,this.info2.node.color=this.info2.node.color.fromHEX(t.infocolor2),this.info3.string=t.info3,this.info3.node.color=this.info3.node.color.fromHEX(t.infocolor3),this.extraInfo.string=t.extraInfo,this.infoSuit1.string=t.suit1,this.infoSuit2.string=t.suit2,this.infoSuit3.string=t.suit3,this.infoSuit1.node.color=this.infoSuit1.node.color.fromHEX(t.suitcolor1),this.infoSuit2.node.color=this.infoSuit2.node.color.fromHEX(t.suitcolor2),this.infoSuit3.node.color=this.infoSuit3.node.color.fromHEX(t.suitcolor3),this.infoDesc.string=t.desc,this.infoBase.node.active=this.infoBase.string.length>0,this.info1.node.active=this.info1.string.length>0,this.info2.node.active=this.info2.string.length>0,this.info3.node.active=this.info3.string.length>0,this.extraInfo.node.active=this.extraInfo.string.length>0,this.infoSuit1.node.active=this.infoSuit1.string.length>0,this.infoSuit2.node.active=this.infoSuit2.string.length>0,this.infoSuit3.node.active=this.infoSuit3.string.length>0},e.prototype.showDialog=function(t,e){if(this.refreshDialog(t),this.node.opacity=255,e){var i=0;t.suitType.length>0&&e.suitMap[t.suitType]&&(i=e.suitMap[t.suitType].count),this.infoSuit1.node.opacity=i>1?255:50,this.infoSuit2.node.opacity=i>2?255:50,this.infoSuit3.node.opacity=i>3?255:50}},e.prototype.hideDialog=function(){this.node.opacity=0},n([l(cc.Label)],e.prototype,"labelTile",void 0),n([l(cc.Label)],e.prototype,"infoBase",void 0),n([l(cc.Label)],e.prototype,"info1",void 0),n([l(cc.Label)],e.prototype,"info2",void 0),n([l(cc.Label)],e.prototype,"info3",void 0),n([l(cc.Label)],e.prototype,"extraInfo",void 0),n([l(cc.Label)],e.prototype,"infoSuit1",void 0),n([l(cc.Label)],e.prototype,"infoSuit2",void 0),n([l(cc.Label)],e.prototype,"infoSuit3",void 0),n([l(cc.Label)],e.prototype,"infoDesc",void 0),n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],EquipmentManager:[function(t,e,i){"use strict";cc._RF.push(e,"29c053rRnlLqrw1VkMXkISC","EquipmentManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("../Data/EquipmentData"),c=t("../Data/EquipmentDescData"),h=t("../Equipment/Equipment"),p=t("../Utils/IndexZ"),u=t("./BaseManager"),d=t("../EventHelper"),f=t("./InventoryManager"),g=t("../Data/SuitData"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipment=null,e.groundList=[],e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.clear=function(){this.groundList=[]},e.getRandomDesc=function(t,e){var o=new c.default,a=0,n=s.default.mapManager.getCurrentRoomRandom4Save(),r=cc.v3(0,0);if(i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.HELMET,f.default.GLOVES,f.default.CLOAK,f.default.REMOTE])&&t.Common.criticalStrikeRate>0){var l=20-t.Common.criticalStrikeRate;l<5&&(l=5),a=(r=i.getRandomQuality(0,l,e,n)).y>a?r.y:a,o.prefix+=r.y>2?"\u66b4\u51fb":"",o.color=i.getMixColor("#000000",r.y>2?i.COLOR_CRITICALSTRIKE:"#000000")}var h=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.GLOVES,f.default.CLOTHES,f.default.REMOTE])&&t.Common.damageMin>0&&(a=(h=i.getRandomQuality(0,i.getRandomRange(),e,n)).y>a?h.y:a);var p=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.GLOVES,f.default.REMOTE])&&t.Common.remoteDamage>0&&(a=(p=n.rand()<.2?i.getRandomQuality(0,i.getRandomRange(),e,n):cc.v3(0,0)).y>a?p.y:a);var u=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.GLOVES,f.default.CLOTHES,f.default.REMOTE])&&t.Common.damageMax>0&&(a=(u=i.getRandomQuality(h.x,h.x+i.getRandomRange(),e,n)).y>a?u.y:a,o.prefix+=u.y>2?"\u5f3a\u529b":"",o.color=i.getMixColor(o.color,u.y>2?i.COLOR_POWERFUL:"#000000"));var d=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.HELMET,f.default.GLOVES,f.default.CLOAK,f.default.TROUSERS,f.default.SHOES,f.default.SHIELD,f.default.CLOTHES])&&t.Common.defence>0&&(a=(d=i.getRandomQuality(0,i.getRandomRange(),e,n)).y>a?d.y:a,o.prefix+=d.y>2?"\u575a\u56fa":"",o.color=i.getMixColor(o.color,d.y>5?i.COLOR_STABLE:"#000000"));var g=cc.v3(0,0);if(i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.HELMET,f.default.GLOVES,f.default.REMOTE])&&t.Common.lifeDrain>0){var y=50-t.Common.lifeDrain;y<5&&(y=5),a=(g=i.getRandomQuality(0,y,e,n)).y>a?g.y:a,o.prefix+=g.y>2?"\u90aa\u6076":"",o.color=i.getMixColor(o.color,g.y>2?i.COLOR_LIFEDRAIN:"#000000")}var m=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.GLOVES,f.default.CLOTHES,f.default.REMOTE])&&t.Common.damageBack>0&&(a=(m=i.getRandomQuality(0,i.getRandomRange(),e,n)).y>a?m.y:a,o.prefix+=m.y>2?"\u9634\u51b7":"",o.color=i.getMixColor(o.color,m.y>2?i.COLOR_BACK:"#000000"));var v=cc.v3(0,0);if(i.isTheEquipType(t.equipmetType,[f.default.CLOAK,f.default.TROUSERS,f.default.SHOES,f.default.CLOTHES])&&t.Common.moveSpeed>0){var E=80-t.Common.moveSpeed;E<10&&(E=10),a=(v=i.getRandomQuality(0,E,e,n)).y>a?v.y:a,o.prefix+=v.y>2?"\u7075\u52a8":"",o.color=i.getMixColor(o.color,v.y>2?i.COLOR_MOVESPEED:"#000000")}var _=cc.v3(0,0);if(i.isTheEquipType(t.equipmetType,[f.default.WEAPON,f.default.GLOVES,f.default.CLOTHES,f.default.REMOTE])&&t.Common.attackSpeed>0){var D=30-t.Common.attackSpeed;D<5&&(D=5),a=(_=i.getRandomQuality(0,D,e,n)).y>a?_.y:a,o.prefix+=_.y>2?"\u8fc5\u6377":"",o.color=i.getMixColor(o.color,_.y>2?i.COLOR_ATTACKSPPED:"#000000")}var S=cc.v3(0,0);if(i.isTheEquipType(t.equipmetType,[f.default.HELMET,f.default.CLOAK,f.default.TROUSERS,f.default.SHOES,f.default.CLOTHES])&&t.Common.dodge>0){var R=30-t.Common.dodge;R<10&&(R=10),a=(S=i.getRandomQuality(0,R,e,n)).y>a?S.y:a,o.prefix+=S.y>2?"\u98d8\u9038":"",o.color=i.getMixColor(o.color,S.y>2?i.COLOR_DODGE:"#000000")}var T=cc.v3(0,0);i.isTheEquipType(t.equipmetType,[f.default.HELMET,f.default.GLOVES,f.default.CLOAK,f.default.TROUSERS,f.default.SHIELD,f.default.SHOES,f.default.CLOTHES])&&t.Common.maxHealth>0&&(a=(T=i.getRandomQuality(0,i.getRandomRange(),e,n)).y>a?T.y:a,o.prefix+=T.y>2?"\u5065\u5eb7":"",o.color=i.getMixColor(o.color,T.y>2?i.COLOR_HEALTHY:"#000000"));var O=cc.v3(0,0);t.Common.maxDream>0&&(a=(O=i.getRandomQuality(0,i.getRandomRange(),e,n)).y>a?O.y:a,o.prefix+=O.y>2?"\u68a6\u5e7b":"",o.color=i.getMixColor(o.color,O.y>2?i.COLOR_DREAM:"#000000"));var C=i.getRandomRange();if(i.isTheEquipType(t.equipmetType,[f.default.GLOVES,f.default.REMOTE,f.default.WEAPON])){var A=n.rand()<.1?i.getRandomQuality(0,C,e,n):cc.v3(0,0);a=A.y>a?A.y:a,o.prefix+=A.y>C/2?"\u950b\u5229":"";var L=n.rand()<.1?i.getRandomQuality(0,C,e,n):cc.v3(0,0);a=L.y>a?L.y:a,o.prefix+=L.y>C/2?"\u795e\u79d8":"",o.common.realDamage=A.x,o.common.magicDamage=L.x}var P=n.rand()<.1?i.getRandomQuality(30,60,e,n):cc.v3(0,0);a=P.y>a?P.y:a;var b=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);a=b.y>a?b.y:a;var I=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);a=I.y>a?I.y:a,o.prefix+=I.y>30?"\u5bd2\u51b7":"";var M=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);a=M.y>a?M.y:a,o.prefix+=M.y>30?"\u708e\u70ed":"";var N=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);a=N.y>a?N.y:a,o.prefix+=N.y>30?"\u95ea\u7535":"";var x=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);a=x.y>a?x.y:a,o.prefix+=x.y>30?"\u5267\u6bd2":"";var H=n.rand()<.05?i.getRandomQuality(10,60,e,n):cc.v3(0,0);return a=H.y>a?H.y:a,o.prefix+=H.y>30?"\u8bc5\u5492":"",o.prefix=["","\u666e\u901a\u7684","\u7cbe\u826f\u7684","\u4f18\u79c0\u7684","\u53f2\u8bd7\u7684","\u4f20\u8bf4\u7684"][a]+o.prefix,o.titlecolor=["#dcdcdc","#ffffff","#00ff00","#0000ff","#800080","#ffa500"][a],o.level=a,o.color="#000000"==o.color?"#ffffff":o.color,o.common.criticalStrikeRate=r.x,o.common.damageMin=h.x,o.common.damageMax=u.x,o.common.defence=d.x,o.common.lifeDrain=g.x,o.common.damageBack=m.x,o.common.moveSpeed=v.x,o.common.attackSpeed=_.x,o.common.dodge=S.x,o.common.maxHealth=T.x,o.common.magicDefence=P.x,o.common.realRate=b.x,o.common.iceRate=I.x,o.common.fireRate=M.x,o.common.lighteningRate=N.x,o.common.toxicRate=x.x,o.common.curseRate=H.x,o.common.maxDream=O.x,o},e.getRandomRange=function(){return 5+s.default.chapterMaxIndex+Math.floor(s.default.playerData.OilGoldData.level/5)},e.isTheEquipType=function(t,e){for(var i=!1,o=0,a=e;o<a.length;o++)a[o]==t&&(i=!0);return i},e.getRandomQuality=function(t,e,i,o){var a=(e-t)/5,n=o.rand();if(i&&i>0)switch(i){case 1:n=o.rand()>.5?.06:n;break;case 2:n=o.rand()>.5?.08:n;break;case 3:n=o.rand()>.5?.086:n;break;case 4:n=o.rand()>.5?.09:n}var r=cc.v3(0,0);return n<.05?(r.x=o.getRandomNum(0,a),a>5&&r.x<5&&(r.x=5),r.y=1):n>=.05&&n<.075?(r.x=o.getRandomNum(a,2*a),r.y=2):n>=.075&&n<.085?(r.x=o.getRandomNum(2*a,3*a),r.y=3):n>=.085&&n<.09?(r.x=o.getRandomNum(3*a,4*a),r.y=4):n>=.09&&n<.091&&(r.x=o.getRandomNum(4*a,5*a),r.y=5),r.x=parseFloat(r.x.toFixed(0)),r},e.prototype.getEquipment=function(t,e,o,a,n,s){var l=cc.instantiate(this.equipment);l.parent=o,l.position=e,l.zIndex=p.default.OVERHEAD;var c=l.getComponent(h.default);if(c.pos=r.default.getIndexInMap(e),a)s&&(c.shopTable=s,a.price=30*(a.level+1),s.data.equipdata=a.clone()),c.refresh(a);else{var u=i.getNewEquipData(t,n);s&&(c.shopTable=s,s.data.equipdata=u.clone(),s.data.price=u.price),c.refresh(u)}return this.groundList.push(c),c},e.getNewEquipData=function(t,e){if(0!=t.length){var o=new l.default;o.valueCopy(s.default.equipments[t]),o.uuid=o.genNonDuplicateID();var a=i.getRandomDesc(o,e),n=o.Common.clone().add(a.common);return o.infobase=i.getEquipmentInfoBase(n),o.info1=i.getEquipmentInfo1(n),o.info2=i.getEquipmentInfo2(n,o),o.info3=i.getEquipmentInfo3(n),o.suit1=i.getSuitDesc(o.suitType,0),o.suit2=i.getSuitDesc(o.suitType,1),o.suit3=i.getSuitDesc(o.suitType,2),o.infobasecolor="#fffff0",o.infocolor1="#9370DB",o.infocolor2="#87CEFA",o.infocolor3="#BC8F8F",o.suitcolor1="#FFD700",o.suitcolor2="#FFD700",o.suitcolor3="#FFD700",o.Common.add(a.common),o.prefix=a.prefix,o.titlecolor=a.titlecolor,"#ffffff"!=a.color&&(o.color=a.color,"#ffffff"!=o.lightcolor?o.lightcolor=i.getMixColor(a.color,o.lightcolor):o.lightcolor=a.color),o.level=a.level,o.price+=i.getPrice(o),o}},e.getSuitDesc=function(t,e){if(!s.default.suits[t])return"";var o=new g.default;if(o.valueCopy(s.default.suits[t]),e>=o.EquipList.length)return"";var a="",n=0==e?o.nameCn+"\n":"";return a+=i.getEquipmentInfoBase(o.EquipList[e].Common)+" ",a+=i.getEquipmentInfo1(o.EquipList[e].Common)+" ",a+=i.getEquipmentInfo2(o.EquipList[e].Common,o.EquipList[e])+" ",a+=i.getEquipmentInfo3(o.EquipList[e].Common)+" ",n+(a+=o.EquipList[e].extraInfo).replace("\n","")},e.getEquipmentInfoBase=function(t){var e="";return e+=0==t.remoteDamage?"":"\u8fdc\u7a0b\u4f24\u5bb3"+t.remoteDamage+"\n",e+=0==t.remoteCritRate?"":"\u8fdc\u7a0b\u66b4\u51fb\u7387"+t.remoteCritRate.toFixed(1).replace(".0","")+"\n",e+=0==t.remoteCooldown?"":"\u8fdc\u7a0b\u51b7\u5374"+t.remoteCooldown/1e3+"s\n",e+=0==t.damageMin?"":"\u653b\u51fb"+t.damageMin+" \u6700\u5927\u653b\u51fb\u529b"+t.damageMax+"\n",e+=0==t.damageMin&&0!=t.damageMax?"\u6700\u5927\u653b\u51fb\u529b"+t.damageMax+"\n":"",e+=0==t.defence?"":"\u9632\u5fa1"+t.defence+"\n",e+=0==t.maxHealth?"":"\u751f\u547d"+t.maxHealth+"\n",(e+=0==t.maxDream?"":"\u68a6\u5883"+t.maxDream+"\n").length>0&&-1!=e.lastIndexOf("\n")&&(e=e.substring(0,e.lastIndexOf("\n"))),e.replace("+-","-")},e.getEquipmentInfo1=function(t){var e="";return e+=0==t.criticalStrikeRate?"":"\u66b4\u51fb"+t.criticalStrikeRate.toFixed(1).replace(".0","")+"%\n",e+=0==t.lifeDrain?"":"\u5438\u8840"+t.lifeDrain.toFixed(1).replace(".0","")+"%\n",e+=0==t.damageBack?"":"\u80cc\u523a"+t.damageBack+"\n",e+=0==t.moveSpeed?"":"\u79fb\u901f"+t.moveSpeed+"\n",e+=0==t.attackSpeed?"":"\u653b\u901f"+t.attackSpeed+"\n",e+=0==t.dodge?"":"\u95ea\u907f"+t.dodge.toFixed(1).replace(".0","")+"%\n",e+=0==t.blockDamage?"":"\u5f39\u53cd\u4f24\u5bb3"+t.blockDamage+"\n",e+=0==t.blockPhysical?"":"\u683c\u6321\u7269\u514d"+t.blockPhysical+"%\n",(e+=0==t.blockMagic?"":"\u683c\u6321\u9b54\u514d"+t.blockMagic+"%\n").length>0&&-1!=e.lastIndexOf("\n")&&(e=e.substring(0,e.lastIndexOf("\n"))),e.replace("+-","-")},e.getEquipmentInfo2=function(t,e){var i="";return i+=e&&0==e.isReflect?"":"\u53cd\u5f39\u5b50\u5f39\n",i+=0==t.realDamage?"":"\u653b\u51fb\u9644\u52a0"+t.realDamage+"\u70b9\u6d41\u8840\u4f24\u5bb3\n",i+=0==t.realRate?"":"\u653b\u51fb\u6709"+t.realRate+"%\u51e0\u7387\u91ca\u653e\u6d41\u8840\n",i+=0==t.magicDamage?"":"\u653b\u51fb\u9644\u52a0"+t.magicDamage+"\u70b9\u5143\u7d20\u4f24\u5bb3\n",i+=0==t.iceRate?"":"\u653b\u51fb\u6709"+t.iceRate+"%\u51e0\u7387\u91ca\u653e\u51b0\u51bb\n",i+=0==t.fireRate?"":"\u653b\u51fb\u6709"+t.fireRate+"%\u51e0\u7387\u91ca\u653e\u71c3\u70e7\n",i+=0==t.lighteningRate?"":"\u653b\u51fb\u6709"+t.lighteningRate+"%\u51e0\u7387\u91ca\u653e\u95ea\u7535\n",i+=0==t.toxicRate?"":"\u6bd2\u653b\u51fb\u6709"+t.toxicRate+"%\u51e0\u7387\u91ca\u653e\u6bd2\u7d20\n",(i+=0==t.curseRate?"":"\u653b\u51fb\u6709"+t.curseRate+"%\u51e0\u7387\u91ca\u653e\u8bc5\u5492\n").length>0&&-1!=i.lastIndexOf("\n")&&(i=i.substring(0,i.lastIndexOf("\n"))),i.replace("+-","-")},e.getEquipmentInfo3=function(t){var e="";return(e+=0==t.magicDefence?"":"\u5143\u7d20\u6297\u6027"+t.magicDefence+"%\n").length>0&&-1!=e.lastIndexOf("\n")&&(e=e.substring(0,e.lastIndexOf("\n"))),e.replace("+-","-")},e.prototype.start=function(){},e.getMixColor=function(t,e){var i=cc.color().fromHEX(t),o=cc.color().fromHEX(e),a=cc.color(),n=i.getR()+o.getR(),r=i.getG()+o.getG(),s=i.getB()+o.getB();return a.setR(n>255?255:n),a.setG(r>255?255:r),a.setB(s>255?255:s),"#"+a.toHEX("#rrggbb")},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.getPrice=function(t){var e=0;return e+=5*t.Common.maxHealth,e+=10*t.Common.maxDream,e+=10*t.Common.damageMin,e+=5*t.Common.damageMax,e+=5*t.Common.damageBack,e+=3*t.Common.criticalStrikeRate,e+=5*t.Common.defence,e+=t.Common.blockPhysical/2,e+=t.Common.blockMagic/2,e+=5*t.Common.blockDamage,e+=t.Common.lifeDrain,t.Common.moveSpeed<0?e+=-20:e+=t.Common.moveSpeed,t.Common.attackSpeed<0?e+=-10:e+=t.Common.attackSpeed,e+=2*t.Common.dodge,t.Common.remoteCooldown>0?e+=Math.floor(1e3/t.Common.remoteCooldown*20):e+=Math.floor(t.Common.remoteCooldown/20),e+=30*t.Common.remoteDamage,e+=t.Common.remoteCritRate,e+=20*t.Common.realDamage,e+=2*t.Common.realRate,e+=10*t.Common.magicDamage,e+=t.Common.magicDefence,e+=t.Common.iceRate,e+=2*t.Common.fireRate,e+=t.Common.lighteningRate,e+=2*t.Common.toxicRate,(e+=2*t.Common.curseRate)>0?Math.floor(e):0},e.prototype.updateLogic=function(t,e){if(this.isCheckTimeDelay(t)){for(var i=200,o=null,a=this.groundList.length-1;a>=0;a--){var n=this.groundList[a];if(n.highLight(!1),!n.isTaken&&n.isValid){var r=s.default.getDistance(n.node.position,e.node.position);r<i&&(i=r,o=n)}else this.groundList.splice(a,1)}i<64&&o?(o.highLight(!0),o.taketips||(o.taketips=this.node.getChildByName("sprite").getChildByName("taketips")),this.lastGroundEquip&&this.lastGroundEquip.uuid==o.uuid||(cc.tween(o.taketips).to(.2,{opacity:255}).delay(1).to(.2,{opacity:0}).start(),cc.director.emit(d.EventHelper.HUD_GROUND_EQUIPMENT_INFO_SHOW,{detail:{equipData:o.data}})),this.lastGroundEquip=o):(this.lastGroundEquip=null,cc.director.emit(d.EventHelper.HUD_GROUND_EQUIPMENT_INFO_HIDE))}},e.EMPTY="emptyequipment",e.WEAPON_DINNERFORK="weapon000",e.WEAPON_KNIFE="weapon001",e.WEAPON_CHOPPER="weapon002",e.WEAPON_HUGEBLADE="weapon003",e.WEAPON_PITCHFORK="weapon004",e.WEAPON_HUGEAXE="weapon005",e.WEAPON_CROWBAR="weapon006",e.WEAPON_KATANA="weapon007",e.WEAPON_FRUITKNIFE="weapon008",e.WEAPON_HAPPYFIRE="weapon009",e.WEAPON_SADICE="weapon010",e.WEAPON_EGYPTWAND="weapon011",e.WEAPON_TOXICDAGGER="weapon012",e.WEAPON_OLDROOTDAGGER="weapon013",e.WEAPON_COOKCHOPPER="weapon014",e.WEAPON_LIGHTENINGBLADE="weapon015",e.WEAPON_JUNGLEFORK="weapon016",e.WEAPON_KUNAI="weapon017",e.WEAPON_DEATH="weapon018",e.WEAPON_SHADOW="weapon019",e.WEAPON_BLOOD="weapon020",e.REMOTE_CROSSBOW="remote001",e.REMOTE_LONGBOW="remote002",e.REMOTE_WAND="remote003",e.REMOTE_ALIENGUN="remote004",e.REMOTE_WINCHESTER="remote005",e.REMOTE_RPG="remote006",e.REMOTE_SHURIKEN="remote007",e.REMOTE_CHICKEN="remote008",e.REMOTE_OLDGUN="remote009",e.REMOTE_BASKETBALL="remote011",e.SHIELD_CIRCLE="shield000",e.SHIELD_CARDOOR="shield001",e.SHIELD_POLICE="shield002",e.CLOTHES_VEST="clothes001",e.CLOTHES_SHIRT="clothes002",e.CLOTHES_NAVY="clothes003",e.CLOTHES_PIRATE="clothes004",e.CLOTHES_BUCKET="clothes005",e.CLOTHES_REDROBE="clothes006",e.CLOTHES_WHITEROBE="clothes007",e.CLOTHES_GENTLEMAN="clothes008",e.CLOTHES_RADIATION="clothes009",e.CLOTHES_JUNGLE="clothes010",e.CLOTHES_PHARAOH="clothes011",e.CLOTHES_KNIGHT="clothes012",e.CLOTHES_DEATH="clothes013",e.CLOTHES_ENERGY="clothes014",e.CLOTHES_CAI="clothes026",e.HELMET_BUCKETHAT="helmet002",e.HELMET_PIRATEHAT="helmet003",e.HELMET_REDHAT="helmet004",e.HELMET_WHITEHAT="helmet005",e.HELMET_PHARAOH="helmet006",e.HELMET_CAT="helmet007",e.HELMET_CHIEF="helmet008",e.HELMET_HORUS="helmet009",e.HELMET_GENTLEMAN="helmet010",e.HELMET_CHICKEN="helmet011",e.HELMET_DUCK="helmet012",e.HELMET_GOOSE="helmet013",e.HELMET_RADIATION="helmet014",e.HELMET_JUNGLE="helmet015",e.HELMET_ANUBIS="helmet016",e.HELMET_KNIGHT="helmet017",e.HELMET_DEATH="helmet018",e.HELMET_ENERY="helmet019",e.CLOAK_WARRIOR="cloak001",e.TROUSERS_LONG="trousers001",e.TROUSERS_SHORT="trousers002",e.TROUSERS_RADIATION="trousers003",e.TROUSERS_JUNGLE="trousers004",e.TROUSERS_PHARAOH="trousers005",e.TROUSERS_KNIGHT="trousers006",e.TROUSERS_DEATH="trousers007",e.TROUSERS_ENERGY="trousers008",e.GLOVES_WARRIOR="gloves001",e.GLOVES_DEMON="gloves002",e.GLOVES_BLOODCRAW="gloves003",e.GLOVES_RADIATION="gloves004",e.GLOVES_JUNGLE="gloves005",e.GLOVES_PHARAOH="gloves006",e.GLOVES_KNIGHT="gloves007",e.GLOVES_DEATH="gloves008",e.GLOVES_ENERGY="gloves009",e.SHOES_WARRIOR="shoes001",e.SHOES_SKATEBOARD="shoes002",e.SHOES_DEMON="shoes003",e.SHOES_RADIATION="shoes004",e.SHOES_JUNGLE="shoes005",e.SHOES_PHARAOH="shoes006",e.SHOES_KNIGHT="shoes007",e.SHOES_DEATH="shoes008",e.SHOES_ENERGY="shoes009",e.COLOR_CRITICALSTRIKE="#DC143C",e.COLOR_ATTACKSPPED="#5F9EA0",e.COLOR_MOVESPEED="#00BFFF",e.COLOR_DODGE="#FFFF00",e.COLOR_STABLE="#DEB887",e.COLOR_POWERFUL="#ADFF2F",e.COLOR_HEALTHY="#90EE90",e.COLOR_LIFEDRAIN="#FFC0CB",e.COLOR_BACK="#9370DB",e.COLOR_DREAM="#800080",n([v(cc.Prefab)],e.prototype,"equipment",void 0),i=n([m],e)}(u.default);i.default=E,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Data/EquipmentDescData":"EquipmentDescData","../Data/SuitData":"SuitData","../Dungeon":"Dungeon","../Equipment/Equipment":"Equipment","../EventHelper":"EventHelper","../Logic":"Logic","../Utils/IndexZ":"IndexZ","./BaseManager":"BaseManager","./InventoryManager":"InventoryManager"}],EquipmentStringData:[function(t,e,i){"use strict";cc._RF.push(e,"92198gP7T1AvKS5hasHWtsb","EquipmentStringData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.nameCn="",this.nameEn="",this.equipmetType="empty",this.desc="",this.img="emptyequipment",this.maxHealth=0,this.maxDream=0,this.damageMin=0,this.damageMax=0,this.criticalStrikeRate=0,this.defence=0,this.lifeDrain=0,this.damageBack=0,this.moveSpeed=0,this.attackSpeed=0,this.dodge=0,this.remoteCooldown=0,this.realDamage=0,this.realRate=0,this.magicDamage=0,this.magicDefence=0,this.iceRate=0,this.fireRate=0,this.lighteningRate=0,this.toxicRate=0,this.curseRate=0,this.stab=0,this.far=0,this.trouserslong=0,this.bulletType="",this.bulletSize=0,this.bulletArcExNum=0,this.bulletLineExNum=0,this.bulletLineInterval=0,this.showShooter=0,this.isHeavy=0,this.isLineAim=0,this.hideHair=0,this.bulletExSpeed=0}return t.prototype.valueCopy=function(t){this.maxHealth=t.Common.maxHealth?t.Common.maxHealth:0,this.maxDream=t.Common.maxDream?t.Common.maxDream:0,this.damageMin=t.Common.damageMin?t.Common.damageMin:0,this.damageMax=t.Common.damageMax?t.Common.damageMax:0,this.criticalStrikeRate=t.Common.criticalStrikeRate?t.Common.criticalStrikeRate:0,this.defence=t.Common.defence?t.Common.defence:0,this.lifeDrain=t.Common.lifeDrain?t.Common.lifeDrain:0,this.damageBack=t.Common.damageBack?t.Common.damageBack:0,this.moveSpeed=t.Common.moveSpeed?t.Common.moveSpeed:0,this.attackSpeed=t.Common.attackSpeed?t.Common.attackSpeed:0,this.remoteCooldown=t.Common.remoteCooldown?t.Common.remoteCooldown:0,this.dodge=t.Common.dodge?t.Common.dodge:0,this.realDamage=t.Common.realDamage?t.Common.realDamage:0,this.realRate=t.Common.realRate?t.Common.realRate:0,this.magicDefence=t.Common.magicDefence?t.Common.magicDefence:0,this.iceRate=t.Common.iceRate?t.Common.iceRate:0,this.magicDamage=t.Common.magicDamage?t.Common.magicDamage:0,this.fireRate=t.Common.fireRate?t.Common.fireRate:0,this.lighteningRate=t.Common.lighteningRate?t.Common.lighteningRate:0,this.toxicRate=t.Common.toxicRate?t.Common.toxicRate:0,this.curseRate=t.Common.curseRate?t.Common.curseRate:0,this.nameCn=t.nameCn?t.nameCn:"",this.nameEn=t.nameEn?t.nameEn:"",this.equipmetType=t.equipmetType?t.equipmetType:"",this.desc=t.desc?t.desc:"",this.img=t.img?t.img:"emptyequipment",this.stab=t.stab?t.stab:0,this.far=t.far?t.far:0,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.trouserslong=t.trouserslong?t.trouserslong:0,this.showShooter=t.showShooter?t.showShooter:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.bulletType=t.bulletType?t.bulletType:"",this.isLineAim=t.isLineAim?t.isLineAim:0,this.hideHair=t.hideHair?t.hideHair:0,this.bulletSize=t.bulletSize?t.bulletSize:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0},t.prototype.clone=function(){var e=new t;return e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.equipmetType=this.equipmetType,e.desc=this.desc,e.img=this.img,e.stab=this.stab,e.far=this.far,e.trouserslong=this.trouserslong,e.showShooter=this.showShooter,e.bulletType=this.bulletType,e.isHeavy=this.isHeavy,e.isLineAim=this.isLineAim,e.bulletArcExNum=this.bulletArcExNum,e.bulletLineExNum=this.bulletLineExNum,e.bulletLineInterval=this.bulletLineInterval,e.hideHair=this.hideHair,e.bulletSize=this.bulletSize,e.bulletExSpeed=this.bulletExSpeed,e.maxHealth=this.maxHealth,e.damageMin=this.damageMin,e.damageMax=this.damageMax,e.criticalStrikeRate=this.criticalStrikeRate,e.defence=this.defence,e.lifeDrain=this.lifeDrain,e.damageBack=this.damageBack,e.moveSpeed=this.moveSpeed,e.attackSpeed=this.attackSpeed,e.remoteCooldown=this.remoteCooldown,e.dodge=this.dodge,e.realDamage=this.realDamage,e.realRate=this.realRate,e.magicDefence=this.magicDefence,e.iceRate=this.iceRate,e.magicDamage=this.magicDamage,e.fireRate=this.fireRate,e.lighteningRate=this.lighteningRate,e.toxicRate=this.toxicRate,e.curseRate=this.curseRate,e},t}();i.default=o,cc._RF.pop()},{}],Equipment:[function(t,e,i){"use strict";cc._RF.push(e,"46d3aM6X2VOCJtzuWiGZaWE","Equipment");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Data/EquipmentData"),l=t("../EventHelper"),c=t("../Dungeon"),h=t("../Utils/AudioPlayer"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new s.default,e.pos=cc.v3(0,0),e.isTaken=!1,e}return a(e,t),e.prototype.onLoad=function(){this.isTaken=!1,this.sprite=this.node.getChildByName("sprite"),this.taketips=this.node.getChildByName("sprite").getChildByName("taketips")},e.prototype.refresh=function(t){this.data.valueCopy(t);var e=r.default.spriteFrameRes(this.data.img);"trousers"==t.equipmetType&&(e=1==t.trouserslong?r.default.spriteFrameRes("trousers000"):e),"clothes"==t.equipmetType?e=r.default.spriteFrameRes(this.data.img+"anim0"):"helmet"==t.equipmetType?e=r.default.spriteFrameRes(this.data.img+"anim0"):"remote"==t.equipmetType&&(e=r.default.spriteFrameRes(this.data.img+"anim0")),this.sprite.getComponent(cc.Sprite).spriteFrame=e,this.sprite.width=e.getRect().width,this.sprite.height=e.getRect().height;var i=cc.color(255,255,255).fromHEX(this.data.color);this.sprite.color=i,this.mat=this.sprite.getComponent(cc.Sprite).getMaterial(0),this.mat.setProperty("textureSizeWidth",e.getTexture().width*this.sprite.scaleX),this.mat.setProperty("textureSizeHeight",e.getTexture().height*this.sprite.scaleY),this.mat.setProperty("outlineColor",cc.Color.WHITE),this.highLight(!1),"remote"==t.equipmetType&&(this.sprite.width=this.sprite.width/2,this.sprite.height=this.sprite.height/2),this.data.pos=c.default.getIndexInMap(this.node.position.clone())},e.prototype.highLight=function(t){this.mat||(this.mat=this.sprite.getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("openOutline",t?1:0)},e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.onEnable=function(){},e.prototype.taken=function(t){return!this.isTaken&&(this.shopTable?r.default.coins>=this.data.price&&(cc.director.emit(l.EventHelper.HUD_ADD_COIN,{detail:{count:-this.data.price}}),cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:h.default.COIN}}),this.shopTable.sale(!0),this._taken(t),!0):(this._taken(t),!0))},e.prototype._taken=function(t){var e=this;this.isTaken=!0,this.anim.play("EquipmentTaken"),cc.director.emit(l.EventHelper.PLAYER_CHANGEEQUIPMENT,{detail:{equipData:this.data,isReplace:t}}),this.node.getChildByName("shadow").active=!1,cc.director.emit(l.EventHelper.HUD_GROUND_EQUIPMENT_INFO_HIDE),this.scheduleOnce(function(){e.node&&e.destroy()},1);var i=r.default.mapManager.getCurrentMapEquipments(),o=new Array;if(i)for(var a=0,n=i;a<n.length;a++){var s=n[a];s.uuid&&s.uuid!=this.data.uuid&&o.push(s)}r.default.mapManager.setCurrentEquipmentsArr(o),cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:h.default.PICK_UP}})},n([u],e)}(cc.Component));i.default=d,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer"}],EventHelper:[function(t,e,i){"use strict";cc._RF.push(e,"4128feS00VLAILEQToHDge5","EventHelper");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.EventHelper=void 0;var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.emit=function(t,e){e?cc.director.emit(t,{detail:e}):cc.director.emit(t)},e.on=function(t,e){cc.director.on(t,function(t){e(t.detail)})},e.PLAYER_MOVE="PLAYER_MOVE",e.PLAYER_ROTATE="PLAYER_ROTATE",e.PLAYER_TRIGGER="PLAYER_TRIGGER",e.PLAYER_USEITEM="PLAYER_USEITEM",e.USEITEM_KEYBOARD="USEITEM_KEYBOARD",e.PLAYER_SKILL="PLAYER_SKILL",e.PLAYER_SKILL1="PLAYER_SKILL1",e.PLAYER_ATTACK="PLAYER_ATTACK",e.PLAYER_REMOTEATTACK="PLAYER_REMOTEATTACK",e.PLAYER_REMOTEATTACK_CANCEL="PLAYER_REMOTEATTACK_CANCEL",e.PLAYER_GETITEM="PLAYER_GETITEM",e.PLAYER_TAPTIPS="PLAYER_TAPTIPS",e.PLAYER_USEDREAM="PLAYER_USEDREAM",e.PLAYER_CHANGEITEM="PLAYER_CHANGEITEM",e.PLAYER_CHANGEEQUIPMENT="PLAYER_CHANGEEQUIPMENT",e.PLAYER_STATUSUPDATE="PLAYER_STATUSUPDATE",e.PLAYER_EXIT_FROM_SETTINGS="PLAYER_EXIT_FROM_SETTINGS",e.PLAYER_UPDATE_OILGOLD_DATA="PLAYER_UPDATE_OILGOLD_DATA",e.INVENTORY_CHANGEITEM="INVENTORY_CHANGEITEM",e.CHANGE_MINIMAP="CHANGE_MINIMAP",e.HUD_ADD_COIN="HUD_ADD_COIN",e.HUD_ADD_OILGOLD="HUD_ADD_OILGOLD",e.HUD_LOSE_OILGOLD="HUD_LOSE_OILGOLD",e.HUD_OILGOLD_LOSE_SHOW="HUD_OILGOLD_LOSE_SHOW",e.HUD_OILGOLD_RECOVERY_SHOW="HUD_OILGOLD_RECOVERY_SHOW",e.HUD_STOP_COUNTTIME="HUD_STOP_COUNTTIME",e.HUD_LIGHT_CONTROLLER="HUD_LIGHT_CONTROLLER",e.HUD_CHANGE_CONTROLLER_SHIELD="HUD_CHANGE_CONTROLLER_SHIELD",e.HUD_CONTROLLER_COOLDOWN="HUD_CONTROLLER_COOLDOWN",e.HUD_CONTROLLER_UPDATE_GAMEPAD="HUD_CONTROLLER_UPDATE_GAMEPAD",e.HUD_DAMAGE_CORNER_SHOW="HUD_DAMAGE_CORNER_SHOW",e.HUD_GROUND_EQUIPMENT_INFO_SHOW="HUD_GROUND_EQUIPMENT_INFO_SHOW",e.HUD_GROUND_EQUIPMENT_INFO_HIDE="HUD_GROUND_EQUIPMENT_INFO_HIDE",e.HUD_GROUND_ITEM_INFO_SHOW="HUD_GROUND_ITEM_INFO_SHOW",e.HUD_GROUND_ITEM_INFO_HIDE="HUD_GROUND_ITEM_INFO_HIDE",e.HUD_FADE_IN="HUD_FADE_IN",e.HUD_FADE_OUT="HUD_FADE_OUT",e.HUD_COMPLETE_SHOW="HUD_COMPLETE_SHOW",e.HUD_MART_SHELVES_DIALOG="HUD_MART_SHELVES_DIALOG",e.HUD_MART_SHELVES_DIALOG_PAY="HUD_MART_SHELVES_DIALOG_BUY",e.HUD_CAMERA_ZOOM_IN="HUD_CAMERA_ZOOM_IN",e.HUD_CAMERA_ZOOM_OUT="HUD_CAMERA_ZOOM_OUT",e.HUD_CANCEL_OR_PAUSE="HUD_CANCEL_OR_PAUSE",e.DUNGEON_SETEQUIPMENT="DUNGEON_SETEQUIPMENT",e.DUNGEON_ADD_ITEM="DUNGEON_ADD_ITEM",e.DUNGEON_SHAKEONCE="DUNGEON_SHAKEONCE",e.DUNGEON_ADD_COIN="DUNGEON_ADD_COIN",e.DUNGEON_ADD_OILGOLD="DUNGEON_ADD_OILGOLD",e.DUNGEON_ADD_FALLSTONE="DUNGEON_ADD_FALLSTONE",e.DUNGEON_ADD_LIGHTENINGFALL="DUNGEON_ADD_LIGHTENINGFALL",e.MONSTER_STATUSUPDATE="MONSTER_STATUSUPDATE",e.BOSS_ADDSLIME="BOSS_ADDSLIME",e.HUD_UPDATE_PLAYER_INFODIALOG="HUD_UPDATE_PLAYER_INFO_DIALOG",e.HUD_UPDATE_PLAYER_HEALTHBAR="HUD_UPDATE_PLAYER_HEALTHBAR",e.HUD_UPDATE_PLAYER_DREAMBAR="HUD_UPDATE_PLAYER_DREAMBAR",e.HUD_SHAKE_PLAYER_DREAMBAR="HUD_SHAKE_PLAYER_DREAMBAR",e.HUD_INVENTORY_SHOW="HUD_INVENTORY_SHOW",e.HUD_INVENTORY_ITEM_UPDATE="HUD_INVENTORY_ITEM_UPDATE",e.HUD_INVENTORY_ALL_UPDATE="HUD_INVENTORY_ALL_UPDATE",e.TALENT_TREE_UPDATE="TALENT_TREE_UPDATE",e.TALENT_TREE_SELECT="TALENT_TREE_SELECT",e.PLAY_AUDIO="PLAY_AUDIO",e.STOP_ALL_AUDIO_EFFECT="STOP_AUDIO_EFFECT",e.CAMERA_SHAKE="CAMERA_SHAKE",e.CAMERA_LOOK="CAMERA_LOOK",e.CHUNK_LOAD="CHUNK_LOAD",e.POOL_DESTORY_WALKSMOKE="destorysmoke",e.POOL_DESTORY_BLOCKLIGHT="destoryblocklight",e.eventHandler=new cc.Node,n([s],e)}(cc.Component));i.EventHelper=l,cc._RF.pop()},{}],EvilEye:[function(t,e,i){"use strict";cc._RF.push(e,"4c205mgXoJFWIARHvt3fCFo","EvilEye");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../EventHelper"),l=t("../Shooter"),c=t("../Data/DamageData"),h=t("../Manager/StatusManager"),p=t("./Boss"),u=t("../Utils/NextStep"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Utils/ActorUtils"),m=cc._decorator,v=m.ccclass,E=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.viceEyesFireSkill=new u.default,e.mainEyesFireSkill=new u.default,e.dashSkill=new u.default,e.isHalfBlood=!1,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.graphics=this.getComponent(cc.Graphics),this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(l.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default),this.viceEyes=new Array,this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb1").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb2").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb3").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb4").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb5").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb6").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceShooters=new Array,this.viceShooters.push(this.node.getChildByName("Shooter1").getComponent(l.default)),this.viceShooters.push(this.node.getChildByName("Shooter2").getComponent(l.default)),this.viceShooters.push(this.node.getChildByName("Shooter3").getComponent(l.default)),this.viceShooters.push(this.node.getChildByName("Shooter4").getComponent(l.default)),this.viceShooters.push(this.node.getChildByName("Shooter5").getComponent(l.default)),this.viceShooters.push(this.node.getChildByName("Shooter6").getComponent(l.default));var t=f.default.getClone(this.actorName(),"evileyeeye");this.shooter.from.valueCopy(t);for(var e=0,i=this.viceShooters;e<i.length;e++)i[e].from.valueCopy(t)},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){var e=this;return!(this.sc.isDied||!this.sc.isShow||this.anim.getAnimationState("EvilEyeHurt").isPlaying||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.data.currentHealth<this.data.Common.maxHealth/2&&!this.isHalfBlood&&(this.isHalfBlood=!0,this.anim.play("EvilEyeHurt"),this.scheduleOnce(function(){e.anim.play("EvilEyeBite")},2.5)),cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(g.default.addMonsterKillAchievement(this.data.resName),cc.tween(this.node).to(3,{opacity:0}).start(),this.sc.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.sc.isDied&&this.sc.isShow&&this.dungeon){this.node.position=r.default.fixOuterMap(this.node.position),this.pos=r.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.getMovePos(),e=this.getNearPlayerDistance(this.dungeon.player.node),i=this.data.currentHealth<this.data.Common.maxHealth/2;e<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.mainEyesFireSkill.IsExcuting||!i||this.anim.getAnimationState("EvilEyeHurt").isPlaying||this.dash(),this.fireWithViceEyes(i),this.dashSkill.IsExcuting||this.fireWithMainEye(),!t.equals(cc.Vec3.ZERO)&&e>100&&!this.shooter.isAiming&&!this.dashSkill.IsExcuting&&(t=t.normalizeSelf(),this.move(t,20))}},e.prototype.getMovePos=function(){var t=this.dungeon.player.pos.clone(),e=r.default.getPosInMap(t);return e.y+=32,(e=e.sub(this.node.position)).x,e},e.prototype.fireWithViceEyes=function(t){var e=this;this.viceEyesFireSkill.next(function(){e.viceEyesFireSkill.IsExcuting=!0,e.scheduleOnce(function(){e.viceEyesFireSkill.IsExcuting=!1},2),t?e.schedule(function(){e.fireViceBullet()},.5,2,0):e.fireViceBullet()},3)},e.prototype.fireViceBullet=function(){for(var t=0;t<this.viceShooters.length;t++){var e=this.viceEyes[t].convertToWorldSpaceAR(cc.v3(0,0));e=this.node.convertToNodeSpaceAR(e),this.viceShooters[t].node.setPosition(e);var i=this.node.position.clone().add(e),o=this.dungeon.player.getCenterPosition().sub(i);o.equals(cc.Vec3.ZERO)||(o=o.normalizeSelf(),this.viceShooters[t].setHv(o),this.fireShooter(this.viceShooters[t],"bullet101",0,0,0,cc.v3(0,0)))}},e.prototype.fireWithMainEye=function(){var t=this;this.mainEyesFireSkill.next(function(){t.mainEyesFireSkill.IsExcuting=!0,t.scheduleOnce(function(){t.mainEyesFireSkill.IsExcuting=!1},3);var e=t.shooter.node.convertToWorldSpaceAR(cc.v3(0,0));e=t.node.convertToNodeSpaceAR(e),t.shooter.node.setPosition(e);var i=t.node.position.clone().add(e),o=t.dungeon.player.getCenterPosition().sub(i);o.equals(cc.Vec3.ZERO)||(o=o.normalizeSelf(),t.shooter.setHv(o),t.shooter.data.isLineAim=1,t.fireShooter(t.shooter,"laser003",0,3,0,cc.v3(0,0)),t.anim.playAdditive("EvilEyeStone"))},7)},e.prototype.dash=function(){var t=this;this.dashSkill.next(function(){cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),t.dashSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("EvilEyeBite");var e=t.getMovePos();e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf());var i=e.x,o=e.y,a=cc.v2(i,o);a=a.mul(800),t.rigidbody.linearVelocity=a,t.scheduleOnce(function(){t.dashSkill.IsExcuting=!1},2)},3,!0)},e.prototype.fireShooter=function(t,e,i,o,a,n){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a,n)},e.prototype.showBoss=function(){this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied,this.sc.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO)},e.prototype.move=function(t,e){if(!this.sc.isDied){t.equals(cc.Vec3.ZERO)||(this.pos=r.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t){var e=y.default.getEnemyCollisionTarget(t);if(e&&this.dashSkill.IsExcuting){var i=new c.default;i.physicalDamage=15;var o=f.default.getClone(this.actorName(),"evileyeeye");e.takeDamage(i,o,this)&&e.addStatus(h.default.BLEEDING,o)}},e.prototype.actorName=function(){return"\u90aa\u773c"},n([v],e)}(p.default));i.default=E,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/NextStep":"NextStep","./Boss":"Boss"}],ExitData:[function(t,e,i){"use strict";cc._RF.push(e,"76ad8SnMG9NL67Zj9BTup1j","ExitData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Logic"),a=function(){function t(){this.fromRoomPos=cc.v3(0,0),this.fromPos=cc.v3(0,0),this.fromChapter=0,this.fromLevel=0,this.toChapter=0,this.toLevel=0,this.toPos=cc.v3(0,0)}return t.prototype.valueCopy=function(t){this.fromChapter=t.fromChapter?t.fromChapter:0,this.fromLevel=t.fromLevel?t.fromLevel:0,this.toChapter=t.toChapter?t.toChapter:0,this.toLevel=t.toLevel?t.toLevel:0,this.fromRoomPos=t.fromRoomPos?cc.v3(t.fromRoomPos.x,t.fromRoomPos.y):cc.v3(0,0),this.toPos=t.toPos?cc.v3(t.toPos.x,t.toPos.y):cc.v3(0,0),this.fromPos=t.fromPos?cc.v3(t.fromPos.x,t.fromPos.y):cc.v3(0,0)},t.prototype.clone=function(){var e=new t;return e.toPos=this.toPos.clone(),e.fromRoomPos=this.fromRoomPos.clone(),e.fromPos=this.fromPos.clone(),e.fromChapter=this.fromChapter,e.fromLevel=this.fromLevel,e.toChapter=this.toChapter,e.toLevel=this.toLevel,e},t.getRealWorldExitDataFromDream=function(e,i){var a=new t;return a.fromChapter=e,a.fromLevel=i,a.toChapter=o.default.CHAPTER099,a.toLevel=0,a.toPos=cc.v3(6,7),a},t.getDreamExitDataFromReal=function(){var e=new t;return e.fromChapter=o.default.CHAPTER099,e.fromLevel=0,e.toChapter=o.default.savePoinitData.chapter,e.toLevel=o.default.savePoinitData.level,e.toPos=cc.v3(o.default.savePoinitData.x,o.default.savePoinitData.y),e},t}();i.default=a,cc._RF.pop()},{"../Logic":"Logic"}],ExitDoor:[function(t,e,i){"use strict";cc._RF.push(e,"479c1KI84hEjY9sMAyTcSmq","ExitDoor");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Player"),s=t("../EventHelper"),l=t("../Logic"),c=t("./Building"),h=t("../Utils/AudioPlayer"),p=t("../Utils/IndexZ"),u=t("../Data/ExitData"),d=t("../Dungeon"),f=t("../Actor/ColliderTag"),g=cc._decorator,y=g.ccclass,m=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.isDoor=!0,e.bgSprite=null,e.closeSprite=null,e.openSprite=null,e.spriteNode=null,e.roof=null,e.isBackToUpLevel=!1,e.dir=0,e.exitData=new u.default,e}return a(e,t),e.prototype.init=function(t,e){if(this.dir=t,this.exitData.valueCopy(e),this.isBackToUpLevel=4==t||5==t||6==t||7==t,this.dir>7){this.node.opacity=0,this.roof.node.opacity=0;var i=this.data.defaultPos.clone(),o=this.node.getComponent(cc.BoxCollider);o.size=cc.size(128,128),o.offset=cc.v2(0,0),8==this.dir&&(i.y+=1),9==this.dir&&(i.y-=1),10==this.dir&&(i.x-=1),11==this.dir&&(i.x+=1),this.node.position=d.default.getPosInMap(i)}this.roof.getComponentInChildren(cc.Label).string="-"+l.default.worldLoader.getLevelData(this.exitData.toChapter,this.exitData.toLevel).name},e.prototype.onLoad=function(){this.spriteNode=this.node.getChildByName("sprite"),this.bgSprite=this.node.getChildByName("sprite").getChildByName("exitbg").getComponent(cc.Sprite),this.closeSprite=this.node.getChildByName("sprite").getChildByName("exitopen").getComponent(cc.Sprite),this.openSprite=this.node.getChildByName("sprite").getChildByName("exitclose").getComponent(cc.Sprite),this.roof=this.node.getChildByName("roof").getComponent(cc.Sprite),this.openSprite.node.zIndex=p.default.FLOOR,this.closeSprite.node.zIndex=p.default.ACTOR},e.prototype.start=function(){switch(l.default.chapterIndex){case l.default.CHAPTER00:this.changeRes("exit000");break;case l.default.CHAPTER01:this.changeRes("exit001");break;case l.default.CHAPTER02:this.changeRes("exit002");break;case l.default.CHAPTER03:this.changeRes("exit003");break;case l.default.CHAPTER04:case l.default.CHAPTER05:this.changeRes("exit004");break;case l.default.CHAPTER099:this.changeRes("exit000")}var t=l.default.spriteFrameRes("roof"+l.default.worldLoader.getCurrentLevelData().wallRes1+"anim000");(this.dir%4>1||this.dir>7)&&(t=null),this.roof.spriteFrame=t,this.roof.node.parent=this.node.parent;var e=this.node.convertToWorldSpaceAR(cc.v3(0,128));switch(this.roof.node.position=this.roof.node.parent.convertToNodeSpaceAR(e),this.roof.node.zIndex=p.default.OVERHEAD,this.roof.node.opacity=255,this.dir%4){case 0:break;case 1:this.roof.node.angle=180,this.roof.node.opacity=128,this.roof.node.getChildByName("info").angle=180}},e.prototype.openGate=function(t){this.isOpen||(this.isOpen=!0,this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.getComponent(cc.PhysicsBoxCollider).apply(),cc.tween(this.closeSprite.node).to(t?0:1,{opacity:0}).start())},e.prototype.closeGate=function(t){this.isOpen&&(this.isOpen=!1,this.getComponent(cc.PhysicsBoxCollider).sensor=!1,this.getComponent(cc.PhysicsBoxCollider).apply(),cc.tween(this.closeSprite.node).to(t?0:1,{opacity:255}).start())},e.prototype.onCollisionEnter=function(t){if(t.tag==f.ColliderTag.PLAYER){var e=t.node.getComponent(r.default);e&&this.isOpen&&(this.isOpen=!1,cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:h.default.EXIT}}),l.default.playerData=e.data.clone(),l.default.loadingNextLevel(this.exitData))}},e.prototype.changeRes=function(t){this.bgSprite.spriteFrame=l.default.spriteFrameRes(t+"bg"),this.openSprite.spriteFrame=l.default.spriteFrameRes(t+"open"),this.closeSprite.spriteFrame=l.default.spriteFrameRes(t+"close")},n([y],e)}(c.default));i.default=m,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Data/ExitData":"ExitData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],FallStone:[function(t,e,i){"use strict";cc._RF.push(e,"606fd8guh5COozFgkmej6tZ","FallStone");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("./Building"),l=t("../Utils/AudioPlayer"),c=t("../Data/FromData"),h=t("../NonPlayer"),p=t("../Utils/ActorUtils"),u=cc._decorator,d=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFall=!1,e.isAuto=!0,e.isFalling=!1,e}return a(e,t),e.prototype.onLoad=function(){this.isFall=!1},e.prototype.fall=function(t){t&&(this.node.getChildByName("stone").getChildByName("fire").active=!0,this.node.getChildByName("stone").color=cc.color(253,122,37)),this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isFalling=!0},e.prototype.FallFinish=function(){var t=this;l.default.play(l.default.BOOM),this.isFall=!0,this.scheduleOnce(function(){t.isFall=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},2)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){!p.default.getEnemyCollisionTarget(t)||this.isAuto||this.isFalling||this.fall()},e.prototype.onCollisionStay=function(t){var e=p.default.getEnemyCollisionTarget(t);e&&this.isFall&&this.isValid&&(this.isFall=!1,e.takeDamage(new r.default(2),c.default.getClone("\u843d\u77f3","stone")));var i=t.getComponent(h.default);i&&this.isFall&&this.isValid&&(this.isFall=!1,i.takeDamage(new r.default(2)))},n([d],e)}(s.default));i.default=f,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../NonPlayer":"NonPlayer","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],FireGhost:[function(t,e,i){"use strict";cc._RF.push(e,"63945bTi0VH3q4BT6nw6+98","FireGhost");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Manager/StatusManager"),l=t("../Data/FromData"),c=t("../Logic"),h=t("../Utils/IndexZ"),p=t("../Utils/ActorUtils"),u=cc._decorator,d=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRotating=!1,e.isAttacking=!1,e.angleOffset=0,e.angle=0,e.isDied=!1,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.rigidBody=this.getComponent(cc.RigidBody)},e.prototype.start=function(){},e.prototype.init=function(t,e){var i=this;this.player=t,this.node.setPosition(t.node.position.clone()),this.node.zIndex=h.default.OVERHEAD,this.angleOffset=e,this.scheduleOnce(function(){i.node.setPosition(i.getPlayerFarPosition(i.player,50,i.angle+i.angleOffset)),i.isRotating=!0},.2)},e.prototype.getPlayerFarPosition=function(t,e,i){var o=t.Hv.clone(),a=cc.v3(cc.v2(o).rotateSelf(i*Math.PI/180).mul(e));return t.node.position.clone().addSelf(cc.v3(8,48).addSelf(a))},e.prototype.onCollisionEnter=function(t,e){e.radius>0&&this.isAttacking&&this.isRotating&&p.default.getEnemyCollisionTarget(t,!0)&&(this.isAttacking=!1,this.attacking(t.node))},e.prototype.attacking=function(t){if(t){var e=new r.default,i=s.default.BURNING;e.magicDamage=1;var o=p.default.getEnemyActorByNode(t,!0);o&&!o.sc.isDied&&(o.takeDamage(e),o.addStatus(i,new l.default)),this.isDied=!0,cc.director.emit("destoryfireghost",{detail:{coinNode:this.node}})}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){if(!c.default.isGamePause&&this.isCheckTimeDelay(t)){var e=this.hasNearEnemy();if(e.equals(cc.Vec3.ZERO))this.isRotating&&this.player&&(this.angle+=5,this.angle>360&&(this.angle=0),i=(e=this.getPlayerFarPosition(this.player,50,this.angle+this.angleOffset)).sub(this.node.position).normalizeSelf().mulSelf(200),this.rigidBody.linearVelocity=cc.v2(i.x,i.y));else{this.isAttacking=!0;var i=e.normalizeSelf().mulSelf(400);this.rigidBody.linearVelocity=cc.v2(i.x,i.y)}}},e.prototype.hasNearEnemy=function(){if(!this.player||!this.isRotating)return cc.Vec3.ZERO;var t=1e3,e=cc.v3(0,0),i=p.default.getNearestEnemyActor(this.player,!1,this.player.weaponRight.meleeWeapon.dungeon);if(i){var o=c.default.getDistance(this.node.position,i.node.position);if(o<400&&o<t&&!i.sc.isDied&&!i.sc.isDisguising){t=o;var a=this.node.position.clone();a.x=this.node.scaleX>0?a.x:-a.x,e=i.node.position.sub(a)}}return 1e3!=t&&(e=e.normalizeSelf()),e},n([d],e)}(cc.Component));i.default=f,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils","../Utils/IndexZ":"IndexZ"}],FloatingLabelManager:[function(t,e,i){"use strict";cc._RF.push(e,"70be4qc1pdJGpxF0vSkBTb1","FloatingLabelManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../UI/FloatingLabel"),s=t("../Utils/IndexZ"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return a(e,t),e.prototype.clear=function(){},e.prototype.onLoad=function(){var t=this;this.labelPool=new cc.NodePool,cc.director.on("destorylabel",function(e){t.destroyLabel(e.detail.labelNode)})},e.prototype.getFloaingLabel=function(t){var e=this.node.position.clone();e=this.node.convertToWorldSpaceAR(e),e=t.convertToNodeSpaceAR(e);var i=null;this.labelPool.size()>0&&(i=this.labelPool.get()),i&&!i.active||(i=cc.instantiate(this.label)),i.parent=t,i.position=e.clone();var o=i.getComponent(r.default);return i.zIndex=s.default.UI,i.opacity=255,i.active=!0,o},e.prototype.destroyLabel=function(t){t.active=!1,t.getComponent(cc.Label),this.labelPool&&this.labelPool.put(t)},e.prototype.start=function(){},n([h(cc.Prefab)],e.prototype,"label",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../UI/FloatingLabel":"FloatingLabel","../Utils/IndexZ":"IndexZ"}],FloatingLabel:[function(t,e,i){"use strict";cc._RF.push(e,"cae6fbyiQhHL5VOrhWuq2d6","FloatingLabel");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.label=this.node.getChildByName("label").getComponent(cc.Label)},e.prototype.start=function(){},e.prototype.showLabel=function(t,e,i){i&&(i>3&&(i=3),this.node.scale=i);var o=this.node.scale;this.node.scale=1.5*o,this.label.node.opacity=255,this.label.node.position=cc.v3(0,0),this.label.string=t,this.label.node.color=e,this.anim.play("FontFloating"),cc.tween(this.node).to(.1,{scale:o}).start()},e.prototype.showMiss=function(){this.showLabel("\u4e22\u5931",cc.color(255,255,255),1)},e.prototype.showDoge=function(){this.showLabel("\u95ea\u907f",cc.color(255,255,255),1)},e.prototype.showDamage=function(t,e,i){var o=t<0?cc.color(255,0,0):cc.color(0,255,0),a=1;e&&(o=cc.color(255,255,0),a=2),i&&(o=cc.color(186,85,211));var n=Math.abs(t),r=parseFloat(t.toFixed(1));this.showLabel((t>0?"+":"")+(0!=r?r:""),o,a+n/50)},e.prototype.hideLabel=function(){this.node.active=!1,cc.director.emit("destorylabel",{detail:{labelNode:this.node}})},e.prototype.FloatingFinish=function(){this.hideLabel()},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],FootBoard:[function(t,e,i){"use strict";cc._RF.push(e,"a20d6iwPAJLg7AtbBgYX0yS","FootBoard");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("./Building"),l=t("../Utils/IndexZ"),c=t("../Actor/ColliderTag"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e.isOpen=!1,e.hasActive=!1,e.pos=cc.v3(0,0),e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.spriteNode=this.node.getChildByName("sprite"),this.sprite=this.spriteNode.getComponent(cc.Sprite)},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=l.default.FLOOR},e.prototype.openTrap=function(){this.isOpen||(this.isOpen=!0,this.sprite.spriteFrame=this.isOpen?this.openSpriteFrame:this.closeSpriteFrame)},e.prototype.onCollisionStay=function(t){t.tag==c.ColliderTag.BUILDING&&(this.isOpen=!0,this.hasActive=!0),t.tag==c.ColliderTag.PLAYER&&(this.isOpen=!0,this.hasActive=!0)},e.prototype.onCollisionEnter=function(t){t.tag==c.ColliderTag.BUILDING&&(this.isOpen=!0,this.hasActive=!0),t.tag==c.ColliderTag.PLAYER&&(this.isOpen=!0,this.hasActive=!0)},e.prototype.onCollisionExit=function(t){t.tag==c.ColliderTag.BUILDING&&(this.isOpen=!1),t.tag==c.ColliderTag.PLAYER&&(this.isOpen=!1)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>.2&&(this.timeDelay=0,this.sprite.spriteFrame=this.isOpen?this.openSpriteFrame:this.closeSpriteFrame)},n([u(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),n([u(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),n([p],e)}(s.default);i.default=d,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../Utils/IndexZ":"IndexZ","./Building":"Building"}],FromData:[function(t,e,i){"use strict";cc._RF.push(e,"cf8a1Noa0FD6qIEI4bqHV5c","FromData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.name="",this.res="",this.id=0}return t.prototype.valueCopy=function(t){t&&(this.name=t.name?t.name:"",this.res=t.res?t.res:"",this.id=t.id?t.id:0)},t.getClone=function(e,i,o){var a=new t;return a.name=e,a.res=i,a.id=o,a},t.prototype.clone=function(){var e=new t;return e.name=this.name,e.res=this.res,e.id=this.id,e},t}();i.default=o,cc._RF.pop()},{}],FsmEvent:[function(t,e,i){"use strict";cc._RF.push(e,"b77f3K+NxhBaYwLRNLbbGxg","FsmEvent"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],GameFinish:[function(t,e,i){"use strict";cc._RF.push(e,"98577N+o/RGi4cE+Wsz8Pp4","GameFinish");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./WxHelper"),l=t("./EventHelper"),c=t("./Utils/AudioPlayer"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wxhelper=null,e.level=null,e.clock=null,e}return a(e,t),e.prototype.start=function(){this.clock&&(this.clock.string=""+r.default.time),this.level&&(this.level.string="Level "+(r.default.chapterIndex+1)+"-"+r.default.level)},e.prototype.retry=function(){r.default.resetData(),cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("loading")},e.prototype.home=function(){this.wxhelper&&this.wxhelper.CloseDialog(),cc.director.emit(l.EventHelper.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("start")},n([u(s.default)],e.prototype,"wxhelper",void 0),n([u(cc.Label)],e.prototype,"level",void 0),n([u(cc.Label)],e.prototype,"clock",void 0),n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer","./WxHelper":"WxHelper"}],GameHud:[function(t,e,i){"use strict";cc._RF.push(e,"34bc5nmZdpM3J3SaZigF3c3","GameHud");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./PlayerInfoDialog"),s=t("../HealthBar"),l=t("../EventHelper"),c=t("../Data/PlayerData"),h=t("../Logic"),p=t("./dialog/SettingsDialog"),u=t("./dialog/MartShelvesDialog"),d=t("./dialog/InventoryDialog"),f=t("../Utils/AudioPlayer"),g=cc._decorator,y=g.ccclass,m=g.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.healthBar=null,e.dreamBar=null,e.bossHealthBar=null,e.playerInfoDialog=null,e.level=null,e.clock=null,e.damageCorner=null,e.pasueButton=null,e.zoomButton=null,e.settingsDialog=null,e.martShelvesDialog=null,e.completeLabel=null,e.oilGoldLabel=null,e.inventoryDialog=null,e.isCompleteShowed=!1,e.checkTimeDelay=0,e.startCountTime=!0,e.hour=0,e.minute=0,e.second=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;cc.director.on(l.EventHelper.HUD_UPDATE_PLAYER_INFODIALOG,function(e){var i=new c.default;i.valueCopy(e.detail.data),t.statusUpdate(i)}),cc.director.on(l.EventHelper.HUD_UPDATE_PLAYER_HEALTHBAR,function(e){t.healthBarUpdate(e.detail.x,e.detail.y)}),cc.director.on(l.EventHelper.HUD_UPDATE_PLAYER_DREAMBAR,function(e){t.dreamBarUpdate(e.detail.x,e.detail.y)}),cc.director.on(l.EventHelper.HUD_SHAKE_PLAYER_DREAMBAR,function(){t.dreamBar&&t.dreamBar.shake()}),cc.director.on(l.EventHelper.HUD_DAMAGE_CORNER_SHOW,function(){t.showDamageCorner(),t.healthBar&&t.healthBar.shake()}),cc.director.on(l.EventHelper.HUD_MART_SHELVES_DIALOG,function(e){t.showMartShelvesDialog(e.detail.type,e.detail.goodsNameList)}),cc.director.on(l.EventHelper.HUD_COMPLETE_SHOW,function(){t.showComplete()}),cc.director.on(l.EventHelper.HUD_OILGOLD_LOSE_SHOW,function(){t.showOilGoldInfo(!0)}),cc.director.on(l.EventHelper.HUD_OILGOLD_RECOVERY_SHOW,function(){t.showOilGoldInfo(!1)}),cc.director.on(l.EventHelper.HUD_INVENTORY_SHOW,function(){t.showInventoryDialog()}),cc.director.on(l.EventHelper.HUD_CANCEL_OR_PAUSE,function(){t.cancelOrPause()}),cc.director.on(l.EventHelper.HUD_STOP_COUNTTIME,function(){t.startCountTime=!1}),cc.director.on(l.EventHelper.HUD_FADE_IN,function(){t.fadeIn()}),cc.director.on(l.EventHelper.HUD_FADE_OUT,function(){t.fadeOut()}),this.clock&&(this.clock.string=""+h.default.time),this.level&&(this.level.string=""+h.default.worldLoader.getCurrentLevelData().name),this.damageCorner&&(this.damageCorner.opacity=0),this.pasueButton.on(cc.Node.EventType.TOUCH_START,function(){t.pauseGame()}),this.zoomButton.on(cc.Node.EventType.TOUCH_START,function(){l.EventHelper.emit(l.EventHelper.HUD_CAMERA_ZOOM_IN,{})}),this.zoomButton.on(cc.Node.EventType.TOUCH_END,function(){l.EventHelper.emit(l.EventHelper.HUD_CAMERA_ZOOM_OUT,{})}),this.zoomButton.on(cc.Node.EventType.TOUCH_CANCEL,function(){l.EventHelper.emit(l.EventHelper.HUD_CAMERA_ZOOM_OUT,{})}),this.healthBarUpdate(h.default.playerData.currentHealth,h.default.playerData.getHealth().y),this.dreamBarUpdate(h.default.playerData.currentDream,h.default.playerData.getDream().y),this.fadeIn()},e.prototype.showOilGoldInfo=function(t){var e=this;if(this.oilGoldLabel){t||f.default.play(f.default.COMPLETE);var i=t?["\u788e","\u788e\u7247","\u788e\u7247\u4e22","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22\u5931","\u788e\u7247\u4e22","\u788e\u7247","\u788e",""]:["\u788e","\u788e\u7247","\u788e\u7247\u627e","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e\u56de","\u788e\u7247\u627e","\u788e\u7247","\u788e",""],o=0;this.oilGoldLabel.string="",this.oilGoldLabel.unscheduleAllCallbacks(),this.oilGoldLabel.schedule(function(){o<i.length&&(e.oilGoldLabel.string=i[o++])},.15,i.length)}},e.prototype.showComplete=function(){var t=this;if(this.completeLabel&&!this.isCompleteShowed){f.default.play(f.default.COMPLETE);var e=["\u6e05","\u6e05\u7406","\u6e05\u7406\u5b8c","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c\u6210","\u6e05\u7406\u5b8c","\u6e05\u7406","\u6e05",""],i=0;this.completeLabel.string="",this.completeLabel.unscheduleAllCallbacks(),this.isCompleteShowed=!0,this.completeLabel.schedule(function(){i<e.length&&(t.completeLabel.string=e[i++])},.1,e.length,.5)}},e.prototype.fadeOut=function(){this.node&&(this.node.opacity=255,cc.tween(this.node).to(.5,{opacity:0}).start())},e.prototype.fadeIn=function(){this.node&&(this.node.opacity=0,cc.tween(this.node).to(3,{opacity:255}).start())},e.prototype.statusUpdate=function(t){this.playerInfoDialog&&this.playerInfoDialog.refreshDialog(t,t.EquipmentTotalData,t.StatusTotalData)},e.prototype.showDamageCorner=function(){this.damageCorner&&(this.damageCorner.stopAllActions(),this.damageCorner.opacity=255,this.damageCorner.scale=1,cc.tween(this.damageCorner).parallel(cc.tween(this.damageCorner).to(.5,{scale:1.05}),cc.tween(this.damageCorner).to(1,{opacity:0})).start())},e.prototype.healthBarUpdate=function(t,e){this.healthBar&&this.healthBar.refreshHealth(t,e)},e.prototype.dreamBarUpdate=function(t,e){this.dreamBar&&this.dreamBar.refreshHealth(t,e)},e.prototype.start=function(){var t=h.default.time.split(":");this.hour=parseInt(t[0]),this.minute=parseInt(t[1]),this.second=parseInt(t[2])},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.clock&&this.startCountTime&&(this.changeTime(),this.clock.string=""+h.default.time),this.settingsDialog.node.active||this.martShelvesDialog.node.active?h.default.isGamePause=!0:h.default.isGamePause=!1},e.prototype.useItem=function(){},e.prototype.changeTime=function(){if(!h.default.isGamePause){this.second=this.second+1,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1);var t=""+this.hour;t=t.length>1?t:"0"+t;var e=""+this.minute;e=e.length>1?e:"0"+e;var i=""+this.second;i=i.length>1?i:"0"+i,h.default.time=t+":"+e+":"+i}},e.prototype.cancelOrPause=function(){this.node&&(this.inventoryDialog.isShow?this.inventoryDialog.dismiss():this.martShelvesDialog.isShow?this.martShelvesDialog.dismiss():this.showSettingsDialog())},e.prototype.pauseGame=function(){this.showSettingsDialog()},e.prototype.showInventoryDialog=function(){this.node&&(this.inventoryDialog.isShow?this.inventoryDialog.dismiss():this.inventoryDialog.show())},e.prototype.showSettingsDialog=function(){var t=this;this.node&&(this.settingsDialog.isShow?(this.settingsDialog.dismiss(),cc.director.getScheduler().setTimeScale(1)):(this.scheduleOnce(function(){t.settingsDialog.isShow&&!t.settingsDialog.isAniming?cc.director.getScheduler().setTimeScale(0):cc.director.getScheduler().setTimeScale(1)},1),this.settingsDialog.show()))},e.prototype.showMartShelvesDialog=function(t,e){this.martShelvesDialog&&(this.martShelvesDialog.isShow?this.martShelvesDialog.dismiss():(this.martShelvesDialog.updateUI(t,e),this.martShelvesDialog.show()))},n([m(s.default)],e.prototype,"healthBar",void 0),n([m(s.default)],e.prototype,"dreamBar",void 0),n([m(s.default)],e.prototype,"bossHealthBar",void 0),n([m(r.default)],e.prototype,"playerInfoDialog",void 0),n([m(cc.Label)],e.prototype,"level",void 0),n([m(cc.Label)],e.prototype,"clock",void 0),n([m(cc.Node)],e.prototype,"damageCorner",void 0),n([m(cc.Node)],e.prototype,"pasueButton",void 0),n([m(cc.Node)],e.prototype,"zoomButton",void 0),n([m(p.default)],e.prototype,"settingsDialog",void 0),n([m(u.default)],e.prototype,"martShelvesDialog",void 0),n([m(cc.Label)],e.prototype,"completeLabel",void 0),n([m(cc.Label)],e.prototype,"oilGoldLabel",void 0),n([m(d.default)],e.prototype,"inventoryDialog",void 0),n([y],e)}(cc.Component);i.default=v,cc._RF.pop()},{"../Data/PlayerData":"PlayerData","../EventHelper":"EventHelper","../HealthBar":"HealthBar","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","./PlayerInfoDialog":"PlayerInfoDialog","./dialog/InventoryDialog":"InventoryDialog","./dialog/MartShelvesDialog":"MartShelvesDialog","./dialog/SettingsDialog":"SettingsDialog"}],GameOver:[function(t,e,i){"use strict";cc._RF.push(e,"0e28bkl25dNTqUQmquXpqGi","GameOver");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./Utils/AudioPlayer"),l=t("./Utils/Random"),c=t("./Data/ExitData"),h=t("./Utils/LocalStorage"),p=cc._decorator,u=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.info=null,e.infoIcon=null,e.level=null,e.clock=null,e.tips=null,e.tipsStr="",e}var i;return a(e,t),i=e,e.prototype.start=function(){var t=this,e=h.default.getAchievementData();this.clock&&(this.clock.string="\u7528\u65f6\uff1a"+r.default.time),this.level&&(this.level.string="");var o="\u6b7b\u4e8e\u975e\u547d";if(r.default.dieFrom.name.length>0&&(o="\u7b2c"+e.playerLifes+"\u6b21\u6b7b\u4ea1\uff0c\u5728 "+r.default.worldLoader.getCurrentLevelData().name+" \u88ab "+r.default.dieFrom.name+" \u51fb\u5012"),this.infoIcon&&r.default.dieFrom.res.length>0&&(this.infoIcon.spriteFrame=r.default.spriteFrameRes(r.default.dieFrom.res),this.infoIcon.node.width=64,this.infoIcon.node.height=64/this.infoIcon.spriteFrame.getRect().width*this.infoIcon.spriteFrame.getRect().height),this.info&&(this.info.string=o),this.tips){var a=0;this.tips.string="";var n=i.TIPS[l.default.getRandomNum(0,i.TIPS.length-1)];this.schedule(function(){++a>n.length&&(a=n.length),t.tips.string=n.substr(0,a)},.05,n.length,.2)}},e.prototype.retry=function(){r.default.resetData(),s.default.play(s.default.SELECT),r.default.loadingNextLevel(c.default.getRealWorldExitDataFromDream(r.default.chapterIndex,r.default.level))},e.prototype.home=function(){s.default.play(s.default.SELECT),cc.director.loadScene("start")},e.prototype.resetWorld=function(){s.default.play(s.default.SELECT),cc.director.loadScene("start"),r.default.profileManager.clearData()},e.TIPS=["\u5f53\u4f60\u51dd\u89c6\u6df1\u6e0a\u7684\u65f6\u5019,\u6df1\u6e0a\u4e5f\u5728\u51dd\u89c6\u7740\u4f60","\u4e0a\u9501\u7684\u95e8\u9700\u8981\u4ece\u53e6\u4e00\u9762\u624d\u80fd\u6253\u5f00","\u68a6\u9192\u53ef\u4ee5\u8eba\u5728\u5e8a\u4e0a\u56de\u5230\u4e0a\u4e00\u4e2a\u7fe0\u91d1\u70b9","\u76fe\u724c\u53ef\u4ee5\u683c\u6321\u5b50\u5f39\uff0c\u751a\u81f3\u5f39\u53cd\u5bf9\u9762","\u7fe0\u6e56\u7684\u6c34\u5f88\u51b0\u51b7","\u5408\u7406\u4f7f\u7528\u7269\u54c1\u6765\u589e\u5f3a\u81ea\u5df1","\u4f60\u6c89\u6c89\u5730\u7761\u7740\u4e86","\u7535\u773c\u4f1a\u9ebb\u75f9\u4f60\u7684\u601d\u7ef4","\u7fe0\u91d1\u70b9\u662f\u7528\u6765\u81ea\u52a8\u4fdd\u5b58\u8fdb\u5ea6\u7684","\u6fc0\u5149\u6709\u4e00\u4e2a\u77ed\u6682\u7684\u7784\u51c6\u671f\uff0c\u6293\u4f4f\u673a\u4f1a\u518d\u8865\u4e00\u5200","\u51b0\u9b54\u7684\u523a\u4f1a\u963b\u6321\u4f60\u7684\u884c\u52a8","\u6b66\u58eb\u5200\u53ef\u4ee5\u53cd\u51fb\u5b50\u5f39","\u4f60\u7684\u5934\u76d6\u9aa8\u88ab\u505a\u6210\u4e86\u7897","\u5e7d\u5149\u5728\u547c\u5524\u7740\u4f60"],n([d(cc.Label)],e.prototype,"info",void 0),n([d(cc.Sprite)],e.prototype,"infoIcon",void 0),n([d(cc.Label)],e.prototype,"level",void 0),n([d(cc.Label)],e.prototype,"clock",void 0),n([d(cc.Label)],e.prototype,"tips",void 0),i=n([u],e)}(cc.Component);i.default=f,cc._RF.pop()},{"./Data/ExitData":"ExitData","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer","./Utils/LocalStorage":"LocalStorage","./Utils/Random":"Random"}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"c30ffLX6hVIjoNslRhRCM7w","Game");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Dungeon"),s=t("./Logic"),l=t("./UI/GameHud"),c=t("./Utils/LocalStorage"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){s.default.settings.showShadow=c.default.isSwitchOpen(c.default.KEY_SWITCH_SHOW_SHADOW),s.default.settings.showGamepad=c.default.isSwitchOpen(c.default.KEY_SWITCH_SHOW_GAMEPAD),cc.director.getScheduler().setTimeScale(1)},Object.defineProperty(e.prototype,"Dungeon",{get:function(){return this.dungeonBase||(this.dungeonBase=this.getComponentInChildren(r.default)),this.dungeonBase},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hud",{get:function(){return this.hudBase||(this.hudBase=this.getComponentInChildren(l.default)),this.hudBase},enumerable:!1,configurable:!0}),n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"./Dungeon":"Dungeon","./Logic":"Logic","./UI/GameHud":"GameHud","./Utils/LocalStorage":"LocalStorage"}],GoodsData:[function(t,e,i){"use strict";cc._RF.push(e,"9eba4cjM5REaKZZ0yKseRh9","GoodsData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./BaseData"),r=t("./ItemData"),s=function(t){function e(){var e=t.call(this)||this;return e.uuid="",e.count=10,e.item=new r.default,e}return a(e,t),e.prototype.valueCopy=function(t){this.uuid=t.uuid?t.uuid:"",this.count=t.count?t.count:this.count,this.item.valueCopy(t.item)},e.prototype.clone=function(){var t=new e;return t.uuid=this.uuid,t.count=this.count,t.item=this.item.clone(),t},e}(n.default);i.default=s,cc._RF.pop()},{"./BaseData":"BaseData","./ItemData":"ItemData"}],Goods:[function(t,e,i){"use strict";cc._RF.push(e,"1cb63YYvfBC97O0f5MEeafg","Goods");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/GoodsData"),s=t("../EventHelper"),l=t("../Logic"),c=cc._decorator,h=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.data=new r.default,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.sprite1=this.node.getChildByName("sprite1").getComponent(cc.Sprite),this.sprite2=this.node.getChildByName("sprite2").getComponent(cc.Sprite),this.sprite3=this.node.getChildByName("sprite3").getComponent(cc.Sprite),this.node.on(cc.Node.EventType.TOUCH_END,function(){s.EventHelper.emit(s.EventHelper.HUD_MART_SHELVES_DIALOG_PAY,{data:t.data})})},e.prototype.init=function(t){this.data=t,this.updateSprite()},e.prototype.updateSprite=function(){this.sprite1||(this.sprite1=this.node.getChildByName("sprite1").getComponent(cc.Sprite),this.sprite2=this.node.getChildByName("sprite2").getComponent(cc.Sprite),this.sprite3=this.node.getChildByName("sprite3").getComponent(cc.Sprite)),this.sprite1.node.opacity=255,this.sprite2.node.opacity=255,this.sprite3.node.opacity=255,this.sprite1.spriteFrame=l.default.spriteFrameRes(this.data.item.resName),this.sprite2.spriteFrame=l.default.spriteFrameRes(this.data.item.resName),this.sprite3.spriteFrame=l.default.spriteFrameRes(this.data.item.resName),this.label.string=this.data.item.nameCn+"\n$:"+this.data.item.price,2==this.data.count?this.sprite1.node.opacity=0:1==this.data.count?(this.sprite2.node.opacity=0,this.sprite1.node.opacity=0):this.data.count<=0&&(this.sprite1.node.opacity=0,this.sprite2.node.opacity=0,this.sprite3.node.opacity=0)},e.prototype.click=function(){},n([p(cc.Label)],e.prototype,"label",void 0),n([h],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../Data/GoodsData":"GoodsData","../EventHelper":"EventHelper","../Logic":"Logic"}],GroundOilGoldData:[function(t,e,i){"use strict";cc._RF.push(e,"06da22NYo5DOLe6uR2c2v0D","GroundOilGoldData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.x=0,this.y=0,this.chapter=0,this.level=0,this.value=0}return t.prototype.valueCopy=function(t){t&&(this.x=t.x?t.x:0,this.y=t.y?t.y:0,this.chapter=t.chapter?t.chapter:0,this.level=t.level?t.level:0,this.value=t.value?t.value:0)},t.prototype.clone=function(){var e=new t;return e.x=this.x,e.y=this.y,e.chapter=this.chapter,e.level=this.level,e.value=this.value,e},t}();i.default=o,cc._RF.pop()},{}],HealthBar:[function(t,e,i){"use strict";cc._RF.push(e,"4298eVZsIJFhKykTJYXRBP0","HealthBar");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backbar=null,e.label=null,e.isPlayer=!1,e.timeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.progressBar=this.getComponent(cc.ProgressBar),this.progressBar.progress=1},e.prototype.start=function(){},e.prototype.refreshHealth=function(t,e){this.progressBar&&(this.isPlayer&&(this.progressBar.totalLength=e*i.ICON_SIZE,this.node.width=this.progressBar.totalLength),this.progressBar.progress=t/e,this.label&&(this.label.string=parseFloat(t.toFixed(1))+"/"+e))},e.prototype.shake=function(){cc.tween(this.node).to(.05,{scale:1.05}).to(.05,{scale:.95}).to(.1,{scale:1.05}).to(.05,{scale:1}).start()},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0),this.backbar.width=this.lerp(this.backbar.width,this.progressBar.barSprite.node.width,5*t)},e.prototype.lerp=function(t,e,i){return t+(e-t)*i},e.ICON_SIZE=17,n([l(cc.Node)],e.prototype,"backbar",void 0),n([l(cc.Label)],e.prototype,"label",void 0),n([l],e.prototype,"isPlayer",void 0),i=n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],HitBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"94f4daN5WxHhp3nfQbY7apH","HitBuilding");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Building"),s=t("../Logic"),l=t("../Dungeon"),c=t("../Utils/IndexZ"),h=t("../Utils/AudioPlayer"),p=t("../Actor/ColliderTag"),u=cc._decorator,d=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resName="",e.itemNames=[],e.equipmentNames=[],e}return a(e,t),e.prototype.init=function(t,e,i,o,a,n,r,s){this.dungeon=t,this.resName=e,this.itemNames=i,this.equipmentNames=o,this.data.maxHealth=a,this.data.currentHealth=n,this.changeRes(e,""+this.data.currentHealth),this.sprite.node.scale=r,this.data.currentHealth<=0&&(this.getComponent(cc.PhysicsBoxCollider).tag=s?p.ColliderTag.DEFAULT:p.ColliderTag.BUILDING,this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.getComponent(cc.PhysicsBoxCollider).apply())},e.prototype.hitLight=function(t){this.mat||(this.mat=this.node.getChildByName("sprite").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT)},e.prototype.setDefaultPos=function(t){this.data.defaultPos=t,this.node.position=l.default.getPosInMap(t),this.node.zIndex=c.default.getActorZIndex(this.node.position)},e.prototype.takeDamage=function(){var t=this;if(this.data.currentHealth<=0||this.data.currentHealth>=9999)return!1;if(h.default.play(h.default.MONSTER_HIT),this.data.currentHealth-=1,this.changeRes(this.resName,""+this.data.currentHealth),this.hitLight(!0),this.scheduleOnce(function(){t.hitLight(!1)},.15),this.data.currentHealth<=0){for(var e=0,i=this.itemNames;e<i.length;e++)(n=i[e])&&n.length>0&&this.dungeon.addItem(this.node.position.clone(),n);for(var o=0,a=this.equipmentNames;o<a.length;o++){var n;(n=a[o])&&n.length>0&&this.dungeon.addEquipment(n,l.default.getPosInMap(this.data.defaultPos),null,1)}this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.getComponent(cc.PhysicsBoxCollider).apply()}var r=s.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);return r&&(r.currentHealth=this.data.currentHealth),!0},e.prototype.changeRes=function(t,e){this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite));var i=s.default.spriteFrameRes(t);if(e&&s.default.spriteFrameRes(t+e)&&(i=s.default.spriteFrameRes(t+e)),i){this.sprite.node.opacity=255,this.sprite.node.width=i.getRect().width,this.sprite.node.height=i.getRect().height;var o=cc.size((this.sprite.node.width-4)*this.sprite.node.scale,(this.sprite.node.height-4)*this.sprite.node.scale);this.node.width=o.width,this.node.height=o.height,this.getComponent(cc.BoxCollider).size=o.clone(),this.getComponent(cc.PhysicsBoxCollider).size=o.clone(),this.getComponent(cc.PhysicsBoxCollider).apply(),this.sprite.spriteFrame=i}},n([d],e)}(r.default));i.default=f,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],IceDemonThron:[function(t,e,i){"use strict";cc._RF.push(e,"24e5dr3bslGlZZLL6MjYCjj","IceDemonThron");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Manager/StatusManager"),l=t("../Data/FromData"),c=t("../Utils/ActorUtils"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUp=!1,e.isAuto=!0,e.isUping=!1,e}return a(e,t),e.prototype.onLoad=function(){this.isUp=!1,this.node.getChildByName("thron").getComponent(cc.Sprite).getMaterial(0).setProperty("addColor",cc.color(194,255,255))},e.prototype.fall=function(){this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isUping=!0},e.prototype.ThronUp=function(){var t=this;this.isUp=!0,this.scheduleOnce(function(){t.isUp=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},2)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t){!c.default.getEnemyCollisionTarget(t)||this.isAuto||this.isUping||this.fall()},e.prototype.onCollisionStay=function(t){var e=c.default.getEnemyCollisionTarget(t);if(e&&this.isUp&&this.isValid){this.isUp=!1;var i=l.default.getClone("\u51b0\u523a","bossicethron02");e.takeDamage(new r.default(3),i)&&e.addStatus(s.default.FROZEN,i)}},n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils"}],IceDemon:[function(t,e,i){"use strict";cc._RF.push(e,"4043fv41gFB1o18Orugu9B9","IceDemon");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../EventHelper"),l=t("../Shooter"),c=t("../Data/DamageData"),h=t("../Manager/StatusManager"),p=t("./Boss"),u=t("../Utils/NextStep"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Data/AreaOfEffectData"),m=t("../Utils/IndexZ"),v=t("../Utils/ActorUtils"),E=t("../Talent/MagicIce"),_=cc._decorator,D=_.ccclass,S=_.property,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isFaceRight=!0,e.isMoving=!1,e.dashSkill=new u.default,e.thronSkill=new u.default,e.defenceSkill=new u.default,e.meleeSkill=new u.default,e.groundThron=null,e.selfThron=null,e.magicice=null,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(l.default),this.shooter.from.valueCopy(f.default.getClone(this.actorName(),"bossicepart01")),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default)},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){if(this.sc.isDied||!this.sc.isShow)return!1;this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth);var e=this.data.currentHealth<this.data.Common.maxHealth/2;return this.defence(e),this.defenceSkill.IsExcuting?d.default.play(d.default.BOSS_ICEDEMON_HIT):d.default.play(d.default.MONSTER_HIT),!0},e.prototype.killed=function(){var t=this;this.sc.isDied||(g.default.addMonsterKillAchievement(this.data.resName),cc.tween(this.node).to(3,{opacity:0}).start(),this.sc.isDied=!0,this.anim.play("IceDemonDefence"),this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.sc.isDied&&this.sc.isShow&&this.dungeon){this.node.position=r.default.fixOuterMap(this.node.position),this.pos=r.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.getMovePos(),e=this.getNearPlayerDistance(this.dungeon.player.node),i=this.data.currentHealth<this.data.Common.maxHealth/2;e<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),!i||this.magicice.isShow||this.defenceSkill.IsInCooling||this.magicice.showIce(),!(e<200)||this.defenceSkill.IsExcuting||this.meleeSkill.IsExcuting||this.thronSkill.IsExcuting||this.dashSkill.IsExcuting||this.attack(),this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.thronSkill.IsExcuting||this.dash(),this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.dashSkill.IsExcuting||this.thronGround(i),t.equals(cc.Vec3.ZERO)||this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.thronSkill.IsExcuting||this.dashSkill.IsExcuting||!(e>60)||(t=t.normalizeSelf(),this.move(t,500))}},e.prototype.getMovePos=function(){var t=this.dungeon.player.pos.clone(),e=r.default.getPosInMap(t);e.y+=32;var i=(e=e.sub(this.node.position)).x;return this.isFaceRight=i>0,e},e.prototype.thronGround=function(t){var e=this;this.thronSkill.next(function(){e.thronSkill.IsExcuting=!0,e.anim||(e.anim=e.getComponent(cc.Animation)),e.anim.play("IceDemonThron");var i=1;e.scheduleOnce(function(){d.default.play(d.default.BOSS_ICEDEMON_THRON)},1),e.scheduleOnce(function(){d.default.play(d.default.BOSS_ICEDEMON_THRON)},2),e.schedule(function(){for(var t=e.pos.clone(),o=[cc.v3(t.x,t.y+i),cc.v3(t.x,t.y-i),cc.v3(t.x+i,t.y+i),cc.v3(t.x+i,t.y-i),cc.v3(t.x+i,t.y),cc.v3(t.x-i,t.y),cc.v3(t.x-i,t.y+i),cc.v3(t.x-i,t.y-i)],a=0;a<o.length;a++){var n=new c.default;n.physicalDamage=3,e.shooter.dungeon=e.dungeon,e.shooter.fireAoe(e.selfThron,(new y.default).init(0,2,.4,4,m.default.getActorZIndex(r.default.getPosInMap(o[a])),!0,!0,!0,!1,!0,n,f.default.getClone("\u51b0\u523a","bossicethron02"),[h.default.FROZEN]),r.default.getPosInMap(o[a]).subSelf(e.getCenterPosition()),0,null,!0)}i++},.2,t?7:5,1),t&&e.scheduleOnce(function(){for(var t=e.pos.clone(),i=[cc.v3(t.x+2,t.y+1),cc.v3(t.x+2,t.y-1),cc.v3(t.x-2,t.y+1),cc.v3(t.x-2,t.y-1),cc.v3(t.x+4,t.y+2),cc.v3(t.x+4,t.y-2),cc.v3(t.x-4,t.y+2),cc.v3(t.x-4,t.y-2),cc.v3(t.x+5,t.y+3),cc.v3(t.x+5,t.y-3),cc.v3(t.x-5,t.y+3),cc.v3(t.x-5,t.y-3),cc.v3(t.x+6,t.y+2),cc.v3(t.x+6,t.y-2),cc.v3(t.x-6,t.y+2),cc.v3(t.x-6,t.y-2),cc.v3(t.x+6,t.y+4),cc.v3(t.x+6,t.y-4),cc.v3(t.x-6,t.y+4),cc.v3(t.x-6,t.y-4),cc.v3(t.x+1,t.y+2),cc.v3(t.x+1,t.y-2),cc.v3(t.x-1,t.y+2),cc.v3(t.x-1,t.y-2),cc.v3(t.x+2,t.y+4),cc.v3(t.x+2,t.y-4),cc.v3(t.x-2,t.y+4),cc.v3(t.x-2,t.y-4),cc.v3(t.x+3,t.y+5),cc.v3(t.x+3,t.y-5),cc.v3(t.x-3,t.y+5),cc.v3(t.x-3,t.y-5),cc.v3(t.x+2,t.y+6),cc.v3(t.x+2,t.y-6),cc.v3(t.x-2,t.y+6),cc.v3(t.x-2,t.y-6),cc.v3(t.x+4,t.y+6),cc.v3(t.x+4,t.y-6),cc.v3(t.x-4,t.y+6),cc.v3(t.x-4,t.y-6)],o=0;o<i.length;o++){var a=new c.default;a.physicalDamage=3,e.shooter.dungeon=e.dungeon,e.shooter.fireAoe(e.selfThron,(new y.default).init(0,2,.4,4,m.default.getActorZIndex(r.default.getPosInMap(i[o])),!0,!0,!0,!1,!0,a,f.default.getClone("\u51b0\u523a","bossicethron02"),[h.default.FROZEN]),r.default.getPosInMap(i[o]).subSelf(e.getCenterPosition()),0,null,!0)}},1.5),e.scheduleOnce(function(){e.thronSkill.IsExcuting=!1},4)},15,!0)},e.prototype.thronSelf=function(){this.scheduleOnce(function(){d.default.play(d.default.SKILL_ICETHRON)},1);var t=[0,45,90,135,180,225,270,315],e=[cc.v3(0,40),cc.v3(-20,20),cc.v3(-40,0),cc.v3(-20,-20),cc.v3(0,-40),cc.v3(20,-20),cc.v3(40,0),cc.v3(20,20)],i=[cc.v3(0,-40),cc.v3(-20,-20),cc.v3(-40,0),cc.v3(-20,20),cc.v3(0,40),cc.v3(20,20),cc.v3(40,0),cc.v3(20,-20)],o=new c.default;o.magicDamage=1;for(var a=0;a<t.length;a++)this.shooter.dungeon=this.dungeon,this.shooter.fireAoe(this.selfThron,(new y.default).init(0,2,.4,3,m.default.OVERHEAD,!0,!0,!0,!1,!0,o,f.default.getClone(this.actorName(),"bossicepart01"),[h.default.FROZEN]),cc.v3(this.isFaceRight?e[a]:i[a]),t[a],null,!0)},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){t.meleeSkill.IsExcuting=!0,cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("IceDemonAttack001"),t.scheduleOnce(function(){d.default.play(d.default.BOOS_ICEDEMON_ATTACK);var e=t.getMovePos();e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf());var i=e.x,o=e.y,a=cc.v2(i,o);a=a.mul(1500),t.rigidbody.linearVelocity=a},1),t.scheduleOnce(function(){t.meleeSkill.IsExcuting=!1},2)},3,!0)},e.prototype.dash=function(){var t=this;this.dashSkill.next(function(){t.dashSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.scheduleOnce(function(){d.default.play(d.default.BOSS_ICEDEMON_DASH)},2.5),t.anim.play("IceDemonDash"),t.scheduleOnce(function(){var e=t.getMovePos();e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf());var i=e.x,o=e.y,a=cc.v2(i,o);a=a.mul(2500),t.rigidbody.linearVelocity=a},2.4),t.scheduleOnce(function(){t.dashSkill.IsExcuting=!1},3)},8,!0)},e.prototype.defence=function(t){var e=this;this.defenceSkill.next(function(){e.defenceSkill.IsExcuting=!0,e.anim||(e.anim=e.getComponent(cc.Animation)),e.anim.play("IceDemonDefence"),e.data.Common.defence=9999,e.data.Common.magicDefence=9999,d.default.play(d.default.BOSS_ICEDEMON_DEFEND),e.scheduleOnce(function(){e.defenceSkill.IsExcuting=!1,e.data.Common.defence=0,e.data.Common.magicDefence=0},3),t&&(e.magicice.isShow&&e.magicice.breakIce(),e.thronSelf())},6,!0)},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a)},e.prototype.showBoss=function(){this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied,this.sc.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.move=function(t,e){if(!this.sc.isDied){t.equals(cc.Vec3.ZERO)||(this.pos=r.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.isMoving?this.anim.getAnimationState("IceDemonWalk").isPlaying||this.anim.playAdditive("IceDemonWalk"):this.anim.getAnimationState("IceDemonWalk").isPlaying&&this.anim.play("IceDemonIdle"),this.changeZIndex()}},e.prototype.onCollisionEnter=function(t){var e=v.default.getEnemyCollisionTarget(t);if(e&&(this.meleeSkill.IsExcuting||this.dashSkill.IsExcuting)&&!this.sc.isDied){var i=new c.default;i.physicalDamage=3;var o=f.default.getClone(this.actorName(),"bossicepart01");e.takeDamage(i,o,this)&&e.addStatus(h.default.FROZEN,o)}},e.prototype.actorName=function(){return"\u51b0\u9b54"},n([S(cc.Prefab)],e.prototype,"groundThron",void 0),n([S(cc.Prefab)],e.prototype,"selfThron",void 0),n([S(E.default)],e.prototype,"magicice",void 0),n([D],e)}(p.default);i.default=R,cc._RF.pop()},{"../Achievement":"Achievement","../Data/AreaOfEffectData":"AreaOfEffectData","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Talent/MagicIce":"MagicIce","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","../Utils/NextStep":"NextStep","./Boss":"Boss"}],IceThron:[function(t,e,i){"use strict";cc._RF.push(e,"732e0QfOMxFu5eXTn+nHJEI","IceThron");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/FromData"),l=t("../Manager/StatusManager"),c=t("../Utils/IndexZ"),h=t("../Utils/ActorUtils"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasTargetMap={},e.isAttacking=!1,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.AnimFinish=function(){var t=this;this.isAttacking=!1,this.scheduleOnce(function(){t.node&&t.node.destroy()},1)},e.prototype.show=function(t,e,i,o){this.player=t,this.node.active=!0,this.node.parent=t.node.parent,this.node.setPosition(this.getPlayerPosition(t,e,i)),this.node.scale=o,e>90&&e<270&&(this.node.scaleX=-this.node.scaleX),this.isAttacking=!0,this.node.zIndex=c.default.getActorZIndex(this.node.position)},e.prototype.getPlayerPosition=function(t,e,i){var o=t.Hv.clone(),a=cc.v3(cc.v2(o).rotateSelf(e*Math.PI/180)).normalizeSelf();return t.node.position.clone().addSelf(a.mulSelf(i))},e.prototype.onCollisionStay=function(t,e){!e.size.equals(cc.Size.ZERO)&&this.isAttacking&&(this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0?this.hasTargetMap[t.node.uuid]++:(this.hasTargetMap[t.node.uuid]=1,h.default.getEnemyCollisionTarget(t,!0)&&this.attacking(t.node)))},e.prototype.attacking=function(t){if(t){var e=new r.default,i=l.default.FROZEN;e.magicDamage=4;var o=h.default.getEnemyActorByNode(t,!0);o&&!o.sc.isDied&&(o.takeDamage(e),o.addStatus(i,new s.default))}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.5&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&(this.hasTargetMap={})},n([u],e)}(cc.Component));i.default=d,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils","../Utils/IndexZ":"IndexZ"}],IndexZ:[function(t,e,i){"use strict";cc._RF.push(e,"ee2b0v0Hy5Er7bVWcKf3jFS","IndexZ"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.getActorZIndex=function(e){return t.ACTOR+3e3-e.y},t.BACKGROUND=100,t.BACKGROUNDFLOOR=300,t.DOORWALLBEHIND=400,t.BASE=500,t.FLOOR=600,t.WATER=610,t.KRAKENBODY=620,t.DARKNESS=650,t.WALL=700,t.WALLCORNER=800,t.WALLINTERNAL=900,t.ACTOR=2e3,t.OVERHEAD=6e3,t.ROOF=6100,t.SHADOW=6200,t.FOG=6500,t.UI=7e3,t}();i.default=o,cc._RF.pop()},{}],InteractBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"7b8abAQqgxLbKCSpiTgLOQk","InteractBuilding");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("./Building"),c=t("../EventHelper"),h=t("../Utils/AudioPlayer"),p=t("../Item/Item"),u=t("../Utils/IndexZ"),d=t("../Data/DamageData"),f=t("../Actor/ColliderTag"),g=t("../Boss/Boss"),y=t("../Data/AvatarData"),m=t("../Data/CommonData"),v=t("../Data/FromData"),E=t("../Manager/StatusManager"),_=t("../NonPlayer"),D=t("./Box"),S=t("./HitBuilding"),R=cc._decorator,T=R.ccclass,O=(R.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.decorateType=0,e.resName="decorate000",e.isTaken=!1,e.isAttacking=!1,e.isThrowing=!1,e.isLift=!1,e.isAniming=!1,e.hasTargetMap={},e.saveTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.shadow=this.node.getChildByName("shadow"),this.rigidBody=this.getComponent(cc.RigidBody)},e.prototype.start=function(){},e.prototype.init=function(t,e){switch(this.decorateType=e,this.data.interact=t?1:0,s.default.chapterIndex){case s.default.CHAPTER00:this.resName="decorate000"+this.decorateType;break;case s.default.CHAPTER01:this.resName="decorate010"+this.decorateType;break;case s.default.CHAPTER02:this.resName="decorate020"+this.decorateType;break;case s.default.CHAPTER03:this.resName="decorate030"+this.decorateType;break;case s.default.CHAPTER04:case s.default.CHAPTER05:this.resName="decorate040"+this.decorateType;break;case s.default.CHAPTER099:this.resName="decorate000"+this.decorateType}this.updateCollider(),this.changeRes(this.resName)},e.prototype.updateCollider=function(){var t=s.default.spriteFrameRes(this.resName),e=t.getRect().width*this.sprite.node.scale,i=t.getRect().height*this.sprite.node.scale/4,o=this.getComponent(cc.PhysicsBoxCollider),a=this.getComponent(cc.BoxCollider);0==this.sprite.node.angle?(o.size=cc.size(e,i),a.size=cc.size(e+5,i+5)):(o.size=cc.size(i,e),a.size=cc.size(i+5,e+5)),o.density=this.isThrowing?1:300,o.sensor=this.data.currentHealth<=0,o.apply()},e.prototype.changeRes=function(t,e){this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite));var i=s.default.spriteFrameRes(t);e&&s.default.spriteFrameRes(t+e)&&(i=s.default.spriteFrameRes(t+e)),this.sprite.node.opacity=255,this.sprite.spriteFrame=i,this.mat||(this.mat=this.node.getChildByName("sprite").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("textureSizeWidth",i.getTexture().width*this.sprite.node.scaleX),this.mat.setProperty("textureSizeHeight",i.getTexture().height*this.sprite.node.scaleY),this.mat.setProperty("outlineColor",cc.Color.WHITE),this.sprite.node.angle=this.data.rollover>0?90:0},e.prototype.BreakingFinish=function(){this.reset()},e.prototype.hitLight=function(t){this.mat||(this.mat=this.node.getChildByName("sprite").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT)},e.prototype.highLight=function(t){this.mat||(this.mat=this.node.getChildByName("sprite").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("openOutline",t?1:0)},e.prototype.takeDamage=function(t){var e=this;if(!(this.data.currentHealth<=0))return this.data.currentHealth-=t.getTotalDamage(),h.default.play(h.default.MONSTER_HIT),this.data.currentHealth>0?(this.hitLight(!0),this.scheduleOnce(function(){e.hitLight(!1)},.1),!0):(this.isTaken=!1,cc.tween(this.sprite.node).call(function(){e.changeRes(e.resName,"anim001"),e.hitLight(!0)}).delay(.1).call(function(){e.hitLight(!1),e.changeRes(e.resName,"anim002")}).delay(.1).call(function(){e.changeRes(e.resName,"anim003")}).delay(.1).call(function(){e.changeRes(e.resName,"anim004"),e.updateCollider();var t=s.default.mapManager.getRandom4Save(s.default.mapManager.getRebornSeed(e.seed)),i=t.rand();i>.6&&i<.8?cc.director.emit(c.EventHelper.DUNGEON_ADD_COIN,{detail:{pos:e.node.position,count:t.getRandomNum(1,3)}}):i>=.8&&i<.85?cc.director.emit(c.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:e.node.position,res:p.default.HEART}}):i>=.85&&i<.9&&cc.director.emit(c.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:e.node.position,res:p.default.DREAM}})}).delay(10).call(function(){e.reset()}).start(),!0)},e.prototype.reset=function(){this.node.position=r.default.getPosInMap(cc.v3(-10,-10)),this.data.currentHealth=this.data.maxHealth},e.prototype.rollover=function(){this.data.rollover=this.data.rollover>0?0:1,cc.tween(this.sprite.node).to(.5,{angle:this.data.rollover>0?90:0},{easing:"bounceOut"}).start(),this.updateCollider()},e.prototype.interact=function(t,e,i,o){return!(this.data.interact<1||this.isAniming)&&(this.player=t,i?this.attack():o?this.throwOrKick():e?this.putDown():this.switchMode())},e.prototype.taken=function(t,e){if(!(this.data.interact<1||this.isAniming))return this.player=t,!this.isTaken&&(e?(this._taken(),!0):(this.rollover(),!1))},e.prototype._taken=function(){if(!this.isAniming)return this.isTaken=!0,this.isLift=!0,!0},e.prototype.putDown=function(){if(!this.isAniming)return this.isTaken=!1,!0},e.prototype.switchMode=function(){if(!this.isAniming)return this.isLift=!this.isLift,!0},e.prototype.throwOrKick=function(){var t=this;if(!this.isAniming&&!this.isThrowing)return this.isAttacking=!0,this.isThrowing=!0,this.isAniming=!0,h.default.play(h.default.MELEE),this.updateCollider(),this.beatBack(this.node,this.player.Hv.clone(),this.isLift?2e3:3e3),this.scheduleOnce(function(){cc.director.emit(c.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}})},this.isLift?.5:0),this.isLift&&(cc.tween(this.sprite.node).to(.2,{position:cc.v3(0,128)}).to(.2,{position:cc.v3(0,0)},{easing:"bounceOut"}).start(),cc.tween(this.shadow).to(.5,{scale:3}).to(.5,{scale:4}).start()),this.scheduleOnce(function(){t.isAniming=!1,t.isAttacking=!1,t.isTaken=!1,t.isThrowing=!1,t.updateCollider()},1),!0},e.prototype.attack=function(){var t=this;if(!this.isTaken||this.isAniming||!this.player)return!1;this.isAniming=!0,this.hasTargetMap={},h.default.play(h.default.MELEE);if(this.isLift){var e=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(-32,0))),i=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(64,0)));cc.tween(this.sprite.node).to(.2,{position:cc.v3(0,64)}).call(function(){t.isAttacking=!0}).to(.1,{position:cc.v3(0,96)}).to(.1,{position:cc.v3(0,0)}).call(function(){t.isAttacking=!1}).to(.2,{position:cc.v3(0,96)}).call(function(){t.isAniming=!1}).start(),cc.tween(this.node).to(.2,{position:e}).to(.2,{position:i}).start()}else{e=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(0,64))),i=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(44.8,44.8)));var o=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(64,0))),a=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(44.8,-44.8))),n=this.node.parent.convertToNodeSpaceAR(this.player.weaponLeft.meleeWeapon.node.convertToWorldSpaceAR(cc.v3(0,-64)));cc.tween(this.node).to(.15,{position:e}).call(function(){t.isAttacking=!0}).to(.1,{position:i}).to(.1,{position:o}).to(.1,{position:a}).to(.1,{position:n}).to(.1,{position:a}).to(.1,{position:o}).call(function(){t.isAttacking=!1,t.isAniming=!1}).start()}return!0},e.prototype.onPreSolve=function(t,e,i){i.tag!=f.ColliderTag.NONPLAYER&&i.tag!=f.ColliderTag.PLAYER&&i.tag!=f.ColliderTag.GOODNONPLAYER||(this.isTaken||this.isAttacking)&&(t.disabledOnce=!0)},e.prototype.onCollisionStay=function(t){if(t.tag!=f.ColliderTag.PLAYER&&this.player&&this.isTaken&&this.isAttacking)return t.tag!=f.ColliderTag.BUILDING&&t.tag!=f.ColliderTag.WALL&&t.tag!=f.ColliderTag.WALL_TOP||this.isThrowing&&(this.rigidBody.linearVelocity=cc.Vec2.ZERO),this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0?(this.hasTargetMap[t.node.uuid]++,!1):(this.hasTargetMap[t.node.uuid]=1,this.attacking(t))},e.prototype.updatePosition=function(){if(this.shadow.opacity=255,this.player&&this.isTaken&&(this.shadow.opacity=this.isThrowing?255:0,!this.isAniming))if(this.isLift)this.sprite.node.position=s.default.lerpPos(this.sprite.node.position,cc.v3(0,96),.1),this.node.position=s.default.lerpPos(this.node.position,this.player.node.position.clone(),.1);else{var t=this.player.Hv.clone().mul(64),e=this.player.node.position.add(t);this.sprite.node.position=s.default.lerpPos(this.sprite.node.position,cc.v3(0,0),.1),this.node.position=s.default.lerpPos(this.node.position,e,.1)}this.node.zIndex=u.default.getActorZIndex(this.node.position)},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isSaveTimeDelay=function(t){return this.saveTimeDelay+=t,this.saveTimeDelay>.2&&(this.saveTimeDelay=0,!0)},e.prototype.update=function(t){if(this.isTimeDelay(t)&&this.updatePosition(),this.isSaveTimeDelay(t)){this.data.position=this.node.position;var e=s.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);e&&e.valueCopy(this.data)}},e.prototype.beatBack=function(t,e,i){var o=t.getComponent(cc.RigidBody),a=e;a.equals(cc.Vec3.ZERO)&&(a=cc.v3(1,0)),a=a.normalizeSelf().mul(i),this.scheduleOnce(function(){o.applyLinearImpulse(cc.v2(a.x,a.y),o.getLocalCenter(),!0)},.1)},e.prototype.attacking=function(t){if(!t||!this.isAttacking)return!1;var e=new d.default,i=new m.default;this.player&&(e=this.player.data.getFinalAttackPoint(),i=this.player.data.FinalCommon),e.isMelee=!0,e.physicalDamage+=this.isThrowing?5:3;var o=!1,a=!1;if(t.tag==f.ColliderTag.NONPLAYER){var n=t.node.getComponent(_.default);n&&!n.sc.isDied&&n.data.isEnemy>0&&(e.isBackAttack=n.isPlayerBehindAttack()&&i.damageBack>0,e.isBackAttack&&(e.realDamage+=i.damageBack),(o=n.takeDamage(e))&&(this.beatBack(n.node,this.player.Hv.clone(),500),this.addTargetAllStatus(i,n)))}else if(t.tag==f.ColliderTag.BOSS){var r=t.node.getComponent(g.default);r&&!r.sc.isDied&&(o=r.takeDamage(e))&&this.addTargetAllStatus(i,r)}else if(t.tag==f.ColliderTag.BUILDING||t.tag==f.ColliderTag.WALL){var s=t.node.getComponent(D.default);if(s&&(a=!0,s.breakBox()),!a){var l=t.node.getComponent(S.default);l&&(a=!0,l.takeDamage(e))}}return(o||a)&&cc.director.emit(c.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}}),o&&this.player.data.AvatarData.organizationIndex==y.default.TECH&&this.player.updateDream(-1),o||a},e.prototype.addTargetAllStatus=function(t,e){this.addTargetStatus(t.iceRate,e,E.default.FROZEN),this.addTargetStatus(t.fireRate,e,E.default.BURNING),this.addTargetStatus(t.lighteningRate,e,E.default.DIZZ),this.addTargetStatus(t.toxicRate,e,E.default.TOXICOSIS),this.addTargetStatus(t.curseRate,e,E.default.CURSING),this.addTargetStatus(t.realRate,e,E.default.BLEEDING)},e.prototype.addTargetStatus=function(t,e,i){s.default.getRandomNum(0,100)<t&&e.addStatus(i,new v.default)},e.BOX=0,e.PLANT=1,e.BOXBREAKABLE=2,n([T],e)}(l.default));i.default=O,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Boss/Boss":"Boss","../Data/AvatarData":"AvatarData","../Data/CommonData":"CommonData","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Item/Item":"Item","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../NonPlayer":"NonPlayer","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Box":"Box","./Building":"Building","./HitBuilding":"HitBuilding"}],InventoryData:[function(t,e,i){"use strict";cc._RF.push(e,"8d617FHrhNC9JdBH0sgyrgd","InventoryData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./BaseData"),r=t("./EquipmentData"),s=t("./ItemData"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.createTime=0,e.type=0,e}return a(e,t),e.prototype.valueCopy=function(t){t&&(this.type=t.type?t.type:0,t.equipmentData&&(this.equipmentData=new r.default,this.equipmentData.valueCopy(t.equipmentData)),t.itemData&&(this.itemData=new s.default,this.itemData.valueCopy(t.itemData)),this.itemData=t.itemData,this.createTime=t.createTime?t.createTime:0)},e.prototype.clone=function(){var t=new e;return t.equipmentData=this.equipmentData,t.itemData=this.itemData,t.createTime=this.createTime,t.type=this.type,t},e.prototype.setEmpty=function(){this.type=0,this.equipmentData=null,this.itemData=null,this.createTime=0},e}(n.default);i.default=l,cc._RF.pop()},{"./BaseData":"BaseData","./EquipmentData":"EquipmentData","./ItemData":"ItemData"}],InventoryDialog:[function(t,e,i){"use strict";cc._RF.push(e,"66439SRIlRDCK2s/WLS+qDi","InventoryDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../Data/AvatarData"),s=t("../../Data/InventoryData"),l=t("../../Equipment/EquipmentDialog"),c=t("../../EventHelper"),h=t("../../Item/Item"),p=t("../../Item/ItemDialog"),u=t("../../Logic"),d=t("../../Manager/InventoryManager"),f=t("../../Utils/AudioPlayer"),g=t("../InventoryItem"),y=t("./BaseDialog"),m=cc._decorator,v=m.ccclass,E=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e.layout=null,e.toggleContainer=null,e.equipmentDialog=null,e.itemDialog=null,e.useButton=null,e.dropButton=null,e.saleButton=null,e.list=[],e.select=null,e.discountLabel=null,e.discount=.6,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.select.opacity=0,this.layout.removeAllChildren();for(var e=0;e<d.default.INVENTORY_MAX;e++){var i=new s.default;i.createTime=(new Date).getTime(),this.list.push(this.getItem(e,i))}cc.director.on(c.EventHelper.HUD_INVENTORY_ALL_UPDATE,function(){t.node&&t.updateList(u.default.bagSortIndex)}),cc.director.on(c.EventHelper.HUD_INVENTORY_ITEM_UPDATE,function(e){if(t.node){var i=u.default.inventoryManager.inventoryList[e.detail.index];t.list[e.detail.index].updateData(i)}}),this.toggleContainer.toggleItems[u.default.bagSortIndex].isChecked=!0,u.default.playerData.AvatarData.organizationIndex==r.default.HUNTER&&(this.discount=.8)},e.prototype.getItem=function(t,e){var i=cc.instantiate(this.item);i.parent=this.layout;var o=i.getComponent(g.default);return o.init(this,t,e),o},e.prototype.start=function(){},e.prototype.show=function(){t.prototype.show.call(this),this.updateList(u.default.bagSortIndex)},e.prototype.changeSort=function(t,e){u.default.bagSortIndex=e,this.updateList(e)},e.prototype.clearSelect=function(){this.currentSelectIndex=-1,this.itemDialog.hideDialog(),this.equipmentDialog.hideDialog(),this.useButton.active=!1,this.dropButton.active=!1,this.saleButton.active=!1,this.select.opacity=0},e.prototype.showSelect=function(t){this.currentSelectIndex=t.index,this.select.position=this.node.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(cc.Vec3.ZERO)),this.select.opacity=200,f.default.play(f.default.SELECT),t.data.type==g.default.TYPE_EQUIP?(this.discountLabel.string="-"+100*this.discount+"%("+Math.floor(t.data.equipmentData.price*this.discount)+")",this.useButton.active=!0,this.dropButton.active=!0,this.saleButton.active=!0,this.itemDialog.hideDialog(),this.equipmentDialog.showDialog(t.data.equipmentData)):(this.discountLabel.string="-"+100*this.discount+"%("+Math.floor(t.data.itemData.count>1?t.data.itemData.price*t.data.itemData.count*this.discount:t.data.itemData.price*this.discount)+")",this.useButton.active=!0,this.dropButton.active=!0,this.saleButton.active=!0,this.equipmentDialog.hideDialog(),this.itemDialog.showDialog(t.data.itemData))},e.prototype.updateList=function(t){this.clearSelect();for(var e=[],i=[],o=[],a=0;a<u.default.inventoryManager.inventoryList.length;a++)(n=u.default.inventoryManager.inventoryList[a]).type!=g.default.TYPE_EMPTY&&(o.push(n),n.type==g.default.TYPE_EQUIP?i.push(n):n.type==g.default.TYPE_ITEM&&e.push(n));for(0==t?o.sort(function(t,e){return t.createTime-e.createTime}):1==t?(e.sort(function(t,e){return t.createTime-e.createTime}),i.sort(function(t,e){return t.createTime-e.createTime}),o=i.concat(e)):2==t&&(e.sort(function(t,e){return t.createTime-e.createTime}),i.sort(function(t,e){return e.equipmentData.level-t.equipmentData.level}),o=i.concat(e)),a=0;a<d.default.INVENTORY_MAX;a++)if(a<o.length&&o[a].type!=g.default.TYPE_EMPTY){var n=o[a];this.list[a].updateData(n)}else this.list[a].setEmpty();u.default.inventoryManager.inventoryList=o},e.prototype.use=function(){if(-1!=this.currentSelectIndex&&this.list[this.currentSelectIndex].data.type!=g.default.TYPE_EMPTY){f.default.play(f.default.SELECT);var t=this.list[this.currentSelectIndex];if(t.data.type==g.default.TYPE_EQUIP){var e=t.data.equipmentData.clone();e.equipmetType!=d.default.EMPTY&&(u.default.inventoryManager.inventoryList[this.currentSelectIndex].setEmpty(),this.list[this.currentSelectIndex].setEmpty(),c.EventHelper.emit(c.EventHelper.PLAYER_CHANGEEQUIPMENT,{equipData:e,isReplace:!0,index:this.currentSelectIndex}))}else{var i=t.data.itemData.clone();i.resName!=h.default.EMPTY&&(u.default.inventoryManager.inventoryList[this.currentSelectIndex].setEmpty(),this.list[this.currentSelectIndex].setEmpty(),c.EventHelper.emit(c.EventHelper.PLAYER_CHANGEITEM,{itemData:i,isReplace:!0,index:this.currentSelectIndex}))}this.clearSelect()}},e.prototype.drop=function(){if(-1!=this.currentSelectIndex&&this.list[this.currentSelectIndex].data.type!=g.default.TYPE_EMPTY){f.default.play(f.default.SELECT);var t=this.list[this.currentSelectIndex];if(t.data.type==g.default.TYPE_EQUIP){var e=t.data.equipmentData;e.equipmetType!=d.default.EMPTY&&c.EventHelper.emit(c.EventHelper.DUNGEON_SETEQUIPMENT,{res:e.img,equipmentData:e})}else{var i=t.data.itemData;i.resName!=h.default.EMPTY&&c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_ITEM,{res:i.resName,count:i.count})}u.default.inventoryManager.inventoryList[this.currentSelectIndex].setEmpty(),this.list[this.currentSelectIndex].setEmpty(),this.clearSelect()}},e.prototype.sale=function(){if(-1!=this.currentSelectIndex&&this.list[this.currentSelectIndex].data.type!=g.default.TYPE_EMPTY){var t=this.list[this.currentSelectIndex];if(t.data.type==g.default.TYPE_EQUIP){var e=t.data.equipmentData;e.equipmetType!=d.default.EMPTY&&(c.EventHelper.emit(c.EventHelper.HUD_ADD_COIN,{count:Math.floor(e.price*this.discount)}),f.default.play(f.default.COIN))}else{var i=t.data.itemData;i.resName!=h.default.EMPTY&&(c.EventHelper.emit(c.EventHelper.HUD_ADD_COIN,{count:Math.floor(i.count>1?i.price*i.count*this.discount:i.price*this.discount)}),f.default.play(f.default.COIN))}u.default.inventoryManager.inventoryList[this.currentSelectIndex].setEmpty(),this.list[this.currentSelectIndex].setEmpty(),this.clearSelect()}},e.prototype.close=function(){f.default.play(f.default.SELECT),this.dismiss()},n([E(cc.Prefab)],e.prototype,"item",void 0),n([E(cc.Node)],e.prototype,"layout",void 0),n([E(cc.ToggleContainer)],e.prototype,"toggleContainer",void 0),n([E(l.default)],e.prototype,"equipmentDialog",void 0),n([E(p.default)],e.prototype,"itemDialog",void 0),n([E(cc.Node)],e.prototype,"useButton",void 0),n([E(cc.Node)],e.prototype,"dropButton",void 0),n([E(cc.Node)],e.prototype,"saleButton",void 0),n([E(cc.Node)],e.prototype,"select",void 0),n([E(cc.Label)],e.prototype,"discountLabel",void 0),n([v],e)}(y.default);i.default=_,cc._RF.pop()},{"../../Data/AvatarData":"AvatarData","../../Data/InventoryData":"InventoryData","../../Equipment/EquipmentDialog":"EquipmentDialog","../../EventHelper":"EventHelper","../../Item/Item":"Item","../../Item/ItemDialog":"ItemDialog","../../Logic":"Logic","../../Manager/InventoryManager":"InventoryManager","../../Utils/AudioPlayer":"AudioPlayer","../InventoryItem":"InventoryItem","./BaseDialog":"BaseDialog"}],InventoryItem:[function(t,e,i){"use strict";cc._RF.push(e,"51ad8KPmpFIULMuWCViUiMp","InventoryItem");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/InventoryData"),s=t("../Logic"),l=t("../Manager/InventoryManager"),c=cc._decorator,h=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSelect=!1,e.sprite=null,e.label=null,e.index=0,e.data=new r.default,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.isSelect&&t.index==t.dialog.currentSelectIndex?t.isSelect=!1:t.isSelect=t.data.type!=i.TYPE_EMPTY,t.dialog.clearSelect(),t.isSelect&&t.dialog.showSelect(t)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){},this)},e.prototype.init=function(t,e,i){this.dialog=t,this.index=e,this.isSelect=!1,this.updateData(i)},e.prototype.updateData=function(t){if(this.isSelect=!1,this.data.valueCopy(t),this.label.string="",this.sprite.spriteFrame=null,this.data.type==i.TYPE_ITEM&&this.data.itemData)this.label.string=t.itemData.count>0?"x"+t.itemData.count:"",this.sprite.spriteFrame=s.default.spriteFrameRes(this.data.itemData.resName);else if(this.data.equipmentData){var e=s.default.spriteFrameRes(this.data.equipmentData.img);this.data.equipmentData.equipmetType==l.default.CLOTHES?e=s.default.spriteFrameRes(this.data.equipmentData.img+"anim0"):this.data.equipmentData.equipmetType==l.default.HELMET?e=s.default.spriteFrameRes(this.data.equipmentData.img+"anim0"):this.data.equipmentData.equipmetType==l.default.REMOTE&&(e=s.default.spriteFrameRes(this.data.equipmentData.img+"anim0")),this.sprite.spriteFrame=e}},e.prototype.setEmpty=function(){this.data.setEmpty(),this.label.string="",this.sprite.spriteFrame=null},e.prototype.start=function(){},e.TYPE_EMPTY=0,e.TYPE_EQUIP=1,e.TYPE_ITEM=2,n([p(cc.Sprite)],e.prototype,"sprite",void 0),n([p(cc.Label)],e.prototype,"label",void 0),i=n([h],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../Data/InventoryData":"InventoryData","../Logic":"Logic","../Manager/InventoryManager":"InventoryManager"}],InventoryManager:[function(t,e,i){"use strict";cc._RF.push(e,"1dc08IgWM1D6q2nqBDxwhzD","InventoryManager"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Data/EquipmentData"),a=t("../Data/ItemData"),n=t("../Utils/NextStep"),r=function(){function t(){this.buffer=new o.default,this.itemList=[],this.inventoryList=[],this.itemCoolDownList=[],this.equips={},this.suitMap={},this.suitEquipMap={},this.emptyEquipData=new o.default;for(var e=0,i=t.EQUIP_TAGS;e<i.length;e++){var r=i[e];this.equips[r]=new o.default}for(var s=0;s<5;s++){var l=new a.default;l.count=-1,this.itemList.push(l),this.itemCoolDownList.push(new n.default)}this.suitMap={},this.suitEquipMap={}}return t.prototype.clear=function(){},t.prototype.getEquipBySuit=function(t){return t&&this.suitEquipMap[t.suitType]?this.suitEquipMap[t.suitType]:this.emptyEquipData},t.prototype.getTotalEquipData=function(){var t=new o.default;for(var e in this.equips)t.Common.add(this.equips[e].Common);for(var e in t.Common.add(this.buffer.Common),this.suitEquipMap){var i=this.suitEquipMap[e];i&&t.Common.add(i.Common)}return t},t.INVENTORY_MAX=30,t.EMPTY="empty",t.WEAPON="weapon",t.REMOTE="remote",t.SHIELD="shield",t.CLOTHES="clothes",t.HELMET="helmet",t.CLOAK="cloak",t.TROUSERS="trousers",t.SHOES="shoes",t.GLOVES="gloves",t.EQUIP_TAGS=[t.WEAPON,t.HELMET,t.CLOTHES,t.TROUSERS,t.GLOVES,t.SHOES,t.CLOAK,t.SHIELD,t.REMOTE],t}();i.default=r,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Data/ItemData":"ItemData","../Utils/NextStep":"NextStep"}],Inventory:[function(t,e,i){"use strict";cc._RF.push(e,"3b411lPIzZAv7ApO4pixeng","Inventory");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=t("./EventHelper"),h=t("./Logic"),p=t("./Data/EquipmentData"),u=t("./Equipment/EquipmentDialog"),d=t("./Manager/InventoryManager"),f=t("./Dungeon"),g=t("./Data/FromData"),y=t("./Data/ItemData"),m=t("./Item/Item"),v=t("./Item/ItemDialog"),E=t("./Data/SuitData"),_=t("./Data/InventoryData"),D=t("./UI/InventoryItem"),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dungeon=null,e.weapon=null,e.remote=null,e.shield=null,e.helmet=null,e.clothes=null,e.trousers=null,e.gloves=null,e.shoes=null,e.cloak=null,e.item1=null,e.item2=null,e.item3=null,e.item4=null,e.item5=null,e.equipmentDialog=null,e.itemDialog=null,e.equipmentGroundDialog=null,e.itemGroundDialog=null,e.graphics=null,e.suitTimeDelay=0,e.equipTimeDelays={},e.equipSprites={},e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.equipmentDialog.isInventory=!0,this.graphics=this.getComponent(cc.Graphics),this.inventoryManager=h.default.inventoryManager,cc.director.on(c.EventHelper.PLAYER_CHANGEEQUIPMENT,function(e){t.node&&(t.refreshEquipment(e.detail.equipData,!1,e.detail.isReplace,e.detail.index),t.refreshSuits())}),this.equipmentGroundDialog&&this.equipmentGroundDialog.hideDialog(),this.itemGroundDialog&&this.itemGroundDialog.hideDialog(),cc.director.on(c.EventHelper.PLAYER_CHANGEITEM,function(e){t.node&&t.refreshItem(e.detail.itemData,e.detail.isReplace,e.detail.index)}),cc.director.on(c.EventHelper.HUD_GROUND_EQUIPMENT_INFO_SHOW,function(e){t.equipmentGroundDialog&&t.equipmentGroundDialog.showDialog(e.detail.equipData)}),cc.director.on(c.EventHelper.HUD_GROUND_EQUIPMENT_INFO_HIDE,function(){t.equipmentGroundDialog&&t.equipmentGroundDialog.hideDialog()}),cc.director.on(c.EventHelper.HUD_GROUND_ITEM_INFO_SHOW,function(e){t.itemGroundDialog&&t.itemGroundDialog.showDialog(e.detail.itemData)}),cc.director.on(c.EventHelper.HUD_GROUND_ITEM_INFO_HIDE,function(){t.itemGroundDialog&&t.itemGroundDialog.hideDialog()}),cc.director.on(c.EventHelper.USEITEM_KEYBOARD,function(e){t.userItem(null,e.detail.index)}),this.remote.node.parent.active=!0,this.shield.node.parent.active=!1;for(var e=0,i=d.default.EQUIP_TAGS;e<i.length;e++){var o=i[e];this.equipTimeDelays[o]=0}this.equipSprites[d.default.WEAPON]=this.weapon,this.equipSprites[d.default.REMOTE]=this.remote,this.equipSprites[d.default.SHIELD]=this.shield,this.equipSprites[d.default.HELMET]=this.helmet,this.equipSprites[d.default.CLOTHES]=this.clothes,this.equipSprites[d.default.TROUSERS]=this.trousers,this.equipSprites[d.default.GLOVES]=this.gloves,this.equipSprites[d.default.SHOES]=this.shoes,this.equipSprites[d.default.CLOAK]=this.cloak},e.prototype.start=function(){for(var t in this.equipSprites)this.equipSprites[t].spriteFrame=null,this.addEquipSpriteTouchEvent(this.equipSprites[t],t);for(var t in this.inventoryManager.equips)this.refreshEquipment(this.inventoryManager.equips[t],!0);this.refreshItemRes();for(var e=[this.item1,this.item2,this.item3,this.item4,this.item5],i=0;i<e.length;i++)this.addItemSpriteTouchEvent(e[i],i);this.refreshSuits()},e.prototype.addEquipSpriteTouchEvent=function(t,e){var i=this;t.node.parent.on(cc.Node.EventType.TOUCH_START,function(){if(null!=t.spriteFrame){var o=new p.default;i.inventoryManager.equips[e]&&(o=i.inventoryManager.equips[e].clone()),i.equipmentDialog.showDialog(o,i.inventoryManager)}}),t.node.parent.on(cc.Node.EventType.TOUCH_END,function(){i.equipmentDialog.hideDialog()}),t.node.parent.on(cc.Node.EventType.TOUCH_CANCEL,function(){i.equipmentDialog.hideDialog()})},e.prototype.addItemSpriteTouchEvent=function(t,e){var i=this,o=!1,a=!1;t.node.parent.parent.on(cc.Node.EventType.TOUCH_START,function(){null!=t.spriteFrame&&(a=!0,i.scheduleOnce(function(){if(a&&i.inventoryManager&&i.inventoryManager.itemList&&!(e>i.inventoryManager.itemList.length-1)){o=!0;var t=i.inventoryManager.itemList[e].clone();t.resName!=m.default.EMPTY&&i.itemDialog.showDialog(t)}},.3))}),t.node.parent.parent.on(cc.Node.EventType.TOUCH_END,function(){i.itemDialog.hideDialog(),o||i.userItem(t.node,e),a=!1,o=!1}),t.node.parent.parent.on(cc.Node.EventType.TOUCH_CANCEL,function(){i.itemDialog.hideDialog(),a=!1,o=!1})},e.prototype.setItemToBag=function(t,e){for(var i=h.default.inventoryManager.inventoryList,o=i.length<d.default.INVENTORY_MAX?i.length:-1,a=e&&e>-1&&e<i.length,n=i.length-1;n>=0;n--){var r=i[n];if(r.type==D.default.TYPE_EMPTY)o=n;else if(r.type==D.default.TYPE_ITEM&&this.isItemEqualCanAdd(r.itemData,t)){var s=r.itemData.count+t.count;return r.itemData=new y.default,r.itemData.valueCopy(t),r.itemData.count=s,void(a&&c.EventHelper.emit(c.EventHelper.HUD_INVENTORY_ITEM_UPDATE,{index:e}))}}var l=new _.default;if(l.itemData=new y.default,l.itemData.valueCopy(t),l.type=D.default.TYPE_ITEM,l.createTime=(new Date).getTime(),a)i[e]=new _.default,i[e].valueCopy(l),c.EventHelper.emit(c.EventHelper.HUD_INVENTORY_ITEM_UPDATE,{index:e});else if(-1==o){var p=this.dungeon.player.node.position.clone();t.resName!=m.default.EMPTY&&c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_ITEM,{pos:p,res:t.resName,count:t.count})}else{var u=new _.default;u.valueCopy(l),o<i.length?i[o]=u:i.push(u),c.EventHelper.emit(c.EventHelper.HUD_INVENTORY_ALL_UPDATE)}},e.prototype.setEquipmentToBag=function(t,e,i){if(!e&&t.equipmetType!=d.default.EMPTY){for(var o=h.default.inventoryManager.inventoryList,a=o.length<d.default.INVENTORY_MAX?o.length:-1,n=i&&i>-1&&i<o.length,r=0;r<o.length;r++)if(o[r].type==D.default.TYPE_EMPTY){a=r;break}var s=new _.default;if(s.equipmentData=new p.default,s.equipmentData.valueCopy(t),s.type=D.default.TYPE_EQUIP,s.createTime=(new Date).getTime(),n)o[i]=new _.default,o[i].valueCopy(s),c.EventHelper.emit(c.EventHelper.HUD_INVENTORY_ITEM_UPDATE,{index:i});else if(-1==a){var l=this.dungeon.player.node.position.clone();t.equipmetType!=d.default.EMPTY&&c.EventHelper.emit(c.EventHelper.DUNGEON_SETEQUIPMENT,{pos:l,res:t.img,equipmentData:t})}else{var u=new _.default;u.valueCopy(s),a<o.length?o[a]=u:o.push(u),c.EventHelper.emit(c.EventHelper.HUD_INVENTORY_ALL_UPDATE)}}},e.prototype.refreshSuits=function(){for(var t in this.inventoryManager.suitMap={},this.inventoryManager.suitEquipMap={},this.inventoryManager.equips){var e=this.inventoryManager.equips[t];if(!(e.suitType.length<1))if(this.inventoryManager.suitMap[e.suitType])this.inventoryManager.suitMap[e.suitType].count++;else{var i=new E.default;i.valueCopy(h.default.suits[e.suitType]),i.count=1,this.inventoryManager.suitMap[e.suitType]=i}}for(var t in this.inventoryManager.suitMap){var o=this.inventoryManager.suitMap[t],a=new p.default;if(o){for(var n=0;n<o.count-1;n++)n<o.EquipList.length&&(a.add(o.EquipList[n]),this.dungeon&&this.dungeon.player&&this.dungeon.player.addStatus(o.EquipList[n].statusName,new g.default));this.inventoryManager.suitEquipMap[t]=a}}},e.prototype.refreshEquipment=function(t,e,i,o){if(t&&this.weapon){var a=this.inventoryManager.equips[t.equipmetType],n=a&&a.equipmetType!=d.default.EMPTY;if(n||(t.equipmetType==d.default.REMOTE&&this.inventoryManager.equips[d.default.SHIELD].equipmetType!=d.default.EMPTY&&(n=!0),t.equipmetType==d.default.SHIELD&&this.inventoryManager.equips[d.default.REMOTE].equipmetType!=d.default.EMPTY&&(n=!0)),i||e||!a||!n){var r=cc.color(255,255,255).fromHEX(t.color),s=h.default.spriteFrameRes(t.img);t.equipmetType==d.default.CLOTHES?s=h.default.spriteFrameRes(t.img+"anim0"):t.equipmetType==d.default.HELMET?s=h.default.spriteFrameRes(t.img+"anim0"):t.equipmetType==d.default.REMOTE&&(s=h.default.spriteFrameRes(t.img+"anim0")),a&&(this.setEquipmentToBag(a,e,o),a.valueCopy(t));var l=this.equipSprites[t.equipmetType];switch(l&&(l.node.color=r,l.spriteFrame=1==t.trouserslong?h.default.spriteFrameRes("trousers000"):s,t.equipmetType==d.default.TROUSERS&&1==t.trouserslong&&(l.spriteFrame=h.default.spriteFrameRes("trousers000"))),t.equipmetType){case d.default.REMOTE:this.remote.node.parent.active=!0,this.shield.node.parent.active=!0,this.setEquipmentToBag(this.inventoryManager.equips[d.default.SHIELD],e,o),this.inventoryManager.equips[d.default.SHIELD].valueCopy(new p.default),this.shield.spriteFrame=h.default.spriteFrameRes(this.inventoryManager.equips[d.default.SHIELD].img),this.shield.node.parent.active=!1;break;case d.default.SHIELD:this.remote.node.parent.active=!0,this.shield.node.parent.active=!0,this.setEquipmentToBag(this.inventoryManager.equips[d.default.REMOTE],e,o),this.inventoryManager.equips[t.equipmetType].equipmetType!=d.default.EMPTY?(this.inventoryManager.equips[d.default.REMOTE].valueCopy(new p.default),this.remote.spriteFrame=h.default.spriteFrameRes(this.inventoryManager.equips[d.default.REMOTE].img),this.remote.node.parent.active=!1,this.shield.node.parent.active=!0):(this.remote.node.parent.active=!0,this.shield.node.parent.active=!1)}this.dungeon&&this.dungeon.player&&(this.dungeon.player.inventoryManager=this.inventoryManager,this.dungeon.player.changeEquipment(t,s),t.statusInterval>0&&t.statusName.length>0&&this.dungeon.player.addStatus(t.statusName,g.default.getClone(t.nameCn,t.img)))}else this.setEquipmentToBag(t,e,o)}},e.prototype.addPlayerStatus=function(t){this.dungeon&&this.dungeon.player&&t.statusInterval>0&&t.statusName.length>0&&this.dungeon.player.addStatus(t.statusName,g.default.getClone(t.nameCn,t.img))},e.prototype.getTimeDelay=function(t,e,i){return(t+=i)>e?t=0:t},e.prototype.isTimeDelay=function(t,e){return this.equipTimeDelays[e.equipmetType]=this.getTimeDelay(this.equipTimeDelays[e.equipmetType],e.statusInterval,t),0==this.equipTimeDelays[e.equipmetType]},e.prototype.update=function(t){if(!h.default.isGamePause){for(var e in this.inventoryManager.equips)this.isTimeDelay(t,this.inventoryManager.equips[e])&&this.addPlayerStatus(this.inventoryManager.equips[e]);for(var e in this.inventoryManager.suitMap){var i=this.inventoryManager.suitMap[e];if(i)for(var o=0;o<i.count-1;o++)o<i.EquipList.length&&(i.EquipList[o].equipmetType=i.suitType,this.isTimeDelay(t,i.EquipList[o])&&this.addPlayerStatus(i.EquipList[o]))}}},e.prototype.userItem=function(t,e){var i=this;if(this.inventoryManager&&this.inventoryManager.itemList&&!(e>this.inventoryManager.itemList.length-1)){var o=this.inventoryManager.itemList[e].clone();o.resName!=m.default.EMPTY&&this.inventoryManager.itemCoolDownList[e].next(function(){i.drawItemCoolDown(o.cooldown,t.convertToWorldSpaceAR(cc.Vec3.ZERO)),-1!=o.count&&o.count--,o.count<=0&&-1!=o.count?i.inventoryManager.itemList[e].valueCopy(h.default.items[m.default.EMPTY]):i.inventoryManager.itemList[e].valueCopy(o),i.refreshItemRes(),o.resName!=m.default.EMPTY&&cc.director.emit(c.EventHelper.PLAYER_USEITEM,{detail:{itemData:o}})},o.cooldown,!0)}},e.prototype.isItemEqualCanAdd=function(t,e){return t.resName!=m.default.EMPTY&&t.resName==e.resName&&t.count>0&&e.count>0},e.prototype.refreshItem=function(t,e,i){if(this.node){for(var o=!1,a=0;a<this.inventoryManager.itemList.length;a++){var n=this.inventoryManager.itemList[a];if(this.isItemEqualCanAdd(n,t)){var r=n.count+t.count;n.valueCopy(t),n.count=r,o=!0;break}}if(!o)for(a=0;a<this.inventoryManager.itemList.length;a++)if((n=this.inventoryManager.itemList[a]).resName==m.default.EMPTY){n.valueCopy(t),o=!0;break}if(!o)if(e){var s=this.inventoryManager.itemList[0].clone(),l=new Array;for(a=1;a<this.inventoryManager.itemList.length;a++)l.push(this.inventoryManager.itemList[a]);for(l.push(t),a=0;a<this.inventoryManager.itemList.length;a++)this.inventoryManager.itemList[a].valueCopy(l[a]);this.setItemToBag(s,i)}else this.setItemToBag(t,i);this.refreshItemRes()}},e.prototype.refreshItemRes=function(){for(var t=[this.item1,this.item2,this.item3,this.item4,this.item5],e=0;e<t.length;e++){var i=this.inventoryManager.itemList[e];t[e].spriteFrame=h.default.spriteFrameRes(i.resName),t[e].node.parent.parent.getComponentInChildren(cc.Label).string=i.count>0?"x"+i.count:""}},e.prototype.drawItemCoolDown=function(t,e){var i=this;if(!(t<=0)){var o=80,a=this.node.convertToNodeSpaceAR(e),n=o/t*.1,r=function(){o-=n,i.graphics&&i.graphics.clear(),i.drawRect(o,a),o<0&&(i.graphics&&i.graphics.clear(),i.unschedule(r))};this.schedule(r,.1,cc.macro.REPEAT_FOREVER)}},e.prototype.drawRect=function(t,e){this.graphics.fillColor=cc.color(255,255,255,150),this.graphics.rect(e.x-32,e.y-32,64,t),this.graphics.fill()},n([l(f.default)],e.prototype,"dungeon",void 0),n([l(cc.Sprite)],e.prototype,"weapon",void 0),n([l(cc.Sprite)],e.prototype,"remote",void 0),n([l(cc.Sprite)],e.prototype,"shield",void 0),n([l(cc.Sprite)],e.prototype,"helmet",void 0),n([l(cc.Sprite)],e.prototype,"clothes",void 0),n([l(cc.Sprite)],e.prototype,"trousers",void 0),n([l(cc.Sprite)],e.prototype,"gloves",void 0),n([l(cc.Sprite)],e.prototype,"shoes",void 0),n([l(cc.Sprite)],e.prototype,"cloak",void 0),n([l(cc.Sprite)],e.prototype,"item1",void 0),n([l(cc.Sprite)],e.prototype,"item2",void 0),n([l(cc.Sprite)],e.prototype,"item3",void 0),n([l(cc.Sprite)],e.prototype,"item4",void 0),n([l(cc.Sprite)],e.prototype,"item5",void 0),n([l(u.default)],e.prototype,"equipmentDialog",void 0),n([l(v.default)],e.prototype,"itemDialog",void 0),n([l(u.default)],e.prototype,"equipmentGroundDialog",void 0),n([l(v.default)],e.prototype,"itemGroundDialog",void 0),n([s],e)}(cc.Component);i.default=S,cc._RF.pop()},{"./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./Data/InventoryData":"InventoryData","./Data/ItemData":"ItemData","./Data/SuitData":"SuitData","./Dungeon":"Dungeon","./Equipment/EquipmentDialog":"EquipmentDialog","./EventHelper":"EventHelper","./Item/Item":"Item","./Item/ItemDialog":"ItemDialog","./Logic":"Logic","./Manager/InventoryManager":"InventoryManager","./UI/InventoryItem":"InventoryItem"}],ItemData:[function(t,e,i){"use strict";cc._RF.push(e,"371e21tzPlAtY0KmtggGqZV","ItemData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./BaseData"),r=t("./CommonData"),s=function(t){function e(){var e=t.call(this)||this;return e.uuid="",e.pos=cc.v3(0,0),e.nameCn="",e.nameEn="",e.duration=0,e.desc="",e.info="",e.resName="emptyitem",e.price=0,e.isTaken=!1,e.count=1,e.cooldown=1,e.statusList="",e.canSave=0,e.common=new r.default,e}return a(e,t),Object.defineProperty(e.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),e.prototype.valueCopy=function(t){this.uuid=t.uuid?t.uuid:"",this.common.valueCopy(t.common),this.pos=t.pos?cc.v3(t.pos.x,t.pos.y):cc.v3(0,0),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn,this.duration=t.duration,this.resName=t.resName?t.resName:"emptyitem",this.info=t.info?t.info:"",this.desc=t.desc?t.desc:"",this.isTaken=!!t.isTaken&&t.isTaken,this.canSave=t.canSave?t.canSave:0,this.count=t.count?t.count:1,this.cooldown=t.cooldown?t.cooldown:1,this.price=t.price?t.price:0,this.statusList=t.statusList?t.statusList:""},e.prototype.clone=function(){var t=new e;return t.uuid=this.uuid,t.common=this.common.clone(),t.pos=this.pos,t.nameCn=this.nameCn,t.nameEn=this.nameEn,t.duration=this.duration,t.info=this.info,t.desc=this.desc,t.resName=this.resName,t.isTaken=this.isTaken,t.canSave=this.canSave,t.count=this.count,t.cooldown=this.cooldown,t.price=this.price,t.statusList=this.statusList,t},e}(n.default);i.default=s,cc._RF.pop()},{"./BaseData":"BaseData","./CommonData":"CommonData"}],ItemDialog:[function(t,e,i){"use strict";cc._RF.push(e,"7261ctkcr1Hb5jd00yv55ME","ItemDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.infoBase=null,e.infoDesc=null,e.count=null,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.opacity=0},e.prototype.refreshDialog=function(t){this.labelTitle.string=""+t.nameCn,this.infoBase.string="\u4ef7\u683c\uff1a"+t.price+"\n"+t.info,this.infoDesc.string=t.desc,this.count.string=t.count>0?"\xd7"+t.count:"\u221e"},e.prototype.showDialog=function(t){this.node.opacity=255,this.refreshDialog(t)},e.prototype.hideDialog=function(){this.node.opacity=0},n([l(cc.Label)],e.prototype,"labelTitle",void 0),n([l(cc.Label)],e.prototype,"infoBase",void 0),n([l(cc.Label)],e.prototype,"infoDesc",void 0),n([l(cc.Label)],e.prototype,"count",void 0),n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],ItemManager:[function(t,e,i){"use strict";cc._RF.push(e,"9211357HjhKqavyVFqZ4zof","ItemManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Item/Coin"),s=t("../Dungeon"),l=t("../Item/OilGold"),c=t("../Utils/IndexZ"),h=t("./BaseManager"),p=t("../Logic"),u=t("../Item/Item"),d=t("../EventHelper"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=null,e.oilGold=null,e.item=null,e.groundList=[],e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.coinPool=new cc.NodePool,this.oilPool=new cc.NodePool,cc.director.on("destorycoin",function(e){t.destroyCoin(e.detail.coinNode)}),cc.director.on("destoryoilgold",function(e){t.destroyOilGold(e.detail.oilGoldNode)})},e.prototype.clear=function(){this.coinPool&&(this.coinPool.clear(),this.oilPool.clear()),this.groundList=[]},e.prototype.getValueCoin=function(t,e,i){for(var o=r.default.FACE_VALUE,a=t%o,n=0;n<a;n++)this.getCoinItem(1,e,i,!0);var s=(t-a)/o;for(n=0;n<s;n++)this.getCoinItem(o,e,i,!0)},e.prototype.getValueOilGold=function(t,e,i){for(var o=l.default.FACE_VALUE,a=t%o,n=0;n<a;n++)this.getCoinItem(1,e,i,!1);var r=(t-a)/o;for(n=0;n<r;n++)this.getCoinItem(o,e,i,!1)},e.prototype.getCoinItem=function(t,e,i,o){var a,n=o?this.coinPool:this.oilPool,h=o?this.coin:this.oilGold,p=i.getComponent(s.default);p&&(a=p.player);var u=null;n.size()>0&&(u=n.get()),u&&!u.active||(u=cc.instantiate(h)),u.parent=i,u.position=e;var d=o?u.getComponent(r.default):u.getComponent(l.default);d.player=a,d.changeValue(t),d.node.zIndex=c.default.OVERHEAD,u.active=!0},e.prototype.destroyCoin=function(t){t.active=!1,this.coinPool&&this.coinPool.put(t)},e.prototype.destroyOilGold=function(t){t.active=!1,this.oilPool&&this.oilPool.put(t)},e.prototype.addItem=function(t,e,i,o){if(this.item&&p.default.items[e]){var a=cc.instantiate(this.item);a.parent=this.node,a.position=t;var n=s.default.getIndexInMap(t);a.zIndex=c.default.OVERHEAD;var r=a.getComponent(u.default);r.init(e,n.clone(),i,o);var l=a.getComponent(u.default).data;if(this.groundList.push(r),!o){var h=p.default.mapManager.getCurrentMapItems();h?h.push(l):((h=new Array).push(l),p.default.mapManager.setCurrentItemsArr(h))}}},e.prototype.addItemFromMap=function(t,e){"A0"==t&&this.addItem(s.default.getPosInMap(e),u.default.HEART),"A1"==t&&this.addItem(s.default.getPosInMap(e),u.default.DREAM),"A3"==t&&this.addItem(s.default.getPosInMap(e),u.default.REDCAPSULE),"A1"==t&&this.addItem(s.default.getPosInMap(e),u.default.BLUECAPSULE),"A4"==t&&this.addItem(s.default.getPosInMap(e),u.default.SHIELD),"A5"==t&&this.addItem(s.default.getPosInMap(e),u.default.GOLDAPPLE),"Aa"==t&&this.addItem(s.default.getPosInMap(e),u.default.BOTTLE_HEALING),"Ab"==t&&this.addItem(s.default.getPosInMap(e),u.default.BOTTLE_MOVESPEED),"Ac"==t&&this.addItem(s.default.getPosInMap(e),u.default.BOTTLE_ATTACK),"Ad"==t&&this.addItem(s.default.getPosInMap(e),u.default.BOTTLE_DREAM),"Ae"==t&&this.addItem(s.default.getPosInMap(e),u.default.BOTTLE_REMOTE)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.updateLogic=function(t,e){if(this.isCheckTimeDelay(t)){for(var i=200,o=null,a=this.groundList.length-1;a>=0;a--){var n=this.groundList[a];if(n.highLight(!1),n.isValid&&!n.data.isTaken){var r=p.default.getDistance(n.node.position,e.node.position);r<i&&(i=r,o=n)}else this.groundList.splice(a,1)}i<(o&&o.data.canSave?64:48)&&o?(o.highLight(!0),o.taketips||(o.taketips=this.node.getChildByName("sprite").getChildByName("taketips")),o.data.canSave?(this.lastGroundItem&&this.lastGroundItem.uuid==o.uuid||(cc.tween(o.taketips).to(.2,{opacity:255}).delay(1).to(.2,{opacity:0}).start(),cc.director.emit(d.EventHelper.HUD_GROUND_ITEM_INFO_SHOW,{detail:{itemData:o.data}})),this.lastGroundItem=o):(o.taken(e,!1),this.lastGroundItem=null)):(this.lastGroundItem=null,cc.director.emit(d.EventHelper.HUD_GROUND_ITEM_INFO_HIDE))}},n([y(cc.Prefab)],e.prototype,"coin",void 0),n([y(cc.Prefab)],e.prototype,"oilGold",void 0),n([y(cc.Prefab)],e.prototype,"item",void 0),n([g],e)}(h.default);i.default=m,cc._RF.pop()},{"../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Item/Coin":"Coin","../Item/Item":"Item","../Item/OilGold":"OilGold","../Logic":"Logic","../Utils/IndexZ":"IndexZ","./BaseManager":"BaseManager"}],Item:[function(t,e,i){"use strict";cc._RF.push(e,"ce4de5SY9BKg5Ay5wKpP9r7","Item");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("../Logic"),l=t("../Data/ItemData"),c=t("../Utils/AudioPlayer"),h=t("../Data/FromData"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new l.default,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.taketips=this.node.getChildByName("sprite").getChildByName("taketips")},e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.init=function(t,e,i,o){this.data.valueCopy(s.default.items[t]),this.data.uuid=this.data.genNonDuplicateID(),this.data.pos=e,this.data.count=i||this.data.count,o&&(this.shopTable=o,o.data.itemdata=new l.default,o.data.itemdata.valueCopy(s.default.items[t]),o.data.price=this.data.price);var a=s.default.spriteFrameRes(this.data.resName);a&&(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.node.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=a,this.sprite.node.width=a.getRect().width,this.sprite.node.height=a.getRect().height,this.mat=this.sprite.getComponent(cc.Sprite).getMaterial(0),this.mat.setProperty("textureSizeWidth",a.getTexture().width*this.sprite.node.scaleX),this.mat.setProperty("textureSizeHeight",a.getTexture().height*this.sprite.node.scaleY),this.mat.setProperty("outlineColor",cc.Color.WHITE),this.highLight(!1))},e.prototype.highLight=function(t){this.mat||(this.mat=this.sprite.getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("openOutline",t?1:0)},e.prototype.taken=function(t,e){return!this.data.isTaken&&(this.data.canSave&&this.shopTable?s.default.coins>=this.data.price&&(cc.director.emit(r.EventHelper.HUD_ADD_COIN,{detail:{count:-this.data.price}}),cc.director.emit(r.EventHelper.PLAY_AUDIO,{detail:{name:c.default.COIN}}),this._taken(t,e),this.shopTable.sale(!0),!0):(this._taken(t,e),!0))},e.prototype._taken=function(t,e){var o=this;!this.data.isTaken&&this.anim&&(this.anim.play("ItemTaken"),this.data.isTaken=!0,c.default.play(c.default.PICK_ITEM),this.data.canSave<1?i.userIt(this.data,t):cc.director.emit(r.EventHelper.PLAYER_CHANGEITEM,{detail:{itemData:this.data,isReplace:e}}),this.scheduleOnce(function(){o.node&&(o.node.active=!1)},3));var a=s.default.mapManager.getCurrentMapItems(),n=new Array;if(a)for(var l=0,h=a;l<h.length;l++){var p=h[l];p.uuid&&p.uuid!=this.data.uuid&&n.push(p)}s.default.mapManager.setCurrentItemsArr(n),cc.director.emit(r.EventHelper.HUD_GROUND_ITEM_INFO_HIDE)},e.userIt=function(t,e){var o=h.default.getClone(t.nameCn,t.resName);switch(t.resName!=i.EMPTY&&t.canSave&&c.default.play(c.default.PICK_ITEM),t.resName){case i.GOLDFINGER:e.stopAllDebuffs()}if(t.statusList.length>0)for(var a=0,n=t.statusList.split(",");a<n.length;a++){var r=n[a];e.addStatus(r,o)}},e.EMPTY="emptyitem",e.HEART="heart",e.DREAM="dream",e.BOTTLE_HEALING="bottle001",e.BOTTLE_MOVESPEED="bottle002",e.BOTTLE_ATTACK="bottle003",e.BOTTLE_DREAM="bottle004",e.BOTTLE_REMOTE="bottle005",e.REDCAPSULE="redcapsule",e.BLUECAPSULE="bluecapsule",e.SHIELD="shield",e.GOLDAPPLE="goldapple",e.GOLDFINGER="goldfinger",i=n([u],e)}(cc.Component));i.default=d,cc._RF.pop()},{"../Data/FromData":"FromData","../Data/ItemData":"ItemData","../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer"}],JoyController:[function(t,e,i){"use strict";cc._RF.push(e,"246e3R5w7RM/68kAxSEZZAX","JoyController");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./EventHelper"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anglePreDirQuadrant=23,e.fixedPoint=null,e.movePoint=null,e.movePointMoveRadius=100,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.touchArea=new cc.Vec3(t.width,t.height),this.fixedPointMoveCenterPos=cc.v3(0,0),this.fixedPointMoveRadius=this.touchArea.x/2-this.movePointMoveRadius,this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(-1==this.touchID){var e=t.getLocation(),i=new cc.Vec3(e.x,e.y);i.subSelf(this.node.position);var o=this.clampPos(i,this.fixedPointMoveCenterPos,this.fixedPointMoveRadius);this.movePointMoveCenterPos=o,this.setFixedPointPos(o),this.touchID=t.getID()}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.touchID==t.getID()){var e=t.getLocation(),i=new cc.Vec3(e.x,e.y);i.subSelf(this.node.position);var o=this.clampPos(i,this.movePointMoveCenterPos,this.movePointMoveRadius);console.log(o),this.setMovePointPos(o)}},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.init(),cc.director.emit(r.EventHelper.PLAYER_ATTACK)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){this.init(),cc.director.emit(r.EventHelper.PLAYER_ATTACK)},this),this.init()},e.prototype.init=function(){this.touchID=-1,this.joystickInputDir=new cc.Vec3,this.setFixedPointPos(this.fixedPointMoveCenterPos),this.setMovePointPos(this.fixedPointMoveCenterPos)},e.prototype.setFixedPointPos=function(){this.fixedPoint.setPosition(cc.v3(0,0))},e.prototype.getFixedPointPos=function(){return this.fixedPoint.getPosition()},e.prototype.setMovePointPos=function(t){this.movePoint.setPosition(t)},e.prototype.getMovePointPos=function(){return this.movePoint.getPosition()},e.prototype.clampPos=function(t,e,i){var o=t.sub(e);return o.mag()>i?o.normalize().mul(i).add(e):t},e.prototype.getInputDir=function(){var t=this.movePoint.getPosition().sub(this.fixedPoint.getPosition());return t.mag()>0&&t.normalizeSelf(),t},e.prototype.getInputQuadrantDir=function(){return this.getVec2ByQuadrant(this.getDirQuadrant(this.getInputDir()))},e.prototype.getDirQuadrant=function(t){var e=null;return t.mag()>0&&(e=Math.floor(this.getAngleByVec2(t)/this.anglePreDirQuadrant)),e},e.prototype.getAngleByVec2=function(t){return 180*-Math.atan2(t.y,t.x)/Math.PI+this.anglePreDirQuadrant/2},e.prototype.getVec2ByAngle=function(t){var e=new cc.Vec2,i=(this.anglePreDirQuadrant/2-t)*(Math.PI/180);return e.x=Math.cos(i),e.y=Math.sin(i),e.normalizeSelf()},e.prototype.getVec2ByQuadrant=function(t){if(null!=t){var e=t*this.anglePreDirQuadrant;return e+=this.anglePreDirQuadrant/2,this.getVec2ByAngle(e)}return cc.Vec2.ZERO},e.prototype.sendMoveMessageToPlayer=function(t){var e=this.getInputQuadrantDir(),i=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(i=0),e.y<-.3&&(i=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(i=2),e.x>.3&&(i=3));var o=this.getInputDir();cc.director.emit(r.EventHelper.PLAYER_ROTATE,{detail:{dir:i,pos:o,dt:t}})},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},n([c(cc.Integer)],e.prototype,"anglePreDirQuadrant",void 0),n([c(cc.Node)],e.prototype,"fixedPoint",void 0),n([c(cc.Node)],e.prototype,"movePoint",void 0),n([c],e.prototype,"movePointMoveRadius",void 0),n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./EventHelper":"EventHelper"}],Joystick:[function(t,e,i){"use strict";cc._RF.push(e,"a3868eVgi9Ewpbgxpufia3p","Joystick");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./EventHelper"),s=t("./Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anglePreDirQuadrant=23,e.fixedPoint=null,e.movePoint=null,e.movePointMoveRadius=100,e.stopCount=0,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.touchArea=new cc.Vec3(t.width,t.height),this.fixedPointMoveCenterPos=this.touchArea.div(0,this.touchArea),this.fixedPointMoveRadius=this.touchArea.x/2-this.movePointMoveRadius,this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(-1==this.touchID){var e=t.getLocation(),i=new cc.Vec3(e.x,e.y);i.subSelf(this.node.position);var o=this.clampPos(i,this.fixedPointMoveCenterPos,this.fixedPointMoveRadius);this.movePointMoveCenterPos=o,this.setFixedPointPos(o),this.setMovePointPos(o),this.touchID=t.getID()}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.touchID==t.getID()){var e=t.getLocation(),i=new cc.Vec3(e.x,e.y);i.subSelf(this.node.position);var o=this.clampPos(i,this.movePointMoveCenterPos,this.movePointMoveRadius);this.setMovePointPos(o)}},this),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.init()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){this.init()},this),this.init()},e.prototype.init=function(){this.touchID=-1,this.joystickInputDir=new cc.Vec3,this.setFixedPointPos(this.fixedPointMoveCenterPos),this.setMovePointPos(this.fixedPointMoveCenterPos)},e.prototype.setFixedPointPos=function(t){this.fixedPoint.setPosition(t)},e.prototype.getFixedPointPos=function(){return this.fixedPoint.getPosition()},e.prototype.setMovePointPos=function(t){this.movePoint.setPosition(t)},e.prototype.getMovePointPos=function(){return this.movePoint.getPosition()},e.prototype.clampPos=function(t,e,i){var o=t.sub(e);return o.mag()>i?o.normalize().mul(i).add(e):t},e.prototype.getInputDir=function(){var t=this.movePoint.getPosition().sub(this.fixedPoint.getPosition());return(isNaN(t.x)||isNaN(t.y))&&(t=cc.v2(0,0)),t.mag()>0&&t.normalizeSelf(),t},e.prototype.getInputQuadrantDir=function(){return this.getVec2ByQuadrant(this.getDirQuadrant(this.getInputDir()))},e.prototype.getDirQuadrant=function(t){var e=null;return t.mag()>0&&(e=Math.floor(this.getAngleByVec2(t)/this.anglePreDirQuadrant)),e},e.prototype.getAngleByVec2=function(t){return 180*-Math.atan2(t.y,t.x)/Math.PI+this.anglePreDirQuadrant/2},e.prototype.getVec2ByAngle=function(t){var e=new cc.Vec2,i=(this.anglePreDirQuadrant/2-t)*(Math.PI/180);return e.x=Math.cos(i),e.y=Math.sin(i),e.normalizeSelf()},e.prototype.getVec2ByQuadrant=function(t){if(null!=t){var e=t*this.anglePreDirQuadrant;return e+=this.anglePreDirQuadrant/2,this.getVec2ByAngle(e)}return cc.Vec2.ZERO},e.prototype.sendMoveMessageToPlayer=function(t){if(!s.default.isGamePause){var e=this.getInputQuadrantDir(),i=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(i=0),e.y<-.3&&(i=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(i=2),e.x>.3&&(i=3));var o=this.getInputDir();o.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(r.EventHelper.PLAYER_MOVE,{detail:{dir:i,pos:o,dt:t}})}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},n([h(cc.Integer)],e.prototype,"anglePreDirQuadrant",void 0),n([h(cc.Node)],e.prototype,"fixedPoint",void 0),n([h(cc.Node)],e.prototype,"movePoint",void 0),n([h],e.prototype,"movePointMoveRadius",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic"}],KeyboardController:[function(t,e,i){"use strict";cc._RF.push(e,"b57f7ePcl9JD6/oAh/+vpUg","KeyboardController");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./EventHelper"),s=t("./Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopCount=0,e.isUp=!1,e.isDown=!1,e.isLeft=!1,e.isRight=!1,e.isA=!1,e.isB=!1,e.isC=!1,e.isD=!1,e.isE=!1,e.isLongPress=!1,e.touchStart=!1,e.mouseArea=null,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){},e.prototype.onKeyDown=function(t){var e=this;switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!0;break;case cc.macro.KEY.s:this.isDown=!0;break;case cc.macro.KEY.a:this.isLeft=!0;break;case cc.macro.KEY.d:this.isRight=!0;break;case cc.macro.KEY.i:this.openInventory();break;case cc.macro.KEY.j:this.isA=!0;break;case cc.macro.KEY.space:this.isB=!0;break;case cc.macro.KEY.e:this.isC=!0,this.touchStart=!0,this.scheduleOnce(function(){e.touchStart&&(e.isLongPress=!0,e.trigger(!0))},.3);break;case cc.macro.KEY.r:this.isD=!0;break;case cc.macro.KEY.f:this.isE=!0;break;case cc.macro.KEY.num1:this.useItem(0);break;case cc.macro.KEY.num2:this.useItem(1);break;case cc.macro.KEY.num3:this.useItem(2);break;case 49:this.useItem(0);break;case 50:this.useItem(1);break;case 51:this.useItem(2);break;case cc.macro.KEY.escape:r.EventHelper.emit(r.EventHelper.HUD_CANCEL_OR_PAUSE)}},e.prototype.trigger=function(t){s.default.isGamePause||r.EventHelper.emit(r.EventHelper.PLAYER_TRIGGER,{isLongPress:t})},e.prototype.openInventory=function(){s.default.isGamePause||r.EventHelper.emit(r.EventHelper.HUD_INVENTORY_SHOW)},e.prototype.useItem=function(t){s.default.isGamePause||r.EventHelper.emit(r.EventHelper.USEITEM_KEYBOARD,{index:t})},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!1;break;case cc.macro.KEY.s:this.isDown=!1;break;case cc.macro.KEY.a:this.isLeft=!1;break;case cc.macro.KEY.d:this.isRight=!1;break;case cc.macro.KEY.j:this.isA=!1;break;case cc.macro.KEY.space:this.isB=!1,r.EventHelper.emit(r.EventHelper.PLAYER_REMOTEATTACK_CANCEL);break;case cc.macro.KEY.e:this.isC=!1,this.isLongPress||this.trigger(),this.touchStart=!1,this.isLongPress=!1;break;case cc.macro.KEY.r:this.isD=!1;break;case cc.macro.KEY.f:this.isE=!1}},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},e.prototype.sendMoveMessageToPlayer=function(t){if(!s.default.isGamePause){var e=cc.v3(0,0);this.isUp&&e.addSelf(cc.v3(0,.9)),this.isDown&&e.addSelf(cc.v3(0,-.9)),this.isLeft&&e.addSelf(cc.v3(-.9,0)),this.isRight&&e.addSelf(cc.v3(.9,0)),e.mag()>0&&e.normalizeSelf();var i=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(i=0),e.y<-.3&&(i=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(i=2),e.x>.3&&(i=3)),e.equals(cc.Vec3.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(r.EventHelper.PLAYER_MOVE,{detail:{dir:i,pos:e,dt:t}}),this.isA&&cc.director.emit(r.EventHelper.PLAYER_ATTACK),this.isB&&cc.director.emit(r.EventHelper.PLAYER_REMOTEATTACK),this.isD&&cc.director.emit(r.EventHelper.PLAYER_SKILL),this.isE&&cc.director.emit(r.EventHelper.PLAYER_SKILL1)}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},n([h(cc.Node)],e.prototype,"mouseArea",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic"}],KrakenSwingHand:[function(t,e,i){"use strict";cc._RF.push(e,"15ea4rtPQxD8pcJLX7yPozV","KrakenSwingHand");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/FromData"),l=t("./Kraken"),c=t("../Utils/ActorUtils"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=2,e.isShow=!1,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.node.parent.getComponent(cc.Animation)},e.prototype.swing=function(){this.anim.play()},e.prototype.start=function(){this.isShow=!1},e.prototype.onCollisionEnter=function(t){var e=c.default.getEnemyCollisionTarget(t);if(e&&this.isShow&&this.node.active){this.node.stopAllActions();var i=new r.default;i.physicalDamage=this.damage,e.takeDamage(i,s.default.getClone(this.actorName(),"boss001"),this.node.parent.getComponent(l.default))}},e.prototype.actorName=function(){return"\u6d77\u5996"},n([u],e.prototype,"damage",void 0),n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Utils/ActorUtils":"ActorUtils","./Kraken":"Kraken"}],Kraken:[function(t,e,i){"use strict";cc._RF.push(e,"cbbb1U+Yy5Jtb8PV4hyvH/c","Kraken");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Shooter"),s=t("../EventHelper"),l=t("./KrakenSwingHand"),c=t("../Dungeon"),h=t("../Logic"),p=t("./Boss"),u=t("../Utils/NextStep"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Utils/IndexZ"),m=t("../Item/Item"),v=cc._decorator,E=v.ccclass,_=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.swingHand=null,e.timeDelay=0,e.remoteSkill=new u.default,e.handSkill=new u.default,e.nearHandSkill=new u.default,e.hands=[],e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.shooter=this.getComponentInChildren(r.default),this.shooter.from.valueCopy(f.default.getClone(this.actorName(),"boss001")),this.anim=this.getComponent(cc.Animation)},e.prototype.ShowFinish=function(){this.anim.play("KrakenHeadIdle"),this.sc.isShow=!0;var t=c.default.getPosInMap(cc.v3(c.default.WIDTH_SIZE,-4)),e=c.default.getPosInMap(cc.v3(-2,-4)),i=c.default.getPosInMap(cc.v3(c.default.WIDTH_SIZE,c.default.HEIGHT_SIZE)),o=c.default.getPosInMap(cc.v3(-2,c.default.HEIGHT_SIZE));this.hand01=this.addHand(t,!0,!0),this.hand02=this.addHand(e,!1,!0),this.hand03=this.addHand(i,!0,!1),this.hand04=this.addHand(o,!1,!1)},e.prototype.addHand=function(t,e,i){var o=cc.instantiate(this.swingHand);this.dungeon.node.addChild(o),o.setPosition(t),o.scaleX=e?-80:80,o.scaleY=i?-80:80,o.zIndex=y.default.OVERHEAD;var a=o.getComponentInChildren(l.default);return this.scheduleOnce(function(){a.isShow=!0},2),this.hands.push(a),a},e.prototype.updatePlayerPos=function(){var t=c.default.getPosInMap(cc.v3(c.default.WIDTH_SIZE/2,c.default.HEIGHT_SIZE+2));this.node.setPosition(t)},e.prototype.changeZIndex=function(){this.node.zIndex=y.default.KRAKENBODY},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){var e=this;return!(this.sc.isDied||!this.sc.isShow||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),this.nearHandSkill.next(function(){e.dungeon.player.pos.x>c.default.WIDTH_SIZE/2?e.hand03&&e.hand03.swing():e.hand04&&e.hand04.swing()},5),0))},e.prototype.killed=function(){var t=this;if(!this.sc.isDied){g.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.changeZIndex();for(var e=0,i=this.hands;e<i.length;e++){var o=i[e];o.isShow=!1,o.node.active=!1}this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot()}},e.prototype.getLoot=function(t){if(this.dungeon){var e=h.default.mapManager.getRandom4Save(this.seed),i=cc.v3(Math.floor(c.default.WIDTH_SIZE/2),Math.floor(c.default.HEIGHT_SIZE/2)),o=c.default.getPosInMap(i);cc.director.emit(s.EventHelper.DUNGEON_ADD_COIN,{detail:{pos:o,count:19}}),t||s.EventHelper.emit(s.EventHelper.DUNGEON_ADD_OILGOLD,{pos:this.node.position,count:100}),(h.default.getHalfChance()&&t||!t)&&(cc.director.emit(s.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:m.default.HEART}}),cc.director.emit(s.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:m.default.DREAM}})),this.dungeon.addEquipment(h.default.getRandomEquipType(e),c.default.getPosInMap(i),null,3)}},e.prototype.showBoss=function(){this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied),this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("KrakenHeadShow")},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.label&&(this.label.string=""+this.node.zIndex),this.healthBar.node.active=!this.sc.isDied},e.prototype.bossAction=function(){var t=this;!this.sc.isDied&&this.sc.isShow&&this.dungeon&&(this.hand01&&(this.hand01.node.parent.y=h.default.lerp(this.hand01.node.y,this.dungeon.player.node.y,.1)),this.hand02&&(this.hand02.node.parent.y=h.default.lerp(this.hand02.node.y,this.dungeon.player.node.y,.1)),this.shooter&&this.remoteSkill.next(function(){t.shooter.skipTopwall=!0;var e=t.node.position.clone().add(t.shooter.node.position),i=t.dungeon.player.getCenterPosition().sub(e);i.equals(cc.Vec3.ZERO)||(i=i.normalizeSelf(),t.shooter.setHv(i),t.shooter.dungeon=t.dungeon,t.shooter.data.bulletType="bullet004",t.shooter.fireBullet(),t.shooter.fireBullet(30),t.shooter.fireBullet(-30)),t.data.currentHealth<t.data.Common.maxHealth/2&&(t.dungeon.addFallStone(t.dungeon.player.node.position,!0),t.shooter.fireBullet(30),t.shooter.fireBullet(-30),t.shooter.fireBullet(15),t.shooter.fireBullet(-15))},3),this.handSkill.next(function(){t.dungeon.player.pos.x>c.default.WIDTH_SIZE/2?t.hand01&&t.hand01.swing():t.hand02&&t.hand02.swing()},10))},e.prototype.actorName=function(){return"\u6d77\u5996"},n([_(cc.Label)],e.prototype,"label",void 0),n([_(cc.Prefab)],e.prototype,"swingHand",void 0),n([E],e)}(p.default);i.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Item/Item":"Item","../Logic":"Logic","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","../Utils/NextStep":"NextStep","./Boss":"Boss","./KrakenSwingHand":"KrakenSwingHand"}],LevelData:[function(t,e,i){"use strict";cc._RF.push(e,"58686Q/aZlPRJziOF8GmsMo","LevelData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ExitData"),a=function(){function t(){this.name="",this.index=0,this.chapter=0,this.width=0,this.height=0,this.seed=0,this.roomWidth=0,this.roomHeight=0,this.floorRes="",this.floorCoverRes="",this.wallRes1="",this.wallRes2="",this.wallRes3="",this.wallRes4="",this.doorRes="",this.exitRes="",this.needRadomDecorate=!1,this.map=[],this.roomTypes=[],this.minimap=[],this.minimaplock=[],this.exits=""}return t.prototype.valueCopy=function(t){this.name=t.name,this.index=t.index,this.chapter=t.chapter,this.width=t.width,this.height=t.height,this.seed=t.seed,this.roomWidth=t.roomWidth,this.roomHeight=t.roomHeight,this.map=t.map,this.roomTypes=t.roomTypes,this.minimap=t.minimap,this.minimaplock=t.minimaplock,this.floorRes=t.floorRes,this.floorCoverRes=t.floorCoverRes,this.wallRes1=t.wallRes1,this.wallRes2=t.wallRes2,this.wallRes3=t.wallRes3,this.wallRes4=t.wallRes4,this.doorRes=t.doorRes,this.exitRes=t.exitRes,this.exits=t.exits,this.needRadomDecorate=t.needRadomDecorate},t.prototype.getRoomMap=function(t,e){var i=new Array;if(t<0||e<0||t>this.width-1||e>this.height-1)return i;for(var o=0;o<this.roomWidth;o++){i[o]=new Array;for(var a=0;a<this.roomHeight;a++)i[o][a]=this.map[o+t*this.roomWidth][a+e*this.roomHeight]}return i},t.prototype.getExitList=function(){var t=new Array;if(this.exits&&this.exits.length>0)for(var e=0,i=this.exits.split("#");e<i.length;e++){var a=i[e],n=new o.default,r=a.split(","),s=parseInt(r[0]),l=this.roomHeight*this.height-parseInt(r[1])-1,c=parseInt(r[4]),h=parseInt(r[5]),p=Math.floor(s/this.roomWidth),u=Math.floor(l/this.roomHeight);n.fromRoomPos=cc.v3(p,u),n.fromPos=cc.v3(s%this.roomWidth,l%this.roomHeight),n.fromChapter=this.chapter,n.fromLevel=this.index,n.toChapter=parseInt(r[2]),n.toLevel=parseInt(r[3]),n.toPos=cc.v3(c,h),t.push(n)}return t},t}();i.default=a,cc._RF.pop()},{"./ExitData":"ExitData"}],LightBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"b2591n42odFIbhfimSigtUE","LightBuilding");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Building"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){},n([l],e)}(r.default));i.default=c,cc._RF.pop()},{"./Building":"Building"}],LightManager:[function(t,e,i){"use strict";cc._RF.push(e,"28a3dFSvA1P3KOJyNBCO1Gn","LightManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./BaseManager"),s=t("../Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e.shadowCamera=null,e.shadow=null,e.ray=null,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.clear=function(){i.lightList=[]},e.prototype.onLoad=function(){},e.prototype.render=function(){for(var t=0;t<i.lightList.length;t++){var e=i.lightList[t];e&&(e.renderSightArea(cc.v2(this.camera.node.x,this.camera.node.y)),this.renderRay(e.lightVertsArray,e.lightRects,e.circle,0==t,s.default.settings.showShadow&&e.showShadow,e.isCircle,e.isSector))}!this.shadowTexture&&s.default.settings.showShadow&&(this.shadowTexture=new cc.RenderTexture,this.shadowTexture.initWithSize(cc.visibleRect.width/8,cc.visibleRect.height/8),this.shadowTexture.setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST),this.shadowCamera.targetTexture=this.shadowTexture,this.shadow.spriteFrame=new cc.SpriteFrame(this.shadowTexture))},e.registerLight=function(t){for(var e=0,o=t;e<o.length;e++){var a=o[e];i.lightList.push(a)}},e.unRegisterLight=function(t){var e=i.lightList.indexOf(t);-1!=e&&i.lightList.splice(e,1)},e.prototype.renderRay=function(t,e,i,o,a,n,r){var s=this.ray;if(o&&s.clear(!1),a){if(s.lineWidth=10,s.fillColor.fromHEX("#ffffff"),t&&t.length>0){var l=this.ray.node.convertToNodeSpaceAR(t[0]);s.moveTo(l.x,l.y);for(var c=1;c<t.length;c++){var h=this.ray.node.convertToNodeSpaceAR(t[c]);s.lineTo(h.x,h.y)}s.close(),s.fill()}for(var p in e){var u=e[p],d=this.ray.node.convertToNodeSpaceAR(cc.v2(u.x,u.y));s.rect(d.x,d.y,u.width,u.height),s.fill()}if(i&&i.z>0){var f=this.ray.node.convertToNodeSpaceAR(cc.v3(i.x,i.y));r?(this.ray.moveTo(f.x-i.z/8,f.y),this.ray.lineTo(f.x-i.z/2,f.y-i.z/3),this.ray.lineTo(f.x-i.z/1.5,f.y-i.z/2),this.ray.lineTo(f.x-i.z/2,f.y-i.z),this.ray.lineTo(f.x,f.y-1.2*i.z),this.ray.lineTo(f.x+i.z/2,f.y-i.z),this.ray.lineTo(f.x+i.z/1.5,f.y-i.z/2),this.ray.lineTo(f.x+i.z/2,f.y-i.z/3),this.ray.lineTo(f.x+i.z/8,f.y),this.ray.close()):n?s.circle(f.x,f.y,i.z):this.ray.rect(f.x-i.z,f.y-i.z,2*i.z,2*i.z),s.fill()}}},e.prototype.fixShadowPos=function(){if(this.shadow&&this.camera){var t=this.camera.node.convertToWorldSpaceAR(cc.v2(0,0)),e=this.ray.node.convertToNodeSpaceAR(t);this.shadow.node.position=cc.v3(e)}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.05&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.render(),this.fixShadowPos()},e.lightList=[],n([h(cc.Camera)],e.prototype,"camera",void 0),n([h(cc.Camera)],e.prototype,"shadowCamera",void 0),n([h(cc.Sprite)],e.prototype,"shadow",void 0),n([h(cc.Graphics)],e.prototype,"ray",void 0),i=n([c],e)}(r.default);i.default=p,cc._RF.pop()},{"../Logic":"Logic","./BaseManager":"BaseManager"}],LightPointData:[function(t,e,i){"use strict";cc._RF.push(e,"c7371Xi6Z1FDZidBXLVH9FT","LightPointData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],Light:[function(t,e,i){"use strict";cc._RF.push(e,"03c71kep4JPC4OkHwKVSXdP","Light");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layer=null,e.lightPrefab=null,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},n([l(cc.Node)],e.prototype,"layer",void 0),n([l(cc.Prefab)],e.prototype,"lightPrefab",void 0),n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],LoadingManager:[function(t,e,i){"use strict";cc._RF.push(e,"cdbddTOfANNwo68tyWHiEGz","LoadingManager");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Data/ProfessionData"),n=t("../Logic"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function t(){this.spriteFrameNames=null,this.isEquipmentLoaded=!1,this.isMonsterLoaded=!1,this.isNonplayerLoaded=!1,this.isWorldLoaded=!1,this.isBuffsLoaded=!1,this.isSuitsLoaded=!1,this.isBulletsLoaded=!1,this.isProfessionLoaded=!1,this.isItemsLoaded=!1,this.isSkillsLoaded=!1,this.isBuildingLoaded=!1,this.isTransportAnimFinished=!0}var e;return e=t,t.prototype.init=function(){this.setAllSpriteFramesUnload(),n.default.spriteFrames||(n.default.spriteFrames={}),n.default.buildings||(n.default.buildings={}),this.isWorldLoaded=!1,this.isEquipmentLoaded=!1,this.isMonsterLoaded=!1,this.isBuffsLoaded=!1,this.isNonplayerLoaded=!1,this.isBuildingLoaded=!1},t.prototype.reset=function(){this.isWorldLoaded=!1,this.isEquipmentLoaded=!1,this.setAllSpriteFramesUnload(),this.isBuffsLoaded=!1,this.isProfessionLoaded=!1,this.isBulletsLoaded=!1,this.isMonsterLoaded=!1,this.isNonplayerLoaded=!1,this.isItemsLoaded=!1,this.isSkillsLoaded=!1,this.isBuildingLoaded=!1,this.isTransportAnimFinished=!1,this.isSuitsLoaded=!1},t.prototype.isSpriteFramesLoaded=function(t){return!!this.spriteFrameNames[t]},t.prototype.isAllSpriteFramesLoaded=function(){for(var t in this.spriteFrameNames)if(!this.spriteFrameNames[t])return!1;return!0},t.prototype.setAllSpriteFramesUnload=function(){this.spriteFrameNames={},this.spriteFrameNames[e.KEY_AUTO]=!1,this.spriteFrameNames[e.KEY_TEXTURES]=!1,this.spriteFrameNames[e.KEY_NPC]=!1},t.prototype.loadWorld=function(){n.default.worldLoader.isloaded=!1,n.default.worldLoader.loadWorld()},t.prototype.loadEquipment=function(){var t=this;n.default.equipments?this.isEquipmentLoaded=!0:cc.resources.load("Data/equipment",function(e,i){if(e)cc.error(e);else for(var o in n.default.equipments=i.json,t.isEquipmentLoaded=!0,cc.log("equipment loaded"),n.default.equipmentNameList=new Array,i.json)n.default.equipmentNameList.push(o)})},t.prototype.loadProfession=function(){var t=this;n.default.professionList&&n.default.professionList.length>0?this.isProfessionLoaded=!0:cc.resources.load("Data/profession",function(e,i){if(e)cc.error(e);else{n.default.professionList=new Array;for(var o=i.json,r=0;r<o.length;r++){var s=new a.default;s.valueCopy(o[r]),s.id=r,n.default.professionList.push(s)}t.isProfessionLoaded=!0,cc.log("professionList loaded")}})},t.prototype.loadTalents=function(){var t=this;n.default.talents?this.isSkillsLoaded=!0:cc.resources.load("Data/talent",function(e,i){e?cc.error(e):(n.default.talents=i.json,t.isSkillsLoaded=!0,cc.log("talent loaded"))})},t.prototype.loadStatus=function(){var t=this;n.default.status?this.isBuffsLoaded=!0:cc.resources.load("Data/status",function(e,i){e?cc.error(e):(n.default.status=i.json,t.isBuffsLoaded=!0,cc.log("debuffs loaded"))})},t.prototype.loadSuits=function(){var t=this;n.default.suits?this.isSuitsLoaded=!0:cc.resources.load("Data/suits",function(e,i){e?cc.error(e):(n.default.suits=i.json,t.isSuitsLoaded=!0,cc.log("suits loaded"))})},t.prototype.loadBullets=function(){var t=this;n.default.bullets?this.isBulletsLoaded=!0:cc.resources.load("Data/bullet",function(e,i){e?cc.error(e):(n.default.bullets=i.json,t.isBulletsLoaded=!0,cc.log("bullets loaded"))})},t.prototype.loadMonsters=function(){var t=this;n.default.monsters?this.isMonsterLoaded=!0:cc.resources.load("Data/monsters",function(e,i){e?cc.error(e):(n.default.monsters=i.json,t.isMonsterLoaded=!0,cc.log("monsters loaded"))})},t.prototype.loadNonplayer=function(){var t=this;n.default.nonplayers?this.isNonplayerLoaded=!0:cc.resources.load("Data/nonplayers",function(e,i){e?cc.error(e):(n.default.nonplayers=i.json,t.isNonplayerLoaded=!0,cc.log("nonplayers loaded"))})},t.prototype.loadBuildings=function(){var t=this;n.default.buildings&&n.default.buildings.Door?this.isBuildingLoaded=!0:cc.resources.loadDir("Prefabs/buildings",cc.Prefab,function(e,i){for(var o=0,a=i;o<a.length;o++){var r=a[o];n.default.buildings[r.name]=r}t.isBuildingLoaded=!0,cc.log("buildings loaded")})},t.prototype.loadItems=function(){var t=this;n.default.items?this.isItemsLoaded=!0:cc.resources.load("Data/item",function(e,i){if(e)cc.error(e);else{for(var o in n.default.items=i.json,n.default.itemNameList=new Array,n.default.goodsNameList=new Array,i.json)n.default.items[o].canSave&&-1==o.indexOf("food")&&-1==o.indexOf("goods")?n.default.itemNameList.push(o):-1!=o.indexOf("goods")&&n.default.goodsNameList.push(o);t.isItemsLoaded=!0,cc.log("items loaded")}})},t.prototype.loadAutoSpriteFrames=function(){var t=this;n.default.spriteFrames&&n.default.spriteFrameRes("auto")?this.spriteFrameNames[e.KEY_AUTO]=!0:cc.resources.loadDir("Texture/Auto",cc.SpriteFrame,function(i,o){for(var a=0,r=o;a<r.length;a++){var s=r[a];n.default.spriteFrames[s.name]=s}t.spriteFrameNames[e.KEY_AUTO]=!0,cc.log("auto texture loaded")})},t.prototype.loadSpriteAtlas=function(t,e){var i=this;n.default.spriteFrames&&n.default.spriteFrames[e]?this.spriteFrameNames[t]=!0:cc.resources.load("Texture/"+t,cc.SpriteAtlas,function(e,o){for(var a=0,r=o.getSpriteFrames();a<r.length;a++){var s=r[a];n.default.spriteFrames[s.name]=s}i.spriteFrameNames[t]=!0,cc.log(t+" loaded")})},t.KEY_AUTO="auto",t.KEY_TEXTURES="textures",t.KEY_NPC="npc",e=o([s],t)}());i.default=l,cc._RF.pop()},{"../Data/ProfessionData":"ProfessionData","../Logic":"Logic"}],Loading:[function(t,e,i){"use strict";cc._RF.push(e,"a2246gAT5JKc4YhD10URG7K","Loading");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./UI/CutScene"),l=t("./Manager/LoadingManager"),c=t("./Utils/AudioPlayer"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingIcon=null,e.cutScene=null,e.shipTransportScene=null,e.timeDelay=0,e.isTransportAnimFinished=!0,e.loadingManager=new l.default,e}return a(e,t),e.prototype.onLoad=function(){this.loadingManager.init(),this.loadingIcon.active=!0},e.prototype.start=function(){this.loadingManager.loadWorld(),this.loadingManager.loadEquipment(),this.loadingManager.loadAutoSpriteFrames(),this.loadingManager.loadSpriteAtlas(l.default.KEY_TEXTURES,"ammo"),this.loadingManager.loadSpriteAtlas(l.default.KEY_NPC,"monster000anim000"),this.loadingManager.loadMonsters(),this.loadingManager.loadStatus(),this.loadingManager.loadBullets(),this.loadingManager.loadItems(),this.loadingManager.loadTalents(),this.loadingManager.loadProfession(),this.loadingManager.loadNonplayer(),this.loadingManager.loadBuildings(),this.loadingManager.loadSuits(),this.showLoadingLabel(),1==r.default.isFirst&&(this.cutScene.isSkip=!0,this.cutScene.unregisterClick())},e.prototype.showLoadingLabel=function(){this.loadingManager.isAllSpriteFramesLoaded()||(this.loadingIcon.active=!0)},e.prototype.showCut=function(){this.loadingManager.isAllSpriteFramesLoaded()&&1!=r.default.isFirst&&(r.default.isFirst=1,this.cutScene.playShow())},e.prototype.showTransport=function(){var t=this;this.loadingManager.isAllSpriteFramesLoaded()&&r.default.shipTransportScene>0&&(this.isTransportAnimFinished=!1,this.shipTransportScene.active=!0,2==r.default.shipTransportScene&&(this.shipTransportScene.scaleX=-1),c.default.play(c.default.TRANSPORTSHIP),r.default.shipTransportScene=0,this.scheduleOnce(function(){t.isTransportAnimFinished=!0},2))},e.prototype.update=function(t){this.timeDelay+=t,this.loadingManager.isWorldLoaded=r.default.worldLoader.isloaded,this.showCut(),this.showTransport(),this.timeDelay>.02&&this.loadingManager.isEquipmentLoaded&&this.loadingManager.isAllSpriteFramesLoaded()&&this.loadingManager.isMonsterLoaded&&this.loadingManager.isNonplayerLoaded&&this.loadingManager.isBuffsLoaded&&this.loadingManager.isProfessionLoaded&&this.loadingManager.isBulletsLoaded&&this.loadingManager.isItemsLoaded&&this.loadingManager.isSkillsLoaded&&this.loadingManager.isWorldLoaded&&this.loadingManager.isBuildingLoaded&&this.loadingManager.isSuitsLoaded&&this.cutScene.isSkip&&this.isTransportAnimFinished&&(this.timeDelay=0,this.cutScene.unregisterClick(),this.isTransportAnimFinished=!1,this.loadingManager.reset(),r.default.mapManager.loadMap(),cc.director.loadScene("game"))},n([u(cc.Node)],e.prototype,"loadingIcon",void 0),n([u(s.default)],e.prototype,"cutScene",void 0),n([u(cc.Node)],e.prototype,"shipTransportScene",void 0),n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"./Logic":"Logic","./Manager/LoadingManager":"LoadingManager","./UI/CutScene":"CutScene","./Utils/AudioPlayer":"AudioPlayer"}],LocalStorage:[function(t,e,i){"use strict";cc._RF.push(e,"0a5cbOqRmZJE4RU1wzXgRD/","LocalStorage");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Data/AchievementData"),n=cc._decorator,r=n.ccclass,s=(n.property,function(){function t(){}var e;return e=t,t.getValue=function(t){return cc.sys.localStorage.getItem(t)},t.putValue=function(t,e){cc.sys.localStorage.setItem(t,JSON.stringify(e))},t.getData=function(){var t=e.getValue(e.SAVE_NAME);return t||(t="{}"),JSON.parse(t)},t.getValueFromData=function(t){var i=e.getValue(e.SAVE_NAME);return i||(i="{}"),e.getData()[t]},t.saveData=function(t,i){var o=e.getData();o[t]=i,e.putValue(e.SAVE_NAME,o)},t.getAchievementData=function(){var t=e.getData()[e.KEY_ACHIEVEMENT];return t&&t.monsters||(t=new a.default),t},t.saveAchievementData=function(t){e.saveData(e.KEY_ACHIEVEMENT,t)},t.isSwitchOpen=function(t){var i=e.getValueFromData(t);return 1==(i?parseInt(i):e.DEFAULT_MAP[t])},t.saveSwitch=function(t,i){e.saveData(t,i?1:0)},t.SAVE_NAME="SINKDUNGEON_SAVE",t.SAVE_DUNGEON="SAVE_DUNGEON",t.SAVE_DUNGEON_BY_POINT="SAVE_DUNGEON_BY_POINT",t.KEY_ACHIEVEMENT="KEY_ACHIEVEMENT",t.KEY_COIN="KEY_COIN",t.KEY_COIN_DREAM_COUNT="KEY_DREAM_COIN_COUNT",t.KEY_SWITCH_SHOW_SHADOW="KEY_SWITCH_SHOW_SHADOW",t.KEY_SWITCH_SHOW_GAMEPAD="KEY_SWITCH_SHOW_GAMEPAD",t.VAULE_OPEN="1",t.DEFAULT_MAP={KEY_SWITCH_SHOW_SHADOW:1,KEY_SWITCH_SHOW_GAMEPAD:0},e=o([r],t)}());i.default=s,cc._RF.pop()},{"../Data/AchievementData":"AchievementData"}],Logic:[function(t,e,i){"use strict";cc._RF.push(e,"2225fYJ0sRMTZjuD7WFmbVi","Logic");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Data/PlayerData"),s=t("./Manager/MapManager"),l=t("./Dungeon"),c=t("./Manager/InventoryManager"),h=t("./Utils/Random"),p=t("./Manager/ProfileManager"),u=t("./Utils/AudioPlayer"),d=t("./Data/FromData"),f=t("./Map/WorldLoader"),g=t("./Model/Settings"),y=t("./Utils/LocalStorage"),m=t("./Data/SavePointData"),v=t("./Data/NonPlayerData"),E=t("./Data/InventoryData"),_=t("./Data/GroundOilGoldData"),D=t("./Data/OilGoldData"),S=cc._decorator,R=S.ccclass,T=(S.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return a(e,t),i=e,e.prototype.onLoad=function(){cc.game.setFrameRate(60),cc.game.addPersistRootNode(this.node),cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0},e.prototype.start=function(){},e.saveData=function(){i.profileManager.data.playerData=i.playerData.clone(),i.profileManager.data.playerEquips=i.inventoryManager.equips,i.profileManager.data.playerItemList=i.inventoryManager.itemList,i.profileManager.data.nonPlayerList=i.nonPlayerList,i.profileManager.data.playerInventoryList=i.inventoryManager.inventoryList,i.profileManager.data.rectDungeons[i.mapManager.rectDungeon.id]=i.mapManager.rectDungeon,i.profileManager.data.level=i.level,i.profileManager.data.chapterIndex=i.chapterIndex,i.profileManager.data.chapterMaxIndex=i.chapterMaxIndex,i.profileManager.data.time=i.time,i.profileManager.data.savePointData=i.savePoinitData.clone(),i.profileManager.data.groundOilGoldData=i.groundOilGoldData.clone(),i.profileManager.data.killPlayerCounts=i.killPlayerCounts,i.profileManager.data.oilGolds=i.oilGolds,i.profileManager.saveData(),y.default.saveData(y.default.KEY_COIN,i.coins),y.default.saveData(y.default.KEY_COIN_DREAM_COUNT,i.coinDreamCount)},e.resetData=function(t){for(var e in i.time=i.profileManager.data.time,i.profileManager.data.chapterIndex=t||i.profileManager.data.chapterIndex,i.profileManager.data.chapterIndex>i.profileManager.data.chapterMaxIndex&&i.profileManager.data.chapterIndex<this.CHAPTER05&&(i.profileManager.data.chapterMaxIndex=i.profileManager.data.chapterIndex),i.chapterIndex=i.profileManager.data.chapterIndex,i.chapterMaxIndex=i.profileManager.data.chapterMaxIndex,i.level=i.profileManager.data.level,i.savePoinitData=i.profileManager.data.savePointData.clone(),i.groundOilGoldData=i.profileManager.data.groundOilGoldData.clone(),i.oilGolds=i.profileManager.data.oilGolds,i.playerData=i.profileManager.data.playerData.clone(),i.inventoryManager=new c.default,i.profileManager.data.playerEquips)i.inventoryManager.equips[e].valueCopy(i.profileManager.data.playerEquips[e]);for(var o=0;o<i.profileManager.data.playerItemList.length;o++)i.inventoryManager.itemList[o].valueCopy(i.profileManager.data.playerItemList[o]);for(o=0;o<i.profileManager.data.playerInventoryList.length;o++)(a=new E.default).valueCopy(i.profileManager.data.playerInventoryList[o]),i.inventoryManager.inventoryList.push(a);for(i.nonPlayerList=[],o=0;o<i.profileManager.data.nonPlayerList.length;o++){var a;(a=new v.default).valueCopy(i.profileManager.data.nonPlayerList[o]),i.nonPlayerList.push(a)}i.isMapReset=!0,l.default.WIDTH_SIZE=15,l.default.HEIGHT_SIZE=9;var n=y.default.getValueFromData(y.default.KEY_COIN);i.coins=n?parseInt(n):0;var r=y.default.getValueFromData(y.default.KEY_COIN_DREAM_COUNT);i.coinDreamCount=r?parseInt(r):0,i.lastBgmIndex=0,i.killPlayerCounts=i.profileManager.data.killPlayerCounts,i.updateOilGoldCount()},e.updateOilGoldCount=function(){for(var t=i.oilGolds,e=new D.default,o=0;o<i.OIL_GOLD_LIST.length;o++){var a=t-i.OIL_GOLD_LIST[o];if(!(a>=0)){e.index=o;break}t=a,e.level++}e.fragments=t,e.Common.damageMin=e.level,e.Common.maxHealth=e.level,e.Common.maxDream=e.level,e.Common.remoteDamage=.5*e.level,i.playerData.OilGoldData.valueCopy(e)},e.changeDungeonSize=function(){var t=i.mapManager.getCurrentMapSize();t&&(l.default.WIDTH_SIZE=t.x,l.default.HEIGHT_SIZE=t.y)},e.posToMapPos=function(t){var e=i.worldLoader.getCurrentLevelData(),o=i.mapManager.rectDungeon.currentPos,a=cc.v3(0,0);return a.x=e.roomWidth*o.x+t.x,a.y=e.height*e.roomHeight-1-e.roomWidth*o.y-t.y,a},e.savePonit=function(t){if(i.chapterIndex!=i.CHAPTER099){var e=new m.default,o=i.posToMapPos(t);e.x=o.x,e.y=o.y,e.level=i.level,e.chapter=i.chapterIndex,i.savePoinitData.valueCopy(e),i.saveData()}},e.saveGroundOilGold=function(t){var e=new _.default;if(t>0){var o=i.mapManager.rectDungeon.currentPos;e.x=o.x,e.y=o.y,e.level=i.level,e.chapter=i.chapterIndex,e.value=t}i.groundOilGoldData.valueCopy(e),i.saveData()},e.loadingNextRoom=function(t){if(i.mapManager.rand4save=null,i.saveData(),u.default.play(u.default.EXIT),i.mapManager.loadingNextRoom(t)){switch(i.changeDungeonSize(),t){case 0:i.playerData.pos=cc.v3(i.playerData.pos.x,1);break;case 1:i.playerData.pos=cc.v3(i.playerData.pos.x,l.default.HEIGHT_SIZE-2);break;case 2:i.playerData.pos=cc.v3(l.default.WIDTH_SIZE-2,i.playerData.pos.y);break;case 3:i.playerData.pos=cc.v3(1,i.playerData.pos.y)}cc.director.loadScene("loading")}},e.loadingNextLevel=function(t){if(t){var e=i.worldLoader.getLevelData(t.toChapter,t.toLevel);if(e){if(t.fromChapter!=i.CHAPTER099&&t.fromChapter!=t.toChapter)for(var o in i.mapManager.rectDungeon.changeAllClearRoomsReborn(),i.profileManager.data.rectDungeons)i.profileManager.data.rectDungeons[o]&&i.profileManager.data.rectDungeons[o].changeAllClearRoomsReborn();i.saveData(),i.chapterIndex=t.toChapter,i.level=t.toLevel,i.chapterMaxIndex<i.chapterIndex&&i.chapterIndex<i.CHAPTER05&&(i.chapterMaxIndex=i.chapterIndex);var a=e.height*e.roomHeight-1-t.toPos.y,n=Math.floor(t.toPos.x/e.roomWidth),r=Math.floor(a/e.roomHeight);i.playerData.pos=cc.v3(t.toPos.x%e.roomWidth,a%e.roomHeight),i.mapManager.reset(cc.v3(n,r)),i.changeDungeonSize(),t.fromChapter==i.CHAPTER00&&i.chapterIndex==i.CHAPTER01?i.shipTransportScene=1:t.fromChapter==i.CHAPTER02&&i.chapterIndex==i.CHAPTER01?i.shipTransportScene=2:t.fromChapter==i.CHAPTER01&&i.chapterIndex==i.CHAPTER00?i.shipTransportScene=2:t.fromChapter==i.CHAPTER01&&i.chapterIndex==i.CHAPTER02&&(i.shipTransportScene=1),cc.director.loadScene("loading")}}},e.getRandomNum=function(t,e){return t+Math.round(h.default.rand()*(e-t))},e.getHalfChance=function(){return h.default.rand()>.5},e.getChance=function(t){return i.getRandomNum(0,100)<t},e.getDistance=function(t,e){var i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)},e.lerp=function(t,e,i){return t+(e-t)*i},e.lerpPos=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},e.genNonDuplicateID=function(){return Number(h.default.rand().toString().substr(3,16)+Date.now()).toString(36)},e.getRandomEquipType=function(t){return i.equipmentNameList[t.getRandomNum(1,i.equipmentNameList.length-1)]},e.getRandomItemType=function(t){return i.itemNameList[t.getRandomNum(1,i.itemNameList.length-1)]},e.spriteFrameRes=function(t){return i.spriteFrames[t]?i.spriteFrames[t]:null},e.getBuildings=function(t){return i.buildings[t]},e.getKillPlayerCount=function(t){return i.killPlayerCounts[t]?i.killPlayerCounts[t]:0},e.setKillPlayerCounts=function(t,e){if(t&&t.id){i.killPlayerCounts[t.id]=i.getKillPlayerCount(t.id)+(e?1:-1);var o=i.killPlayerCounts;for(var a in i.killPlayerCounts={},o)o[a]&&o[a]>0&&(i.killPlayerCounts[a]=o[a])}},e.BOSS_LEVEL_1=10,e.CHAPTER00=0,e.CHAPTER01=1,e.CHAPTER02=2,e.CHAPTER03=3,e.CHAPTER04=4,e.CHAPTER05=5,e.CHAPTER099=99,e.OIL_GOLD_LIST=[100,150,200,300,500,1e3,1500,2e3,3e3,5e3,1e4,15e3,2e4,3e4,5e4,1e5,15e4,2e5,3e5,5e5,1e6,15e5,2e6,3e6,5e6],e.equipments=null,e.equipmentNameList=[],e.itemNameList=[],e.goodsNameList=[],e.monsters=null,e.nonplayers=null,e.spriteFrames=null,e.status=null,e.suits=null,e.bullets=null,e.items=null,e.talents=null,e.professionList=[],e.buildings=null,e.level=0,e.chapterIndex=0,e.chapterMaxIndex=0,e.playerData=new r.default,e.inventoryManager=new c.default,e.mapManager=new s.default,e.worldLoader=new f.default,e.coins=0,e.oilGolds=0,e.killCount=0,e.coinDreamCount=0,e.time="00:00:00",e.seed=5,e.isFirst=1,e.jumpChapter=0,e.shipTransportScene=0,e.isCheatMode=!1,e.isDebug=!1,e.isTour=!1,e.isGamePause=!1,e.dieFrom=new d.default,e.isMapReset=!1,e.lastBgmIndex=0,e.savePoinitData=new m.default,e.groundOilGoldData=new _.default,e.killPlayerCounts={},e.profileManager=new p.default,e.bagSortIndex=0,e.settings=new g.default,e.nonPlayerList=[],i=n([R],e)}(cc.Component));i.default=T,cc._RF.pop()},{"./Data/FromData":"FromData","./Data/GroundOilGoldData":"GroundOilGoldData","./Data/InventoryData":"InventoryData","./Data/NonPlayerData":"NonPlayerData","./Data/OilGoldData":"OilGoldData","./Data/PlayerData":"PlayerData","./Data/SavePointData":"SavePointData","./Dungeon":"Dungeon","./Manager/InventoryManager":"InventoryManager","./Manager/MapManager":"MapManager","./Manager/ProfileManager":"ProfileManager","./Map/WorldLoader":"WorldLoader","./Model/Settings":"Settings","./Utils/AudioPlayer":"AudioPlayer","./Utils/LocalStorage":"LocalStorage","./Utils/Random":"Random"}],MagicCircle:[function(t,e,i){"use strict";cc._RF.push(e,"4b4e32e5VZL3KOgwsnsl4rh","MagicCircle");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e.spellNow=!1,e}return a(e,t),e.prototype.playMagic=function(t){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play(),this.anim.getAnimationState("PlayerMagicShow").speed=2,this.isShow=!0,this.spellNow=t,t&&this.talentMaigc&&this.talentMaigc.MagicFinish()},e.prototype.MagicFinish=function(){!this.spellNow&&this.talentMaigc&&this.talentMaigc.MagicFinish(),this.isShow=!1},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],MagicIce:[function(t,e,i){"use strict";cc._RF.push(e,"593bdTc6U9L8aRhkgXkK2Pf","MagicIce");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e}return a(e,t),e.prototype.showIce=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.node.opacity=128,this.anim.play("PlayerMagicIceIdle"),this.isShow=!0},e.prototype.breakIce=function(){this.anim.play("PlayerMagicIceBreak"),this.isShow=!1},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],MagicLightening:[function(t,e,i){"use strict";cc._RF.push(e,"6dfcbPWaC1Bm5ogHJjkBBm7","MagicLightening");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Utils/AudioPlayer"),l=t("../Data/FromData"),c=t("../Manager/StatusManager"),h=t("../Utils/ActorUtils"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasTargetMap={},e.needPrepare=!1,e.showArea=!1,e.isTrigger=!0,e.isAttacked=!1,e.damagePoint=5,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.fall=function(t,e,i){i&&i>0&&(this.damagePoint=i),this.needPrepare=t,this.isAttacked=!1;var o="LighteningFall";e&&(o="LighteningFallArea"),t&&(o="LighteningPrepareFall",this.isAttacked=!0),this.anim=this.getComponent(cc.Animation),this.anim.play(o),s.default.play(s.default.BOOM)},e.prototype.AnimBegin=function(){this.isAttacked=!1},e.prototype.AnimFinish=function(){var t=this;this.scheduleOnce(function(){t.node&&t.node.destroy()},2)},e.prototype.onCollisionEnter=function(t){h.default.getEnemyCollisionTarget(t)&&this.isTrigger&&(this.isTrigger=!1,this.fall(!0,!0))},e.prototype.onCollisionStay=function(t,e){e.radius>0&&!this.isAttacked&&this.attacking(t.node)},e.prototype.attacking=function(t){if(t){var e=new r.default,i=c.default.BURNING;e.magicDamage=this.damagePoint,i=c.default.DIZZ;var o=h.default.getEnemyActorByNode(t,!this.needPrepare);if(o&&!o.sc.isDied){o.takeDamage(e);var a=l.default.getClone("\u95ea\u7535","magiclighteningdown1");o.addStatus(i,a),this.isAttacked=!0}}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.5&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(){},n([u],e)}(cc.Component));i.default=d,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer"}],MapData:[function(t,e,i){"use strict";cc._RF.push(e,"9d7bcZhUYBIzJR0A6/ryRxj","MapData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t){this.map=new Array,this.init(t)}return t.prototype.init=function(t){if(t){var e=(t=t.substring(2,t.length-2)).split("\r\n");this.map=new Array;for(var i=0;i<e.length;i++)this.map[i]=new Array;for(i=0;i<e.length;i++)for(var o=e[e.length-1-i].split(""),a=0,n=0;n<o.length-1;a++)this.map[i][a]=o[n]+o[n+1],n+=2;var r=new Array;for(i=0;i<this.map[0].length;i++)for(r[i]=new Array,n=0;n<this.map.length;n++)r[i][n]=this.map[n][i];this.map=r}},t.prototype.logMap=function(){for(var t="",e=this.map[0].length-1;e>=0;e--){for(var i=0;i<this.map.length;i++)t+=""+this.map[i][e];t+="\n"}return t},t.prototype.clone=function(){var e=new t("");return e.map=this.map.slice(),e},t.prototype.valueCopy=function(t){return this.map=t&&t.map?t.map:null,this},t}();i.default=o,cc._RF.pop()},{}],MapManagerData:[function(t,e,i){"use strict";cc._RF.push(e,"fc23bpSDqZOALYDNPFUGFLx","MapManagerData"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],MapManager:[function(t,e,i){"use strict";cc._RF.push(e,"3b0b2KGAWdGI6jcP8eIcPHE","MapManager"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Data/MapData"),a=t("../Rect/RectRoom"),n=t("../Rect/RectDungeon"),r=t("../Logic"),s=t("../Utils/Random4Save"),l=t("../Rect/RoomType"),c=function(){function t(){this.isloaded=!1,this.rectDungeon=null,this.init()}return t.prototype.init=function(){this.isloaded=!1},t.prototype.clear=function(){},t.prototype.loadMap=function(){r.default.isMapReset&&r.default.mapManager.reset(),cc.log("maps loaded")},t.prototype.reset=function(t){r.default.isMapReset=!1;var e=r.default.worldLoader.getCurrentLevelData();if(this.rand4save=null,this.rectDungeon=new n.default,r.default.profileManager.data&&r.default.profileManager.data.rectDungeons[""+e.chapter+e.index])this.rectDungeon.buildMapFromSave(r.default.profileManager.data.rectDungeons[""+e.chapter+e.index],e);else{this.rectDungeon.buildMap(e);var i=this.rectDungeon.startIndex;this.rectDungeon.currentPos=cc.v3(i.x,i.y)}t&&(this.rectDungeon.currentPos=t.clone()),cc.log(this.rectDungeon.getDisPlay()),this.rectDungeon.changeRoomsIsFound(this.rectDungeon.currentPos.x,this.rectDungeon.currentPos.y)},t.prototype.loadingNextRoom=function(t){var e=this.rectDungeon.getNeighborRoom(this.rectDungeon.currentPos.x,this.rectDungeon.currentPos.y,t);return e&&e.roomType&&(this.rectDungeon.currentPos=cc.v3(e.x,e.y),this.rectDungeon.changeRoomsIsFound(e.x,e.y)),e},t.prototype.getCurrentMapStringArray=function(){var t=this.getCurrentRoom(),e=new o.default(""),i=r.default.worldLoader.getCurrentLevelData();return e.map=i.getRoomMap(t.x,t.y),this.addGenerateThings(e,t.roomType,t.seed,i.needRadomDecorate).map},t.prototype.getCurrentSideMapStringArray=function(t){var e=this.getCurrentRoom(),i=new o.default(""),a=r.default.worldLoader.getCurrentLevelData();return i.map=a.getRoomMap(e.x+t.x,e.y+t.y),i.map},t.prototype.getCurrentMapSize=function(){var t=r.default.worldLoader.getCurrentLevelData();return cc.v3(t.roomWidth,t.roomHeight)},t.prototype.getCurrentRoom=function(){return this.rectDungeon&&this.rectDungeon.map?this.rectDungeon.map[this.rectDungeon.currentPos.x][this.rectDungeon.currentPos.y]:null},t.prototype.getCurrentMapBuilding=function(t){var e=this.rectDungeon.buildings["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y];return e?e["x="+t.x+"y="+t.y]:null},t.prototype.setCurrentBuildingData=function(t){var e=this.rectDungeon.buildings["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y];e||(e={},this.rectDungeon.buildings["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y]=e),e["x="+t.defaultPos.x+"y="+t.defaultPos.y]=t},t.prototype.getCurrentMapEquipments=function(){return this.rectDungeon.equipments["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y]},t.prototype.setCurrentEquipmentsArr=function(t){this.rectDungeon.equipments["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y]=t},t.prototype.getCurrentMapItems=function(){return this.rectDungeon.items["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y]},t.prototype.setCurrentItemsArr=function(t){this.rectDungeon.items["x="+this.rectDungeon.currentPos.x+"y="+this.rectDungeon.currentPos.y]=t},t.prototype.setRoomClear=function(t,e){this.rectDungeon.map[t][e].state=a.default.STATE_CLEAR,this.rectDungeon.map[t][e].isReborn=!1},t.prototype.getCurrentRoomState=function(){return this.getCurrentRoom().state},t.prototype.isCurrentRoomStateClear=function(){return this.getCurrentRoomState()==a.default.STATE_CLEAR},t.prototype.getCurrentRoomType=function(){return this.getCurrentRoom().roomType},t.prototype.isNeighborRoomStateClear=function(t){return this.rectDungeon.getNeighborRoom(this.rectDungeon.currentPos.x,this.rectDungeon.currentPos.y,t).state==a.default.STATE_CLEAR},t.prototype.getCurrentRoomRandom4Save=function(){var t=this.getCurrentRoom();return t?this.rand4save||(this.rand4save=new s.default(t.seed),this.rand4save.Seed=t.seed):this.rand4save||(this.rand4save=new s.default(0)),this.rand4save},t.prototype.getRebornSeed=function(t){return t+1e8*r.default.mapManager.getCurrentRoom().reborn},t.prototype.getSeedFromRoom=function(){return r.default.mapManager.getCurrentRoomRandom4Save().getRandomNum(0,1e8)},t.prototype.getRandom4Save=function(t){var e=new s.default(t>0?t:this.getSeedFromRoom());return e.rand(),e},t.prototype.addGenerateThings=function(t,e,i,o){var a=new s.default(i);return cc.log("seed:"+i),this.addRandomTile(t,a),l.default.isDecorateRoomType(e)&&o&&(a=new s.default(i),this.addDecorate(t,a)),t},t.prototype.addRandomTile=function(t,e){for(var i=[],o=0;o<10;o++){var a=e.getRandomNum(0,t.map.length-1),n=e.getRandomNum(0,t.map[0].length-1);i.push(cc.v3(a,0)),i.push(cc.v3(0,n)),i.push(cc.v3(a,n))}for(var r=0,s=i;r<s.length;r++){var l=s[r];"**"==t.map[l.x][l.y]&&(t.map[l.x][l.y]="*"+e.getRandomNum(0,2))}},t.prototype.addDecorate=function(t,e){for(var i=[],o=0;o<2;o++){var a=e.getRandomNum(1,t.map.length-2),n=e.getRandomNum(1,t.map[0].length-2);i.push(cc.v3(a,n))}for(var r=0,s=i;r<s.length;r++){var l=s[r];"**"!=t.map[l.x][l.y]&&-1==t.map[l.x][l.y].indexOf("W")||(t.map[l.x][l.y]="W"+e.getRandomNum(0,2))}},t}();i.default=c,cc._RF.pop()},{"../Data/MapData":"MapData","../Logic":"Logic","../Rect/RectDungeon":"RectDungeon","../Rect/RectRoom":"RectRoom","../Rect/RoomType":"RoomType","../Utils/Random4Save":"Random4Save"}],MartCashier:[function(t,e,i){"use strict";cc._RF.push(e,"88c99phMSBLjpgR45Dw2hZG","MartCashier");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Utils/AudioPlayer"),s=t("./Building"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){r.default.play(r.default.WELCOME)},e.prototype.onCollisionEnter=function(){},e.prototype.onCollisionExit=function(){},n([c],e)}(s.default));i.default=h,cc._RF.pop()},{"../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],MartShelvesDialog:[function(t,e,i){"use strict";cc._RF.push(e,"24e528ueQhMDYfsDE3eSpqK","MartShelvesDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../Data/GoodsData"),s=t("../../EventHelper"),l=t("../../Item/Goods"),c=t("../../Logic"),h=t("../../Utils/AudioPlayer"),p=t("./BaseDialog"),u=cc._decorator,d=u.ccclass,f=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goods=null,e.layer=null,e.spriteNode=null,e.fridgeNode=null,e.fridgeLayer=null,e.doorLeft=null,e.doorRight=null,e.payNode=null,e.payTitle=null,e.payDesc=null,e.payIcon=null,e.type=i.TYPE_NORMAL,e.goodsList=[],e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;cc.director.on(s.EventHelper.HUD_MART_SHELVES_DIALOG_PAY,function(e){t.node&&t.showPay(e.detail.data)})},e.prototype.showPay=function(t){this.goodsData=t,this.payTitle.string=""+t.item.nameCn,this.payDesc.string="\u4ef7\u683c\uff1a"+t.item.price+"\n\n\u8bf4\u660e\uff1a"+t.item.info+"\n"+t.item.desc,c.default.spriteFrameRes(t.item.resName)&&(this.payIcon.spriteFrame=c.default.spriteFrameRes(t.item.resName),this.payIcon.node.width=this.payIcon.spriteFrame.getRect().width,this.payIcon.node.height=this.payIcon.spriteFrame.getRect().height),this.payNode.active=!0},e.prototype.Pay=function(){c.default.coins>=this.goodsData.item.price&&(cc.director.emit(s.EventHelper.HUD_ADD_COIN,{detail:{count:-this.goodsData.item.price}}),h.default.play(h.default.CASHIERING),cc.director.emit(s.EventHelper.PLAYER_CHANGEITEM,{detail:{itemData:this.goodsData.item}}),this.close())},e.prototype.Cancel=function(){this.payNode.active=!1},e.prototype.updateUI=function(t,e){this.payNode.active=!1,this.spriteNode.active=!1,this.fridgeNode.active=!1,this.type=t,this.changeBg(t),this.addGoods(t,e)},e.prototype.changeBg=function(t){this.martshelvesbg||(this.martshelvesbg=this.node.getChildByName("sprite").getChildByName("martshelves"),this.martshelvesside0=this.node.getChildByName("sprite").getChildByName("martshelvesside0"),this.martshelvesside1=this.node.getChildByName("sprite").getChildByName("martshelvesside1"),this.martshelvesside2=this.node.getChildByName("sprite").getChildByName("martshelvesside2"),this.martshelvesside3=this.node.getChildByName("sprite").getChildByName("martshelvesside3")),t==i.TYPE_FRIDGE?(this.fridgeNode.active=!0,this.doorLeft.scaleX=1,this.doorRight.scaleX=1):this.spriteNode.active=!0;var e=t==i.TYPE_WOOD?"#DF8143":"#FFFFFF";this.martshelvesbg.color=cc.color().fromHEX(e),this.martshelvesside0.color=cc.color().fromHEX(e),this.martshelvesside1.color=cc.color().fromHEX(e),this.martshelvesside2.color=cc.color().fromHEX(e),this.martshelvesside3.color=cc.color().fromHEX(e)},e.prototype.addGoods=function(t,e){var o=this;this.layer.removeAllChildren(),this.fridgeLayer.removeAllChildren();for(var a=t==i.TYPE_FRIDGE,n=a?this.fridgeLayer:this.layer,s=a?i.SIZE_FRIDGE:i.SIZE,h=0;h<s;h++){if(h>e.length-1)return;var p=cc.instantiate(this.goods).getComponent(l.default),u=new r.default;u.count=1,u.item.valueCopy(c.default.items[e[h]]),p.init(u),this.goodsList.push(p),n.addChild(p.node)}a&&this.scheduleOnce(function(){o.anim||(o.anim=o.getComponent(cc.Animation)),o.anim.play()},1)},e.prototype.close=function(){this.fridgeNode.active=!1,this.spriteNode.active=!1,this.payNode.active=!1,this.dismiss()},e.SIZE=21,e.SIZE_FRIDGE=12,e.TYPE_NORMAL="Sa",e.TYPE_WOOD="Sb",e.TYPE_FRIDGE="Sc",n([f(cc.Prefab)],e.prototype,"goods",void 0),n([f(cc.Node)],e.prototype,"layer",void 0),n([f(cc.Node)],e.prototype,"spriteNode",void 0),n([f(cc.Node)],e.prototype,"fridgeNode",void 0),n([f(cc.Node)],e.prototype,"fridgeLayer",void 0),n([f(cc.Node)],e.prototype,"doorLeft",void 0),n([f(cc.Node)],e.prototype,"doorRight",void 0),n([f(cc.Node)],e.prototype,"payNode",void 0),n([f(cc.Label)],e.prototype,"payTitle",void 0),n([f(cc.Label)],e.prototype,"payDesc",void 0),n([f(cc.Sprite)],e.prototype,"payIcon",void 0),i=n([d],e)}(p.default);i.default=g,cc._RF.pop()},{"../../Data/GoodsData":"GoodsData","../../EventHelper":"EventHelper","../../Item/Goods":"Goods","../../Logic":"Logic","../../Utils/AudioPlayer":"AudioPlayer","./BaseDialog":"BaseDialog"}],MartShelves:[function(t,e,i){"use strict";cc._RF.push(e,"4800aSbfApGHYS7nMK4o5Bn","MartShelves");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/GoodsData"),s=t("../EventHelper"),l=t("../Item/Goods"),c=t("../Logic"),h=t("../UI/Tips"),p=t("./Building"),u=cc._decorator,d=u.ccclass,f=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goods=null,e.layer=null,e.type=i.TYPE_NORMAL,e.goodsList=[],e.goodsNameList=[],e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.tips=this.getComponentInChildren(h.default),cc.director.on(s.EventHelper.PLAYER_TAPTIPS,function(e){t.node&&e.detail.tipsType==h.default.MART_SHELVES+"x="+t.data.defaultPos.x+"y="+t.data.defaultPos.y&&s.EventHelper.emit(s.EventHelper.HUD_MART_SHELVES_DIALOG,{type:t.type,goodsNameList:t.goodsNameList})})},e.prototype.init=function(t,e){this.goodsNameList=e,this.type=t,this.tips&&(this.tips.tipsType=h.default.MART_SHELVES+"x="+this.data.defaultPos.x+"y="+this.data.defaultPos.y),this.changeBg(t),this.addGoods(e)},e.prototype.changeBg=function(t){this.martshelvesbg||(this.martshelvesbg=this.node.getChildByName("sprite").getChildByName("martshelves"),this.martshelvesside0=this.node.getChildByName("sprite").getChildByName("martshelvesside0"),this.martshelvesside1=this.node.getChildByName("sprite").getChildByName("martshelvesside1"),this.martshelvesside2=this.node.getChildByName("sprite").getChildByName("martshelvesside2"),this.martshelvesside3=this.node.getChildByName("sprite").getChildByName("martshelvesside3"));var e=t==i.TYPE_WOOD?"#DF8143":"#FFFFFF";this.martshelvesbg.color=cc.color().fromHEX(e),t!=i.TYPE_FRIDGE&&(this.martshelvesside0.color=cc.color().fromHEX(e)),this.martshelvesside1.color=cc.color().fromHEX(e),this.martshelvesside2.color=cc.color().fromHEX(e),this.martshelvesside3.color=cc.color().fromHEX(e)},e.prototype.addGoods=function(t){this.layer.removeAllChildren();for(var e=this.type==i.TYPE_FRIDGE?i.SIZE_FRIDGE:i.SIZE_NORMAL,o=0;o<e;o++){if(o>t.length-1)return;var a=cc.instantiate(this.goods).getComponent(l.default),n=new r.default;n.count=10,n.item.valueCopy(c.default.items[t[o]]),a.init(n),this.goodsList.push(a),this.layer.addChild(a.node)}},e.prototype.onCollisionEnter=function(){},e.prototype.onCollisionExit=function(){},e.SIZE_NORMAL=21,e.SIZE_FRIDGE=12,e.TYPE_NORMAL="Sa",e.TYPE_WOOD="Sb",e.TYPE_FRIDGE="Sc",n([f(cc.Prefab)],e.prototype,"goods",void 0),n([f(cc.Node)],e.prototype,"layer",void 0),i=n([d],e)}(p.default);i.default=g,cc._RF.pop()},{"../Data/GoodsData":"GoodsData","../EventHelper":"EventHelper","../Item/Goods":"Goods","../Logic":"Logic","../UI/Tips":"Tips","./Building":"Building"}],MeleeWeaponChild:[function(t,e,i){"use strict";cc._RF.push(e,"81ac4Ib50VMBoiaBfrNyVFU","MeleeWeaponChild");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.meleeWeapon=null,e}return a(e,t),e.prototype.onLoad=function(){this.getComponent(cc.Sprite).spriteFrame},e.prototype.start=function(){},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],MeleeWeapon:[function(t,e,i){"use strict";cc._RF.push(e,"8747dgi/6dFupzO0r46t7Ya","MeleeWeapon");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Player"),s=t("./NonPlayer"),l=t("./EventHelper"),c=t("./Building/Box"),h=t("./Logic"),p=t("./MeleeWeaponChild"),u=t("./Data/DamageData"),d=t("./Manager/StatusManager"),f=t("./Boss/Boss"),g=t("./Utils/NextStep"),y=t("./Data/FromData"),m=t("./Utils/AudioPlayer"),v=t("./Utils/IndexZ"),E=t("./PlayerAvatar"),_=t("./Manager/InventoryManager"),D=t("./Building/HitBuilding"),S=t("./Data/CommonData"),R=t("./Data/AvatarData"),T=t("./Actor/ColliderTag"),O=t("./Utils/ActorUtils"),C=t("./Building/InteractBuilding"),A=cc._decorator,L=A.ccclass,P=A.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerNode=null,e.player=null,e.stabWeapon=null,e.waveWeapon=null,e.iceLight=null,e.fireLight=null,e.lighteningLight=null,e.toxicLight=null,e.curseLight=null,e.meleeLightLeftPos=cc.v3(8,0),e.meleeLightRightPos=cc.v3(-8,0),e.isAttacking=!1,e.hv=cc.v3(1,0),e.isStab=!0,e.isFar=!1,e.isFist=!0,e.isBlunt=!1,e.isMiss=!1,e.drainSkill=new g.default,e.isReflect=!1,e.weaponSprite=null,e.weaponStabSprite=null,e.weaponStabLightSprite=null,e.weaponLightSprite=null,e.handSprite=null,e.glovesSprite=null,e.comboType=0,e.isComboing=!1,e.hasTargetMap={},e.isSecond=!1,e.currentAngle=0,e.fistCombo=0,e.exBeatBack=0,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"IsSword",{get:function(){return!(this.isStab||this.isFar||this.isFist||this.isBlunt)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsSecond",{set:function(t){this.isSecond=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsFist",{get:function(){return this.isFist},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsComboing",{get:function(){return this.isComboing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsAttacking",{get:function(){return this.isAttacking},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsReflect",{get:function(){return this.isReflect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"GlovesSprite",{get:function(){return this.glovesSprite},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.player=this.playerNode.getComponent(r.default),this.weaponFirePoint=this.node.getChildByName("firepoint"),this.meleeLightLeftPos=this.player.node.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(this.meleeLightLeftPos)),this.meleeLightRightPos=this.player.node.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(this.meleeLightRightPos)),this.weaponSprite=this.getSpriteChildSprite(["sprite",_.default.WEAPON]),this.weaponStabSprite=this.getSpriteChildSprite(["sprite","stabweapon"]),this.weaponStabLightSprite=this.getSpriteChildSprite(["sprite","stablight"]),this.weaponLightSprite=this.getSpriteChildSprite(["sprite","meleelight"]),this.handSprite=this.getSpriteChildSprite(["sprite","hand"]),this.glovesSprite=this.getSpriteChildSprite(["sprite","hand","gloves"]),this.handSprite.node.color=cc.Color.WHITE.fromHEX(this.player.avatar.data.skinColor)},Object.defineProperty(e.prototype,"Hv",{get:function(){return this.hv},set:function(t){var e=this.hasNearEnemy();e.equals(cc.Vec3.ZERO)?this.hv=t.normalizeSelf():this.hv=e},enumerable:!1,configurable:!0}),e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,i=0,o=t;i<o.length;i++){var a=o[i];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.changeEquipment=function(t,e,i){if(_.default.WEAPON==t.equipmetType){this.isStab=1==t.stab,this.isFar=1==t.far,this.isReflect=1==t.isReflect,this.isFist=!1,this.isBlunt=1==t.blunt,this.exBeatBack=i.getEquipBySuit(t).exBeatBack,1==t.stab?(this.weaponSprite.spriteFrame=null,this.weaponStabSprite.spriteFrame=e,this.weaponStabLightSprite.spriteFrame=this.isFar?h.default.spriteFrameRes("stablight"):h.default.spriteFrameRes("stablight1")):(this.weaponSprite.spriteFrame=e,this.weaponStabSprite.spriteFrame=null);var o=cc.color(255,255,255).fromHEX(i.equips[_.default.WEAPON].color),a=cc.color(255,255,255).fromHEX(i.equips[_.default.WEAPON].lightcolor);this.weaponSprite.node.color=o,this.weaponStabSprite.node.color=o,this.weaponStabLightSprite.node.color=a,this.weaponLightSprite.node.color=a}else cc.log("its not a weapon")},e.prototype.updateCombo=function(){this.comboType==i.COMBO1?this.comboType=i.COMBO2:this.comboType==i.COMBO2?this.comboType=i.COMBO3:(this.comboType,i.COMBO3,this.comboType=i.COMBO1),this.isComboing||(this.comboType=i.COMBO1,this.isComboing=!0)},e.prototype.attack=function(t,e,o){var a=this;if(this.isAttacking)return!1;this.hasTargetMap={};var n=m.default.MELEE;this.fistCombo=o;var r=0;this.isStab&&!this.isFar&&(n=m.default.FIST),this.isStab||this.isFar||(n=m.default.SWORD_ATTACK),this.isStab&&this.isFar&&(r=.1,n=m.default.MELEE),!this.isStab&&this.isFar&&(r=.3,n=m.default.MELEE),this.scheduleOnce(function(){m.default.play(n)},r),this.updateCombo(),this.isMiss=e,this.isAttacking=!0;var s=t.FinalCommon,l=1+s.attackSpeed/500;if(l<.2&&(l=.2),l>3&&(l=3),this.anim){var c=this.getAttackAnimName();this.anim.play(c),this.anim.getAnimationState(c).speed=l}var p=this.weaponFirePoint.position.clone(),u=h.default.getRandomNum(0,100),d=[s.magicDamage>0&&u<s.iceRate?i.ELEMENT_TYPE_ICE:0,s.magicDamage>0&&u<s.fireRate?i.ELEMENT_TYPE_FIRE:0,s.magicDamage>0&&u<s.lighteningRate?i.ELEMENT_TYPE_LIGHTENING:0,s.magicDamage>0&&u<s.toxicRate?i.ELEMENT_TYPE_TOXIC:0,s.magicDamage>0&&u<s.curseRate?i.ELEMENT_TYPE_CURSE:0],f=!this.isStab&&this.isFar?.5:0;return this.scheduleOnce(function(){for(var t=0,e=d;t<e.length;t++){var i=e[t];a.getWaveLight(a.dungeon.node,p,i,a.isStab,a.isFar)}},f),!0},e.prototype.attackIdle=function(t){this.anim&&this.anim.play(t?"MeleeAttackIdleReverse":"MeleeAttackIdle")},e.prototype.getMeleeSlowRatio=function(){return!this.isFar&&this.isStab?.05:this.isFar&&this.isStab?.02:this.isFar||this.isStab?.01:.02},e.prototype.getAttackAnimName=function(){return(!this.isFar&&this.isStab?this.isFist?"MeleeAttackFist":"MeleeAttackStab":this.isFar&&this.isStab?"MeleeAttackStabFar":this.isFar&&!this.isStab?"MeleeAttackFar":this.isBlunt?"MeleeAttackBlunt":"MeleeAttack")+this.getComboSuffix()},e.prototype.getComboSuffix=function(){return this.isFist?this.isSecond?"2":"1":this.comboType==i.COMBO1?"1":this.comboType==i.COMBO2?"2":this.comboType==i.COMBO3?"3":"1"},e.prototype.getWaveLight=function(t,e,i,o,a){var n=[this.iceLight,this.fireLight,this.lighteningLight,this.toxicLight,this.curseLight];if(!(i<1||i>n.length)&&this.dungeon){var r=cc.instantiate(n[i-1]),s=60,l=60;o&&(s=10),a&&(s+=o?20:80,l+=10);var c=[cc.v3(e.x,e.y+l),cc.v3(e.x+.9*s,e.y+l/2),cc.v3(e.x+s,e.y),cc.v3(e.x+.9*s,-e.y-l/2),cc.v3(e.x,-e.y-l)],h=[cc.v3(e.x-2*s,e.y),cc.v3(e.x-.5*s,e.y),cc.v3(e.x,e.y),cc.v3(e.x+.5*s,e.y),cc.v3(e.x+s,e.y)];o||(h=c);for(var p=0;p<h.length;p++){var u=h[p];u=this.node.convertToWorldSpaceAR(u),u=t.convertToNodeSpaceAR(u),h[p]=u.clone()}r.parent=t,r.position=h[0],r.zIndex=v.default.OVERHEAD,r.opacity=255,r.setScale(.2),r.active=!0,cc.tween(r).to(.15,{position:h[1]}).to(.15,{position:h[2]}).to(.1,{position:h[3]}).to(.1,{position:h[4]}).start()}},e.prototype.MeleeAttackFinish=function(){var t=this;this.scheduleOnce(function(){t.isAttacking=!1},.05),this.scheduleOnce(function(){t.isAttacking||(t.isComboing=!1)},.3)},e.prototype.ExAttackTime=function(){this.player.remoteExAttack(this.comboType)},e.prototype.AudioTime=function(){var t=m.default.MELEE;this.isStab&&!this.isFar&&(t=m.default.FIST),this.isStab||this.isFar||(t=m.default.SWORD_ATTACK),this.isStab&&this.isFar&&(t=m.default.MELEE),!this.isStab&&this.isFar&&(t=m.default.MELEE),m.default.play(t)},e.prototype.RefreshTime=function(){this.hasTargetMap={}},e.prototype.DashTime=function(t){var e=this;m.default.play(m.default.DASH),t||(t=600),this.schedule(function(){e.player.getWalkSmoke(e.player.node,e.node.position)},.05,4,0);var i=cc.v2(this.hv.x,this.hv.y);this.player.sc.isMoving=!1,this.player.isWeaponDashing=!0,i=i.equals(cc.Vec2.ZERO)?this.player.isFaceRight?cc.v2(1,0):cc.v2(-1,0):i.normalizeSelf();var o=cc.v3(i.x,i.y);this.hv=o.clone(),i=i.mul(t),this.player.rigidbody.linearVelocity=i,this.scheduleOnce(function(){e.player.isWeaponDashing=!1,e.player.rigidbody.linearVelocity=cc.Vec2.ZERO,e.player.playerAnim(E.default.STATE_IDLE,e.player.currentDir)},.2)},e.prototype.setHandAndWeaponInVisible=function(t){t?(this.weaponSprite.node.opacity=0,this.weaponStabSprite.node.opacity=0,this.handSprite.node.opacity=0):(this.weaponSprite.node.opacity=255,this.weaponStabSprite.node.opacity=255,this.handSprite.node.opacity=255)},e.prototype.updateLogic=function(t){this.node.angle=h.default.lerp(this.node.angle,this.currentAngle,5*t);var e=this.hasNearEnemy();if(e.equals(cc.Vec3.ZERO)){if((0!=this.hv.x||0!=this.hv.y)&&!this.isAttacking){var i=cc.v3(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(i)}}else this.isAttacking||this.rotateColliderManager(cc.v3(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e},e.prototype.hasNearEnemy=function(){var t=1e3,e=cc.v3(0,0);if(this.dungeon){var i=O.default.getNearestEnemyActor(this.player,!1,this.dungeon);if(i){var o=h.default.getDistance(this.player.node.position,i.node.position);if(o<200&&o<t&&!i.sc.isDied){t=o;var a=this.node.position.clone();a.x=this.node.scaleX>0?a.x:-a.x,e=i.getCenterPosition().sub(this.player.node.position.add(a))}}1e3!=t&&(e=e.normalizeSelf())}return e},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),i=360/(2*Math.PI),o=360-Math.atan2(e.x,e.y)*i,a=Math.abs(this.node.scaleX);this.node.scaleX=this.player.node.scaleX>0?a:-a;var n=Math.abs(this.node.scaleY);this.node.scaleY=this.node.scaleX<0?-n:n,(o+=90)>=360&&(o-=360),o<=-360&&(o+=360);var r=this.currentAngle;this.currentAngle=this.node.scaleX<0?-o:o,(r>=0&&this.currentAngle<0||r<0&&this.currentAngle>=0)&&(this.node.angle=this.currentAngle)},e.prototype.onCollisionStay=function(t,e){if(e.radius>0)return this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0?(this.hasTargetMap[t.node.uuid]++,!1):(this.hasTargetMap[t.node.uuid]=1,this.attacking(t))},e.prototype.beatBack=function(t){var e=t.getComponent(cc.RigidBody),o=this.Hv.clone();o.equals(cc.Vec3.ZERO)&&(o=cc.v3(1,0));var a=50+this.exBeatBack;a=!this.isFar&&this.isStab?50:this.isFar&&this.isStab?250:this.isFar||this.isStab?50:150,this.comboType==i.COMBO3&&(a+=50),o=o.normalizeSelf().mul(a),this.scheduleOnce(function(){e.applyLinearImpulse(cc.v2(o.x,o.y),e.getLocalCenter(),!0)},.1)},e.prototype.attacking=function(t){var e=this;if(!t||!this.isAttacking)return!1;var o=new u.default,a=new S.default;this.player&&(o=this.player.data.getFinalAttackPoint(),a=this.player.data.FinalCommon),o.isStab=this.isStab,o.isFist=this.isFist,o.isFar=this.isFar,o.isBlunt=this.isBlunt,o.isMelee=!0,o.comboType=this.comboType,this.isFist&&(o.comboType=this.fistCombo);var n=!1,r=!1;if(t.tag==T.ColliderTag.NONPLAYER){var h=t.node.getComponent(s.default);h&&!h.sc.isDied&&!this.isMiss&&h.data.isEnemy>0&&(o.isBackAttack=h.isPlayerBehindAttack()&&a.damageBack>0,o.isBackAttack&&(o.realDamage+=a.damageBack),(n=h.takeDamage(o))&&(this.beatBack(h),this.addTargetAllStatus(a,h)))}else if(t.tag==T.ColliderTag.BOSS){var p=t.node.getComponent(f.default);!p||p.sc.isDied||this.isMiss||(n=p.takeDamage(o))&&this.addTargetAllStatus(a,p)}else if(t.tag==T.ColliderTag.BUILDING||t.tag==T.ColliderTag.WALL){var d=t.node.getComponent(c.default);if(d&&(r=!0,d.breakBox()),!r){var g=t.node.getComponent(C.default);g&&(r=!0,g.takeDamage(o))}if(!r){var y=t.node.getComponent(D.default);y&&(r=!0,y.takeDamage(o))}}return n&&this.drainSkill.next(function(){var t=e.player.data.getLifeDrain();t>0&&e.player.takeDamage(new u.default(-t))},1,!0),this.isMiss=!1,(n||r)&&(this.anim.pause(),cc.director.emit(l.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:this.comboType==i.COMBO3}}),this.scheduleOnce(function(){e.anim.resume()},.1)),n&&this.player.data.AvatarData.organizationIndex==R.default.TECH&&this.player.updateDream(-1),n||r},e.prototype.addTargetAllStatus=function(t,e){this.addTargetStatus(t.iceRate,e,d.default.FROZEN),this.addTargetStatus(t.fireRate,e,d.default.BURNING),this.addTargetStatus(t.lighteningRate,e,d.default.DIZZ),this.addTargetStatus(t.toxicRate,e,d.default.TOXICOSIS),this.addTargetStatus(t.curseRate,e,d.default.CURSING),this.addTargetStatus(t.realRate,e,d.default.BLEEDING)},e.prototype.addTargetStatus=function(t,e,i){h.default.getRandomNum(0,100)<t&&e.addStatus(i,new y.default)},e.ELEMENT_TYPE_ICE=1,e.ELEMENT_TYPE_FIRE=2,e.ELEMENT_TYPE_LIGHTENING=3,e.ELEMENT_TYPE_TOXIC=4,e.ELEMENT_TYPE_CURSE=5,e.COMBO1=1,e.COMBO2=2,e.COMBO3=3,n([P(cc.Node)],e.prototype,"playerNode",void 0),n([P(p.default)],e.prototype,"stabWeapon",void 0),n([P(p.default)],e.prototype,"waveWeapon",void 0),n([P(cc.Prefab)],e.prototype,"iceLight",void 0),n([P(cc.Prefab)],e.prototype,"fireLight",void 0),n([P(cc.Prefab)],e.prototype,"lighteningLight",void 0),n([P(cc.Prefab)],e.prototype,"toxicLight",void 0),n([P(cc.Prefab)],e.prototype,"curseLight",void 0),i=n([L],e)}(cc.Component);i.default=b,cc._RF.pop()},{"./Actor/ColliderTag":"ColliderTag","./Boss/Boss":"Boss","./Building/Box":"Box","./Building/HitBuilding":"HitBuilding","./Building/InteractBuilding":"InteractBuilding","./Data/AvatarData":"AvatarData","./Data/CommonData":"CommonData","./Data/DamageData":"DamageData","./Data/FromData":"FromData","./EventHelper":"EventHelper","./Logic":"Logic","./Manager/InventoryManager":"InventoryManager","./Manager/StatusManager":"StatusManager","./MeleeWeaponChild":"MeleeWeaponChild","./NonPlayer":"NonPlayer","./Player":"Player","./PlayerAvatar":"PlayerAvatar","./Utils/ActorUtils":"ActorUtils","./Utils/AudioPlayer":"AudioPlayer","./Utils/IndexZ":"IndexZ","./Utils/NextStep":"NextStep"}],MgCrack:[function(t,e,i){"use strict";cc._RF.push(e,"1d929jibO9BjosaDA5nr9aL","MgCrack");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Utils/AudioPlayer"),l=t("./MonsterGenerator"),c=cc._decorator,h=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=["crack000","crack001","crack002","crack003"],e}return a(e,t),e.prototype.init=function(e,i,o,a){t.prototype.init.call(this,e,i,o,a),this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite)},e.prototype.setFrames=function(t){this.frames=t},e.prototype.open=function(){var e=this;if(t.prototype.open.call(this)){s.default.play(s.default.SCARABCRAWL);for(var i=cc.tween(this.sprite),o=function(t){i.then(cc.tween(a.sprite).delay(.2).call(function(){e.sprite.spriteFrame=r.default.spriteFrameRes(t)}))},a=this,n=0,l=this.frames;n<l.length;n++)o(l[n]);i.call(function(){e.showMonster()}).start()}return!0},e.prototype.addMonster=function(){return t.prototype.addMonster.call(this)&&(s.default.play(s.default.SCARABCRAWL),this.showMonster()),!0},n([h],e)}(l.default));i.default=p,cc._RF.pop()},{"../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","./MonsterGenerator":"MonsterGenerator"}],MgWentLine:[function(t,e,i){"use strict";cc._RF.push(e,"657e7MsMqdJ2by+hThG3E0k","MgWentLine");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Utils/AudioPlayer"),s=t("./MonsterGenerator"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(e,i,o,a){t.prototype.init.call(this,e,i,o,a),this.node.getChildByName("sprite").getChildByName("door").opacity=this.data.isOpen?0:255},e.prototype.open=function(){return t.prototype.open.call(this)&&(this.anim.play("WentLineOpen"),r.default.play(r.default.WENTLINE_OPEN)),!0},e.prototype.ShowFinish=function(){this.showMonster()},e.prototype.addMonster=function(){return t.prototype.addMonster.call(this)&&(this.anim.play("WentLineShow"),r.default.play(r.default.WENTLINE_SHOW)),!0},n([c],e)}(s.default));i.default=h,cc._RF.pop()},{"../Utils/AudioPlayer":"AudioPlayer","./MonsterGenerator":"MonsterGenerator"}],MiniMap:[function(t,e,i){"use strict";cc._RF.push(e,"b8f7e0qah9Ot5qnGbL59sxK","MiniMap");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./Rect/RectRoom"),l=t("./EventHelper"),c=t("./Rect/RoomType"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.miniTile=null,e.width=0,e.height=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;cc.director.on(l.EventHelper.CHANGE_MINIMAP,function(e){t.changeMap(e.detail.x,e.detail.y)}),this.width=r.default.mapManager.rectDungeon.map.length,this.height=r.default.mapManager.rectDungeon.map[0].length,this.map=new Array;for(var e=0;e<this.width;e++){this.map[e]=new Array;for(var i=0;i<this.height;i++){var o=cc.instantiate(this.miniTile);o.group="ui",this.map[e][i]=o,this.map[e][i].parent=this.node,this.map[e][i].position=cc.v3(e*o.width,i*o.height),this.map[e][i].color=cc.Color.BLACK,this.map[e][i].opacity=0}}},e.prototype.start=function(){},e.prototype.changeMap=function(t,e){var o=r.default.worldLoader.getCurrentLevelData();if(this.map)for(var a=r.default.groundOilGoldData.clone(),n=0;n<this.height;n++)for(var l=0;l<this.width;l++){var h=r.default.mapManager.rectDungeon.map[l][n];if(h){var p=h.state,u=h.roomType;o.minimap[l][n]&&(this.map[l][n].getComponent(cc.Sprite).spriteFrame=r.default.spriteFrameRes("minimap"+o.minimap[l][n])),o.minimaplock[l][n]?this.map[l][n].getChildByName("lock").getComponent(cc.Sprite).spriteFrame=r.default.spriteFrameRes("minimaplock"+o.minimaplock[l][n]):this.map[l][n].getChildByName("lock").getComponent(cc.Sprite).spriteFrame=null,a.chapter==r.default.chapterIndex&&a.level==r.default.level&&a.x==h.x&&a.y==h.y&&a.value>0&&(this.map[l][n].getChildByName("label").active=!0),this.map[l][n].color=this.getColor(i.ColorLevel.HIDE),this.map[l][n].color=this.getColor(i.ColorLevel.NORMAL),this.map[l][n].opacity=255;var d=p==s.default.STATE_CLEAR;this.map[l][n].color=this.getColor(d?i.ColorLevel.CLEAR:i.ColorLevel.NORMAL),this.getMapColor(l,n,u,c.default.EMPTY_ROOM,d,i.ColorLevel.EMPTY,i.ColorLevel.EMPTY),this.getMapColor(l,n,u,c.default.BOSS_ROOM,d,i.ColorLevel.NORMAL_BOSS,i.ColorLevel.CLEAR_BOSS),this.getMapColor(l,n,u,c.default.LOOT_ROOM,d,i.ColorLevel.NORMAL_LOOT,i.ColorLevel.CLEAR_LOOT),this.getMapColor(l,n,u,c.default.MERCHANT_ROOM,d,i.ColorLevel.NORMAL_MERCHANT,i.ColorLevel.CLEAR_MERCHANT),this.getMapColor(l,n,u,c.default.START_ROOM,d,i.ColorLevel.NORMAL_START,i.ColorLevel.NORMAL_START),this.getMapColor(l,n,u,c.default.END_ROOM,d,i.ColorLevel.NORMAL_END,i.ColorLevel.CLEAR_END),this.getMapColor(l,n,u,c.default.ELITE_ROOM,d,i.ColorLevel.NORMAL_PUZZLE,i.ColorLevel.CLEAR_PUZZLE),this.getMapColor(l,n,u,c.default.REST_ROOM,d,i.ColorLevel.NORMAL_REST,i.ColorLevel.NORMAL_REST),this.getMapColor(l,n,u,c.default.PREPARE_ROOM,d,i.ColorLevel.NORMAL_PREPARE,i.ColorLevel.NORMAL_PREPARE),this.getMapColor(l,n,u,c.default.TEST_ROOM,d,i.ColorLevel.NORMAL_TEST,i.ColorLevel.NORMAL_TEST),u==c.default.START_ROOM&&(this.map[l][n].color=this.getColor(i.ColorLevel.NORMAL_START)),l==t&&n==e&&(this.map[t][e].color=this.getColor(i.ColorLevel.PLAYER))}}},e.prototype.getMapColor=function(t,e,i,o,a,n,r){i.isEqual(o)&&(this.map[t][e].color=this.getColor(a?r:n))},e.prototype.getColor=function(t){var e=new cc.Color(0,0,0);switch(t){case i.ColorLevel.EMPTY:case i.ColorLevel.HIDE:e=new cc.Color(0,0,0);break;case i.ColorLevel.NORMAL:e=new cc.Color(128,128,128);break;case i.ColorLevel.CLEAR:e=new cc.Color(255,255,255);break;case i.ColorLevel.PLAYER:e=new cc.Color(0,255,0);break;case i.ColorLevel.NORMAL_START:e=new cc.Color(144,238,144);break;case i.ColorLevel.NORMAL_END:e=new cc.Color(100,149,237);break;case i.ColorLevel.NORMAL_BOSS:e=new cc.Color(128,0,128);break;case i.ColorLevel.NORMAL_LOOT:case i.ColorLevel.NORMAL_MERCHANT:e=new cc.Color(255,215,0);break;case i.ColorLevel.NORMAL_REST:e=new cc.Color(139,69,19);break;case i.ColorLevel.NORMAL_PREPARE:e=new cc.Color(255,165,0);break;case i.ColorLevel.NORMAL_TEST:e=new cc.Color(238,130,238);break;case i.ColorLevel.NORMAL_PUZZLE:e=new cc.Color(128,0,128);break;case i.ColorLevel.CLEAR_LOOT:case i.ColorLevel.CLEAR_MERCHANT:e=new cc.Color(240,230,140);break;case i.ColorLevel.CLEAR_BOSS:e=new cc.Color(75,0,130);break;case i.ColorLevel.CLEAR_END:e=new cc.Color(176,196,222);break;case i.ColorLevel.CLEAR_PUZZLE:e=new cc.Color(75,0,130)}return e},e.prototype.getMixColor=function(t,e){var i=t.clone(),o=e.clone(),a=cc.color(),n=i.getR()+o.getR(),r=i.getG()+o.getG(),s=i.getB()+o.getB();return a.setR(n>255?255:n),a.setG(r>255?255:r),a.setB(s>255?255:s),a},e.ColorLevel={EMPTY:-1,HIDE:0,NORMAL:1,PLAYER:2,CLEAR:3,NORMAL_BOSS:4,CLEAR_PUZZLE:5,CLEAR_END:6,CLEAR_BOSS:7,NORMAL_LOOT:8,CLEAR_LOOT:9,NORMAL_START:10,NORMAL_END:11,NORMAL_REST:12,NORMAL_PREPARE:13,NORMAL_TEST:14,NORMAL_PUZZLE:15,NORMAL_MERCHANT:16,CLEAR_MERCHANT:17},n([u(cc.Prefab)],e.prototype,"miniTile",void 0),i=n([p],e)}(cc.Component);i.default=d,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic","./Rect/RectRoom":"RectRoom","./Rect/RoomType":"RoomType"}],MonsterGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"b0bbeYGzEhP+4L1gNiAPnRb","MonsterGenerator");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Actor/ColliderTag"),s=t("../Dungeon"),l=t("../Logic"),c=t("../Utils/IndexZ"),h=t("./Building"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canAdd=!1,e.addFinish=!1,e.count=0,e.addDelay=2,e.timeDelay=0,e}return a(e,t),e.prototype.init=function(t,e,i,o){this.dungeon=t,this.data.generatorCount=i,this.data.generatorInterval=e,this.data.generatorList=o,this.node.zIndex=c.default.getActorZIndex(this.node.position.clone().add(cc.v3(0,120)));var a=l.default.mapManager.getCurrentRoom().isReborn,n=l.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);n?(this.data.isOpen=n.isOpen,a&&(this.data.isOpen=!1)):l.default.mapManager.setCurrentBuildingData(this.data.clone()),this.anim=this.getComponent(cc.Animation),this.addFinish=this.data.isOpen},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>this.data.generatorInterval&&(this.timeDelay=0,!0)},e.prototype.update=function(t){l.default.isGamePause||this.isTimeDelay(t)&&this.addMonster()},e.prototype.addMonster=function(){return this.count>=this.data.generatorCount?(this.addFinish=!0,!1):!!this.canAdd},e.prototype.showMonster=function(){var t=s.default.getIndexInMap(this.node.position.clone());this.dungeon.monsterManager.addMonsterFromData(this.data.generatorList[l.default.getRandomNum(0,this.data.generatorList.length-1)],t,this.dungeon,!0),this.count++},e.prototype.open=function(){var t=this;if(this.data.isOpen)return!1;this.data.isOpen=!0,this.scheduleOnce(function(){t.canAdd=!0},this.addDelay);var e=l.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);return e?e.isOpen=this.data.isOpen:l.default.mapManager.setCurrentBuildingData(this.data.clone()),!0},e.prototype.onCollisionEnter=function(t){this.data.isOpen||t.tag!=r.ColliderTag.PLAYER||this.open()},n([u],e)}(h.default));i.default=d,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../Logic":"Logic","../Utils/IndexZ":"IndexZ","./Building":"Building"}],MonsterManager:[function(t,e,i){"use strict";cc._RF.push(e,"441f6g4iH9M574s+sdv3n8E","MonsterManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../NonPlayer"),s=t("../Dungeon"),l=t("../Logic"),c=t("../Boss/Slime"),h=t("../Rect/RoomType"),p=t("../Boss/Boss"),u=t("./BaseManager"),d=t("../UI/GameHud"),f=t("./MonsterRandomAttr"),g=t("../Utils/Random4Save"),y=t("../Data/NonPlayerData"),m=cc._decorator,v=m.ccclass,E=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monster=null,e.kraken=null,e.captain=null,e.slime=null,e.warmachine=null,e.rah=null,e.iceDemon=null,e.evilEye=null,e.dryad=null,e.sphinx=null,e.dragon=null,e.maxHealth00=200,e.maxHealth01=400,e.maxHealth02=600,e.maxHealth03=800,e.maxHealth04=1e3,e.maxHealth05=1200,e.maxHealth06=1400,e.maxHealth07=1600,e.maxHealth08=1800,e.maxHealth09=2e3,e.monsters=new Array,e.bosses=new Array,e.isRoomInitWithEnemy=!1,e.seed=0,e.monsterRandomAttr=new f.default,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"monsterList",{get:function(){return this.monsters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bossList",{get:function(){return this.bosses},enumerable:!1,configurable:!0}),e.prototype.clear=function(){for(var t=0,e=this.monsters;t<e.length;t++){var i=e[t];i&&i.isValid&&i.destroy()}for(var o=0,a=this.bosses;o<a.length;o++){var n=a[o];n&&n.isValid&&n.destroy()}this.monsters=new Array,this.bosses=new Array},e.prototype.addMonsterFromData=function(t,e,i,o){this.addMonster(this.getMonster(t,i,o),e)},e.prototype.addMonstersAndBossFromMap=function(t,e,o){if(s.default.isFirstEqual(e,"M")){var a=parseInt(e[1]);if(isNaN(a))"a"==e[1]?this.addMonsterFromData(i.MONSTER_DUMMY,o,t,!1):"b"==e[1]&&this.addMonsterFromData(i.MONSTER_CHEST,o,t,!1);else{var n=new Array;switch(l.default.chapterIndex){case l.default.CHAPTER00:n=i.MONSTERS_LAB;break;case l.default.CHAPTER01:n=i.MONSTERS_SHIP;break;case l.default.CHAPTER02:n=i.MONSTERS_FOREST;break;case l.default.CHAPTER03:n=i.MONSTERS_PYRAMID;break;case l.default.CHAPTER04:case l.default.CHAPTER05:n=i.MONSTERS_DUNGEON;break;case l.default.CHAPTER099:n=i.MONSTERS_LAB}this.addMonsterFromData(n[a],o,t,!1)}}else"z0"==e?this.addBoss(this.iceDemon,"iconboss000",this.maxHealth00,0,2,o,t):"z1"==e?this.addBoss(this.warmachine,"iconboss001",this.maxHealth01,2,3.5,o,t):"z2"==e?this.addBoss(this.captain,"iconboss002",this.maxHealth02,2,0,o,t):"z3"==e?(t.shakeForKraken(),this.addBoss(this.kraken,"iconboss003",this.maxHealth03,2,3.5,o,t)):"z4"==e?this.addBossSlime(0,o,t):"z5"==e?this.addBoss(this.dryad,"iconboss005",this.maxHealth05,2,2,o,t):"z6"==e?this.addBoss(this.rah,"iconboss006",this.maxHealth06,2,2,o,t):"z7"==e?this.addBoss(this.sphinx,"iconboss007",this.maxHealth07,2,2,o,t):"z8"==e?this.addBoss(this.evilEye,"iconboss008",this.maxHealth08,2,2,o,t):"z9"==e&&this.addBoss(this.dragon,"iconboss009",this.maxHealth09,5,2,o,t)},e.prototype.getRandomMonsterSeed=function(){return l.default.mapManager.getCurrentRoom().seed+this.seed++},e.prototype.getMonster=function(t,e,i){var o=null;(o=cc.instantiate(this.monster)).active=!1,o.parent=e.node;var a=o.getComponent(r.default),n=new y.default;a.seed=this.getRandomMonsterSeed(),a.killPlayerCount=l.default.getKillPlayerCount(a.seed);var s=l.default.mapManager.getRandom4Save(a.seed);a.dungeon=e,n.valueCopy(l.default.monsters[t]);var c=l.default.mapManager.getCurrentRoom().reborn;n.reborn=c||0,a.isSummon=i,s.rand()<.1+a.killPlayerCount/10&&(this.monsterRandomAttr.addRandomAttrs(2,s),n=this.monsterRandomAttr.updateMonsterData(n),a.attrmap=this.monsterRandomAttr.attrmap);var p=5+2*a.killPlayerCount,u=0;l.default.mapManager.getCurrentRoomType().isEqual(h.default.DANGER_ROOM)&&(u=10),l.default.mapManager.getCurrentRoomType().isEqual(h.default.INSANE_ROOM)&&(u=30),p=p+2*l.default.chapterIndex+2*l.default.level+u,a.isVariation=s.getRandomNum(0,100)<p&&n.isTest<1,a.isVariation&&(n.Common.maxHealth=2*n.Common.maxHealth,n.Common.maxDream=2*n.Common.maxDream,n.Common.damageMin=2*n.Common.damageMin,n.currentHealth=n.Common.maxHealth,n.melee>0&&(n.melee=n.melee>1?n.melee-1:1),n.remote>0&&(n.remote=n.remote>1?n.remote-1:1),n.dash>0&&(n.dash=n.dash>1?n.dash-1:1),n.Common.moveSpeed=n.Common.moveSpeed>0?n.Common.moveSpeed+100+10*a.killPlayerCount:0),n.Common.maxDream+=.25*n.Common.maxDream*a.killPlayerCount,n.Common.damageMin+=.25*n.Common.damageMin*a.killPlayerCount,n.Common.maxHealth+=.25*n.Common.maxHealth*a.killPlayerCount,n.Common.defence+=3*a.killPlayerCount,n.currentHealth=n.Common.maxHealth,n.melee-a.killPlayerCount>1&&(n.melee-=a.killPlayerCount),n.remote-a.killPlayerCount>1&&(n.remote-=a.killPlayerCount),n.dash-a.killPlayerCount>1&&(n.dash-=a.killPlayerCount);var d=s.getRandomNum(0,100),f=s.getRandomNum(80,100),g=s.getRandomNum(80,100),m=d<=5+3*a.killPlayerCount;if(d=s.getRandomNum(0,4),m)switch(n.Common.magicDamage+=1,n.Common.magicDefence=n.Common.magicDefence+f>100?100:n.Common.magicDefence+f,d){case 0:n.Common.iceRate=n.Common.iceRate+g>100?100:n.Common.iceRate+g,n.bodyColor="#CCFFFF";break;case 1:n.Common.fireRate=n.Common.fireRate+g>100?100:n.Common.fireRate+g,n.bodyColor="#FF6633";break;case 2:n.Common.lighteningRate=n.Common.lighteningRate+g>100?100:n.Common.lighteningRate+g,n.bodyColor="#0099FF";break;case 3:n.Common.toxicRate=n.Common.toxicRate+g>100?100:n.Common.toxicRate+g,n.bodyColor="#66CC00";break;case 4:n.Common.curseRate=n.Common.curseRate+g>100?100:n.Common.curseRate+g,n.bodyColor="#660099"}return n.isEnemy=1,a.data=n,a.sc.isDisguising=n.disguise>0,a.sc.isDisguising?a.changeBodyRes(n.resName,r.default.RES_DISGUISE):a.changeBodyRes(t,r.default.RES_IDLE000),a.addAttrIcon(),a},e.prototype.addMonster=function(t,e){t.node.active=!0,t.pos=e,t.node.position=s.default.getPosInMap(e),this.isRoomInitWithEnemy=t.data.isTest<1,this.monsterList.push(t)},e.prototype.addBossSlime=function(t,e,i){this.bosses&&(this.isRoomInitWithEnemy=!0,this.bosses.push(this.getSlime(i,e.clone(),t)))},e.prototype.addBoss=function(t,e,i,o,a,n,r){var s=cc.instantiate(t);s.active=!1,s.parent=r.node;var l=s.getComponent(p.default);l.dungeon=r;var c=new y.default;c.resName=e,c.updateHA(i,i,o),l.data=c,l.transportBoss(n.x,n.y),l.healthBar=this.node.parent.getComponentInChildren(d.default).bossHealthBar,l.node.active=!0,this.bosses.push(l),this.isRoomInitWithEnemy=!0,this.scheduleOnce(function(){l.showBoss()},a)},e.prototype.getSlime=function(t,e,i){var o=null;(o=cc.instantiate(this.slime)).active=!1,o.parent=t.node;var a=o.getComponent(c.default);a.dungeon=t;var n=new y.default;switch(n.resName="iconboss004",n.Common.moveSpeed=200,i){case 0:n.updateHA(this.maxHealth04,this.maxHealth04,9),a.scaleSize=2;break;case 1:n.updateHA(200,200,7),a.scaleSize=1.5;break;case 2:n.updateHA(100,100,7),a.scaleSize=1;break;case 3:n.updateHA(50,50,5),a.scaleSize=.5;break;case 4:n.updateHA(25,25,3),a.scaleSize=.3;break;case 5:n.updateHA(10,10,2),a.scaleSize=.2;break;default:n.updateHA(5,5,1),a.scaleSize=.2}return a.slimeType=i,a.node.scaleY=a.scaleSize,a.node.scaleX=a.scaleSize,a.data=n,a.transportBoss(e.x,e.y),a.healthBar=this.node.parent.getComponentInChildren(d.default).bossHealthBar,a.node.active=!0,this.bosses.push(a),a},e.prototype.addRandomMonsters=function(t){var e=new Array,o=new g.default(l.default.mapManager.getCurrentRoom().seed),a=o.getRandomNum(1,3),n=0;switch(l.default.mapManager.getCurrentRoomType().isEqual(h.default.DANGER_ROOM)&&(n=2),l.default.mapManager.getCurrentRoomType().isEqual(h.default.INSANE_ROOM)&&(n=5),l.default.chapterIndex){case l.default.CHAPTER00:e=i.MONSTERS_LAB,a=o.getRandomNum(3,6);break;case l.default.CHAPTER01:e=i.MONSTERS_SHIP,a=o.getRandomNum(3,7);break;case l.default.CHAPTER02:e=i.MONSTERS_FOREST,a=o.getRandomNum(4,8);break;case l.default.CHAPTER03:e=i.MONSTERS_PYRAMID,a=o.getRandomNum(4,9);break;case l.default.CHAPTER04:e=i.MONSTERS_DUNGEON,a=o.getRandomNum(5,10);break;case l.default.CHAPTER05:e=i.MONSTERS_DUNGEON,a=o.getRandomNum(5,11);break;case l.default.CHAPTER099:e=i.MONSTERS_LAB,a=o.getRandomNum(1,3)}(l.default.mapManager.getCurrentRoomType().isEqual(h.default.VERTICAL_ROOM)||l.default.mapManager.getCurrentRoomType().isEqual(h.default.HORIZONTAL_ROOM))&&(a=Math.floor(a/2));for(var r=[],s=0;s<t.floorIndexmap.length;s++)r.push(t.floorIndexmap[s]);for(s=0;s<=a+n;s++)if(!(r.length<1)){var c=o.getRandomNum(0,r.length-1),p=r[c];r.splice(c,1),this.addMonsterFromData(e[o.getRandomNum(0,e.length-1)],cc.v3(p.x,p.y),t,!1)}},e.prototype.updateLogic=function(t){for(var e=0,i=this.monsters;e<i.length;e++){var o=i[e];o&&o.node.active&&o.updateLogic(t)}for(var a=0,n=this.bosses;a<n.length;a++){var r=n[a];r&&r.node.active&&r.updateLogic(t)}},e.BOSS_KRAKEN="BOSS_KRAKEN",e.MONSTER_SLIME="monster000",e.MONSTER_GOBLIN="monster001",e.MONSTER_MUMMY="monster002",e.MONSTER_ANUBIS="monster003",e.MONSTER_PIRATE="monster004",e.MONSTER_SAILOR="monster005",e.MONSTER_OCTOPUS="monster006",e.MONSTER_KILLER="monster007",e.MONSTER_STRONGSAILOR="monster008",e.MONSTER_CHEST="monster009",e.MONSTER_GARGOYLE="monster010",e.MONSTER_CHICKEN="monster011",e.MONSTER_SCARAB="monster012",e.MONSTER_GOBLIN_ARCHER="monster013",e.MONSTER_TERRORDRONE="monster014",e.MONSTER_WEREWOLF="monster015",e.MONSTER_DUMMY="monster016",e.MONSTER_ZEBRA="monster017",e.MONSTER_GIRAFFE="monster018",e.MONSTER_ZOOMBIE="monster019",e.MONSTER_ELECTRICEYE="monster020",e.MONSTER_FISH="monster021",e.MONSTER_CROCODILE="monster022",e.MONSTER_SNAKE="monster023",e.MONSTER_DEMON="monster024",e.MONSTER_WARLOCK="monster025",e.MONSTER_SPIDER="monster026",e.MONSTER_BOOMER="monster027",e.MONSTER_SANDSTATUE="monster028",e.MONSTER_HIPPO="monster029",e.MONSTER_CYCLOPS="monster030",e.MONSTER_ICEDEMON="monster031",e.MONSTER_BITE_ZOMBIE="monster032",e.MONSTER_BANANA="monster033",e.MONSTERS_LAB=[i.MONSTER_ZEBRA,i.MONSTER_TERRORDRONE,i.MONSTER_KILLER,i.MONSTER_ZOOMBIE,i.MONSTER_ELECTRICEYE,i.MONSTER_GIRAFFE,i.MONSTER_ICEDEMON,i.MONSTER_BITE_ZOMBIE],e.MONSTERS_SHIP=[i.MONSTER_PIRATE,i.MONSTER_SAILOR,i.MONSTER_OCTOPUS,i.MONSTER_STRONGSAILOR,i.MONSTER_FISH,i.MONSTER_BOOMER],e.MONSTERS_FOREST=[i.MONSTER_SLIME,i.MONSTER_GOBLIN,i.MONSTER_GOBLIN_ARCHER,i.MONSTER_WEREWOLF,i.MONSTER_SNAKE,i.MONSTER_CHICKEN,i.MONSTER_HIPPO,i.MONSTER_BANANA],e.MONSTERS_PYRAMID=[i.MONSTER_MUMMY,i.MONSTER_ANUBIS,i.MONSTER_SCARAB,i.MONSTER_CROCODILE,i.MONSTER_SANDSTATUE],e.MONSTERS_DUNGEON=[i.MONSTER_GARGOYLE,i.MONSTER_WARLOCK,i.MONSTER_DEMON,i.MONSTER_CYCLOPS,i.MONSTER_SPIDER,i.MONSTER_CYCLOPS],e.MONSTERS_SPECIAL=[i.MONSTER_DUMMY,i.MONSTER_CHEST],n([E(cc.Prefab)],e.prototype,"monster",void 0),n([E(cc.Prefab)],e.prototype,"kraken",void 0),n([E(cc.Prefab)],e.prototype,"captain",void 0),n([E(cc.Prefab)],e.prototype,"slime",void 0),n([E(cc.Prefab)],e.prototype,"warmachine",void 0),n([E(cc.Prefab)],e.prototype,"rah",void 0),n([E(cc.Prefab)],e.prototype,"iceDemon",void 0),n([E(cc.Prefab)],e.prototype,"evilEye",void 0),n([E(cc.Prefab)],e.prototype,"dryad",void 0),n([E(cc.Prefab)],e.prototype,"sphinx",void 0),n([E(cc.Prefab)],e.prototype,"dragon",void 0),i=n([v],e)}(u.default);i.default=_,cc._RF.pop()},{"../Boss/Boss":"Boss","../Boss/Slime":"Slime","../Data/NonPlayerData":"NonPlayerData","../Dungeon":"Dungeon","../Logic":"Logic","../NonPlayer":"NonPlayer","../Rect/RoomType":"RoomType","../UI/GameHud":"GameHud","../Utils/Random4Save":"Random4Save","./BaseManager":"BaseManager","./MonsterRandomAttr":"MonsterRandomAttr"}],MonsterRandomAttr:[function(t,e,i){"use strict";cc._RF.push(e,"9949f1Fu8NGLLz3ZQCj49YJ","MonsterRandomAttr"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.attrmap={},this.attrmap={}}return t.prototype.hasAttr=function(t){return this.attrmap[t]&&this.attrmap[t]>0},t.prototype.addAttr=function(t){var e=t>9?""+t:"0"+t;this.attrmap["attr_"+e]=1},t.prototype.removeAttr=function(t){var e=t>9?""+t:"0"+t;this.attrmap["attr_"+e]=0},t.prototype.addRandomAttrs=function(t,e){this.attrmap={};for(var i=0;i<t;i++)this.addAttr(e.getRandomNum(1,23))},t.prototype.updateMonsterData=function(e){return this.hasAttr(t.ATTR_01)&&(e.Common.maxHealth=1,e.currentHealth=1,e.Common.defence+=50),this.hasAttr(t.ATTR_02)&&(e.Common.damageMin+=10),this.hasAttr(t.ATTR_03)&&(e.Common.maxHealth+=50,e.currentHealth+=50),this.hasAttr(t.ATTR_04)&&(e.Common.damageMin=1),this.hasAttr(t.ATTR_05)&&(e.Common.moveSpeed-=100,e.Common.moveSpeed<0&&(e.Common.moveSpeed=50)),this.hasAttr(t.ATTR_06)&&(e.Common.moveSpeed+=100),this.hasAttr(t.ATTR_07)&&e.melee>0&&(e.melee+=2),this.hasAttr(t.ATTR_08)&&e.melee>0&&(e.melee=1),this.hasAttr(t.ATTR_09)&&e.remote>0&&e.isLineAim<=0&&e.isArcAim<=0&&(e.remote=1),this.hasAttr(t.ATTR_10)&&e.remote>0&&(e.remote+=2),this.hasAttr(t.ATTR_11)&&e.remote>0&&(e.bulletLineExNum+=1),this.hasAttr(t.ATTR_12)&&e.remote>0&&(e.bulletExSpeed=-100),this.hasAttr(t.ATTR_13)&&e.remote>0&&(e.bulletExSpeed=100),this.hasAttr(t.ATTR_14)&&(e.Common.dodge+=50,e.Common.dodge>60&&(e.Common.dodge=60)),this.hasAttr(t.ATTR_15)&&(e.Common.damageBack=15),this.hasAttr(t.ATTR_16)&&(e.blink>0?e.blink=2:e.blink=5),this.hasAttr(t.ATTR_17)&&(e.Common.magicDamage+=1,e.Common.iceRate=100),this.hasAttr(t.ATTR_18)&&(e.Common.magicDamage+=1,e.Common.fireRate=100),this.hasAttr(t.ATTR_19)&&(e.Common.magicDamage+=1,e.Common.lighteningRate=100),this.hasAttr(t.ATTR_20)&&(e.Common.magicDamage+=1,e.Common.toxicRate=100),this.hasAttr(t.ATTR_21)&&(e.Common.magicDamage+=1,e.Common.curseRate=100),this.hasAttr(t.ATTR_22)&&(e.Common.realDamage+=1,e.Common.realRate=100),this.hasAttr(t.ATTR_23)&&(e.isBoom=1),e},t.ATTR_01="attr_01",t.ATTR_02="attr_02",t.ATTR_03="attr_03",t.ATTR_04="attr_04",t.ATTR_05="attr_05",t.ATTR_06="attr_06",t.ATTR_07="attr_07",t.ATTR_08="attr_08",t.ATTR_09="attr_09",t.ATTR_10="attr_10",t.ATTR_11="attr_11",t.ATTR_12="attr_12",t.ATTR_13="attr_13",t.ATTR_14="attr_14",t.ATTR_15="attr_15",t.ATTR_16="attr_16",t.ATTR_17="attr_17",t.ATTR_18="attr_18",t.ATTR_19="attr_19",t.ATTR_20="attr_20",t.ATTR_21="attr_21",t.ATTR_22="attr_22",t.ATTR_23="attr_23",t}();i.default=o,cc._RF.pop()},{}],MushRoomChild:[function(t,e,i){"use strict";cc._RF.push(e,"1cc30/RGadFmqTqY/1+mFMR","MushRoomChild");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("./Building"),l=t("../Actor/ColliderTag"),c=cc._decorator,h=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRotate=!1,e.isPlus=!1,e}return a(e,t),e.prototype.onCollisionEnter=function(t){if(t.tag==l.ColliderTag.PLAYER){this.isRotate=!0;var e=t.node.convertToWorldSpaceAR(cc.Vec3.ZERO),i=this.node.convertToWorldSpaceAR(cc.Vec3.ZERO);this.isPlus=e.x>i.x}},e.prototype.onCollisionExit=function(t){t.tag==l.ColliderTag.PLAYER&&(this.isRotate=!1)},e.prototype.update=function(t){this.isRotate?this.node.angle=r.default.lerp(this.node.angle,this.isPlus?15:-15,5*t):this.node.angle=r.default.lerp(this.node.angle,0,5*t)},n([h],e)}(s.default));i.default=p,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Logic":"Logic","./Building":"Building"}],NextStep:[function(t,e,i){"use strict";cc._RF.push(e,"017cbligblAvaHFuvAAHvD9","NextStep");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,r=(n.ccclass,n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isExcuting=!1,e.storePoint=1,e.storePointMax=1,e.duration=0,e.isLooping=!1,e.excuteRest=!1,e.secondCount=0,e}return a(e,t),e.prototype.init=function(t,e,i,o,a,n){this.secondCallback=n,this.storePointMax=e||1,this.duration=o&&o>0?o:0,this.storePointMax<1&&(this.storePointMax=1),this.storePoint=i||0==i?i:1,this.storePoint<=0&&(this.storePoint=0),this.storePoint>this.storePointMax&&(this.storePoint=this.storePointMax),t?this.storePoint=0:this.startLoop(a)},e.prototype.startLoop=function(t){var e=this;if(!this.isLooping){if(this.unscheduleAllCallbacks(),this.secondCount=t&&t>0?t:this.duration,this.isLooping=!0,this.storePointMax==this.storePoint)return this._refreshCoolDown(),void(this.secondCallback&&this.secondCallback(this.secondCount));this.schedule(function(){e.secondCount--,e.secondCount<=0&&(e.excuteRest&&(e.isExcuting=!1),e._refreshCoolDown()),e.secondCallback&&e.secondCallback(e.secondCount)},this.duration<1?this.duration:1,cc.macro.REPEAT_FOREVER)}},e.prototype.next=function(t,e,i,o){this.secondCallback=o,this.excuteRest=i,this.duration=e,0!=this.storePoint?(this.storePoint--,this.storePoint<=0&&(this.storePoint=0),this.startLoop(),t&&t()):this.startLoop()},e.prototype.cutCoolDown=function(t){return t&&this.isLooping&&(this.secondCount-=t),this.secondCount<=0?0:this.secondCount},e.prototype.refreshCoolDown=function(){this._refreshCoolDown()},e.prototype._refreshCoolDown=function(){this.storePoint++,this.secondCount=0,this.storePoint>=this.storePointMax?(this.storePoint=this.storePointMax,this.isLooping=!1,this.secondCount=0,this.unscheduleAllCallbacks()):this.secondCount=this.duration},Object.defineProperty(e.prototype,"IsInCooling",{get:function(){return this.storePoint<this.StorePointMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsExcuting",{get:function(){return this.isExcuting},set:function(t){this.isExcuting=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StorePoint",{get:function(){return this.storePoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"StorePointMax",{get:function(){return this.storePointMax},enumerable:!1,configurable:!0}),e}(cc.Component));i.default=r,cc._RF.pop()},{}],NonPlayerActorState:[function(t,e,i){"use strict";cc._RF.push(e,"9492bjmskVBUqR8oiksJoFq","NonPlayerActorState");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0}),i.GLOBAL=i.FALL=i.BLINK=i.DIZZ=i.DODGE=i.DASH=i.DISGUISE=i.BLOCK=i.TALK=i.HURT=i.DIED=i.SHOW=i.PRPARE=i.ATTACK=i.WALK=i.IDLE=void 0;var n=t("../Base/BaseNonPlayerActorState"),r=t("../Utils/Utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(IDLE):enter"),e.enterIdle()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isMoving?e.stateMachine.changeState(R.WALK):e.sc.isAttacking?e.stateMachine.changeState(R.ATTACK):e.sc.isBlinking&&e.stateMachine.changeState(R.BLINK)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(IDLE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(IDLE):event"),!0},e}(n.default);i.IDLE=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),e.enterWalk(),r.default.log(e.actorName()+"(WALK):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isMoving?e.sc.isAttacking?e.stateMachine.changeState(R.ATTACK):e.sc.isDodging?e.stateMachine.changeState(R.DODGE):e.sc.isBlinking&&e.stateMachine.changeState(R.BLINK):e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(WALK):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(WALK):event"),!0},e}(n.default);i.WALK=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(ATTACK):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isAttacking||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(ATTACK):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(ATTACK):event"),!0},e}(n.default);i.ATTACK=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(PRPARE):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDisguising?e.stateMachine.changeState(R.DISGUISE):e.stateMachine.changeState(R.SHOW)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(PRPARE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(PRPARE):event"),!0},e}(n.default);i.PRPARE=h;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(SHOW):enter"),e.enterShow()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isShow&&e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(SHOW):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(SHOW):event"),!0},e}(n.default);i.SHOW=p;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(DIE):enter"),e.killed()},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(DIE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(DIE):event"),!0},e}(n.default);i.DIED=u;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(HURT):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isHurting?e.sc.isFalling?e.stateMachine.changeState(R.FALL):e.sc.isBlinking&&e.stateMachine.changeState(R.BLINK):e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(TAKEDAMAGE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(TAKEDAMAGE):event"),!0},e}(n.default);i.HURT=d;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(TALK):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(TALK):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(TALK):event"),!0},e}(n.default);i.TALK=f;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(BLOCK):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(BLOCK):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(BLOCK):event"),!0},e}(n.default);i.BLOCK=g;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(DISGUISE):enter"),e.enterDisguise()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDisguising||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(DISGUISE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(DISGUISE):event"),!0},e}(n.default);i.DISGUISE=y;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(DASH):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDashing||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(DASH):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(DASH):event"),!0},e}(n.default);i.DASH=m;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(DODGE):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDodging||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(DODGE):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(DODGE):event"),!0},e}(n.default);i.DODGE=v;var E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(DIZZ):enter"),e.enterDizz()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDizzing||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(DIZZ):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(DIZZ):event"),!0},e}(n.default);i.DIZZ=E;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(BLINK):enter"),e.enterBlink()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isBlinking||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(BLINK):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(BLINK):event"),!0},e}(n.default);i.BLINK=_;var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(FALL):enter"),e.enterFall()},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isFalling||e.stateMachine.changeState(R.IDLE)},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(FALL):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(FALL):event"),!0},e}(n.default);i.FALL=D;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.enter=function(e){t.prototype.enter.call(this,e),r.default.log(e.actorName()+"(GLOBAL):enter")},e.prototype.update=function(e){t.prototype.update.call(this,e),e.sc.isDied||(e.data.currentHealth<=0?e.stateMachine.changeState(R.DIED):e.sc.isHurting&&e.stateMachine.changeState(R.HURT))},e.prototype.exit=function(e){t.prototype.exit.call(this,e),r.default.log(e.actorName()+"(GLOBAL):exit")},e.prototype.event=function(e,i){return t.prototype.event.call(this,e,i),r.default.log(e.actorName()+"(GLOBAL):event"),!0},e}(n.default);i.GLOBAL=S;var R=function(){function t(){}return t.GLOBAL=new S,t.WALK=new l,t.ATTACK=new c,t.IDLE=new s,t.DISGUISE=new y,t.DIED=new u,t.DODGE=new v,t.HURT=new d,t.PRPARE=new h,t.SHOW=new p,t.BLINK=new _,t.FALL=new D,t}();i.default=R,cc._RF.pop()},{"../Base/BaseNonPlayerActorState":"BaseNonPlayerActorState","../Utils/Utils":"Utils"}],NonPlayerData:[function(t,e,i){"use strict";cc._RF.push(e,"e5e26RTCAFA6KSlJtwFy/GC","NonPlayerData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./DamageData"),a=t("./StatusData"),n=t("./CommonData"),r=function(){function t(){this.nameCn="",this.nameEn="",this.resName="",this.chapter=0,this.stageLevel=0,this.invisible=0,this.remote=0,this.melee=0,this.dash=0,this.disguise=0,this.sizeType=0,this.bulletType="",this.bulletArcExNum=0,this.bulletLineExNum=0,this.bulletLineInterval=0,this.bulletExSpeed=0,this.isArcAim=0,this.isLineAim=0,this.blink=0,this.isBoom=0,this.isHeavy=0,this.isStatic=0,this.isRecovery=0,this.shooterOffsetX=0,this.shooterOffsetY=0,this.specialAttack=0,this.specialType="",this.specialDistance=0,this.specialBulletArcExNum=0,this.specialBulletLineExNum=0,this.specialDelay=0,this.bodyColor="#ffffff",this.pos=cc.v3(0,0),this.currentHealth=0,this.boxType=0,this.attackType=0,this.isEnemy=0,this.isFollow=0,this.lifeTime=0,this.isTest=0,this.reborn=0,this.attackFrames=2,this.specialFrames=2,this.remoteAudio="",this.specialAudio="",this.isPet=0,this.statusTotalData=new a.default,this.common=new n.default,this.statusList=new Array}return Object.defineProperty(t.prototype,"StatusTotalData",{get:function(){return this.statusTotalData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FinalCommon",{get:function(){return(new n.default).add(this.common).add(this.statusTotalData.Common)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"StatusList",{get:function(){return this.statusList},set:function(t){if(t){this.statusList=new Array;for(var e=0,i=t;e<i.length;e++){var o=i[e],n=new a.default;n.valueCopy(o),this.statusList.push(n)}}},enumerable:!1,configurable:!0}),t.prototype.updateHA=function(t,e,i){this.currentHealth=t,this.common.maxHealth=e,this.common.damageMin=i},t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.StatusList=t.statusList,this.nameCn=t.nameCn,this.nameEn=t.nameEn,this.resName=t.resName,this.chapter=t.chapter,this.stageLevel=t.stageLevel,this.currentHealth=t.currentHealth?t.currentHealth:0,this.invisible=t.invisible?t.invisible:0,this.remote=t.remote?t.remote:0,this.melee=t.melee?t.melee:0,this.dash=t.dash?t.dash:0,this.pos=t.pos?cc.v3(t.pos.x,t.pos.y):cc.v3(0,0),this.disguise=t.disguise?t.disguise:0,this.sizeType=t.sizeType?t.sizeType:0,this.bulletType=t.bulletType,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.isArcAim=t.isArcAim?t.isArcAim:0,this.isLineAim=t.isLineAim?t.isLineAim:0,this.blink=t.blink?t.blink:0,this.isBoom=t.isBoom?t.isBoom:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.isStatic=t.isStatic?t.isStatic:0,this.shooterOffsetX=t.shooterOffsetX?t.shooterOffsetX:0,this.shooterOffsetY=t.shooterOffsetY?t.shooterOffsetY:0,this.specialAttack=t.specialAttack?t.specialAttack:0,this.specialType=t.specialType?t.specialType:"",this.specialDistance=t.specialDistance?t.specialDistance:0,this.specialBulletArcExNum=t.specialBulletArcExNum?t.specialBulletArcExNum:0,this.specialBulletLineExNum=t.specialBulletLineExNum?t.specialBulletLineExNum:0,this.specialDelay=t.specialDelay?t.specialDelay:0,this.boxType=t.boxType?t.boxType:0,this.attackType=t.attackType?t.attackType:0,this.isRecovery=t.isRecovery?t.isRecovery:0,this.isEnemy=t.isEnemy?t.isEnemy:0,this.isFollow=t.isFollow?t.isFollow:0,this.lifeTime=t.lifeTime?t.lifeTime:0,this.isTest=t.isTest?t.isTest:0,this.reborn=t.reborn?t.reborn:0,this.attackFrames=t.attackFrames?t.attackFrames:2,this.specialFrames=t.specialFrames?t.specialFrames:2,this.bodyColor=t.bodyColor?t.bodyColor:"#ffffff",this.remoteAudio=t.remoteAudio?t.remoteAudio:"",this.specialAudio=t.specialAudio?t.specialAudio:"",this.isPet=t.isPet?t.isPet:0},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.resName=this.resName,e.chapter=this.chapter,e.stageLevel=this.stageLevel,e.currentHealth=this.currentHealth,e.invisible=this.invisible,e.remote=this.remote,e.melee=this.melee,e.dash=this.dash,e.pos=this.pos,e.disguise=this.disguise,e.sizeType=this.sizeType,e.bulletType=this.bulletType,e.bulletArcExNum=this.bulletArcExNum,e.bulletLineExNum=this.bulletLineExNum,e.bulletLineInterval=this.bulletLineInterval,e.isArcAim=this.isArcAim,e.isLineAim=this.isLineAim,e.blink=this.blink,e.isBoom=this.isBoom,e.bulletExSpeed=this.bulletExSpeed,e.isHeavy=this.isHeavy,e.isStatic=this.isStatic,e.shooterOffsetX=this.shooterOffsetX,e.shooterOffsetY=this.shooterOffsetY,e.specialAttack=this.specialAttack,e.specialType=this.specialType,e.specialDistance=this.specialDistance,e.specialBulletArcExNum=this.specialBulletArcExNum,e.specialBulletLineExNum=this.specialBulletLineExNum,e.specialDelay=this.specialDelay,e.boxType=this.boxType,e.attackType=this.attackType,e.isRecovery=this.isRecovery,e.bodyColor=this.bodyColor,e.isEnemy=this.isEnemy,e.isFollow=this.isFollow,e.lifeTime=this.lifeTime,e.isTest=this.isTest,e.reborn=this.reborn,e.remoteAudio=this.remoteAudio,e.specialAudio=this.specialAudio,e.isPet=this.isPet,e.StatusList=this.statusList,e},t.prototype.getAttackPoint=function(){var t=this.FinalCommon,e=new o.default;return e.realDamage=t.realDamage,e.physicalDamage=t.damageMin,e.magicDamage=t.magicDamage,e.physicalDamage<0&&(e.physicalDamage=0),e},t.prototype.getDamage=function(t){var e=this.FinalCommon,i=t.clone(),o=e.defence,a=e.magicDefence;return i.physicalDamage=o>=0?i.physicalDamage*(1-.06*o/(.06*o+1)):i.physicalDamage*(2-Math.pow(.94,-o)),i.magicDamage=i.magicDamage*(1-a/100),i},t.prototype.getHealth=function(){var t=1,e=this.FinalCommon.maxHealth;return e>0?(t=this.currentHealth/e,cc.v3(e*t,e)):cc.v3(1,1)},t}();i.default=r,cc._RF.pop()},{"./CommonData":"CommonData","./DamageData":"DamageData","./StatusData":"StatusData"}],NonPlayerManager:[function(t,e,i){"use strict";cc._RF.push(e,"2a4f27Fn0RPWppWDoGhOHT3","NonPlayerManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("./BaseManager"),c=t("../Utils/Utils"),h=t("../NonPlayer"),p=t("../Data/NonPlayerData"),u=cc._decorator,d=u.ccclass,f=u.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nonplayer=null,e.nonplayers=new Array,e.timeDelay=0,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"nonPlayerList",{get:function(){return this.nonplayers},enumerable:!1,configurable:!0}),e.prototype.clear=function(){c.default.clearComponentArray(this.nonplayers)},e.prototype.addNonPlayerListFromSave=function(t,e,i){for(var o=0,a=e;o<a.length;o++){var n=a[o];this.addNonPlayer(this.getNonPlayer(n,t),i)}},e.prototype.addNonPlayerFromData=function(t,e,i){this.addNonPlayer(this.getNonPlayer(s.default.nonplayers[t],i),e)},e.prototype.isPetAlive=function(){return!!(this.pet&&this.pet.isValid&&this.pet.node.active&&this.pet.data.currentHealth>0)},e.prototype.addPetFromData=function(t,e,i){for(var o=0,a=this.nonPlayerList;o<a.length;o++)a[o].data.isPet;this.isPetAlive()||this.addNonPlayer(this.getNonPlayer(t,i),e)},e.prototype.addNonPlayerFromMap=function(t,e,o){"N0"==e&&this.addNonPlayerFromData(i.NON_SHADOW,r.default.getPosInMap(o),t)},e.prototype.getNonPlayer=function(t,e){var i=null;(i=cc.instantiate(this.nonplayer)).active=!1,i.parent=e.node;var o=i.getComponent(h.default),a=new p.default;return o.dungeon=e,a.valueCopy(t),a.isEnemy=0,o.data=a,o.sc.isDisguising=a.disguise>0,o.sc.isDisguising?o.changeBodyRes(a.resName,h.default.RES_DISGUISE):o.changeBodyRes(a.resName,h.default.RES_IDLE000),o},e.prototype.addNonPlayer=function(t,e){t.node.active=!0,t.pos=r.default.getIndexInMap(e),t.node.position=e,this.nonPlayerList.push(t),t.data.isPet>0&&(this.pet=t)},e.prototype.updateLogic=function(t){s.default.nonPlayerList=[];for(var e=0,i=this.nonPlayerList;e<i.length;e++){var o=i[e];if(o&&o.node.active){o.updateLogic(t);var a=o.data.clone();o.leftLifeTime>0&&(a.lifeTime=o.leftLifeTime),a.currentHealth>0&&s.default.nonPlayerList.push(a)}}},e.NON_SHADOW="nonplayer001",e.SHOP_KEEPER="nonplayer002",e.DOG="nonplayer003",n([f(cc.Prefab)],e.prototype,"nonplayer",void 0),i=n([d],e)}(l.default);i.default=g,cc._RF.pop()},{"../Data/NonPlayerData":"NonPlayerData","../Dungeon":"Dungeon","../Logic":"Logic","../NonPlayer":"NonPlayer","../Utils/Utils":"Utils","./BaseManager":"BaseManager"}],NonPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"b7513vXKLpHGrSf+utaohLs","NonPlayer");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=t("./EventHelper"),h=t("./HealthBar"),p=t("./Logic"),u=t("./Dungeon"),d=t("./Shooter"),f=t("./Manager/StatusManager"),g=t("./Data/DamageData"),y=t("./Manager/FloatingLabelManager"),m=t("./Utils/Random"),v=t("./Utils/NextStep"),E=t("./Item/Item"),_=t("./Base/Actor"),D=t("./Achievement"),S=t("./Utils/AudioPlayer"),R=t("./Manager/SpecialManager"),T=t("./Data/FromData"),O=t("./Utils/IndexZ"),C=t("./Actor/AreaOfEffect"),A=t("./Data/AreaOfEffectData"),L=t("./Actor/ActorAttackBox"),P=t("./Base/fsm/DefaultStateMachine"),b=t("./Actor/NonPlayerActorState"),I=t("./Base/StateContext"),M=t("./Data/NonPlayerData"),N=t("./Actor/ColliderTag"),x=t("./Utils/ActorUtils"),H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=cc.v3(0,0),e.healthBar=null,e.statusManager=null,e.floatinglabelManager=null,e.specialManager=null,e.boom=null,e.dangerBox=null,e.dangerTips=null,e.attrPrefab=null,e.isFaceRight=!0,e.shooter=null,e.currentlinearVelocitySpeed=cc.Vec2.ZERO,e.isVariation=!1,e.isSummon=!1,e.killPlayerCount=0,e.moveStep=new v.default,e.remoteStep=new v.default,e.meleeStep=new v.default,e.specialStep=new v.default,e.dashStep=new v.default,e.blinkStep=new v.default,e.attrmap={},e.animStatus=i.ANIM_NONE,e.data=new M.default,e.leftLifeTime=0,e.moveTimeDelay=0,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"IsVariation",{get:function(){return this.isVariation||this.data.StatusTotalData.variation>0},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.graphics=this.getComponent(cc.Graphics),this.sc.isAttacking=!1,this.anim=this.getComponent(cc.Animation),this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite),this.mat=this.bodySprite.getComponent(cc.Sprite).getMaterial(0),this.boxCollider=this.getComponent(cc.BoxCollider),this.node.scale=this.getScaleSize(),this.dashlight=this.sprite.getChildByName("dashlight"),this.dashlight.opacity=0,this.shadow=this.sprite.getChildByName("shadow"),this.rigidbody=this.getComponent(cc.RigidBody),this.shooter=this.node.getChildByName("Shooter").getComponent(d.default),this.effectNode=this.node.getChildByName("Effect"),this.hitLightSprite=this.node.getChildByName("Effect").getChildByName("hitlight").getComponent(cc.Sprite),this.hitLightSprite.node.opacity=0,this.particleBlood=this.node.getChildByName("Effect").getChildByName("blood").getComponent(cc.ParticleSystem),this.particleBlood.stopSystem(),this.attrNode=this.node.getChildByName("attr"),this.updatePlayerPos(),this.resetBodyColor(),this.data.isStatic>0&&(this.rigidbody.type=cc.RigidBodyType.Static),this.dangerBox.init(this,this.dungeon,this.data.isEnemy>0),this.dangerTips.opacity=0,this.specialStep.init(!0),this.specialStep.cutCoolDown(this.data.specialAttack/2),this.stateMachine=new P.default(this,b.default.PRPARE,b.default.GLOBAL)},e.prototype.start=function(){var t=this;if(this.changeZIndex(),this.healthBar.refreshHealth(this.data.getHealth().x,this.data.getHealth().y),this.data.lifeTime>0){var e=new v.default;this.leftLifeTime=this.data.lifeTime,e.next(function(){},this.data.lifeTime,!0,function(){t.leftLifeTime--,t.leftLifeTime<=0&&t.data&&(t.data.currentHealth=0)})}this.addSaveStatusList()},e.prototype.hitLightS=function(t){var e=!0,i="hitlight1",o=8;t.isFist?(i=p.default.getHalfChance()?"hitlight1":"hitlight2",S.default.play(S.default.PUNCH)):t.isRemote?i=p.default.getHalfChance()?"hitlight9":"hitlight10":t.isBlunt?(i=p.default.getHalfChance()?"hitlight3":"hitlight4",o=t.isFar?10:8,S.default.play(S.default.SWORD_HIT)):t.isMelee?(S.default.play(S.default.SWORD_HIT),t.isStab?(i=p.default.getHalfChance()?"hitlight5":"hitlight6",o=t.isFar?10:8):(i=p.default.getHalfChance()?"hitlight7":"hitlight8",o=t.isFar?10:8)):e=!1,e&&(this.hitLightSprite.node.stopAllActions(),this.hitLightSprite.spriteFrame=p.default.spriteFrameRes(i),this.hitLightSprite.node.opacity=220,this.hitLightSprite.node.color=cc.Color.WHITE,this.hitLightSprite.node.scale=t.isCriticalStrike?o:o+3,cc.tween(this.hitLightSprite.node).delay(.2).to(.3,{opacity:0,color:cc.Color.BLACK}).to(.3,{opacity:0}).start())},e.prototype.addSaveStatusList=function(){this.statusManager&&this.statusManager.addStatusListFromSave(this.data.StatusList)},e.prototype.hitLight=function(t){this.mat||(this.mat=this.node.getChildByName("sprite").getChildByName("body").getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT)},e.prototype.addAttrIcon=function(){for(var t in this.attrNode||(this.attrNode=this.node.getChildByName("attr")),this.attrNode.removeAllChildren(),this.attrmap){var e=cc.instantiate(this.attrPrefab);e.getComponent(cc.Sprite).spriteFrame=p.default.spriteFrameRes(t),this.attrNode.addChild(e)}},e.prototype.showDangerTips=function(){var t=this;this.dangerTips.opacity=255,this.scheduleOnce(function(){t.dangerTips.opacity=0},1)},e.prototype.getCurrentBodyRes=function(){return this.sprite||(this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite)),this.bodySprite.spriteFrame.name},e.prototype.changeBodyRes=function(t,e){this.sprite||(this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite)),this.boxCollider||(this.boxCollider=this.getComponent(cc.BoxCollider)),this.shadow||(this.shadow=this.sprite.getChildByName("shadow"));var i=this.getSpriteFrameByName(t,e);this.bodySprite.spriteFrame=i||null,this.bodySprite.node.width=i.getRect().width,this.bodySprite.node.height=i.getRect().height;var o=48,a=80,n=80;switch(this.data.boxType){case 0:o=32,a=80,n=64;break;case 1:o=48,a=48,n=96;break;case 2:o=48,a=80,n=80;break;case 3:o=64,a=80,n=128;break;case 4:o=32,a=128,n=48;break;case 5:o=48,a=128,n=96;break;default:o=48,a=80,n=80}this.boxCollider.offset=cc.v2(0,o),this.boxCollider.size.width=a,this.boxCollider.size.height=n,this.boxCollider.tag=this.data.isEnemy>0?N.ColliderTag.NONPLAYER:N.ColliderTag.GOODNONPLAYER,this.data.boxType>2?this.shadow.scale=3:this.shadow.scale=2},e.prototype.getSpriteFrameByName=function(t,e){var i=p.default.spriteFrameRes(t+e);return i||(i=p.default.spriteFrameRes(t)),i},e.prototype.updatePlayerPos=function(){this.node.position=u.default.getPosInMap(this.pos)},e.prototype.transportPlayer=function(t,e){this.sprite.angle=0,this.sprite.scale=1,this.sprite.opacity=255,this.sprite.x=0,this.sprite.y=0,this.pos.x=t,this.pos.y=e,this.changeZIndex(),this.updatePlayerPos()},e.prototype.changeZIndex=function(){this.node.zIndex=O.default.getActorZIndex(this.node.position)},e.prototype.showFloatFont=function(t,e,i,o,a,n){if(this.floatinglabelManager){var r=this.floatinglabelManager.getFloaingLabel(t);i?r.showDoge():o?r.showMiss():0!=e?r.showDamage(-e,a,n):r.hideLabel()}},e.prototype.remoteAttack=function(t,e){this.remoteStep.IsExcuting=!1;var i=this.shooter.node.position.clone();i.x=this.shooter.node.scaleX>0?i.x+30:-i.x-30;var o=t.getCenterPosition().sub(this.node.position.add(i));o.equals(cc.Vec3.ZERO)||(o=o.normalizeSelf(),this.shooter.setHv(o),this.shooter.from.valueCopy(T.default.getClone(this.data.nameCn,this.data.resName+"anim000",this.seed)),this.IsVariation&&(this.shooter.data.bulletSize=.5),this.shooter.dungeon=this.dungeon,this.shooter.data.remoteAudio=this.data.remoteAudio,this.shooter.isFromPlayer=this.data.isEnemy<1,this.shooter.data.bulletArcExNum=this.data.bulletArcExNum,this.shooter.data.bulletLineExNum=this.data.bulletLineExNum,this.shooter.data.bulletLineInterval=this.data.bulletLineInterval,e&&(this.shooter.data.bulletLineExNum=this.data.specialBulletLineExNum,this.shooter.data.bulletArcExNum=this.data.specialBulletArcExNum),this.shooter.data.isLineAim=this.data.isLineAim,this.shooter.data.bulletType=this.data.bulletType?this.data.bulletType:"bullet001",this.shooter.data.bulletExSpeed=this.data.bulletExSpeed,this.shooter.fireBullet(p.default.getRandomNum(0,5)-5,cc.v3(this.data.shooterOffsetX,this.data.shooterOffsetY)))},e.prototype.showAttackAnim=function(t,e,o,a,n,r,s){var l=this,c=1-this.data.FinalCommon.attackSpeed/500;c<.2&&(c=.2),c>2&&(c=2);var h=a.node.position.clone().sub(this.node.position);h.equals(cc.Vec3.ZERO)||(h=h.normalizeSelf()),this.anim.pause(),h.equals(cc.Vec3.ZERO)&&(h=cc.v3(1,0)),h=h.normalizeSelf().mul(this.node.scaleX>0?48:-48),this.node.scaleX<0&&(h.y=-h.y),this.sprite.stopAllActions();var p=0;this.data.attackType==L.default.ATTACK_STAB&&r&&(p=.8*c);for(var u=cc.tween().delay(.5*c).call(function(){t&&t(n)}),d=cc.tween().by(.1,{position:cc.v3(5,0)}).by(.1,{position:cc.v3(-5,0)}).by(.1,{position:cc.v3(5,0)}).by(.1,{position:cc.v3(-5,0)}).by(.1,{position:cc.v3(5,0)}).by(.1,{position:cc.v3(-5,0)}).by(.1,{position:cc.v3(5,0)}).by(.1,{position:cc.v3(-5,0)}),f=["anim009"],g=[],y=0;y<this.data.attackFrames-1;)f.push("anim0"+(10+y++));for(var m=0;m<this.data.specialFrames;m++)g.push("anim0"+(10+y++));var v=cc.tween().by(.5*c,{position:cc.v3(-h.x/8,-h.y/8)}).delay(p),E=cc.tween().by(.2*c,{position:cc.v3(h.x,h.y)}).delay(p),_=this.data.specialType.length<=0||this.data.specialType==R.default.AFTER_ASH,D=cc.tween().call(function(){l.changeBodyRes(l.data.resName,n?g[0]:f[0]),(r&&!n||n&&r&&_)&&l.dangerBox.show(l.data.attackType,n,5==l.data.boxType,h),n&&(l.data.specialType==R.default.AFTER_DOWN&&l.dangerBox.show(L.default.ATTACK_STAB,!1,!1,h),l.scheduleOnce(function(){l.specialManager.dungeon=l.dungeon,l.specialManager.addEffect(l.data.specialType,l.data.specialDistance,l.isFaceRight,T.default.getClone(l.data.nameCn,l.data.resName+"anim000",l.seed),l.IsVariation)},l.data.specialDelay))}),O=cc.tween().call(function(){l.changeBodyRes(l.data.resName,n?g[1]:f[1]),l.dangerBox.hide(s),(r&&!n||n&&l.data.specialType.length<=0)&&l.data.attackType==L.default.ATTACK_STAB&&l.move(cc.v3(l.isFaceRight?l.dangerBox.hv.x:-l.dangerBox.hv.x,l.dangerBox.hv.y),n?2e3:1e3),n&&(l.data.specialType==R.default.AFTER_DOWN&&l.move(cc.v3(l.isFaceRight?l.dangerBox.hv.x:-l.dangerBox.hv.x,l.dangerBox.hv.y),1e3),l.scheduleOnce(function(){l.specialManager.dungeon=l.dungeon,l.specialManager.addPlacement(l.data.specialType,l.data.specialDistance,l.isFaceRight,T.default.getClone(l.data.nameCn,l.data.resName+"anim000",l.seed),l.IsVariation)},l.data.specialDelay)),e&&e(n)}),C=cc.tween().call(function(){l.dangerBox.finish()}),A=function(t){C.then(cc.tween().delay(.2*c).call(function(){l.changeBodyRes(l.data.resName,f[t])}))};for(m=2;m<f.length;m++)A(m);var P=cc.tween().call(function(){l.dangerBox.finish()}),b=function(t){P.then(cc.tween().delay(.2*c).call(function(){l.changeBodyRes(l.data.resName,g[t])}))};for(m=2;m<g.length;m++)b(m);var I=cc.tween().delay(.2*c).call(function(){l.dangerBox.finish(),l.changeBodyRes(l.data.resName,i.RES_IDLE000),l.setLinearVelocity(cc.Vec2.ZERO)}),M=cc.tween().to(.2*c,{position:cc.v3(0,0)}).delay(.2*c).call(function(){o&&o(n)}),N=cc.tween().then(D).then(v).then(O).then(E).then(C).then(I),x=cc.tween().then(D).delay(.5*c).then(O).delay(.2*c).then(C).then(I),H=cc.tween().then(D).then(v).then(d).then(O).then(E).then(P).then(I),B=cc.tween().then(D).then(d).then(O).delay(.5*c).then(P).then(I),w=cc.tween().then(u).then(x).then(M);r&&(w=cc.tween().then(u).then(N).then(M)),n&&(this.showDangerTips(),S.default.play(this.data.specialAudio),w=cc.tween().then(u).then(B).then(M),r&&_&&(w=cc.tween().then(u).then(H).then(M))),cc.tween(this.sprite).then(w).start()},e.prototype.move=function(t,e){if(!t.equals(cc.Vec3.ZERO)){(t=t.normalizeSelf()).equals(cc.Vec3.ZERO)||(this.pos=u.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=Math.abs(i),n=Math.abs(o),r=a>n?a:n;r=0==r?1:r;var s=cc.v2(i,o);e<0&&(e=0),s=s.mul(e),this.setLinearVelocity(s),this.changeZIndex()}},e.prototype.setLinearVelocity=function(t){this.currentlinearVelocitySpeed=t,this.rigidbody.linearVelocity=this.currentlinearVelocitySpeed.clone()},e.prototype.isPlayerBehindAttack=function(){var t=this.dungeon.player.node.position.x>this.node.position.x,e=this.node.scaleX>0;return t&&!e||!t&&e},e.prototype.isFaceTargetBehind=function(t){var e=t.node.position.x>this.node.position.x,i=t.isFaceRight;return e&&i||!e&&!i},e.prototype.fall=function(){this.data.isStatic>0||this.data.isHeavy>0||this.IsVariation||(this.sc.isFalling=!0,this.bodySprite.node.angle=this.isPlayerBehindAttack()?-75:105,this.anim.play("MonsterFall"))},e.prototype.FallFinish=function(){this.sc.isFalling=!1,this.bodySprite.node.angle=0,this.sprite.y=0,this.sprite.x=0},e.prototype.takeDamage=function(t){var e=this;if(!this.sc.isShow||this.sc.isDied)return!1;if(this.data.invisible>0&&this.sprite.opacity<100&&p.default.getRandomNum(1,10)>4)return this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike,!1),!1;if(this.sc.isBlinking)return this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike,!1),!1;var o=this.data.getDamage(t),a=this.data.FinalCommon.dodge/100,n=m.default.rand()<=a&&o.getTotalDamage()>0;if(o=n?new g.default:o,n)return this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike,!1),!1;var r=o.getTotalDamage()>0;return this.sc.isHurting=r&&!this.specialStep.IsExcuting&&t.isMelee,this.sc.isHurting&&(this.sc.isDisguising=!1,this.sc.isAttacking=!1,this.setLinearVelocity(cc.Vec2.ZERO),t.isCriticalStrike&&this.fall(),this.sprite.stopAllActions(),this.changeBodyRes(this.data.resName,p.default.getHalfChance()?i.RES_HIT001:i.RES_HIT002),this.anim.getAnimationState("MonsterIdle").isPlaying&&this.anim.pause(),this.dangerBox.finish()),r&&(cc.director.emit(c.EventHelper.PLAY_AUDIO,{detail:{name:S.default.MONSTER_HIT}}),this.hitLight(!0),this.hitLightS(t),t.isBackAttack&&this.showBloodEffect(),this.scheduleOnce(function(){e.node&&(e.hitLight(!1),e.resetBodyColor(),e.sc.isHurting&&(e.sc.isHurting=!1,e.anim.resume()))},.1)),this.sprite.opacity=255,this.data.currentHealth-=o.getTotalDamage(),this.data.currentHealth>this.data.getHealth().y&&(this.data.currentHealth=this.data.getHealth().y),this.healthBar.refreshHealth(this.data.currentHealth,this.data.getHealth().y),this.showFloatFont(this.dungeon.node,o.getTotalDamage(),!1,!1,t.isCriticalStrike,t.isBackAttack),this.data.isRecovery>0&&r&&this.addStatus(f.default.RECOVERY,new T.default),r},e.prototype.resetBodyColor=function(){this.data&&(this.bodySprite.node.color=cc.color(255,255,255).fromHEX(this.data.bodyColor))},e.prototype.getMixColor=function(t,e){var i=cc.color().fromHEX(t),o=cc.color().fromHEX(e),a=cc.color(),n=i.getR()+o.getR(),r=i.getG()+o.getG(),s=i.getB()+o.getB();return a.setR(n>255?255:n),a.setG(r>255?255:r),a.setB(s>255?255:s),"#"+a.toHEX("#rrggbb")},e.prototype.addStatus=function(t,e){this.node&&!this.sc.isDied&&this.statusManager.addStatus(t,e)},e.prototype.addCustomStatus=function(t,e){this.node&&!this.sc.isDied&&this.statusManager.addCustomStatus(t,e)},e.prototype.stopAllDebuffs=function(){this.node&&this.statusManager.stopAllDebuffs()},e.prototype.showAttackEffect=function(t){this.effectNode.setPosition(cc.v3(0,32)),t||cc.tween(this.effectNode).to(.2,{position:cc.v3(32,32)}).to(.2,{position:cc.v3(0,16)}).start()},e.prototype.showBloodEffect=function(){var t=this;S.default.play(S.default.BLEEDING),this.particleBlood.resetSystem(),this.scheduleOnce(function(){t.particleBlood.stopSystem()},.5)},e.prototype.addPlayerStatus=function(t,e){p.default.getRandomNum(0,100)<this.data.FinalCommon.iceRate&&t.addStatus(f.default.FROZEN,e),p.default.getRandomNum(0,100)<this.data.FinalCommon.fireRate&&t.addStatus(f.default.BURNING,e),p.default.getRandomNum(0,100)<this.data.FinalCommon.lighteningRate&&t.addStatus(f.default.DIZZ,e),p.default.getRandomNum(0,100)<this.data.FinalCommon.toxicRate&&t.addStatus(f.default.TOXICOSIS,e),p.default.getRandomNum(0,100)<this.data.FinalCommon.curseRate&&t.addStatus(f.default.CURSING,e),p.default.getRandomNum(0,100)<this.data.FinalCommon.realRate&&t.addStatus(f.default.BLEEDING,e)},e.prototype.killed=function(){var t=this;this.sc.isDied||(this.sc.isDied=!0,this.sc.isDisguising=!1,this.dashStep.IsExcuting=!1,this.sprite.stopAllActions(),this.dangerBox.finish(),this.bodySprite.node.angle=0,this.anim.play("MonsterDie"),this.setLinearVelocity(cc.Vec2.ZERO),this.changeBodyRes(this.data.resName,i.RES_HIT003),this.getComponent(cc.PhysicsCollider).sensor=!0,this.data.isEnemy>0&&this.getLoot(),D.default.addMonsterKillAchievement(this.data.resName),p.default.setKillPlayerCounts(T.default.getClone(this.actorName(),this.data.resName+"anim000",this.seed),!1),this.scheduleOnce(function(){if(t.node){if(t.data.isBoom>0){var e=cc.instantiate(t.boom).getComponent(C.default);e&&(e.show(t.node.parent,t.node.position,cc.v3(1,0),0,(new A.default).init(1,.2,0,0,O.default.OVERHEAD,t.data.isEnemy>0,!0,!0,!1,!1,new g.default(2),T.default.getClone("\u7206\u70b8","boom000anim004"),[])),S.default.play(S.default.BOOM),cc.director.emit(c.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!0}}))}t.scheduleOnce(function(){t.node.active=!1},t.data.isPet?0:5)}},2))},e.prototype.getLoot=function(){var t=p.default.mapManager.getRandom4Save(p.default.mapManager.getRebornSeed(this.seed)),e=t.rand(),i=.75;this.IsVariation&&(i=.6),(i-=this.killPlayerCount/10)<.3&&(i=.3);var o=(1-i)/10,a=1+this.killPlayerCount/2;if((a=Math.floor(a))>4&&(a=4),this.dungeon){var n=1;this.IsVariation&&(n=2),this.killPlayerCount>0&&(n=5),c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_OILGOLD,{pos:this.node.position,count:n}),e<i?c.EventHelper.emit(c.EventHelper.DUNGEON_ADD_COIN,{pos:this.node.position,count:t.getRandomNum(1,10)}):e>=i&&e<i+o?this.addLootSaveItem(E.default.HEART,!0):e>=i+o&&e<i+2*o?this.addLootSaveItem(E.default.HEART,!0):e>=i+2*o&&e<i+3*o?this.addLootSaveItem(E.default.BOTTLE_ATTACK):e>=i+3*o&&e<i+4*o?this.addLootSaveItem(E.default.BOTTLE_MOVESPEED):e>=i+4*o&&e<i+5*o?this.addLootSaveItem(E.default.BOTTLE_HEALING):e>=i+5*o&&e<i+6*o?this.addLootSaveItem(E.default.BOTTLE_DREAM):e>=i+6*o&&e<i+7*o?this.addLootSaveItem(E.default.BOTTLE_REMOTE):e>=i+7*o&&e<1&&(this.isSummon||this.dungeon.addEquipment(p.default.getRandomEquipType(t),u.default.getPosInMap(this.pos),null,a))}},e.prototype.addLootSaveItem=function(t,e){!e&&this.isSummon||this.dungeon.addItem(this.node.position.clone(),t)},e.prototype.getCenterPosition=function(){return this.node.position.clone()},Object.defineProperty(e.prototype,"isPassive",{get:function(){return!this.dungeon||this.sc.isDied||this.sc.isHurting||this.sc.isFalling||this.sc.isAttacking||!this.sc.isShow||this.sc.isDizzing||this.sc.isDisguising||this.sc.isDodging||this.sc.isDashing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isImmovable",{get:function(){return!this.dungeon||this.sc.isDied||this.sc.isFalling||!this.sc.isShow||this.sc.isDizzing||this.sc.isDisguising},enumerable:!1,configurable:!0}),e.prototype.updateAttack=function(){var t=this;if(!this.isPassive){var e=x.default.getNearestEnemyActor(this,this.data.isEnemy>0,this.dungeon),i=x.default.getNearestTargetDistance(this,e);if(x.default.isTargetAlive(e)){this.data.specialAttack>0&&this.specialStep.next(function(){t.specialStep.IsExcuting=!0},this.data.specialAttack,!0);var o=100;this.specialStep.IsExcuting&&(o=200),this.data.attackType==L.default.ATTACK_STAB&&(o=300,this.specialStep.IsExcuting&&(o=600));var a=this.data.melee>0&&i<o*this.node.scaleY,n=this.data.remote>0&&i<600*this.node.scaleY;a&&!this.meleeStep.IsInCooling?this.meleeStep.next(function(){t.changeFaceRight(e),t.setLinearVelocity(cc.Vec2.ZERO),t.sc.isAttacking=!0,t.sprite.opacity=255,t.showAttackEffect(!1),cc.director.emit(c.EventHelper.PLAY_AUDIO,{detail:{name:S.default.MELEE}});var i=p.default.getRandomNum(0,100)<t.data.StatusTotalData.missRate;i&&t.showFloatFont(t.dungeon.node,0,!1,!0,!1,!1),t.showAttackAnim(function(){},function(){},function(){t.sc.isAttacking=!1,t.specialStep.IsExcuting=!1},e,t.specialStep.IsExcuting,!0,i)},this.data.melee):n&&this.remoteStep.next(function(){t.sc.isAttacking=!0,t.sprite.opacity=255,t.changeFaceRight(e);var i=p.default.bullets[t.data.bulletType]&&p.default.bullets[t.data.bulletType].isLaser>0;t.showAttackAnim(function(o){i&&o&&t.remoteAttack(e,o)},function(o){i&&o||t.remoteAttack(e,o)},function(){t.specialStep.IsExcuting=!1,t.sc.isAttacking=!1},e,t.specialStep.IsExcuting,!1,!1)},this.data.remote,!0)}}},e.prototype.dodge=function(t){var e=this;if(!this.isPassive){this.sc.isDodging=!0;var i=this.data.FinalCommon.moveSpeed;this.move(t,2.5*i),this.scheduleOnce(function(){e.sc.isDodging=!1},.1)}},e.prototype.updateLogic=function(t){var e=this;if(this.dungeon){this.stateMachine.update(),this.node.position=u.default.fixOuterMap(this.node.position),this.pos=u.default.getIndexInMap(this.node.position),this.changeZIndex(),this.updateAttack();var i=x.default.getNearestEnemyActor(this,this.data.isEnemy>0,this.dungeon),o=x.default.getNearestTargetDistance(this,i);this.data.disguise>0&&o<this.data.disguise&&this.sc.isDisguising&&(this.sc.isDisguising=!1),this.data.blink>0&&!this.sc.isBlinking&&this.blinkStep.next(function(){e.sc.isBlinking=!0},this.data.blink,!0);var a=this.data.FinalCommon.moveSpeed;this.data.dash>0&&!this.isPassive&&x.default.isTargetAlive(i)&&o<600&&o>100&&this.dashStep.next(function(){e.sc.isDashing=!0,e.enterWalk(),cc.director.emit(c.EventHelper.PLAY_AUDIO,{detail:{name:S.default.MELEE}}),e.showAttackEffect(!0),e.move(e.getMovePosFromTarget(i),a),e.scheduleOnce(function(){e.node&&(e.sc.isDashing=!1)},2)},this.data.dash),!x.default.isTargetAlive(i)&&this.data.isFollow>0&&this.data.isEnemy<1&&(i=this.dungeon.player,o=x.default.getNearestTargetDistance(this,this.dungeon.player));var n=o<500&&this.data.melee>0;o<500&&o>300&&this.data.remote>0&&(n=!0),x.default.isTargetAlive(i)||(n=!1),this.data.melee>0&&o<64||this.data.remote>0&&this.data.melee<=0&&o<300||this.shooter.isAiming||this.isImmovable?this.sc.isMoving=!1:this.moveStep.next(function(){e.sc.isMoving=!0;var t=cc.v3(0,0);t.x+=p.default.getRandomNum(0,400)-200,t.y+=p.default.getRandomNum(0,400)-200,n&&(t=e.getMovePosFromTarget(i)),e.move(t,n?.5*a:a)},n?0:2,!0),this.data.invisible>0&&this.sprite.opacity>20&&(this.sprite.opacity=this.lerp(this.sprite.opacity,19,3*t)),this.dashlight.opacity=0,this.dungeon&&this.sc.isDashing&&(this.dashlight.opacity=128),this.sc.isDashing&&this.setLinearVelocity(this.currentlinearVelocitySpeed),this.rigidbody.linearVelocity.equals(cc.Vec2.ZERO)&&(this.sc.isMoving=!1),this.healthBar.node.opacity=this.sc.isDisguising?0:255,this.shadow&&(this.shadow.opacity=this.sc.isDisguising?0:128),this.sc.isDisguising&&this.anim&&this.anim.pause(),this.data.invisible>0&&(this.healthBar.node.opacity=this.sprite.opacity>20?255:9),this.healthBar.node.active=!this.sc.isDied;var r=this.getScaleSize();this.node.scaleX=this.isFaceRight?r:-r,this.node.scaleY=r,this.healthBar.node.scaleX=this.node.scaleX>0?1:-1,this.healthBar.node.x=-30*this.node.scaleX,this.healthBar.node.y=3==this.data.boxType||5==this.data.boxType?150:120,this.healthBar.progressBar.barSprite.node.color=this.IsVariation?cc.color(128,0,128):cc.color(194,0,0),this.healthBar.progressBar.barSprite.node.color=this.killPlayerCount>0?cc.color(255,215,0):this.healthBar.progressBar.barSprite.node.color,this.dashlight.color=this.IsVariation?cc.color(0,0,0):cc.color(255,255,255),this.attrNode&&(this.attrNode.opacity=this.healthBar.node.opacity)}},e.prototype.getMovePosFromTarget=function(t){var e=cc.v3(1,0);t&&(e=t.node.position.clone()),e=(e=u.default.getIndexInMap(e)).x>this.pos.x?e.addSelf(cc.v3(1,0)):e.addSelf(cc.v3(-1,0));var i=u.default.getPosInMap(e);return i=i.sub(this.node.position),!this.sc.isAttacking&&!this.sc.isDisguising&&this.data.isStatic<1&&this.changeFaceRight(t),i},e.prototype.changeFaceRight=function(t){var e=t.node.position.clone(),i=(e=e.sub(this.node.position)).x;this.isFaceRight=i>=0},e.prototype.lerp=function(t,e,i){return t+(e-t)*i},e.prototype.onCollisionEnter=function(t){var e=x.default.getEnemyCollisionTarget(t,this.data.isEnemy<1);if(e&&this.sc.isDashing&&this.dungeon&&!this.sc.isHurting&&!this.sc.isFalling&&!this.sc.isDied){this.sc.isDashing=!1,this.setLinearVelocity(cc.Vec2.ZERO);var i=T.default.getClone(this.data.nameCn,this.data.resName+"anim000",this.seed);e.takeDamage(this.data.getAttackPoint(),i,this)&&this.addPlayerStatus(e,i)}},e.prototype.takeDizz=function(t){var e=this;t>0&&(this.sc.isDizzing=!0,this.scheduleOnce(function(){e.sc.isDizzing=!1},t))},e.prototype.getScaleSize=function(){var t=this.data.sizeType&&this.data.sizeType>0?this.data.sizeType:1;return this.IsVariation?i.SCALE_NUM*t:t},e.prototype.actorName=function(){return this.data.nameCn},e.prototype.enterShow=function(){var t=this;this.sprite.stopAllActions(),this.bodySprite.node.color=cc.Color.BLACK,cc.tween(this.bodySprite.node).to(1,{color:cc.color(255,255,255).fromHEX(this.data.bodyColor)}).call(function(){t.sc.isShow=!0}).start()},e.prototype.enterDisguise=function(){this.sc.isShow=!0,this.sprite.stopAllActions(),this.anim.getAnimationState("MonsterIdle").isPlaying&&this.anim.pause(),this.changeBodyRes(this.data.resName,i.RES_DISGUISE)},e.prototype.enterIdle=function(){var t=this;this.sc=new I.default,this.sc.isShow=!0;var e=cc.tween().delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_IDLE000)}).delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_IDLE001)});this.sprite.stopAllActions(),this.setLinearVelocity(cc.Vec2.ZERO),cc.tween(this.sprite).repeatForever(e).start(),this.anim.play("MonsterIdle"),this.dangerBox.finish()},e.prototype.enterWalk=function(){var t=this,e=cc.tween().delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_WALK00)}).delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_WALK01)}).delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_WALK02)}).delay(.2).call(function(){t.changeBodyRes(t.data.resName,i.RES_WALK03)});this.sprite.stopAllActions(),cc.tween(this.sprite).repeatForever(e).start(),this.anim.play("MonsterIdle")},e.prototype.enterDizz=function(){this.sprite.stopAllActions()},e.prototype.enterBlink=function(){var t=this;this.setLinearVelocity(cc.Vec2.ZERO),cc.director.emit(c.EventHelper.PLAY_AUDIO,{detail:{name:S.default.BLINK}});var e=this.bodySprite.node;cc.tween(e).to(.2,{opacity:0}).call(function(){var e=x.default.getNearestEnemyPosition(t,!0,t.dungeon,!0);e=(e=u.default.getIndexInMap(e)).x>t.pos.x?e.addSelf(cc.v3(1,0)):e.addSelf(cc.v3(-1,0));var i=u.default.getPosInMap(e);t.node.setPosition(i)}).to(.2,{opacity:255}).call(function(){t.sc.isBlinking=!1}).start()},e.prototype.isMoveTimeDelay=function(t,e){return this.moveTimeDelay+=t,this.moveTimeDelay>e&&(this.moveTimeDelay=0,!0)},e.prototype.enterFall=function(){this.bodySprite.node.angle=this.isPlayerBehindAttack()?-75:105,this.anim.play("MonsterFall")},e.prototype.updateStatus=function(t,e){this.data.StatusTotalData.valueCopy(e),this.data.StatusList=t},e.prototype.hideSelf=function(){},e.prototype.updateDream=function(){return 0},e.RES_DISGUISE="disguise",e.RES_IDLE000="anim000",e.RES_IDLE001="anim001",e.RES_WALK00="anim002",e.RES_WALK01="anim003",e.RES_WALK02="anim004",e.RES_WALK03="anim005",e.RES_HIT001="anim006",e.RES_HIT002="anim007",e.RES_HIT003="anim008",e.RES_ATTACK01="anim009",e.SCALE_NUM=1.5,e.ANIM_NONE=-1,e.ANIM_IDLE=0,e.ANIM_WALK=1,e.ANIM_ATTACK=2,e.ANIM_HIT=3,e.ANIM_DIED=4,n([l(cc.Vec3)],e.prototype,"pos",void 0),n([l(h.default)],e.prototype,"healthBar",void 0),n([l(f.default)],e.prototype,"statusManager",void 0),n([l(y.default)],e.prototype,"floatinglabelManager",void 0),n([l(R.default)],e.prototype,"specialManager",void 0),n([l(cc.Prefab)],e.prototype,"boom",void 0),n([l(L.default)],e.prototype,"dangerBox",void 0),n([l(cc.Node)],e.prototype,"dangerTips",void 0),n([l(cc.Prefab)],e.prototype,"attrPrefab",void 0),i=n([s],e)}(_.default);i.default=H,cc._RF.pop()},{"./Achievement":"Achievement","./Actor/ActorAttackBox":"ActorAttackBox","./Actor/AreaOfEffect":"AreaOfEffect","./Actor/ColliderTag":"ColliderTag","./Actor/NonPlayerActorState":"NonPlayerActorState","./Base/Actor":"Actor","./Base/StateContext":"StateContext","./Base/fsm/DefaultStateMachine":"DefaultStateMachine","./Data/AreaOfEffectData":"AreaOfEffectData","./Data/DamageData":"DamageData","./Data/FromData":"FromData","./Data/NonPlayerData":"NonPlayerData","./Dungeon":"Dungeon","./EventHelper":"EventHelper","./HealthBar":"HealthBar","./Item/Item":"Item","./Logic":"Logic","./Manager/FloatingLabelManager":"FloatingLabelManager","./Manager/SpecialManager":"SpecialManager","./Manager/StatusManager":"StatusManager","./Shooter":"Shooter","./Utils/ActorUtils":"ActorUtils","./Utils/AudioPlayer":"AudioPlayer","./Utils/IndexZ":"IndexZ","./Utils/NextStep":"NextStep","./Utils/Random":"Random"}],OilGoldCount:[function(t,e,i){"use strict";cc._RF.push(e,"12dafP9eVJAZosCqqpFY/Vi","OilGoldCount");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./EventHelper"),l=t("./Utils/AudioPlayer"),c=cc._decorator,h=c.ccclass,p=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentLabel=null,e.gemLabel=null,e.gemCountLerp=0,e.fragmentCountLerp=0,e.progreesBar=null,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),cc.director.on(s.EventHelper.HUD_ADD_OILGOLD,function(e){t.addCount(e.detail.count)}),cc.director.on(s.EventHelper.HUD_LOSE_OILGOLD,function(){if(t.node){var e=r.default.playerData.OilGoldData.fragments;t.addCount(""+-e),r.default.saveGroundOilGold(e)}})},e.prototype.start=function(){},e.prototype.addCount=function(t){if(this.anim){r.default.oilGolds+=parseInt(t);var e=r.default.playerData.OilGoldData.index;r.default.updateOilGoldCount(),e<r.default.playerData.OilGoldData.index&&l.default.play(l.default.LEVELUP),s.EventHelper.emit(s.EventHelper.PLAYER_UPDATE_OILGOLD_DATA)}},e.prototype.update=function(t){this.gemCountLerp=r.default.lerp(this.gemCountLerp,r.default.playerData.OilGoldData.level,5*t),this.fragmentCountLerp=r.default.lerp(this.fragmentCountLerp,r.default.playerData.OilGoldData.fragments,5*t),this.gemLabel&&(this.gemLabel.string=""+this.gemCountLerp.toFixed(0)),this.fragmentLabel&&(this.fragmentLabel.string=this.fragmentCountLerp.toFixed(0)+"/"+r.default.OIL_GOLD_LIST[r.default.playerData.OilGoldData.index]),this.progreesBar&&(this.progreesBar.progress=r.default.lerp(this.progreesBar.progress,r.default.playerData.OilGoldData.fragments/r.default.OIL_GOLD_LIST[r.default.playerData.OilGoldData.index],5*t))},n([p(cc.Label)],e.prototype,"fragmentLabel",void 0),n([p(cc.Label)],e.prototype,"gemLabel",void 0),n([p(cc.ProgressBar)],e.prototype,"progreesBar",void 0),n([h],e)}(cc.Component);i.default=u,cc._RF.pop()},{"./EventHelper":"EventHelper","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer"}],OilGoldData:[function(t,e,i){"use strict";cc._RF.push(e,"700faV6hzxA44Hyyhr1kVep","OilGoldData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./BaseData"),r=t("./CommonData"),s=function(t){function e(){var e=t.call(this)||this;return e.value=0,e.fragments=0,e.level=0,e.index=0,e.common=new r.default,e}return a(e,t),Object.defineProperty(e.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),e.prototype.valueCopy=function(t){t&&(this.common.valueCopy(t.common),this.fragments=t.fragments?t.fragments:0,this.level=t.level?t.level:0,this.index=t.index?t.index:0,this.value=t.value?t.value:0)},e.prototype.clone=function(){var t=new e;return t.fragments=this.fragments,t.common=this.common.clone(),t.level=this.level,t.index=this.index,t.value=this.value,t},e}(n.default);i.default=s,cc._RF.pop()},{"./BaseData":"BaseData","./CommonData":"CommonData"}],OilGold:[function(t,e,i){"use strict";cc._RF.push(e,"8833cW2JN9EQJVhihMruuSF","OilGold");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../EventHelper"),l=t("../Utils/Random"),c=t("../Utils/AudioPlayer"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e.isReady=!1,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){},e.prototype.onEnable=function(){var t=this;this.rigidBody=this.getComponent(cc.RigidBody);var e=l.default.rand()*(r.default.getHalfChance()?1:-1)*1200,i=l.default.rand()*(r.default.getHalfChance()?1:-1)*1200;this.rigidBody.linearVelocity=cc.v2(e,i),this.rigidBody.linearDamping=10,this.isReady=!1,this.scheduleOnce(function(){t.isReady=!0},1.5)},e.prototype.changeValue=function(t){this.value=t,this.value>=i.FACE_VALUE?this.node.scale=2:this.node.scale=1},e.prototype.getFinalValue=function(){var t=this.value;switch(r.default.chapterIndex){case r.default.CHAPTER00:break;case r.default.CHAPTER01:t*=10;break;case r.default.CHAPTER02:t*=100;break;case r.default.CHAPTER03:t*=1e3;break;case r.default.CHAPTER04:case r.default.CHAPTER05:t*=1e4}return t},e.prototype.start=function(){},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.getNearPlayerDistance=function(t){return r.default.getDistance(this.node.position,t.position.clone().addSelf(cc.v3(0,32)))},e.prototype.update=function(t){if(this.isCheckTimeDelay(t)&&this.player&&this.getNearPlayerDistance(this.player.node)<400&&this.node.active&&this.isReady){var e=this.player.node.position.clone();e.y+=10;var i=e.sub(this.node.position);i.equals(cc.Vec3.ZERO)||(i=(i=i.normalizeSelf()).mul(800),this.rigidBody.linearVelocity=cc.v2(i),this.rigidBody.linearDamping=1)}this.player&&this.getNearPlayerDistance(this.player.node)<64&&this.node.active&&this.isReady&&(this.isReady=!1,c.default.play(c.default.OILGOLD),s.EventHelper.emit(s.EventHelper.HUD_ADD_OILGOLD,{count:this.getFinalValue()}),s.EventHelper.emit("destoryoilgold",{oilGoldNode:this.node}))},e.FACE_VALUE=100,i=n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"../EventHelper":"EventHelper","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/Random":"Random"}],OilLake:[function(t,e,i){"use strict";cc._RF.push(e,"8cd153I1qFEbb/uteHyUJpM","OilLake");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=t("./PerlinNoise2D"),n=t("../Utils/Random"),r=cc._decorator,s=r.ccclass,l=(r.property,function(){function t(){this.map=new Array;var t,i,o,r,s=new a.default;s.seed(n.default.rand()),o=20+this.getRandomNum(20),r=20+this.getRandomNum(20),t=this.getRandomNum(9999),i=this.getRandomNum(9999);var l=e.WIDTH,c=e.HEIGHT;this.map=new Array;for(var h=0;h<l;h++){this.map[h]=new Array;for(var p=0;p<c;p++){this.map[h][p]=".";var u=o*h/l+t,d=r*p/c+i,f=s.simplex2(u,d);f>.14?this.map[h][p]="Y":f<-.14&&(this.map[h][p]="~");var g=n.default.rand();g>=0&&g<.2&&"~"!=this.map[h][p]&&(this.map[h][p]="o"),g>=.2&&g<.25&&"~"!=this.map[h][p]&&(this.map[h][p]="w")}}}var e;return e=t,t.prototype.getRandomNum=function(t){return Math.round(n.default.rand()*t)},t.prototype.getDisPlay=function(){for(var t="",i=e.HEIGHT-1;i>=0;i--){for(var o=0;o<e.WIDTH;o++)t+=this.map[o][i];t+="\n"}return t},t.WIDTH=64,t.HEIGHT=64,e=o([s],t)}());i.default=l,cc._RF.pop()},{"../Utils/Random":"Random","./PerlinNoise2D":"PerlinNoise2D"}],OrganizationTalent:[function(t,e,i){"use strict";cc._RF.push(e,"05cb5HVifxPKYxNiXzzrtHe","OrganizationTalent");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/AvatarData"),s=t("../Data/FromData"),l=t("../Data/NonPlayerData"),c=t("../Data/StatusData"),h=t("../Logic"),p=t("../Manager/NonPlayerManager"),u=t("../Manager/StatusManager"),d=t("../UI/CoolDownView"),f=t("../Utils/AudioPlayer"),g=t("./Talent"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.energyShieldList=[],e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.changePerformance=function(){},e.prototype.init=function(e){t.prototype.init.call(this,e),this.coolDownId=d.default.ORGANIZATION;var i=1;this.player.data.AvatarData.organizationIndex==r.default.GURAD&&(i=1+Math.floor(h.default.playerData.OilGoldData.level/5)),this.initCoolDown(e,i)},e.prototype.doSkill=function(){var t=this;if(this.player.data.AvatarData.organizationIndex==r.default.GURAD){if(this.energyShieldList.length>this.talentSkill.StorePointMax){var e=this.energyShieldList.pop();e.isShow=!1,e&&e.isValid&&e.destroy()}var i=this.player.dungeon.buildingManager.addEnergyShield(this.player);i&&(this.energyShieldList.push(i),this.scheduleOnce(function(){t.talentSkill.IsExcuting=!1},1))}else if(this.player.data.AvatarData.organizationIndex==r.default.HUNTER)f.default.play(f.default.DOG),this.player.dungeon.nonPlayerManager.isPetAlive()?((o=new c.default).valueCopy(h.default.status[u.default.PET_DOG]),o.Common.realRate+=1*h.default.playerData.OilGoldData.level,o.Common.realDamage+=h.default.playerData.OilGoldData.level,o.realDamageOvertime-=h.default.playerData.OilGoldData.level/5,this.player.dungeon.nonPlayerManager.pet.addCustomStatus(o,new s.default)):((o=new l.default).valueCopy(h.default.nonplayers[p.default.DOG]),o.Common.maxHealth+=3*h.default.playerData.OilGoldData.level,o.currentHealth=o.Common.maxHealth,o.Common.damageMin+=h.default.playerData.OilGoldData.level,o.Common.defence+=h.default.playerData.OilGoldData.level,this.player.dungeon.nonPlayerManager.addPetFromData(o,this.player.node.position,this.player.dungeon));else if(this.player.data.AvatarData.organizationIndex==r.default.TECH){var o;f.default.play(f.default.PICK_ITEM),(o=new c.default).valueCopy(h.default.status[u.default.REAGENT]),o.duration+=3*h.default.playerData.OilGoldData.level,o.Common.maxHealth=this.player.data.FinalCommon.maxHealth*(.5+.1*h.default.playerData.OilGoldData.level),o.Common.damageMin=this.player.data.FinalCommon.damageMin*(.5+.1*h.default.playerData.OilGoldData.level),o.Common.defence=this.player.data.FinalCommon.defence*(.5+.1*h.default.playerData.OilGoldData.level),o.Common.remoteDamage=this.player.data.FinalCommon.remoteDamage*(.5+.05*h.default.playerData.OilGoldData.level),o.realDamageDirect-=o.Common.maxHealth,this.player.addCustomStatus(o,new s.default)}},e.prototype.takeDamage=function(t){return this.energyShieldBlock(t)},e.prototype.energyShieldBlock=function(t){for(var e=this.energyShieldList.length-1;e>=0;e--){var i=this.energyShieldList[e];if(i.node&&i.node.isValid)return i.isShow&&i.checkTargetIn(this.player.node)&&i.takeDamage(t);this.energyShieldList.splice(e,1)}return!1},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},n([v(cc.Sprite)],e.prototype,"sprite",void 0),n([m],e)}(g.default);i.default=E,cc._RF.pop()},{"../Data/AvatarData":"AvatarData","../Data/FromData":"FromData","../Data/NonPlayerData":"NonPlayerData","../Data/StatusData":"StatusData","../Logic":"Logic","../Manager/NonPlayerManager":"NonPlayerManager","../Manager/StatusManager":"StatusManager","../UI/CoolDownView":"CoolDownView","../Utils/AudioPlayer":"AudioPlayer","./Talent":"Talent"}],PaletteSelector:[function(t,e,i){"use strict";cc._RF.push(e,"2484805pD1NW4q2UMrBMgzJ","PaletteSelector");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layout=null,e.colors=[],e.currentIndex=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){},e.prototype.init=function(t,e){var o=this;switch(t){case i.TYPE_EYES:this.colors=i.EYESCOLORS;break;case i.TYPE_HAIR:this.colors=i.HAIRCOLORS;break;case i.TYPE_FACE:this.colors=i.FACECOLORS}this.currentIndex=e||0;for(var a=function(t){var e=n.layout.children[t];t>n.colors.length-1?e.color=cc.Color.BLACK:e.color=cc.Color.WHITE.fromHEX(n.colors[t]),e.on(cc.Node.EventType.TOUCH_START,function(){o.updateAttribute(e.color)})},n=this,r=0;r<this.layout.childrenCount;r++)a(r);this.updateAttribute(cc.Color.WHITE.fromHEX(this.colors[this.currentIndex]))},e.prototype.selectRandom=function(){this.currentIndex=r.default.getRandomNum(0,this.colors.length-1),this.updateAttribute(cc.Color.WHITE.fromHEX(this.colors[this.currentIndex]))},e.prototype.setSelectorCallback=function(t){this.selectorCallback=t},e.prototype.updateAttribute=function(t){this.selectorCallback&&this.selectorCallback(t)},e.TYPE_HAIR=0,e.TYPE_EYES=1,e.TYPE_FACE=2,e.EYESCOLORS=["#000000","#222034","#45283c","#663931","#fbf236","#6abe30","#37946e","#524b24","#306082","#5b6ee1","#639bff","#5fcde4","#cbdbfc","#ffc500","#ffffff","#9badb7","#76428a","#ac3232","#d95763","#8f974a","#c20000"],e.HAIRCOLORS=["#000000","#222034","#45283c","#663931","#fbf236","#6abe30","#37946e","#524b24","#306082","#5b6ee1","#639bff","#5fcde4","#cbdbfc","#ffc500","#ffffff","#9badb7","#76428a","#ac3232","#d95763","#8f974a","#c20000"],e.FACECOLORS=["#FBA1DE","#d95763","#818185","#d9a066","#663931","#fbf236","#6abe30","#37946e","#524b24","#306082","#5b6ee1","#639bff","#5fcde4","#cbdbfc","#ffc500","#ffffff","#9badb7","#76428a","#ac3232","#8f974a","#c20000"],n([c(cc.Node)],e.prototype,"layout",void 0),i=n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../Logic":"Logic"}],ParallaxBackground:[function(t,e,i){"use strict";cc._RF.push(e,"509a7aimNhEX5/e74VkypMj","ParallaxBackground");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.layer1=null,e.layer2=null,e}return a(e,t),e.prototype.init=function(){this.layer1.getComponent(cc.Sprite).spriteFrame=s.default.spriteFrameRes("chapter0"+s.default.chapterIndex+"layer1"),this.layer2.getComponent(cc.Sprite).spriteFrame=s.default.spriteFrameRes("chapter0"+s.default.chapterIndex+"layer2")},e.prototype.getPlayer=function(){return this.player||(this.player=this.node.parent.getComponent(r.default).player),this.player},e.prototype.start=function(){},e.prototype.lateUpdate=function(){var t=this.getPlayer();if(t){var e=t.node.convertToWorldSpaceAR(cc.Vec3.ZERO);this.layer1.position=this.lerp(this.layer1.position,this.node.convertToNodeSpaceAR(e),.005),this.layer2.position=this.lerp(this.layer2.position,this.node.convertToNodeSpaceAR(e),.015)}},e.prototype.lerp=function(t,e,i){var o=cc.v3(0,0),a=t.x,n=t.y;return o.x=a+(e.x-a)*i,o.y=n+(e.y-n)*i,o},n([h(cc.Node)],e.prototype,"background",void 0),n([h(cc.Node)],e.prototype,"layer1",void 0),n([h(cc.Node)],e.prototype,"layer2",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic"}],PerlinNoise2D:[function(t,e,i){"use strict";cc._RF.push(e,"59901zRRqlG9KvoKLDTbxq7","PerlinNoise2D");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,n=a.ccclass,r=(a.property,function(){function t(){this.grad3=[new s(1,1,0),new s(-1,1,0),new s(1,-1,0),new s(-1,-1,0),new s(1,0,1),new s(-1,0,1),new s(1,0,-1),new s(-1,0,-1),new s(0,1,1),new s(0,-1,1),new s(0,1,-1),new s(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.F2=.5*(Math.sqrt(3)-1),this.G2=(3-Math.sqrt(3))/6,this.F3=1/3,this.G3=1/6}return t.prototype.simplex2=function(t,e){var i,o,a=(t+e)*this.F2,n=Math.floor(t+a),r=Math.floor(e+a),s=(n+r)*this.G2,l=t-n+s,c=e-r+s;l>c?(i=1,o=0):(i=0,o=1);var h=l-i+this.G2,p=c-o+this.G2,u=l-1+2*this.G2,d=c-1+2*this.G2;n&=255,r&=255;var f=this.gradP[n+this.perm[r]],g=this.gradP[n+i+this.perm[r+o]],y=this.gradP[n+1+this.perm[r+1]],m=.5-l*l-c*c,v=.5-h*h-p*p,E=.5-u*u-d*d;return 70*((m<0?0:(m*=m)*m*f.dot2(l,c))+(v<0?0:(v*=v)*v*g.dot2(h,p))+(E<0?0:(E*=E)*E*y.dot2(u,d)))},t.prototype.simplex3=function(t,e,i){var o,a,n,r,s,l,c=(t+e+i)*this.F3,h=Math.floor(t+c),p=Math.floor(e+c),u=Math.floor(i+c),d=(h+p+u)*this.G3,f=t-h+d,g=e-p+d,y=i-u+d;f>=g?g>=y?(o=1,a=0,n=0,r=1,s=1,l=0):f>=y?(o=1,a=0,n=0,r=1,s=0,l=1):(o=0,a=0,n=1,r=1,s=0,l=1):g<y?(o=0,a=0,n=1,r=0,s=1,l=1):f<y?(o=0,a=1,n=0,r=0,s=1,l=1):(o=0,a=1,n=0,r=1,s=1,l=0);var m=f-o+this.G3,v=g-a+this.G3,E=y-n+this.G3,_=f-r+2*this.G3,D=g-s+2*this.G3,S=y-l+2*this.G3,R=f-1+3*this.G3,T=g-1+3*this.G3,O=y-1+3*this.G3;h&=255,p&=255,u&=255;var C=this.gradP[h+this.perm[p+this.perm[u]]],A=this.gradP[h+o+this.perm[p+a+this.perm[u+n]]],L=this.gradP[h+r+this.perm[p+s+this.perm[u+l]]],P=this.gradP[h+1+this.perm[p+1+this.perm[u+1]]],b=.6-f*f-g*g-y*y,I=.6-m*m-v*v-E*E,M=.6-_*_-D*D-S*S,N=.6-R*R-T*T-O*O;return 32*((b<0?0:(b*=b)*b*C.dot3(f,g,y))+(I<0?0:(I*=I)*I*A.dot3(m,v,E))+(M<0?0:(M*=M)*M*L.dot3(_,D,S))+(N<0?0:(N*=N)*N*P.dot3(R,T,O)))},t.prototype.perlin2=function(t,e){var i=Math.floor(t),o=Math.floor(e);t-=i,e-=o,i&=255,o&=255;var a=this.gradP[i+this.perm[o]].dot2(t,e),n=this.gradP[i+this.perm[o+1]].dot2(t,e-1),r=this.gradP[i+1+this.perm[o]].dot2(t-1,e),s=this.gradP[i+1+this.perm[o+1]].dot2(t-1,e-1),l=this.fade(t);return this.lerp(this.lerp(a,r,l),this.lerp(n,s,l),this.fade(e))},t.prototype.perlin3=function(t,e,i){var o=Math.floor(t),a=Math.floor(e),n=Math.floor(i);t-=o,e-=a,i-=n,o&=255,a&=255,n&=255;var r=this.gradP[o+this.perm[a+this.perm[n]]].dot3(t,e,i),s=this.gradP[o+this.perm[a+this.perm[n+1]]].dot3(t,e,i-1),l=this.gradP[o+this.perm[a+1+this.perm[n]]].dot3(t,e-1,i),c=this.gradP[o+this.perm[a+1+this.perm[n+1]]].dot3(t,e-1,i-1),h=this.gradP[o+1+this.perm[a+this.perm[n]]].dot3(t-1,e,i),p=this.gradP[o+1+this.perm[a+this.perm[n+1]]].dot3(t-1,e,i-1),u=this.gradP[o+1+this.perm[a+1+this.perm[n]]].dot3(t-1,e-1,i),d=this.gradP[o+1+this.perm[a+1+this.perm[n+1]]].dot3(t-1,e-1,i-1),f=this.fade(t),g=this.fade(e),y=this.fade(i);return this.lerp(this.lerp(this.lerp(r,h,f),this.lerp(s,p,f),y),this.lerp(this.lerp(l,u,f),this.lerp(c,d,f),y),g)},t.prototype.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var i;i=1&e?this.p[e]^255&t:this.p[e]^t>>8&255,this.perm[e]=this.perm[e+256]=i,this.gradP[e]=this.gradP[e+256]=this.grad3[i%12]}},t.prototype.lerp=function(t,e,i){return(1-i)*t+i*e},t.prototype.fade=function(t){return t*t*t*(t*(6*t-15)+10)},o([n],t)}());i.default=r;var s=function(){function t(t,e,i){this.x=t,this.y=e,this.z=i}return t.prototype.dot2=function(t,e){return this.x*t+this.y*e},t.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i},t}();cc._RF.pop()},{}],PickAvatar:[function(t,e,i){"use strict";cc._RF.push(e,"c7974nYPCdMvb6AS/8/NF4d","PickAvatar");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Utils/AudioPlayer"),l=t("./AttributeSelector"),c=t("../Data/AttributeData"),h=t("./BrightnessBar"),p=t("./PaletteSelector"),u=t("../Data/AvatarData"),d=t("../Manager/EquipmentManager"),f=t("../Manager/InventoryManager"),g=t("../Manager/LoadingManager"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SELECTOR_ORGANIZATION=0,e.SELECTOR_GENGER=1,e.SELECTOR_HAIR=2,e.COLOR_PATTLE_HAIR=3,e.SELECTOR_EYES=4,e.COLOR_PATTLE_EYES=5,e.SELECTOR_FACE=6,e.COLOR_PATTLE_FACE=7,e.SELECTOR_BODY=8,e.PROGRESS_SKIN_COLOR=9,e.SELECTOR_PROFESSION=10,e.loadingBackground=null,e.avatarTable=null,e.attributeLayout=null,e.randomLayout=null,e.randomLabelTitle=null,e.randomLabelName=null,e.randomLabelDesc=null,e.randomLabelSkillName=null,e.randomLabelSkillDesc=null,e.randomButton=null,e.selectorPrefab=null,e.brightnessBarPrefab=null,e.palettePrefab=null,e.cloakSprite=null,e.shoesSprite1=null,e.shoesSprite2=null,e.helmetSprite=null,e.pantsSprite=null,e.clothesSprite=null,e.glovesSprite1=null,e.glovesSprite2=null,e.weaponSprite=null,e.remoteSprite=null,e.shieldSprite=null,e.randomTouched=!1,e.isShow=!1,e.loadingManager=new g.default,e.delayTime=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.loadingManager.init(),this.data=new u.default,this.bedSprite=this.getSpriteChildSprite(this.avatarTable,["bed"]),this.coverSprite=this.getSpriteChildSprite(this.avatarTable,["cover"]),this.bodySprite=this.getSpriteChildSprite(this.avatarTable,["avatar","body"]),this.handSprite1=this.getSpriteChildSprite(this.avatarTable,["avatar","body","hand1"]),this.handSprite2=this.getSpriteChildSprite(this.avatarTable,["avatar","body","hand2"]),this.legSprite1=this.getSpriteChildSprite(this.avatarTable,["avatar","body","leg1"]),this.legSprite2=this.getSpriteChildSprite(this.avatarTable,["avatar","body","leg2"]),this.headSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","head"]),this.hairSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","head","hair"]),this.faceSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","head","face"]),this.eyesSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","head","eyes"]),this.helmetSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","head","helmet"]),this.pantsSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","body","pants"]),this.cloakSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","cloak"]),this.weaponSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","weapon"]),this.remoteSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","remote"]),this.shieldSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","shield"]),this.clothesSprite=this.getSpriteChildSprite(this.avatarTable,["avatar","body","clothes"]),this.glovesSprite1=this.getSpriteChildSprite(this.avatarTable,["avatar","body","hand1","gloves"]),this.glovesSprite2=this.getSpriteChildSprite(this.avatarTable,["avatar","body","hand2","gloves"]),this.shoesSprite1=this.getSpriteChildSprite(this.avatarTable,["avatar","body","leg1","shoes"]),this.shoesSprite2=this.getSpriteChildSprite(this.avatarTable,["avatar","body","leg2","shoes"]),this.loadingBackground.active=!0,this.loadingManager.loadSpriteAtlas(g.default.KEY_TEXTURES,"ammo"),this.loadingManager.loadProfession(),this.loadingManager.loadEquipment(),this.loadingManager.loadTalents(),this.loadingManager.loadItems(),this.loadingManager.loadSuits(),this.attributeLayout.active=!1,this.randomButton.on(cc.Node.EventType.TOUCH_START,function(){t.randomTouched=!0},this),this.randomButton.on(cc.Node.EventType.TOUCH_END,function(){t.randomTouched=!1},this),this.randomButton.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.randomTouched=!1},this)},e.prototype.getSpriteChildSprite=function(t,e){for(var i=0,o=e;i<o.length;i++){var a=o[i];t=t.getChildByName(a)}return t.getComponent(cc.Sprite)},e.prototype.show=function(){var t=this;this.isShow=!0,this.loadingBackground.active=!1;for(var e=new Array,i=0;i<u.default.ORGANIZATION.length;i++)e.push(new c.default(i,u.default.ORGANIZATION[i],"","","",""));this.organizationSelector=this.addAttributeSelector("\u7ec4\u7ec7\uff1a",e),this.organizationSelector.selectorCallback=function(e){t.data.organizationIndex=e.id,t.bedSprite.spriteFrame=r.default.spriteFrameRes("avatarbed00"+e.id),t.coverSprite.spriteFrame=r.default.spriteFrameRes("avatarcover00"+e.id),t.randomLabelTitle.string=e.name};var o=new Array;for(i=0;i<r.default.professionList.length;i++){var a=r.default.professionList[i],n=r.default.talents[a.talent];o.push(new c.default(a.id,a.nameCn,"",a.desc,"\u6280\u80fd\uff1a"+n.nameCn,""+n.desc))}this.professionSelector=this.addAttributeSelector("\u804c\u4e1a\uff1a",o),this.professionSelector.selectorCallback=function(e){t.data.professionData.valueCopy(r.default.professionList[e.id]),t.randomLabelName.string=""+e.name,t.randomLabelDesc.string=""+e.desc,t.randomLabelSkillName.string=""+e.name1,t.randomLabelSkillDesc.string=""+e.desc1,t.changeEquipment(r.default.professionList[e.id])},this.skinSelector=this.addBrightnessBar(),this.skinSelector.setSelectorCallback(function(e){t.bodySprite.node.color=e,t.headSprite.node.color=e,t.handSprite1.node.color=e,t.handSprite2.node.color=e,t.legSprite1.node.color=e,t.legSprite2.node.color=e,t.data.skinColor=e.toHEX("#rrggbb")});var s=[];for(i=0;i<10;i++)s.push(new c.default(i,"\u6837\u5f0f"+i,"avatarhair0"+(i>9?"":"0")+i+"anim00","","",""));this.hairSelector=this.addAttributeSelector("\u53d1\u578b\uff1a",s),this.hairSelector.selectorCallback=function(e){t.hairSprite.spriteFrame=r.default.spriteFrameRes(e.resName+"0"),t.data.hairResName=e.resName},this.hairColorSelector=this.addPaletteSelector(p.default.TYPE_HAIR),this.hairColorSelector.setSelectorCallback(function(e){t.hairSprite.node.color=e,t.data.hairColor=e.toHEX("#rrggbb")});var l=[];for(i=0;i<22;i++)l.push(new c.default(i,"\u6837\u5f0f"+i,"avatareyes0"+(i>9?"":"0")+i,"","",""));this.eyesSelector=this.addAttributeSelector("\u773c\u775b\uff1a",l),this.eyesSelector.selectorCallback=function(e){t.eyesSprite.spriteFrame=r.default.spriteFrameRes(e.resName),t.data.eyesResName=e.resName},this.eyesColorSelector=this.addPaletteSelector(p.default.TYPE_EYES),this.eyesColorSelector.setSelectorCallback(function(e){t.eyesSprite.node.color=e,t.data.eyesColor=e.toHEX("#rrggbb")});var h=[];for(i=0;i<15;i++)h.push(new c.default(i,"\u6837\u5f0f"+i,"avatarface0"+(i>9?"":"0")+i,"","",""));this.faceSelector=this.addAttributeSelector("\u9762\u988a\uff1a",h),this.faceSelector.selectorCallback=function(e){t.faceSprite.spriteFrame=r.default.spriteFrameRes(e.resName),t.data.faceResName=e.resName},this.faceColorSelector=this.addPaletteSelector(p.default.TYPE_FACE),this.faceColorSelector.setSelectorCallback(function(e){t.faceSprite.node.color=e,t.data.faceColor=e.toHEX("#rrggbb")}),this.ButtonRandom()},e.prototype.changeEquipment=function(t){this.changeRes(this.helmetSprite,t.equips[f.default.HELMET],"anim0"),this.changeRes(this.pantsSprite,t.equips[f.default.TROUSERS]),this.changeRes(this.cloakSprite,t.equips[f.default.CLOAK]),this.changeRes(this.weaponSprite,t.equips[f.default.WEAPON]),this.changeRes(this.remoteSprite,t.equips[f.default.REMOTE],"anim0"),this.changeRes(this.shieldSprite,t.equips[f.default.SHIELD]),this.changeRes(this.clothesSprite,t.equips[f.default.CLOTHES],"anim0"),this.changeRes(this.glovesSprite1,t.equips[f.default.GLOVES]),this.changeRes(this.glovesSprite2,t.equips[f.default.GLOVES]),this.changeRes(this.shoesSprite1,t.equips[f.default.SHOES]),this.changeRes(this.shoesSprite2,t.equips[f.default.SHOES]),this.resetSpriteSize(this.weaponSprite),this.resetSpriteSize(this.remoteSprite),this.resetSpriteSize(this.shieldSprite)},e.prototype.resetSpriteSize=function(t){t.spriteFrame&&(t.node.width=t.spriteFrame.getRect().width,t.node.height=t.spriteFrame.getRect().height)},e.prototype.changeRes=function(t,e,i){if(!t)return!1;var o=r.default.spriteFrameRes(e);i&&r.default.spriteFrameRes(e+i)&&(o=r.default.spriteFrameRes(e+i)),t.spriteFrame=o||null},e.prototype.startGame=function(){this.loadingBackground.active||(r.default.profileManager.clearData(),r.default.resetData(r.default.jumpChapter),r.default.jumpChapter=0,s.default.play(s.default.SELECT),r.default.playerData.AvatarData=this.data.clone(),this.addPorfessionEquipment(),cc.director.loadScene("loading"))},e.prototype.backToHome=function(){cc.director.loadScene("start"),s.default.play(s.default.SELECT)},e.prototype.addPorfessionEquipment=function(){for(var t in r.default.inventoryManager.equips)r.default.inventoryManager.equips[t].valueCopy(d.default.getNewEquipData(this.data.professionData.equips[t]?this.data.professionData.equips[t]:""))},e.prototype.addBrightnessBar=function(){var t=cc.instantiate(this.brightnessBarPrefab),e=t.getComponent(h.default);return this.attributeLayout.addChild(t),e},e.prototype.addAttributeSelector=function(t,e,i){var o=cc.instantiate(this.selectorPrefab),a=o.getComponent(l.default);return this.attributeLayout.addChild(o),a.init(t,e,i),a},e.prototype.addPaletteSelector=function(t,e){var i=cc.instantiate(this.palettePrefab),o=i.getComponent(p.default);return this.attributeLayout.addChild(i),o.init(t,e),o},e.prototype.update=function(t){this.loadingManager.isSpriteFramesLoaded(g.default.KEY_TEXTURES)&&this.loadingManager.isProfessionLoaded&&this.loadingManager.isEquipmentLoaded&&this.loadingManager.isSkillsLoaded&&this.loadingManager.isItemsLoaded&&this.loadingManager.isSuitsLoaded&&(this.loadingManager.reset(),this.show()),this.isShow&&this.isTimeDelay(t)&&this.randomTouched&&this.ButtonRandom()},e.prototype.isTimeDelay=function(t){return this.delayTime+=t,this.delayTime>.1&&(this.delayTime=0,!0)},e.prototype.ButtonSwitch=function(){this.loadingBackground.active||(this.randomLayout.active=!this.randomLayout.active,this.attributeLayout.active=!this.attributeLayout.active,s.default.play(s.default.SELECT))},e.prototype.ButtonRandom=function(){this.loadingBackground.active||(this.organizationSelector.selectRandom(),this.professionSelector.selectRandom(),this.skinSelector.selectRandom(),this.hairSelector.selectRandom(),this.hairColorSelector.selectRandom(),this.eyesSelector.selectRandom(),this.eyesColorSelector.selectRandom(),this.faceSelector.selectRandom(),this.faceColorSelector.selectRandom(),s.default.play(s.default.SELECT))},e.prototype.ButtonSelect=function(t,e){this.loadingBackground.active||(this.professionSelector.selectNext(0==e),s.default.play(s.default.SELECT))},n([v(cc.Node)],e.prototype,"loadingBackground",void 0),n([v(cc.Node)],e.prototype,"avatarTable",void 0),n([v(cc.Node)],e.prototype,"attributeLayout",void 0),n([v(cc.Node)],e.prototype,"randomLayout",void 0),n([v(cc.Label)],e.prototype,"randomLabelTitle",void 0),n([v(cc.Label)],e.prototype,"randomLabelName",void 0),n([v(cc.Label)],e.prototype,"randomLabelDesc",void 0),n([v(cc.Label)],e.prototype,"randomLabelSkillName",void 0),n([v(cc.Label)],e.prototype,"randomLabelSkillDesc",void 0),n([v(cc.Node)],e.prototype,"randomButton",void 0),n([v(cc.Prefab)],e.prototype,"selectorPrefab",void 0),n([v(cc.Prefab)],e.prototype,"brightnessBarPrefab",void 0),n([v(cc.Prefab)],e.prototype,"palettePrefab",void 0),n([m],e)}(cc.Component);i.default=E,cc._RF.pop()},{"../Data/AttributeData":"AttributeData","../Data/AvatarData":"AvatarData","../Logic":"Logic","../Manager/EquipmentManager":"EquipmentManager","../Manager/InventoryManager":"InventoryManager","../Manager/LoadingManager":"LoadingManager","../Utils/AudioPlayer":"AudioPlayer","./AttributeSelector":"AttributeSelector","./BrightnessBar":"BrightnessBar","./PaletteSelector":"PaletteSelector"}],PlayerAvatar:[function(t,e,i){"use strict";cc._RF.push(e,"7621b1Y+05Jj7j6YdAgY785","PlayerAvatar");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./Manager/InventoryManager"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dir=i.DIR_RIGHT,e.status=i.STATE_IDLE,e.cloakSprite=null,e.legLeftSprite=null,e.legRightSprite=null,e.footLeftSprite=null,e.footRightSprite=null,e.shoesLeftSprite=null,e.shoesRightSprite=null,e.handLeftSprite=null,e.glovesLeftSprite=null,e.handRightSprite=null,e.glovesRightSprite=null,e.headSprite=null,e.faceSprite=null,e.eyesSprite=null,e.hairSprite=null,e.helmetSprite=null,e.bodySprite=null,e.pantsSprite=null,e.clothesSprite=null,e.avatarNode=null,e.spriteNode=null,e.idlehair=[0,1],e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.init()},e.prototype.init=function(){var t=this;this.data=r.default.playerData.AvatarData.clone(),this.anim=this.getComponent(cc.Animation),this.avatarNode=this.getSpriteChildNode(["sprite","avatar"]),this.spriteNode=this.getSpriteChildNode(["sprite"]),this.cloakSprite=this.getSpriteChildSprite(["sprite","cloak"]),this.legLeftSprite=this.getSpriteChildSprite(["sprite","avatar","legleft"]),this.legRightSprite=this.getSpriteChildSprite(["sprite","avatar","legright"]),this.footLeftSprite=this.getSpriteChildSprite(["sprite","avatar","legleft","foot"]),this.footRightSprite=this.getSpriteChildSprite(["sprite","avatar","legright","foot"]),this.shoesLeftSprite=this.getSpriteChildSprite(["sprite","avatar","legleft","foot","shoes"]),this.shoesRightSprite=this.getSpriteChildSprite(["sprite","avatar","legright","foot","shoes"]),this.handLeftSprite=this.getSpriteChildSprite(["sprite","avatar","handleft"]),this.handRightSprite=this.getSpriteChildSprite(["sprite","avatar","handright"]),this.glovesLeftSprite=this.getSpriteChildSprite(["sprite","avatar","handleft","gloves"]),this.glovesRightSprite=this.getSpriteChildSprite(["sprite","avatar","handright","gloves"]),this.headSprite=this.getSpriteChildSprite(["sprite","avatar","head"]),this.faceSprite=this.getSpriteChildSprite(["sprite","avatar","head","face"]),this.eyesSprite=this.getSpriteChildSprite(["sprite","avatar","head","eyes"]),this.hairSprite=this.getSpriteChildSprite(["sprite","avatar","head","hair"]),this.helmetSprite=this.getSpriteChildSprite(["sprite","avatar","head","helmet"]),this.bodySprite=this.getSpriteChildSprite(["sprite","avatar","body"]),this.pantsSprite=this.getSpriteChildSprite(["sprite","avatar","body","pants"]),this.clothesSprite=this.getSpriteChildSprite(["sprite","avatar","body","clothes"]),this.headSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.faceSprite.node.color=cc.Color.WHITE.fromHEX(this.data.faceColor),this.eyesSprite.node.color=cc.Color.WHITE.fromHEX(this.data.eyesColor),this.hairSprite.node.color=cc.Color.WHITE.fromHEX(this.data.hairColor),this.bodySprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.legLeftSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.legRightSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.footLeftSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.footRightSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.handLeftSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.handRightSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.hairSprite.node.stopAllActions(),this.changeAvatarByDir(i.DIR_RIGHT);var e=0;this.schedule(function(){t.hairSprite.spriteFrame=r.default.spriteFrameRes(t.data.hairResName+t.idlehair[e++]),e>1&&(e=0)},.2,cc.macro.REPEAT_FOREVER,.1)},e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,i=0,o=t;i<o.length;i++){var a=o[i];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.getSpriteChildNode=function(t){for(var e=this.node,i=0,o=t;i<o.length;i++){var a=o[i];e=e.getChildByName(a)}return e},e.prototype.showHandsWithInteract=function(t,e){this.handLeftSprite.node.scaleY=.2,this.handRightSprite.node.scaleY=.2,this.handLeftSprite.node.opacity=0,this.handRightSprite.node.opacity=0,this.handLeftSprite.node.y=8,this.handRightSprite.node.y=8,t&&(this.handLeftSprite.node.opacity=255,this.handRightSprite.node.opacity=255,e&&(this.handLeftSprite.node.scaleY=.3,this.handRightSprite.node.scaleY=.3,this.handLeftSprite.node.y=16,this.handRightSprite.node.y=16))},e.prototype.playAnim=function(t,e){switch(this.anim||this.init(),t){case i.STATE_IDLE:this.status!=t&&i.STATE_DIE!=this.status&&this.playIdle(e);break;case i.STATE_WALK:this.status==t&&this.dir==e||i.STATE_ATTACK==this.status||i.STATE_DIE==this.status||this.playWalk(e);break;case i.STATE_ATTACK:i.STATE_DIE!=this.status&&this.playAttack(e);break;case i.STATE_DIE:i.STATE_DIE!=this.status&&this.playDie();break;case i.STATE_FALL:i.STATE_DIE!=this.status&&this.anim.play("AvatarFall");break;case i.STATE_JUMP:i.STATE_DIE!=this.status&&this.anim.play("AvatarJump")}this.status=t,this.dir=e},e.prototype.changeLegColor=function(t,e){t?(this.legLeftSprite.node.color=cc.Color.WHITE.fromHEX(e),this.legRightSprite.node.color=cc.Color.WHITE.fromHEX(e),this.footLeftSprite.node.color=cc.Color.WHITE.fromHEX(e),this.footRightSprite.node.color=cc.Color.WHITE.fromHEX(e)):(this.legLeftSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.legRightSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.footLeftSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor),this.footRightSprite.node.color=cc.Color.WHITE.fromHEX(this.data.skinColor))},e.prototype.hitLight=function(t){this.bodySprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.headSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.hairSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.faceSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.eyesSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.handLeftSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.handRightSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.legLeftSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.legRightSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.footLeftSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT),this.footLeftSprite.getMaterial(0).setProperty("addColor",t?cc.color(200,200,200,100):cc.Color.TRANSPARENT)},e.prototype.changeEquipDirSpriteFrame=function(t,e){var i=t.equips[s.default.HELMET],o=t.equips[s.default.CLOTHES];this.cloakSprite.node.zIndex=0==e?this.avatarNode.zIndex+1:this.avatarNode.zIndex-1,0==e&&r.default.spriteFrameRes(i.img+"anim2")?this.helmetSprite.spriteFrame=r.default.spriteFrameRes(i.img+"anim2"):1==e&&r.default.spriteFrameRes(i.img+"anim1")?this.helmetSprite.spriteFrame=r.default.spriteFrameRes(i.img+"anim1"):this.helmetSprite.spriteFrame=r.default.spriteFrameRes(i.img+"anim0"),0==e&&r.default.spriteFrameRes(o.img+"anim2")?this.clothesSprite.spriteFrame=r.default.spriteFrameRes(o.img+"anim2"):1==e&&r.default.spriteFrameRes(o.img+"anim1")?this.clothesSprite.spriteFrame=r.default.spriteFrameRes(o.img+"anim1"):this.clothesSprite.spriteFrame=r.default.spriteFrameRes(o.img+"anim0")},e.prototype.playDie=function(){this.anim.play("AvatarDie")},e.prototype.playIdle=function(){this.anim.play("AvatarIdle")},e.prototype.changeAvatarByDir=function(t){var e=this.data.eyesResName,o=this.data.faceResName;switch(t){case i.DIR_UP:this.idlehair=[2,3],this.eyesSprite.spriteFrame=null,this.faceSprite.spriteFrame=null;break;case i.DIR_DOWN:this.idlehair=[0,1],this.eyesSprite.spriteFrame=r.default.spriteFrameRes(e),this.faceSprite.spriteFrame=r.default.spriteFrameRes(o);break;case i.DIR_LEFT:case i.DIR_RIGHT:this.idlehair=[4,5],this.eyesSprite.spriteFrame=r.default.spriteFrameRes("side"+e),this.faceSprite.spriteFrame=r.default.spriteFrameRes("side"+o)}this.hairSprite.spriteFrame=r.default.spriteFrameRes(this.data.hairResName+this.idlehair[0]),4!=t&&(this.cloakSprite.node.zIndex=0==t?this.avatarNode.zIndex+1:this.avatarNode.zIndex-1,this.handRightSprite.node.zIndex=0==t?this.bodySprite.node.zIndex-1:this.bodySprite.node.zIndex+1)},e.prototype.playWalk=function(t){this.anim.play(t==i.DIR_UP||t==i.DIR_DOWN?"AvatarWalkVertical":"AvatarWalkHorizontal")},e.prototype.playAttack=function(t){var e=this;this.anim.play(t==i.DIR_UP||t==i.DIR_DOWN?"AvatarAttackVertical":"AvatarAttackHorizontal");var o=0,a=0;switch(t){case i.DIR_UP:a=-16;break;case i.DIR_DOWN:a=16;break;case i.DIR_LEFT:case i.DIR_RIGHT:o=-16}cc.tween(this.spriteNode).stop(),cc.tween(this.spriteNode).to(.1,{position:cc.v3(o,a)}).to(.1,{position:cc.v3(-o,-a)}).to(.1,{position:cc.v3(0,0)}).delay(.1).call(function(){e.playAnim(i.STATE_IDLE,t)}).start()},e.prototype.start=function(){},e.DIR_UP=0,e.DIR_DOWN=1,e.DIR_LEFT=2,e.DIR_RIGHT=3,e.STATE_IDLE=0,e.STATE_WALK=1,e.STATE_ATTACK=2,e.STATE_FALL=3,e.STATE_DIE=4,e.STATE_JUMP=5,i=n([c],e)}(cc.Component));i.default=h,cc._RF.pop()},{"./Logic":"Logic","./Manager/InventoryManager":"InventoryManager"}],PlayerData:[function(t,e,i){"use strict";cc._RF.push(e,"802a53ZqslNorozVvKYFivM","PlayerData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./EquipmentData"),a=t("./DamageData"),n=t("./StatusData"),r=t("./CommonData"),s=t("../Utils/Random"),l=t("./AvatarData"),c=t("../Shield"),h=t("./OilGoldData"),p=t("./TalentData"),u=function(){function t(){this.name="",this.pos=cc.v3(5,5),this.currentHealth=t.DEFAULT_HEALTH,this.currentDream=t.DEFAULT_DREAM,this.equipmentTotalData=new o.default,this.statusTotalData=new n.default,this.avatarData=new l.default,this.oilGoldData=new h.default,this.organizationTalentData=new p.default,this.professionTalentData=new p.default,this.statusList=new Array,this.common=new r.default,this.common.maxHealth=t.DEFAULT_HEALTH,this.common.moveSpeed=t.DEFAULT_SPEED,this.common.damageMin=t.DEFAULT_ATTACK,this.common.damageBack=t.DEFAULT_BACK_ATTACK,this.common.maxDream=t.DEFAULT_DREAM}return Object.defineProperty(t.prototype,"StatusList",{get:function(){return this.statusList},set:function(t){if(t){this.statusList=new Array;for(var e=0,i=t;e<i.length;e++){var o=i[e],a=new n.default;a.valueCopy(o),this.statusList.push(a)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"EquipmentTotalData",{get:function(){return this.equipmentTotalData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"StatusTotalData",{get:function(){return this.statusTotalData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"AvatarData",{get:function(){return this.avatarData},set:function(t){this.avatarData=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OilGoldData",{get:function(){return this.oilGoldData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OrganizationTalentData",{get:function(){return this.organizationTalentData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ProfessionTalentData",{get:function(){return this.professionTalentData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"FinalCommon",{get:function(){return(new r.default).add(this.common).add(this.statusTotalData.Common).add(this.equipmentTotalData.Common).add(this.avatarData.professionData.Common).add(this.oilGoldData.Common)},enumerable:!1,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.pos=t.pos?cc.v3(t.pos.x,t.pos.y):cc.v3(4,7),this.name=t.name?t.name:"",this.equipmentTotalData.valueCopy(t.equipmentTotalData),this.statusTotalData.valueCopy(t.statusTotalData),this.avatarData.valueCopy(t.avatarData),this.oilGoldData.valueCopy(t.oilGoldData),this.StatusList=t.statusList,this.currentHealth=t.currentHealth?t.currentHealth:0,this.currentDream=t.currentDream?t.currentDream:0,this.common.maxHealth=t.common.maxHealth?t.common.maxHealth:0,this.common.moveSpeed=t.common.moveSpeed?t.common.moveSpeed:0},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.pos=this.pos,e.name=this.name,e.currentHealth=this.currentHealth,e.currentDream=this.currentDream,e.equipmentTotalData=this.equipmentTotalData.clone(),e.statusTotalData=this.statusTotalData.clone(),e.avatarData=this.avatarData.clone(),e.oilGoldData=this.oilGoldData.clone(),e.organizationTalentData=this.organizationTalentData.clone(),e.professionTalentData=this.professionTalentData.clone(),e.StatusList=this.statusList,e},t.prototype.getFinalAttackPoint=function(){var t=this.FinalCommon,e=new a.default,i=t.damageMin,o=t.damageMax,n=t.criticalStrikeRate/100,r=s.default.rand()<n,c=r?i+o:i;return c<0&&(c=0),e.isCriticalStrike=r,e.physicalDamage=c,e.realDamage=t.realDamage,e.magicDamage=t.magicDamage,this.avatarData.organizationIndex==l.default.TECH&&(e.physicalDamage+=.5*this.currentDream),e},t.prototype.getFinalRemoteDamage=function(){var t=this.FinalCommon,e=new a.default,i=t.remoteDamage;this.avatarData.organizationIndex==l.default.HUNTER&&(i+=.5*this.currentDream);var o=t.remoteCritRate/100,n=s.default.rand()<o,r=n?i+i:i;return r<0&&(r=0),e.physicalDamage=r,e.isCriticalStrike=n,e},t.prototype.getDamage=function(t,e){var i=this.FinalCommon,o=t.clone(),a=i.defence,n=i.magicDefence/100,r=i.blockPhysical/100,s=i.blockMagic/100;return o.physicalDamage=a>=0?o.physicalDamage*(1-.06*a/(.06*a+1)):o.physicalDamage*(2-Math.pow(.94,-a)),o.magicDamage=o.magicDamage*(1-n),(o.physicalDamage>0||o.magicDamage>0)&&(e==c.default.BLOCK_NORMAL?(o.physicalDamage=o.physicalDamage*(1-r),o.magicDamage=o.magicDamage*(1-s)):e==c.default.BLOCK_PARRY&&(o.physicalDamage=0,o.magicDamage=0,o.realDamage=0)),o},t.prototype.getLifeDrain=function(){var t=this.FinalCommon,e=t.criticalStrikeRate/100,i=t.lifeDrain/100,o=0;return s.default.rand()<i&&(o=.2,s.default.rand()<e&&(o=1)),o},t.prototype.getMoveSpeed=function(){var e=this.FinalCommon.moveSpeed;return e>2*t.DEFAULT_SPEED&&(e=2*t.DEFAULT_SPEED),e<2*-t.DEFAULT_SPEED&&(e=2*-t.DEFAULT_SPEED),e},t.prototype.getHealth=function(){var t=1,e=this.FinalCommon.maxHealth;return e>0?(t=this.currentHealth/e,cc.v3(e*t,e)):cc.v3(1,1)},t.prototype.getDream=function(){var t=1,e=this.FinalCommon.maxDream;return e>0?(t=this.currentDream/e,cc.v3(e*t,e)):cc.v3(1,1)},t.DEFAULT_HEALTH=10,t.DEFAULT_SPEED=300,t.DEFAULT_ATTACK=1,t.DEFAULT_BACK_ATTACK=0,t.DEFAULT_DREAM=5,t}();i.default=u,cc._RF.pop()},{"../Shield":"Shield","../Utils/Random":"Random","./AvatarData":"AvatarData","./CommonData":"CommonData","./DamageData":"DamageData","./EquipmentData":"EquipmentData","./OilGoldData":"OilGoldData","./StatusData":"StatusData","./TalentData":"TalentData"}],PlayerInfoDialog:[function(t,e,i){"use strict";cc._RF.push(e,"15316LuMnlLl6y6PlDqoReo","PlayerInfoDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/AvatarData"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attack=null,e.organization=null,e.criticalStrikeRate=null,e.defence=null,e.lifeDrain=null,e.damageBack=null,e.moveSpeed=null,e.attackSpeed=null,e.dodge=null,e.health=null,e.dream=null,e.realDamage=null,e.realRate=null,e.magicDamage=null,e.magicDefence=null,e.iceRate=null,e.fireRate=null,e.lighteningRate=null,e.toxicRate=null,e.curseRate=null,e.remoteDamage=null,e.remoteCritRate=null,e.remoteCooldown=null,e.isShow=!1,e.layout=null,e}return a(e,t),e.prototype.onLoad=function(){this.attack=this.node.getChildByName("layout").getChildByName("attack").getChildByName("label").getComponent(cc.Label),this.organization=this.node.getChildByName("layout").getChildByName("organization").getChildByName("label").getComponent(cc.Label),this.criticalStrikeRate=this.node.getChildByName("layout").getChildByName("criticalStrikeRate").getChildByName("label").getComponent(cc.Label),this.defence=this.node.getChildByName("layout").getChildByName("defence").getChildByName("label").getComponent(cc.Label),this.lifeDrain=this.node.getChildByName("layout").getChildByName("lifeDrain").getChildByName("label").getComponent(cc.Label),this.damageBack=this.node.getChildByName("layout").getChildByName("damageBack").getChildByName("label").getComponent(cc.Label),this.moveSpeed=this.node.getChildByName("layout").getChildByName("moveSpeed").getChildByName("label").getComponent(cc.Label),this.attackSpeed=this.node.getChildByName("layout").getChildByName("attackSpeed").getChildByName("label").getComponent(cc.Label),this.dodge=this.node.getChildByName("layout").getChildByName("dodge").getChildByName("label").getComponent(cc.Label),this.health=this.node.getChildByName("layout").getChildByName("health").getChildByName("label").getComponent(cc.Label),this.dream=this.node.getChildByName("layout").getChildByName("dream").getChildByName("label").getComponent(cc.Label),this.realDamage=this.node.getChildByName("layout").getChildByName("realDamage").getChildByName("label").getComponent(cc.Label),this.realRate=this.node.getChildByName("layout").getChildByName("realRate").getChildByName("label").getComponent(cc.Label),this.magicDamage=this.node.getChildByName("layout").getChildByName("magicDamage").getChildByName("label").getComponent(cc.Label),this.magicDefence=this.node.getChildByName("layout").getChildByName("magicDefence").getChildByName("label").getComponent(cc.Label),this.iceRate=this.node.getChildByName("layout").getChildByName("iceRate").getChildByName("label").getComponent(cc.Label),this.fireRate=this.node.getChildByName("layout").getChildByName("fireRate").getChildByName("label").getComponent(cc.Label),this.lighteningRate=this.node.getChildByName("layout").getChildByName("lighteningRate").getChildByName("label").getComponent(cc.Label),this.toxicRate=this.node.getChildByName("layout").getChildByName("toxicRate").getChildByName("label").getComponent(cc.Label),this.curseRate=this.node.getChildByName("layout").getChildByName("curseRate").getChildByName("label").getComponent(cc.Label),this.remoteCooldown=this.node.getChildByName("layout").getChildByName("remoteCooldown").getChildByName("label").getComponent(cc.Label),this.remoteCritRate=this.node.getChildByName("layout").getChildByName("remoteCritRate").getChildByName("label").getComponent(cc.Label),this.remoteDamage=this.node.getChildByName("layout").getChildByName("remoteDamage").getChildByName("label").getComponent(cc.Label),this.layout=this.node.getChildByName("layout"),this.addSpriteTouchEvent()},e.prototype.start=function(){},e.prototype.refreshDialog=function(t,e,i){if(this.attack){var o=t.Common.clone().add(t.AvatarData.professionData.Common);this.organization.string=r.default.ORGANIZATION[t.AvatarData.organizationIndex],this.attack.string=this.getInfo(o.damageMin,e.Common.damageMin,i.Common.damageMin)+"    MAX:"+this.getInfo(o.damageMax,e.Common.damageMax,i.Common.damageMax),this.criticalStrikeRate.string=this.getInfo(o.criticalStrikeRate,e.Common.criticalStrikeRate,i.Common.criticalStrikeRate,!0),this.defence.string=this.getInfo(o.defence,e.Common.defence,i.Common.defence),this.lifeDrain.string=this.getInfo(o.lifeDrain,e.Common.lifeDrain,i.Common.lifeDrain,!0),this.damageBack.string=this.getInfo(o.damageBack,e.Common.damageBack,i.Common.damageBack),this.moveSpeed.string=this.getInfo(o.moveSpeed,e.Common.moveSpeed,i.Common.moveSpeed),this.attackSpeed.string=this.getInfo(o.attackSpeed,e.Common.attackSpeed,i.Common.attackSpeed,!0),this.dodge.string=this.getInfo(o.dodge,e.Common.dodge,i.Common.dodge,!0),this.health.string=t.currentHealth.toFixed(1).replace(".0","")+"/"+this.getInfo(o.maxHealth,e.Common.maxHealth,i.Common.maxHealth),this.dream.string=t.currentDream.toFixed(1).replace(".0","")+"/"+this.getInfo(o.maxDream,e.Common.maxDream,i.Common.maxDream),this.realDamage.string=this.getInfo(o.realDamage,e.Common.realDamage,i.Common.realDamage),this.realRate.string=this.getInfo(o.realRate,e.Common.realRate,i.Common.realRate,!0),this.magicDamage.string=this.getInfo(o.magicDamage,e.Common.magicDamage,i.Common.magicDamage),this.magicDefence.string=this.getInfo(o.magicDefence,e.Common.magicDefence,i.Common.magicDefence,!0),this.iceRate.string=this.getInfo(o.iceRate,e.Common.iceRate,i.Common.iceRate,!0),this.fireRate.string=this.getInfo(o.fireRate,e.Common.fireRate,i.Common.fireRate,!0),this.lighteningRate.string=this.getInfo(o.lighteningRate,e.Common.lighteningRate,i.Common.lighteningRate,!0),this.toxicRate.string=this.getInfo(o.toxicRate,e.Common.toxicRate,i.Common.toxicRate,!0),this.curseRate.string=this.getInfo(o.curseRate,e.Common.curseRate,i.Common.curseRate,!0),this.remoteCritRate.string=this.getInfo(o.remoteCritRate,e.Common.remoteCritRate,i.Common.remoteCritRate,!0),this.remoteDamage.string=this.getInfo(o.remoteDamage,e.Common.remoteDamage,i.Common.remoteDamage),this.remoteCooldown.string=this.getInfo(o.remoteCooldown,e.Common.remoteCooldown,i.Common.remoteCooldown)}},e.prototype.getInfo=function(t,e,i,o){var a=""+(t+e+i).toFixed(1).replace(".0","");return o&&(a+="%"),e>0?(a+=" E:+"+e.toFixed(1).replace(".0",""),o&&(a+="%")):e<0&&(a+=" E:"+e.toFixed(1).replace(".0",""),o&&(a+="%")),i>0?(a+=" S:+"+i.toFixed(1).replace(".0",""),o&&(a+="%")):i<0&&(a+=" S:"+i.toFixed(1).replace(".0",""),o&&(a+="%")),a},e.prototype.addSpriteTouchEvent=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){t.isShow=!0}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.isShow=!1}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.isShow=!1})},e.prototype.update=function(){this.layout.active=this.isShow},n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"../Data/AvatarData":"AvatarData"}],PlayerWeapon:[function(t,e,i){"use strict";cc._RF.push(e,"e3affyq+pdEIqRjlXOazN5E","PlayerWeapon");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./MeleeWeapon"),s=t("./Shooter"),l=t("./Manager/InventoryManager"),c=t("./PlayerAvatar"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.meleeWeapon=null,e.shooter=null,e.isLeftHand=!1,e.isHeavyRemotoAttacking=!1,e.remoteIntervalTime=0,e}return a(e,t),e.prototype.init=function(t,e){this.isLeftHand=e,this.player=t,this.initMelee(),this.initShooter()},e.prototype.initMelee=function(){this.meleeWeapon=this.getComponentInChildren(r.default),this.meleeWeapon.IsSecond=this.isLeftHand},e.prototype.initShooter=function(){this.shooter=this.getComponentInChildren(s.default),this.shooter.player=this.player,this.shooter.parentNode=this.player.node},e.prototype.changeZIndexByDir=function(t,e){switch(e){case c.default.DIR_UP:this.node.zIndex=t-1;break;case c.default.DIR_DOWN:this.node.zIndex=t+1;break;case c.default.DIR_LEFT:case c.default.DIR_RIGHT:this.node.zIndex=this.isLeftHand?t-1:t+1}},e.prototype.changeWeapon=function(t,e,i){switch(t.equipmetType){case l.default.WEAPON:this.meleeWeapon.changeEquipment(t,e,i);break;case l.default.REMOTE:this.shooter.data=t.clone(),this.shooter.changeRes(this.shooter.data.img);var o=cc.color(255,255,255).fromHEX(this.shooter.data.color);this.shooter.changeResColor(o)}},e.prototype.meleeAttack=function(t,e,i){this.meleeWeapon&&!this.meleeWeapon.IsAttacking&&this.meleeWeapon.attack(t,e,i)},e.prototype.remoteAttack=function(t,e,i,o){var a=this,n=!1,r=t.FinalCommon.remoteCooldown;r<100&&(r=100);var s=Date.now();return s-this.remoteIntervalTime>r&&(this.remoteIntervalTime=s,n=!0),!!n&&(this.isHeavyRemotoAttacking=1==this.shooter.data.isHeavy,this.scheduleOnce(function(){a.isHeavyRemotoAttacking=!1},.2),this.shooter&&(this.shooter.remoteDamagePlayer=t.getFinalRemoteDamage(),this.shooter.fireBullet(0,null,i,o)),e&&r>500&&(e.width=80,e.stopAllActions(),cc.tween(e).to(r/1e3,{width:0}).start()),!0)},e.prototype.updateLogic=function(t){this.meleeWeapon&&this.meleeWeapon.updateLogic(t)},n([p],e)}(cc.Component));i.default=u,cc._RF.pop()},{"./Manager/InventoryManager":"InventoryManager","./MeleeWeapon":"MeleeWeapon","./PlayerAvatar":"PlayerAvatar","./Shooter":"Shooter"}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"03570PUzDdNyIu4Asd1jFZT","Player");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=t("./Shooter"),h=t("./Logic"),p=t("./Dungeon"),u=t("./Equipment/Equipment"),d=t("./Data/EquipmentData"),f=t("./MeleeWeapon"),g=t("./Manager/StatusManager"),y=t("./Data/DamageData"),m=t("./Manager/InventoryManager"),v=t("./Manager/FloatingLabelManager"),E=t("./UI/Tips"),_=t("./Utils/Random"),D=t("./Shield"),S=t("./Base/Actor"),R=t("./Talent/Talent"),T=t("./Utils/AudioPlayer"),O=t("./Data/FromData"),C=t("./Achievement"),A=t("./Item/Item"),L=t("./Utils/IndexZ"),P=t("./PlayerAvatar"),b=t("./PlayerWeapon"),I=t("./EventHelper"),M=t("./Effect/ShadowOfSight"),N=t("./Manager/LightManager"),x=t("./Data/AvatarData"),H=t("./Actor/ColliderTag"),B=t("./Talent/ProfessionTalent"),w=t("./Talent/OrganizationTalent"),k=t("./Data/TalentData"),F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.floatinglabelManager=null,e.pos=null,e.walksmoke=null,e.smokePool=null,e.weaponLeft=null,e.weaponRight=null,e.shooterEx=null,e.statusManager=null,e.avatar=null,e.shield=null,e.remoteCooldown=null,e.isStone=!1,e.baseAttackPoint=1,e.touchDelay=!1,e.currentDir=3,e.defaultPos=cc.v3(0,0),e.isWeaponDashing=!1,e.fistCombo=0,e.smokeTimeDelay=0,e.dreamTimeDelay=0,e.dreamLongTimeDelay=0,e.dreamShortTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.inventoryManager=h.default.inventoryManager,this.data=h.default.playerData.clone(),this.updateStatus(this.data.StatusList,this.data.StatusTotalData),this.pos=cc.v3(0,0),this.sc.isDied=!1,this.isStone=!1,this.sc.isShow=!1,this.scheduleOnce(function(){t.sc.isShow=!0,t.addSaveStatusList()},.5),this.rigidbody=this.getComponent(cc.RigidBody),this.initTalent(),this.weaponLeft.init(this,!0),this.weaponRight.init(this,!1),this.remoteCooldown.width=0,this.remoteCooldown.opacity=200,cc.director.on(I.EventHelper.PLAYER_TRIGGER,function(e){t.node&&t.triggerThings(e&&e.detail&&e.detail.isLongPress)}),cc.director.on(I.EventHelper.PLAYER_EXIT_FROM_SETTINGS,function(){cc.director.loadScene("start")}),cc.director.on(I.EventHelper.PLAYER_USEITEM,function(e){t.node&&t.useItem(e.detail.itemData)}),cc.director.on(I.EventHelper.PLAYER_SKILL,function(){t.node&&t.useSkill()}),cc.director.on(I.EventHelper.PLAYER_SKILL1,function(){t.node&&t.useSkill1()}),cc.director.on(I.EventHelper.PLAYER_UPDATE_OILGOLD_DATA,function(){t.node&&t.data.OilGoldData.valueCopy(h.default.playerData.OilGoldData)}),cc.director.on(I.EventHelper.PLAYER_ATTACK,function(){t.useInteractBuilding(!0)||t.node&&t.meleeAttack()}),cc.director.on(I.EventHelper.PLAYER_REMOTEATTACK_CANCEL,function(){t.shield&&t.shield.data.equipmetType==m.default.SHIELD&&t.shield.cancel()}),cc.director.on(I.EventHelper.PLAYER_REMOTEATTACK,function(){t.useInteractBuilding(!1)||(t.shield&&t.shield.data.equipmetType==m.default.SHIELD?t.shield.use():t.node&&t.remoteAttack())}),cc.director.on(I.EventHelper.PLAYER_USEDREAM,function(e){t.node&&t.data.AvatarData.organizationIndex==x.default.HUNTER&&t.updateDream(e.detail.value)}),h.default.playerData.pos.y==p.default.HEIGHT_SIZE-1&&(h.default.playerData.pos.y=p.default.HEIGHT_SIZE-2),this.pos=h.default.playerData.pos.clone(),this.defaultPos=h.default.playerData.pos.clone(),this.baseAttackPoint=h.default.playerData.FinalCommon.damageMin,this.updatePlayerPos(),cc.director.emit(I.EventHelper.CAMERA_LOOK),this.shooterEx.player=this,this.shooterEx.isEx=!0,this.smokePool=new cc.NodePool,cc.director.on(I.EventHelper.POOL_DESTORY_WALKSMOKE,function(e){t.destroySmoke(e.detail.coinNode)}),this.playerAnim(P.default.STATE_IDLE,this.currentDir),h.default.isCheatMode&&this.scheduleOnce(function(){t.addStatus(g.default.PERFECTDEFENCE,new O.default),t.data.Common.damageMin=99,t.data.Common.moveSpeed=999},.2),this.lights=this.getComponentsInChildren(M.default),N.default.registerLight(this.lights),this.lights[0].rayRadius=0,h.default.chapterIndex==h.default.CHAPTER099&&(this.lights[0].rayRadius=0)},e.prototype.addSaveStatusList=function(){this.statusManager&&this.statusManager.addStatusListFromSave(this.data.StatusList)},e.prototype.initTalent=function(){var t=this,e=new k.default,i=new k.default;e.valueCopy(h.default.talents["talent10"+this.data.AvatarData.organizationIndex]),i.valueCopy(h.default.talents[this.data.AvatarData.professionData.talent]),e.resName==this.data.OrganizationTalentData.resName&&e.valueCopy(this.data.OrganizationTalentData),i.resName==this.data.ProfessionTalentData.resName&&i.valueCopy(this.data.ProfessionTalentData),this.data.OrganizationTalentData.valueCopy(e),this.data.ProfessionTalentData.valueCopy(i),this.professionTalent=this.getComponent(B.default),this.organizationTalent=this.getComponent(w.default),this.scheduleOnce(function(){t.professionTalent.init(t.data.ProfessionTalentData),t.organizationTalent.init(t.data.OrganizationTalentData)},.1)},e.prototype.actorName=function(){return"Player"},e.prototype.turnStone=function(t){this.avatar.hitLight(t)},e.prototype.updateCombo=function(){this.weaponRight.meleeWeapon.IsFist?(this.fistCombo==f.default.COMBO1?this.fistCombo=f.default.COMBO2:this.fistCombo==f.default.COMBO2?this.fistCombo=f.default.COMBO3:(this.fistCombo,f.default.COMBO3,this.fistCombo=f.default.COMBO1),this.weaponLeft.meleeWeapon.IsComboing||this.weaponRight.meleeWeapon.IsComboing||(this.fistCombo=f.default.COMBO1)):this.fistCombo=f.default.COMBO1},e.prototype.takeDizz=function(t){var e=this;t>0&&!this.sc.isJumping&&(this.sc.isDizzing=!0,this.rigidbody.linearVelocity=cc.Vec2.ZERO,this.playerAnim(P.default.STATE_IDLE,this.currentDir),this.scheduleOnce(function(){e.sc.isDizzing=!1},t))},e.prototype.hideSelf=function(t){var e=this;t>0&&(this.invisible=!0,this.scheduleOnce(function(){e.stopHiding()},t))},e.prototype.stopHiding=function(){this.invisible=!1,this.statusManager.stopStatus(g.default.TALENT_INVISIBLE)},e.prototype.updateStatus=function(t,e){this.inventoryManager&&(this.data.StatusTotalData.valueCopy(e),this.data.StatusList=t,this.updateInfoUi())},e.prototype.getWalkSmoke=function(t,e){var i=null;this.smokePool.size()>0&&(i=this.smokePool.get()),i&&!i.active||(i=cc.instantiate(this.walksmoke)),i.parent=t,i.position=e,i.zIndex=L.default.ACTOR,i.opacity=255,i.active=!0},e.prototype.destroySmoke=function(t){t&&(t.active=!1,this.smokePool&&this.smokePool.put(t))},e.prototype.changeEquipment=function(t,e){var i=this.inventoryManager.equips[t.equipmetType];switch(t.equipmetType){case m.default.WEAPON:this.weaponRight.meleeWeapon.changeEquipment(t,e,this.inventoryManager);break;case m.default.REMOTE:this.weaponLeft.shooter.data=t.clone(),this.weaponLeft.shooter.changeRes(this.weaponLeft.shooter.data.img);var o=cc.color(255,255,255).fromHEX(this.weaponLeft.shooter.data.color);this.weaponLeft.shooter.changeResColor(o),this.shield.data=new d.default,this.updateEquipment(this.shield.sprite,this.inventoryManager.equips[m.default.SHIELD].color,h.default.spriteFrameRes(m.default.EMPTY),1==this.shield.data.isHeavy?80:64),I.EventHelper.emit(I.EventHelper.HUD_CHANGE_CONTROLLER_SHIELD,{isShield:!1});break;case m.default.SHIELD:this.shield.data=t.clone(),this.shield.node.color=cc.Color.WHITE.fromHEX(i.color),this.updateEquipment(this.shield.sprite,i.color,e,1==this.shield.data.isHeavy?80:64),this.weaponLeft.shooter.data=new d.default,this.weaponLeft.shooter.changeRes(this.weaponLeft.shooter.data.img),I.EventHelper.emit(I.EventHelper.HUD_CHANGE_CONTROLLER_SHIELD,{isShield:!0});break;case m.default.HELMET:this.avatar.hairSprite.node.opacity=1==i.hideHair?0:255,this.updateEquipment(this.avatar.helmetSprite,i.color,e);break;case m.default.CLOTHES:this.updateEquipment(this.avatar.clothesSprite,i.color,e);break;case m.default.TROUSERS:var a=1==i.trouserslong;this.avatar.changeLegColor(a,i.color),this.updateEquipment(this.avatar.pantsSprite,i.color,e);break;case m.default.GLOVES:this.updateEquipment(this.weaponRight.meleeWeapon.GlovesSprite,i.color,e),this.updateEquipment(this.weaponLeft.meleeWeapon.GlovesSprite,i.color,e),this.updateEquipment(this.avatar.glovesLeftSprite,i.color,e),this.updateEquipment(this.avatar.glovesRightSprite,i.color,e);break;case m.default.SHOES:this.updateEquipment(this.avatar.shoesLeftSprite,i.color,e),this.updateEquipment(this.avatar.shoesRightSprite,i.color,e);break;case m.default.CLOAK:this.updateEquipment(this.avatar.cloakSprite,i.color,e)}this.avatar.changeEquipDirSpriteFrame(this.inventoryManager,this.currentDir),this.shield.changeZIndexByDir(this.avatar.node.zIndex,this.currentDir),this.updateInfoUi()},e.prototype.updateEquipment=function(t,e,i,o){t.spriteFrame=i,o&&o>0&&(t.node.width=o,t.node.height=o);var a=cc.color(255,255,255).fromHEX(e);t.node.color=a},e.prototype.updateInfoUi=function(){var t=this.data.getHealth(),e=this.data.getDream();I.EventHelper.emit(I.EventHelper.HUD_UPDATE_PLAYER_HEALTHBAR,{x:t.x,y:t.y}),I.EventHelper.emit(I.EventHelper.HUD_UPDATE_PLAYER_DREAMBAR,{x:e.x,y:e.y}),this.data.EquipmentTotalData.valueCopy(this.inventoryManager.getTotalEquipData()),cc.director.emit(I.EventHelper.HUD_UPDATE_PLAYER_INFODIALOG,{detail:{data:this.data}})},e.prototype.getCenterPosition=function(){return this.node.position.clone().addSelf(cc.v3(0,32*this.node.scaleY))},e.prototype.updatePlayerPos=function(){this.node.position=p.default.getPosInMap(this.pos)},e.prototype.transportPlayer=function(t){this.avatar.spriteNode&&(this.avatar.spriteNode.angle=0,this.avatar.spriteNode.scale=5,this.avatar.spriteNode.opacity=255,this.avatar.spriteNode.x=0,this.avatar.spriteNode.y=0,this.pos=t,this.changeZIndex(this.pos),this.updatePlayerPos())},e.prototype.changeZIndex=function(){this.node.zIndex=L.default.getActorZIndex(this.node.position)},e.prototype.addStatus=function(t,e){this.node&&!this.sc.isDied&&this.statusManager.addStatus(t,e)},e.prototype.addCustomStatus=function(t,e){this.node&&!this.sc.isDied&&this.statusManager.addCustomStatus(t,e)},Object.defineProperty(e.prototype,"IsVariation",{get:function(){return this.data.StatusTotalData.variation>0},enumerable:!1,configurable:!0}),e.prototype.stopAllDebuffs=function(){this.node&&this.statusManager.stopAllDebuffs()},Object.defineProperty(e.prototype,"isInteractBuildingAniming",{get:function(){return this.interactBuilding&&this.interactBuilding.isTaken&&this.interactBuilding.isAniming},enumerable:!1,configurable:!0}),e.prototype.meleeAttack=function(){var t=this;if(!(!this.weaponRight||this.sc.isDizzing||this.sc.isDied||this.sc.isFalling||this.sc.isJumping||this.weaponRight.meleeWeapon.IsAttacking||this.weaponLeft.meleeWeapon.IsAttacking||this.isInteractBuildingAniming||this.shield.isDefendOrParrying)){var e=this.weaponRight.meleeWeapon.Hv.clone();this.shield.isAniming||(this.isFaceRight=e.x>0),this.isFaceUp=e.y>0;var i=h.default.getRandomNum(0,100)<this.data.StatusTotalData.missRate;i&&this.showFloatFont(this.node.parent,0,!1,!0,!1),this.updateCombo(),this.fistCombo==f.default.COMBO1?(this.weaponRight.meleeWeapon.attack(this.data,i,this.fistCombo),this.weaponLeft.meleeWeapon.attackIdle(!1)):this.fistCombo==f.default.COMBO2?(this.weaponRight.meleeWeapon.attackIdle(!0),this.weaponLeft.meleeWeapon.attack(this.data,i,this.fistCombo)):this.fistCombo==f.default.COMBO3&&(this.weaponRight.meleeWeapon.attack(this.data,i,this.fistCombo),this.weaponRight.meleeWeapon.DashTime(400),this.scheduleOnce(function(){t.weaponLeft.meleeWeapon.attack(t.data,i,t.fistCombo)},.15)),this.playerAnim(P.default.STATE_ATTACK,this.currentDir),this.stopHiding()}},e.prototype.useShield=function(){!this.weaponRight||this.sc.isDizzing||this.sc.isDied||this.sc.isFalling||this.sc.isJumping||this.weaponRight.meleeWeapon.IsAttacking||this.weaponLeft.meleeWeapon.IsAttacking||this.isInteractBuildingAniming||this.shield.Status!=D.default.STATUS_PARRY&&(this.shield.Status,D.default.STATUS_PUTDOWN)},e.prototype.useInteractBuilding=function(t){return!!this.interactBuilding&&!!this.interactBuilding.isTaken&&(!!this.interactBuilding.isAniming||(this.stopHiding(),this.playerAnim(P.default.STATE_ATTACK,this.currentDir),this.interactBuilding.interact(this,!1,t,!t)))},e.prototype.remoteAttack=function(){if(this.data&&!this.sc.isDizzing&&!this.sc.isDied&&!this.sc.isFalling&&this.weaponLeft.shooter&&!this.sc.isJumping){var t=0,e=0;this.professionTalent.hashTalent(R.default.TALENT_005)&&this.professionTalent.IsExcuting&&(t=2,e=1),this.weaponLeft.shooter.data.bulletSize=this.IsVariation?.5:0,this.weaponLeft.remoteAttack(this.data,this.remoteCooldown,t,e)&&this.stopHiding()}},e.prototype.remoteExAttack=function(t){for(var e in this.inventoryManager.equips){var i=this.inventoryManager.equips[e];this.remoteExAttackDo(i,t)}for(var e in this.inventoryManager.suitMap){var o=this.inventoryManager.suitMap[e];if(o)for(var a=0;a<o.count-1;a++)a<o.EquipList.length&&this.remoteExAttackDo(o.EquipList[a],t)}},e.prototype.remoteExAttackDo=function(t,e){var i=!1;e==f.default.COMBO1&&t.exBulletCombo1>0&&(i=!0),e==f.default.COMBO2&&t.exBulletCombo2>0&&(i=!0),e==f.default.COMBO3&&t.exBulletCombo3>0&&(i=!0),i&&t.exBulletTypeAttack.length>0&&_.default.getRandomNum(0,100)<t.exBulletRate&&(this.shooterEx.data.bulletType=t.exBulletTypeAttack,this.shooterEx.data.bulletArcExNum=t.bulletArcExNum,this.shooterEx.data.bulletLineExNum=t.bulletLineExNum,this.shooterEx.data.bulletSize=t.bulletSize,this.shooterEx.data.bulletSize+=this.IsVariation?.5:0,this.shooterEx.fireBullet(0,cc.v3(t.exBulletOffsetX,24)))},e.prototype.remoteOrStatusExHurt=function(t,e,i){for(var o in this.inventoryManager.equips){var a=this.inventoryManager.equips[o];this.remoteOrStatusExHurtDo(a,t,e,i)}for(var o in this.inventoryManager.suitMap){var n=this.inventoryManager.suitMap[o];if(n)for(var r=0;r<n.count-1;r++)r<n.EquipList.length&&this.remoteOrStatusExHurtDo(n.EquipList[r],t,e,i)}},e.prototype.remoteOrStatusExHurtDo=function(t,e,i,o){var a=!1;t.exBulletTypeHurt.length>0&&_.default.getRandomNum(0,100)<t.exBulletRate&&(a=!0,this.shooterEx.data.bulletType=t.exBulletTypeHurt),e==D.default.BLOCK_PARRY&&t.exBulletTypeParry.length>0&&_.default.getRandomNum(0,100)<t.exBulletRate&&(a=!0,this.shooterEx.data.bulletType=t.exBulletTypeParry),e==D.default.BLOCK_NORMAL&&t.exBulletTypeBlock.length>0&&_.default.getRandomNum(0,100)<t.exBulletRate&&(a=!0,this.shooterEx.data.bulletType=t.exBulletTypeBlock),a&&(this.shooterEx.data.bulletArcExNum=t.bulletArcExNum,this.shooterEx.data.bulletLineExNum=t.bulletLineExNum,this.shooterEx.data.bulletSize=t.bulletSize,this.shooterEx.fireBullet(0)),o&&t.statusNameHurtOther.length>0&&t.statusRateHurt>h.default.getRandomNum(0,100)&&o.addStatus(t.statusNameHurtOther,new O.default),t.statusNameHurtSelf.length>0&&t.statusRateHurt>h.default.getRandomNum(0,100)&&this.addStatus(t.statusNameHurtSelf,new O.default)},e.prototype.move=function(t,e){if(!(this.sc.isDied||this.sc.isFalling||this.sc.isDizzing)&&this.sc.isShow){this.weaponRight.meleeWeapon.IsAttacking&&!e.equals(cc.Vec3.ZERO)&&(e=e.mul(this.weaponRight.meleeWeapon.getMeleeSlowRatio())),this.weaponLeft.meleeWeapon.IsAttacking&&!e.equals(cc.Vec3.ZERO)&&(e=e.mul(this.weaponLeft.meleeWeapon.getMeleeSlowRatio())),this.weaponLeft.isHeavyRemotoAttacking&&!e.equals(cc.Vec3.ZERO)&&(e=e.mul(.01)),1==this.shield.data.isHeavy&&this.shield.Status>D.default.STATUS_IDLE&&(e=e.mul(.5)),this.interactBuilding&&this.interactBuilding.isTaken&&(e=e.mul(.5)),this.professionTalent.IsExcuting&&this.professionTalent.hashTalent(R.default.TALENT_007)&&!e.equals(cc.Vec3.ZERO)&&(e=e.mul(.01)),e.equals(cc.Vec3.ZERO)||(this.pos=p.default.getIndexInMap(this.node.position),this.data.pos=this.pos.clone()),e.equals(cc.Vec3.ZERO)||(this.shooterEx.setHv(cc.v3(e.x,e.y)),this.weaponLeft.shooter.setHv(cc.v3(e.x,e.y)),this.weaponRight.shooter.setHv(cc.v3(e.x,e.y)));var i=e.x,o=e.y,a=Math.abs(i),n=Math.abs(o),r=a>n?a:n;r=0==r?1:r;var s=cc.v2(i,o),l=this.data.getMoveSpeed();l<0&&(l=0),s=s.mul(l),this.rigidbody.linearVelocity=s,this.sc.isMoving=0!=i||0!=o,!this.weaponRight.meleeWeapon||e.equals(cc.Vec3.ZERO)||this.weaponRight.meleeWeapon.IsAttacking||(this.weaponRight.meleeWeapon.Hv=cc.v3(e.x,e.y)),!this.weaponLeft.meleeWeapon||e.equals(cc.Vec3.ZERO)||this.weaponLeft.meleeWeapon.IsAttacking||(this.weaponLeft.meleeWeapon.Hv=cc.v3(e.x,e.y)),!this.sc.isMoving||this.weaponLeft.meleeWeapon.IsAttacking||this.weaponRight.meleeWeapon.IsAttacking||(this.shield.isAniming||(this.isFaceRight=this.weaponLeft.meleeWeapon.Hv.x>0),this.isFaceUp=this.weaponLeft.meleeWeapon.Hv.y>0),this.sc.isJumping||(this.sc.isMoving&&!this.isStone?this.playerAnim(P.default.STATE_WALK,t):this.playerAnim(P.default.STATE_IDLE,t)),4!=t&&this.changeZIndex(this.pos),4==t||this.shield.isAniming||(this.currentDir=t,t==P.default.DIR_DOWN&&this.isFaceUp?t=P.default.DIR_UP:t!=P.default.DIR_UP||this.isFaceUp||(t=P.default.DIR_DOWN),this.weaponLeft.changeZIndexByDir(this.avatar.node.zIndex,t),this.weaponRight.changeZIndexByDir(this.avatar.node.zIndex,t),this.avatar.changeEquipDirSpriteFrame(this.inventoryManager,t),this.shield.changeZIndexByDir(this.avatar.node.zIndex,t),this.avatar.changeAvatarByDir(t))}},e.prototype.playerAnim=function(t,e){switch(t==P.default.STATE_IDLE&&this.avatar.status!=P.default.STATE_IDLE&&(this.weaponLeft.shooter.playWalk(!1),this.weaponRight.shooter.playWalk(!1)),t){case P.default.STATE_IDLE:this.avatar.status!=P.default.STATE_IDLE&&(this.weaponLeft.shooter.playWalk(!1),this.weaponRight.shooter.playWalk(!1));break;case P.default.STATE_WALK:this.avatar.status!=P.default.STATE_ATTACK&&(this.weaponLeft.shooter.playWalk(!0),this.weaponRight.shooter.playWalk(!0));break;case P.default.STATE_ATTACK:this.weaponLeft.shooter.playWalk(!0),this.weaponRight.shooter.playWalk(!0);break;case P.default.STATE_FALL:case P.default.STATE_DIE:}this.avatar.playAnim(t,e)},e.prototype.start=function(){this.node&&(this.changeZIndex(this.pos),this.updateInfoUi())},e.prototype.fall=function(){var t=this;this.sc.isFalling||this.sc.isJumping||(this.sc.isFalling=!0,this.avatar.playAnim(P.default.STATE_FALL,this.currentDir),this.scheduleOnce(function(){t.transportPlayer(t.defaultPos),t.playerAnim(P.default.STATE_IDLE,1);var e=new y.default;e.realDamage=1,t.takeDamage(e,O.default.getClone("\u8dcc\u843d","")),t.sc.isFalling=!1},2))},e.prototype.jump=function(){var t=this;return!(this.sc.isDied||this.sc.isFalling||this.sc.isDizzing||!this.sc.isShow||this.sc.isJumping||this.weaponRight.meleeWeapon.IsAttacking||this.weaponLeft.meleeWeapon.IsAttacking||this.isInteractBuildingAniming||(this.sc.isJumping=!0,this.scheduleOnce(function(){t.weaponLeft.node.opacity=0,t.weaponRight.node.opacity=0,t.shield.node.opacity=0},.1),this.avatar.playAnim(P.default.STATE_JUMP,this.currentDir),this.scheduleOnce(function(){t.avatar.playAnim(P.default.STATE_IDLE,t.currentDir),t.sc.isJumping=!1,t.weaponLeft.node.opacity=255,t.weaponRight.node.opacity=255,t.shield.node.opacity=255},1.3),0))},e.prototype.takeDamage=function(t,e,i){if(!this.data||this.sc.isJumping||this.sc.isDied)return!1;var o=this.shield.blockDamage(this,t,i),a=this.data.getDamage(t,o),n=this.data.FinalCommon.dodge/100,r=_.default.rand()<=n&&a.getTotalDamage()>0;this.professionTalent.hashTalent(R.default.TALENT_015)&&this.professionTalent.IsExcuting&&a.getTotalDamage()>0&&(r=!0),this.organizationTalent.takeDamage(a,i)&&(a=new y.default),a=r?new y.default:a;var s=this.data.getHealth(),l=a.getTotalDamage();l>0&&this.data.AvatarData.organizationIndex==x.default.GURAD&&(l=this.updateDream(l)),(l>0&&(this.data.AvatarData.organizationIndex==x.default.HUNTER||this.data.AvatarData.organizationIndex==x.default.TECH)||this.data.AvatarData.organizationIndex==x.default.FOLLOWER)&&this.updateDream(1),s.x-=l,s.x>s.y&&(s.x=s.y),I.EventHelper.emit(I.EventHelper.HUD_UPDATE_PLAYER_HEALTHBAR,{x:s.x,y:s.y}),this.data.currentHealth=s.x,this.showFloatFont(this.node.parent,a.getTotalDamage(),r,!1,!1),this.data.currentHealth<=0&&this.killed(e);var c=!r&&a.getTotalDamage()>0&&o!=D.default.BLOCK_PARRY;return(c||o==D.default.BLOCK_PARRY)&&this.showDamageEffect(o,e,i),c},e.prototype.updateDream=function(t){var e=this.data.getDream();e.x-=t;var i=-e.x;return e.x>e.y&&(e.x=e.y),e.x<0&&(e.x=0),this.data.currentDream=e.x,I.EventHelper.emit(I.EventHelper.HUD_UPDATE_PLAYER_DREAMBAR,{x:e.x,y:e.y}),i<0?0:i},e.prototype.showDamageEffect=function(t,e,i){this.remoteOrStatusExHurt(t,e,i),cc.director.emit(I.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}}),t==D.default.BLOCK_NORMAL?(T.default.play(T.default.BOSS_ICEDEMON_HIT),cc.director.emit(I.EventHelper.HUD_DAMAGE_CORNER_SHOW)):t==D.default.BLOCK_PARRY?T.default.play(T.default.MELEE_PARRY):(T.default.play(T.default.PLAYER_HIT),cc.director.emit(I.EventHelper.HUD_DAMAGE_CORNER_SHOW))},e.prototype.showFloatFont=function(t,e,i,o,a){if(this.floatinglabelManager){var n=this.floatinglabelManager.getFloaingLabel(t);i?n.showDoge():o?n.showMiss():0!=e&&e?n.showDamage(-e,a):n.hideLabel()}},e.prototype.killed=function(t){this.sc.isDied||(this.sc.isDied=!0,this.avatar.playAnim(P.default.STATE_DIE,this.currentDir),I.EventHelper.emit(I.EventHelper.HUD_STOP_COUNTTIME),this.scheduleOnce(function(){I.EventHelper.emit(I.EventHelper.HUD_FADE_OUT)},1.5),T.default.play(T.default.DIE),I.EventHelper.emit(I.EventHelper.HUD_LOSE_OILGOLD),I.EventHelper.emit(I.EventHelper.HUD_OILGOLD_LOSE_SHOW),C.default.addPlayerDiedLifesAchievement(),this.weaponLeft.node.opacity=0,this.weaponRight.node.opacity=0,h.default.dieFrom.valueCopy(t),h.default.setKillPlayerCounts(t,!0),h.default.saveData(),this.scheduleOnce(function(){cc.audioEngine.stopMusic(),cc.director.loadScene("gameover")},3),this.weaponLeft.meleeWeapon.dungeon.darkAfterKill())},e.prototype.playerAction=function(t,e,i,o){if(this.dungeon=o,this.weaponLeft.meleeWeapon&&!this.weaponLeft.meleeWeapon.dungeon&&(this.weaponLeft.meleeWeapon.dungeon=o),this.weaponRight.meleeWeapon&&!this.weaponRight.meleeWeapon.dungeon&&(this.weaponRight.meleeWeapon.dungeon=o),this.weaponRight.shooter&&!this.weaponRight.shooter.dungeon&&(this.weaponRight.shooter.dungeon=o),this.weaponLeft.shooter&&!this.weaponLeft.shooter.dungeon&&(this.weaponLeft.shooter.dungeon=o),this.shooterEx&&!this.shooterEx.dungeon&&(this.shooterEx.dungeon=o),this.sc.isShow){var a=this.professionTalent.hashTalent(R.default.TALENT_015)&&this.professionTalent.IsExcuting;!this.professionTalent||a||this.isWeaponDashing||this.move(t,e,i)}},e.prototype.isSmokeTimeDelay=function(t){return this.smokeTimeDelay+=t,this.smokeTimeDelay>.3&&(this.smokeTimeDelay=0,!0)},e.prototype.isDreamTimeDelay=function(t){return this.dreamTimeDelay+=t,this.dreamTimeDelay>8&&(this.dreamTimeDelay=0,!0)},e.prototype.isDreamShortTimeDelay=function(t){return this.dreamShortTimeDelay+=t,this.dreamShortTimeDelay>5&&(this.dreamShortTimeDelay=0,!0)},e.prototype.isDreamLongTimeDelay=function(t){return this.dreamLongTimeDelay+=t,this.dreamLongTimeDelay>20&&(this.dreamLongTimeDelay=0,!0)},e.prototype.update=function(t){if(!h.default.isGamePause){this.isSmokeTimeDelay(t)&&this.sc.isMoving&&!this.sc.isJumping&&this.getWalkSmoke(this.node.parent,this.node.position),this.isDreamLongTimeDelay(t)&&(this.data.AvatarData.organizationIndex!=x.default.GURAD&&this.data.AvatarData.organizationIndex!=x.default.HUNTER||this.updateDream(-1)),this.isDreamTimeDelay(t)&&this.data.AvatarData.organizationIndex==x.default.FOLLOWER&&this.updateDream(-1),this.isDreamShortTimeDelay(t)&&this.data.AvatarData.organizationIndex==x.default.TECH&&this.updateDream(1);var e=this.isStone;this.isStone=this.statusManager.hasStatus(g.default.STONE),e==!this.isStone&&this.turnStone(this.isStone),this.node.scaleX=this.isFaceRight?this.getScaleSize():-this.getScaleSize(),this.node.scaleY=this.getScaleSize(),this.node.opacity=this.invisible?80:255;var i=this.interactBuilding&&this.interactBuilding.isTaken&&!this.interactBuilding.isThrowing,o=this.interactBuilding&&this.interactBuilding.isTaken&&this.interactBuilding.isLift;this.weaponLeft&&(this.weaponLeft.updateLogic(t),this.weaponLeft.meleeWeapon.setHandAndWeaponInVisible(i)),this.weaponRight&&(this.weaponRight.updateLogic(t),this.weaponRight.meleeWeapon.setHandAndWeaponInVisible(i)),this.avatar&&this.avatar.showHandsWithInteract(i,o)}},e.prototype.getScaleSize=function(){return this.IsVariation?1.5:1},e.prototype.useSkill=function(){!this.professionTalent||this.sc.isJumping||this.sc.isAttacking||this.professionTalent.useSKill()},e.prototype.useSkill1=function(){!this.organizationTalent||this.sc.isJumping||this.sc.isAttacking||this.organizationTalent.useSKill()},e.prototype.triggerThings=function(t){!this.sc.isJumping&&this.dungeon&&(this.dungeon.equipmentManager.lastGroundEquip&&this.dungeon.equipmentManager.lastGroundEquip.taken(t)&&(this.dungeon.equipmentManager.lastGroundEquip=null),this.dungeon.itemManager.lastGroundItem&&this.dungeon.itemManager.lastGroundItem.taken(this,t)&&(this.dungeon.itemManager.lastGroundItem=null),this.interactBuilding&&this.interactBuilding.isTaken?this.interactBuilding.interact(this,t,!1,!1):this.dungeon.buildingManager.lastInteractBuilding&&this.dungeon.buildingManager.lastInteractBuilding.taken(this,t)&&(this.interactBuilding=this.dungeon.buildingManager.lastInteractBuilding,this.dungeon.buildingManager.lastInteractBuilding=null),this.touchedTips&&this.touchedTips.next(t,this))},e.prototype.onPreSolve=function(t,e,i){i.tag!=H.ColliderTag.NONPLAYER&&i.tag!=H.ColliderTag.GOODNONPLAYER||(t.disabledOnce=!0)},e.prototype.onCollisionEnter=function(){this.touchedTips=null},e.prototype.onCollisionExit=function(){this.touchedTips=null},e.prototype.onCollisionStay=function(t){var e=this;if(!this.touchDelay){var i=!1;t.node.getComponent(u.default)&&(i=!0),t.node.getComponent(A.default)&&(i=!0);var o=t.node.getComponent(E.default);o&&(i=!0,this.touchedTips=o),i&&(this.touchDelay=!0,this.scheduleOnce(function(){e.touchDelay=!1},.1))}},Object.defineProperty(e.prototype,"Hv",{get:function(){return this.weaponRight.meleeWeapon.Hv},enumerable:!1,configurable:!0}),e.prototype.useItem=function(t){A.default.userIt(t,this)},e.prototype.setLinearVelocity=function(){},n([l(v.default)],e.prototype,"floatinglabelManager",void 0),n([l(cc.Vec3)],e.prototype,"pos",void 0),n([l(cc.Prefab)],e.prototype,"walksmoke",void 0),n([l(b.default)],e.prototype,"weaponLeft",void 0),n([l(b.default)],e.prototype,"weaponRight",void 0),n([l(c.default)],e.prototype,"shooterEx",void 0),n([l(g.default)],e.prototype,"statusManager",void 0),n([l(P.default)],e.prototype,"avatar",void 0),n([l(D.default)],e.prototype,"shield",void 0),n([l(cc.Node)],e.prototype,"remoteCooldown",void 0),n([s],e)}(S.default);i.default=F,cc._RF.pop()},{"./Achievement":"Achievement","./Actor/ColliderTag":"ColliderTag","./Base/Actor":"Actor","./Data/AvatarData":"AvatarData","./Data/DamageData":"DamageData","./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./Data/TalentData":"TalentData","./Dungeon":"Dungeon","./Effect/ShadowOfSight":"ShadowOfSight","./Equipment/Equipment":"Equipment","./EventHelper":"EventHelper","./Item/Item":"Item","./Logic":"Logic","./Manager/FloatingLabelManager":"FloatingLabelManager","./Manager/InventoryManager":"InventoryManager","./Manager/LightManager":"LightManager","./Manager/StatusManager":"StatusManager","./MeleeWeapon":"MeleeWeapon","./PlayerAvatar":"PlayerAvatar","./PlayerWeapon":"PlayerWeapon","./Shield":"Shield","./Shooter":"Shooter","./Talent/OrganizationTalent":"OrganizationTalent","./Talent/ProfessionTalent":"ProfessionTalent","./Talent/Talent":"Talent","./UI/Tips":"Tips","./Utils/AudioPlayer":"AudioPlayer","./Utils/IndexZ":"IndexZ","./Utils/Random":"Random"}],Portal:[function(t,e,i){"use strict";cc._RF.push(e,"deb90P3hX5AB5svKZmVAO6Q","Portal");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Player"),l=t("./Building"),c=t("../Utils/IndexZ"),h=t("../Logic"),p=t("../Data/ExitData"),u=t("../Utils/AudioPlayer"),d=t("../EventHelper"),f=cc._decorator,g=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.isBackDream=!1,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.start=function(){this.anim=this.getComponent(cc.Animation),this.anim.play("PortalCloseIdle")},e.prototype.setPos=function(t){this.node.position=r.default.getPosInMap(t),this.node.zIndex=c.default.BASE+10*(r.default.HEIGHT_SIZE-t.y)+1},e.prototype.AnimGateClose=function(){this.anim.play("PortalCloseIdle")},e.prototype.AnimGateOpen=function(){this.anim.play("PortalOpenIdle")},e.prototype.openGate=function(){var t=this;this.isOpen||(this.isOpen=!0,this.scheduleOnce(function(){t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("PortalOpen")},.1))},e.prototype.closeGate=function(){this.isOpen&&(this.isOpen=!1,this.anim.play("PortalClose"))},e.prototype.onBeginContact=function(t,e,i){var o=i.body.node.getComponent(s.default);o&&this.isOpen&&(this.closeGate(),r.default.getIndexInMap(this.node.position),h.default.playerData=o.data.clone(),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.EXIT}}),h.default.loadingNextLevel(this.isBackDream?p.default.getDreamExitDataFromReal():p.default.getRealWorldExitDataFromDream(h.default.chapterIndex,h.default.level)))},n([g],e)}(l.default));i.default=y,cc._RF.pop()},{"../Data/ExitData":"ExitData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],ProfessionData:[function(t,e,i){"use strict";cc._RF.push(e,"a352fkUprhBDLnAwraLUc3I","ProfessionData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./CommonData"),a=function(){function t(){this.id=0,this.desc="",this.nameCn="",this.nameEn="",this.equips={},this.talent="",this.items=[],this.common=new o.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.desc=t.desc?t.desc:this.desc,this.equips=t.equips?t.equips:{},this.id=t.id?t.id:0,this.talent=t.talent?t.talent:"",this.items=t.items?t.items:[]},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.desc=this.desc,e.id=this.id,e.equips=this.equips,e.talent=this.talent,e.items=this.items,e},t}();i.default=a,cc._RF.pop()},{"./CommonData":"CommonData"}],ProfessionTalent:[function(t,e,i){"use strict";cc._RF.push(e,"a250fm206dD/bouLDpaklSh","ProfessionTalent");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/FromData"),l=t("../EventHelper"),c=t("../Logic"),h=t("../Shooter"),p=t("./FireGhost"),u=t("./Talent"),d=t("../Utils/AudioPlayer"),f=t("../Utils/IndexZ"),g=t("../Manager/StatusManager"),y=t("../PlayerAvatar"),m=t("../NonPlayer"),v=t("../Boss/Boss"),E=t("../Data/AreaOfEffectData"),_=t("../Manager/NonPlayerManager"),D=t("../Utils/ActorUtils"),S=t("../UI/CoolDownView"),R=cc._decorator,T=R.ccclass,O=R.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.aoe=null,e.fireball=null,e.icethron=null,e.fireGhost=null,e.healingLight=null,e.rageLight=null,e.broomPrefab=null,e.cookingPrefab=null,e.swordLightPrefab=null,e.smokePrefab=null,e.skyhandPrefab=null,e.fireGhostNum=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.ghostPool=new cc.NodePool(p.default),cc.director.on("destoryfireghost",function(e){t.destroyGhost(e.detail.coinNode)})},e.prototype.destroyGhost=function(t){t&&(t.active=!1,this.ghostPool&&(this.ghostPool.put(t),this.fireGhostNum--,cc.log("destroyGhost")))},e.prototype.init=function(e){t.prototype.init.call(this,e),this.coolDownId=S.default.PROFESSION;var i=1;this.data.resName==u.default.TALENT_014&&(i=3),this.initCoolDown(e,i)},e.prototype.doSkill=function(){var t=this;switch(this.data.resName){case u.default.TALENT_000:break;case u.default.TALENT_001:d.default.play(d.default.MELEE_PARRY),this.shoot(this.player.shooterEx,0,0,"bullet040",null,null);break;case u.default.TALENT_002:this.healing();break;case u.default.TALENT_003:this.cooking();break;case u.default.TALENT_004:this.showIceThron();break;case u.default.TALENT_005:this.rageShoot();break;case u.default.TALENT_006:this.flash();break;case u.default.TALENT_007:this.addSwordLight();break;case u.default.TALENT_008:this.player.addStatus(g.default.TALENT_INVISIBLE,new s.default);break;case u.default.TALENT_009:this.steal();break;case u.default.TALENT_010:break;case u.default.TALENT_011:this.aimedShoot();break;case u.default.TALENT_012:this.addBroom();break;case u.default.TALENT_013:this.showFireBall();break;case u.default.TALENT_014:d.default.play(d.default.SKILL_MAGICBALL1),this.shoot(this.player.shooterEx,h.default.ARC_EX_NUM_8,0,"bullet035",null,null),this.scheduleOnce(function(){t.IsExcuting=!1},.1);break;case u.default.TALENT_015:this.dash();break;case u.default.TALENT_016:this.addClearCircle();break;case u.default.TALENT_017:this.showSmoke();break;case u.default.TALENT_018:this.addShadowFighter();break;case u.default.TALENT_019:this.jump()}},e.prototype.addClearCircle=function(){this.player.stopAllDebuffs(),this.player.dungeon.nonPlayerManager.isPetAlive()&&this.player.dungeon.nonPlayerManager.pet.stopAllDebuffs(),this.addAoe(this.aoe,this.player.getCenterPosition(),(new E.default).init(2,.2,0,this.player.IsVariation?3:2,f.default.getActorZIndex(this.player.getCenterPosition()),!1,!1,!0,!1,!1,new r.default(0),new s.default,[]),["clearcircle1","clearcircle2","clearcircle3","clearcircle4"],!1,!0)},e.prototype.addShadowFighter=function(){for(var t=0;t<3;t++)this.player.weaponRight.meleeWeapon.dungeon.nonPlayerManager.addNonPlayerFromData(_.default.NON_SHADOW,this.player.node.position,this.player.weaponRight.meleeWeapon.dungeon)},e.prototype.healing=function(){d.default.play(d.default.PICK_ITEM);var t=cc.instantiate(this.healingLight);t.parent=this.player.node,t.position=cc.v3(0,64),t.zIndex=f.default.OVERHEAD,this.player.addStatus(g.default.HEALING,new s.default),this.player.dungeon.nonPlayerManager.isPetAlive()&&this.player.dungeon.nonPlayerManager.pet.addStatus(g.default.HEALING,new s.default)},e.prototype.rageShoot=function(){var t=this;d.default.play(d.default.PICK_ITEM);var e=cc.instantiate(this.rageLight);e.parent=this.player.node,e.position=cc.v3(0,64),e.zIndex=f.default.OVERHEAD,this.scheduleOnce(function(){t.talentSkill.IsExcuting=!1,e&&cc.isValid(e)&&e.destroy()},3)},e.prototype.flash=function(){var t=this;d.default.play(d.default.TAKEPHOTO),cc.tween(this.sprite.node).call(function(){t.player.addStatus(g.default.TALENT_FLASH_SPEED,new s.default),t.player.dungeon.nonPlayerManager.isPetAlive()&&t.player.dungeon.nonPlayerManager.pet.addStatus(g.default.TALENT_FLASH_SPEED,new s.default),t.sprite.spriteFrame=c.default.spriteFrameRes("flash"),t.sprite.node.width=128,t.sprite.node.height=128,t.sprite.node.opacity=255,t.sprite.node.position=cc.v3(0,32)}).to(.1,{opacity:0}).call(function(){t.sprite.spriteFrame=c.default.spriteFrameRes("singleColor"),t.sprite.node.width=2e3,t.sprite.node.height=2e3,t.sprite.node.opacity=255}).to(.1,{opacity:0}).call(function(){t.addStatus2NearEnemy(g.default.TALENT_FLASH_DIZZ,t.player.IsVariation?500:400),t.sprite.spriteFrame=null}).start()},e.prototype.aimedShoot=function(){var t=this;d.default.play(d.default.RELOAD),cc.tween(this.sprite.node).call(function(){t.player.addStatus(g.default.TALENT_AIMED,new s.default),t.player.dungeon.nonPlayerManager.isPetAlive()&&t.player.dungeon.nonPlayerManager.pet.addStatus(g.default.TALENT_AIMED,new s.default),t.sprite.spriteFrame=c.default.spriteFrameRes("talentshoot"),t.sprite.node.width=64,t.sprite.node.height=64,t.sprite.node.opacity=255,t.sprite.node.scale=1,t.sprite.node.position=cc.v3(0,128)}).repeat(5,cc.tween().to(1,{scale:1.5}).to(1,{scale:1})).call(function(){t.sprite.spriteFrame=null}).start()},e.prototype.dash=function(){var t=this,e=1500;this.player.IsVariation&&(e=2e3),d.default.play(d.default.DASH),this.schedule(function(){t.player.getWalkSmoke(t.node.parent,t.node.position)},.05,4,0);var i=this.player.rigidbody.linearVelocity.clone();this.player.sc.isMoving=!1,i=i.equals(cc.Vec2.ZERO)?cc.v2(this.player.Hv.clone()):i.normalizeSelf();var o=cc.v3(i.x,i.y);this.hv=o.clone(),i=i.mul(e),this.player.rigidbody.linearVelocity=i,this.scheduleOnce(function(){t.player.rigidbody.linearVelocity=cc.Vec2.ZERO,t.player.playerAnim(y.default.STATE_IDLE,t.player.currentDir),t.IsExcuting=!1},.5)},e.prototype.jump=function(){var t=this;d.default.play(d.default.DASH),this.player.jump()||(this.talentSkill.IsExcuting=!1,this.refreshCooldown()),this.scheduleOnce(function(){d.default.play(d.default.BOOM);var e=t.player.data.getFinalAttackPoint();e.isMelee=!0;var i=2;t.player.IsVariation&&(i+=1),t.player.shooterEx.fireAoe(t.skyhandPrefab,(new E.default).init(0,.15,0,i,f.default.OVERHEAD,!1,!0,!0,!1,!1,e,new s.default,[g.default.DIZZ])),t.talentSkill.IsExcuting=!1},.8)},e.prototype.steal=function(){var t=this;d.default.play(d.default.FIREBALL),this.sprite.node.width=128,this.sprite.node.height=128,this.sprite.node.opacity=255,this.sprite.node.scale=1,this.sprite.node.position=cc.v3(0,128);var e=D.default.getNearestEnemyActor(this.player,!1,this.player.weaponRight.meleeWeapon.dungeon);if(e){var i=e.getComponent(m.default),o=e.getComponent(v.default);i&&i.data.isTest<1&&i.getLoot(),o&&o.getLoot(),cc.tween(this.sprite.node).call(function(){t.sprite.spriteFrame=c.default.spriteFrameRes("talenthand01")}).delay(.2).call(function(){t.sprite.spriteFrame=c.default.spriteFrameRes("talenthand02")}).delay(.2).call(function(){t.sprite.spriteFrame=c.default.spriteFrameRes("talenthand03")}).delay(.2).call(function(){t.sprite.spriteFrame=c.default.spriteFrameRes("talenthand04")}).delay(.2).call(function(){t.sprite.spriteFrame=null}).start()}},e.prototype.showSmoke=function(){d.default.play(d.default.MELEE_PARRY),(new r.default).magicDamage=3+c.default.playerData.OilGoldData.level;var t=1;this.player.IsVariation&&(t+=1),this.shoot(this.player.shooterEx,0,0,"bullet041",this.smokePrefab,(new E.default).init(7,.1,0,t,f.default.OVERHEAD,!1,!1,!1,!1,!1,new r.default,new s.default,[g.default.WINE_CLOUD]))},e.prototype.showFireBall=function(){d.default.play(d.default.SKILL_FIREBALL);var t=new r.default;t.magicDamage=3+c.default.playerData.OilGoldData.level,t.isMelee=!0;var e=4;this.player.IsVariation&&(e+=1),this.player.shooterEx.fireAoe(this.fireball,(new E.default).init(0,.1,0,e,f.default.OVERHEAD,!1,!0,!0,!1,!0,t,new s.default,[g.default.BURNING]))},e.prototype.showIceThron=function(){this.scheduleOnce(function(){d.default.play(d.default.SKILL_ICETHRON)},1);var t=new r.default;t.magicDamage=3+c.default.playerData.OilGoldData.level,t.isMelee=!0;var e=100,i=60,o=3;this.player.IsVariation&&(o+=1,e=150,i=90);for(var a=[0,45,90,135,180,225,270,315],n=[cc.v3(0,e),cc.v3(-i,i),cc.v3(-e,0),cc.v3(-i,-i),cc.v3(0,-e),cc.v3(i,-i),cc.v3(e,0),cc.v3(i,i)],l=[cc.v3(0,-e),cc.v3(-i,-i),cc.v3(-e,0),cc.v3(-i,i),cc.v3(0,e),cc.v3(i,i),cc.v3(e,0),cc.v3(i,-i)],h=[a],p=0;p<h[0].length;p++)this.player.shooterEx.fireAoe(this.icethron,(new E.default).init(0,2,0,o,f.default.OVERHEAD,!1,!0,!0,!1,!0,t,new s.default,[g.default.FROZEN]),cc.v3(this.player.isFaceRight?n[p]:l[p]),a[p],null,!0)},e.prototype.changePerformance=function(){},e.prototype.takeDamage=function(){return!1},e.prototype.addLighteningFall=function(t,e){l.EventHelper.emit(l.EventHelper.DUNGEON_ADD_LIGHTENINGFALL,{pos:D.default.getNearestEnemyPosition(this.player,!1,this.player.weaponRight.meleeWeapon.dungeon,!0),showArea:t,damage:e})},e.prototype.addBroom=function(){d.default.play(d.default.MELEE_PARRY);var t=this.player.data.getFinalAttackPoint();t.isMelee=!0;var e=1.5;this.player.IsVariation&&(e+=1),this.player.shooterEx.fireAoe(this.broomPrefab,(new E.default).init(0,.5,.2,e,f.default.OVERHEAD,!1,!0,!0,!0,!0,t,new s.default,[g.default.FROZEN]),cc.v3(0,32*this.player.node.scaleY))},e.prototype.cooking=function(){d.default.play(d.default.MELEE_PARRY);var t=this.player.data.getFinalAttackPoint();t.isMelee=!0;var e=1;this.player.IsVariation&&(e+=1),this.player.shooterEx.fireAoe(this.cookingPrefab,(new E.default).init(0,2,0,e,f.default.OVERHEAD,!1,!1,!1,!1,!1,t,new s.default,[]),cc.v3(0,32),0,function(t){var e=t.node.getComponent(m.default);e&&e.dungeon.addItem(e.node.position.clone(),"food"+e.data.resName.replace("monster",""));var i=t.node.getComponent(v.default);i&&i.dungeon.addItem(i.node.position.clone(),"foodboss"+i.data.resName.replace("iconboss",""))})},e.prototype.addSwordLight=function(){var t=this;d.default.play(d.default.SKILL_MAGICBALL),d.default.play(d.default.SWORD_SHOW);var e=new r.default;e.isMelee=!0;var i=5;e.physicalDamage=2+c.default.playerData.OilGoldData.level,this.player.weaponRight.meleeWeapon.IsSword&&(e=this.player.data.getFinalAttackPoint(),i=6),this.player.IsVariation&&(i+=1);var o=this.player.shooterEx.fireAoe(this.swordLightPrefab,(new E.default).init(0,.35,0,i,f.default.OVERHEAD,!1,!0,!0,!1,!0,e,new s.default,[g.default.FROZEN]));this.player.weaponRight.meleeWeapon.IsSword&&(o.node.getChildByName("sprite").color=cc.Color.RED),this.scheduleOnce(function(){t.talentSkill.IsExcuting=!1},1)},e.prototype.initFireGhosts=function(){for(var t=this.fireGhostNum,e=0;e<5-t;e++){var i=null;this.ghostPool.size()>0&&(i=this.ghostPool.get()),i&&!i.active||(i=cc.instantiate(this.fireGhost)),this.fireGhostNum++,i.active=!0;var o=i.getComponent(p.default);this.player.node.parent.addChild(o.node),o.init(this.player,72*e)}},n([O(cc.Sprite)],e.prototype,"sprite",void 0),n([O(cc.Prefab)],e.prototype,"aoe",void 0),n([O(cc.Prefab)],e.prototype,"fireball",void 0),n([O(cc.Prefab)],e.prototype,"icethron",void 0),n([O(cc.Prefab)],e.prototype,"fireGhost",void 0),n([O(cc.Prefab)],e.prototype,"healingLight",void 0),n([O(cc.Prefab)],e.prototype,"rageLight",void 0),n([O(cc.Prefab)],e.prototype,"broomPrefab",void 0),n([O(cc.Prefab)],e.prototype,"cookingPrefab",void 0),n([O(cc.Prefab)],e.prototype,"swordLightPrefab",void 0),n([O(cc.Prefab)],e.prototype,"smokePrefab",void 0),n([O(cc.Prefab)],e.prototype,"skyhandPrefab",void 0),n([T],e)}(u.default);i.default=C,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/AreaOfEffectData":"AreaOfEffectData","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/NonPlayerManager":"NonPlayerManager","../Manager/StatusManager":"StatusManager","../NonPlayer":"NonPlayer","../PlayerAvatar":"PlayerAvatar","../Shooter":"Shooter","../UI/CoolDownView":"CoolDownView","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./FireGhost":"FireGhost","./Talent":"Talent"}],ProfileData:[function(t,e,i){"use strict";cc._RF.push(e,"6ba48LTPitPa5dUl/wXJcJ0","ProfileData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./PlayerData"),a=t("./SavePointData"),n=t("./GroundOilGoldData");i.default=function(){this.rectDungeons={},this.chapterIndex=0,this.chapterMaxIndex=0,this.playerData=new o.default,this.playerEquips={},this.playerItemList=new Array,this.playerInventoryList=new Array,this.nonPlayerList=new Array,this.level=0,this.time="00:00:00",this.savePointData=new a.default,this.groundOilGoldData=new n.default,this.oilGolds=0,this.killPlayerCounts={}},cc._RF.pop()},{"./GroundOilGoldData":"GroundOilGoldData","./PlayerData":"PlayerData","./SavePointData":"SavePointData"}],ProfileManager:[function(t,e,i){"use strict";cc._RF.push(e,"5915dTUdVpDi5LG7x2qxIEk","ProfileManager");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Data/ProfileData"),n=t("../Rect/RectDungeon"),r=t("../Utils/LocalStorage"),s=cc._decorator,l=s.ccclass,c=(s.property,function(){function t(){this.data=new a.default,this.hasSaveData=!1,this.loadData()}return t.prototype.loadData=function(){this.loadProfile()},t.prototype.getSaveData=function(){var t=r.default.getValue(r.default.SAVE_DUNGEON);return t?JSON.parse(t):null},t.prototype.saveData=function(){r.default.putValue(r.default.SAVE_DUNGEON,this.data),this.hasSaveData=!0,console.log("save data")},t.prototype.clearData=function(){cc.sys.localStorage.setItem("data",""),this.hasSaveData=!1,this.data=new a.default,console.log("clear data")},t.prototype.loadProfile=function(){var t=this.getSaveData();if(!t)return this.hasSaveData=!1,!1;if(!(t.savePointData&&t.playerData&&t.playerEquips&&t.playerItemList&&t.rectDungeons))return this.hasSaveData=!1,!1;for(var e in this.data=new a.default,this.hasSaveData=!0,this.data.playerData.valueCopy(t.playerData),this.data.chapterIndex=t.chapterIndex,this.data.chapterMaxIndex=t.chapterMaxIndex,this.data.level=t.level,this.data.savePointData.valueCopy(t.savePointData),this.data.oilGolds=t.oilGolds?t.oilGolds:0,this.data.groundOilGoldData.valueCopy(t.groundOilGoldData),t.playerEquips)this.data.playerEquips[e]=t.playerEquips[e];if(t.playerItemList)for(var i=0;i<t.playerItemList.length;i++)this.data.playerItemList[i]=t.playerItemList[i];if(t.playerInventoryList)for(i=0;i<t.playerInventoryList.length;i++)this.data.playerInventoryList[i]=t.playerInventoryList[i];if(t.nonPlayerList)for(i=0;i<t.nonPlayerList.length;i++)this.data.nonPlayerList[i]=t.nonPlayerList[i];for(var e in t.rectDungeons){var o=new n.default;o.buildMapFromSave(t.rectDungeons[e]),this.data.rectDungeons[e]=o}return t.killPlayerCounts&&(this.data.killPlayerCounts=t.killPlayerCounts),t.time&&(this.data.time=t.time),console.log("data",this),!0},o([l],t)}());i.default=c,cc._RF.pop()},{"../Data/ProfileData":"ProfileData","../Rect/RectDungeon":"RectDungeon","../Utils/LocalStorage":"LocalStorage"}],Rah:[function(t,e,i){"use strict";cc._RF.push(e,"d367aUD8qtMnYoMv/zpvvi2","Rah");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../Data/DamageData"),l=t("../Shooter"),c=t("../Dungeon"),h=t("../Logic"),p=t("../Manager/StatusManager"),u=t("../Utils/NextStep"),d=t("../EventHelper"),f=t("../Utils/AudioPlayer"),g=t("../Data/FromData"),y=t("../Achievement"),m=t("../Utils/ActorUtils"),v=cc._decorator,E=v.ccclass,_=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isFaceRight=!0,e.isMoving=!1,e.darkSkill=new u.default,e.blinkSkill=new u.default,e.snakeSkill=new u.default,e.bugsSkill=new u.default,e.meleeSkill=new u.default,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(l.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(p.default),this.shooter.from.valueCopy(g.default.getClone(this.actorName(),"bossrahhead"))},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){return!(this.sc.isDied||!this.sc.isShow||this.blinkSkill.IsExcuting||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(y.default.addMonsterKillAchievement(this.data.resName),cc.tween(this.node).to(3,{opacity:0}).start(),this.sc.isDied=!0,cc.tween(this.dungeon.fog).to(1,{scale:3}).start(),this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.sc.isDied&&this.sc.isShow&&this.dungeon){this.node.position=c.default.fixOuterMap(this.node.position),this.pos=c.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.dungeon.player.pos.clone(),e=c.default.getPosInMap(t).sub(this.node.position),i=this.getNearPlayerDistance(this.dungeon.player.node),o=e.x,a=e.y;Math.abs(o),Math.abs(a),this.isFaceRight=o>0;var n=this.data.currentHealth<this.data.Common.maxHealth/2;i<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),h.default.getChance(20)&&n&&this.dark(),h.default.getChance(80)&&this.blink(),i<600&&!this.blinkSkill.IsExcuting&&this.fireSnake(),h.default.getChance(90)&&!this.blinkSkill.IsExcuting&&this.fireBugs(n),i<100&&!this.blinkSkill.IsExcuting&&this.attack(),!e.equals(cc.Vec3.ZERO)&&!this.meleeSkill.IsExcuting&&!this.blinkSkill.IsExcuting&&i>100&&(e=e.normalizeSelf(),this.move(e,100))}},e.prototype.blink=function(){var t=this;this.blinkSkill.next(function(){cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.BLINK}}),t.blinkSkill.IsExcuting=!0,t.rigidbody.linearVelocity=cc.Vec2.ZERO,cc.tween(t.node).to(1,{opacity:0}).call(function(){var e=t.dungeon.player.pos.clone();e.y>c.default.HEIGHT_SIZE-1?e.y-=1:e.y+=1,t.transportBoss(e.x,e.y)}).to(1,{opacity:255}).call(function(){t.attack()}).start(),t.scheduleOnce(function(){t.blinkSkill.IsExcuting=!1},5)},10)},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:f.default.MELEE}}),t.meleeSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahAttack001")},2,!0)},e.prototype.dark=function(){var t=this;this.darkSkill.next(function(){cc.tween(t.dungeon.fog).to(2,{scale:1.75}).to(6,{angle:0}).to(2,{scale:.6}).start(),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahSpellDark")},20)},e.prototype.fireSnake=function(){var t=this;this.snakeSkill.next(function(){t.shooter.setHv(cc.v3(0,-1));var e=t.node.position.clone().add(t.shooter.node.position),i=t.dungeon.player.getCenterPosition().sub(e);i.equals(cc.Vec3.ZERO)||(i=i.normalizeSelf(),t.shooter.setHv(i),t.fireShooter(t.shooter,"bullet014",1,0)),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahSpellSnake")},6)},e.prototype.fireBugs=function(){var t=this;this.bugsSkill.next(function(){t.shooter.data.bulletLineInterval=.5;var e=t.node.position.clone().add(t.shooter.node.position),i=t.dungeon.player.getCenterPosition().sub(e);i.equals(cc.Vec3.ZERO)||(i=i.normalizeSelf(),t.shooter.setHv(i)),t.fireShooter(t.shooter,"bullet017",99,0),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahSpellBugs")},4)},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a)},e.prototype.showBoss=function(){this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied,this.sc.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.move=function(t,e){if(!this.sc.isDied){t.equals(cc.Vec3.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t){var e=m.default.getEnemyCollisionTarget(t);if(e&&this.meleeSkill.IsExcuting&&!this.sc.isDied){var i=new s.default;i.physicalDamage=15,e.takeDamage(i,g.default.getClone(this.actorName(),"bossrahhead"),this)}},e.prototype.actorName=function(){return"\u673a\u68b0\u62c9\u795e"},n([E],e)}(r.default));i.default=_,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/NextStep":"NextStep","./Boss":"Boss"}],Random4Save:[function(t,e,i){"use strict";cc._RF.push(e,"74f98/L5YNOk7ZP1QlogXyD","Random4Save"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t){this.seed=0,this.seed=t,t<=0&&(t=(new Date).getTime())}return Object.defineProperty(t.prototype,"Seed",{get:function(){return this.seed},set:function(t){this.seed=t},enumerable:!1,configurable:!0}),t.prototype.rand=function(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280},t.prototype.getRandomNum=function(t,e){return t+Math.round(this.rand()*(e-t))},t.prototype.getHalfChance=function(){return this.rand()>.5},t}();i.default=o,cc._RF.pop()},{}],Random:[function(t,e,i){"use strict";cc._RF.push(e,"b33a81ZfJ9HoIP2sjcUTtfA","Random"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.prototype.setSeed=function(e){t.seed=e},t.rand=function(){return t.seed=(9301*t.seed+49297)%233280,t.seed/233280},t.getRandomNum=function(e,i){return e+Math.round(t.rand()*(i-e))},t.getHalfChance=function(){return t.rand()>.5},t.seed=(new Date).getTime(),t}();i.default=o,cc._RF.pop()},{}],RectDoor:[function(t,e,i){"use strict";cc._RF.push(e,"d41e5HipSBBVLDWw2G1WR/C","RectDoor"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(t,e,i){this.isDoor=!1,this.isHidden=!1,this.dir=t,this.isDoor=e,this.isHidden=i},cc._RF.pop()},{}],RectDungeon:[function(t,e,i){"use strict";cc._RF.push(e,"3b710jO571KQpPd9DCAmaJb","RectDungeon"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./RectRoom"),a=t("./RoomType"),n=t("../Data/BuildingData"),r=t("../Data/EquipmentData"),s=t("../Data/ItemData"),l=function(){function t(){this.id="00",this.width=0,this.height=0,this.currentPos=cc.v3(1,1),this.buildings={},this.equipments={},this.items={},this.startIndex=cc.Vec2.ZERO,this.endIndex=cc.v2(-1,-1)}return t.prototype.buildMapFromSave=function(t,e){for(var i in this.id=t.id,this.width=t.width,this.height=t.height,this.map=new Array,this.currentPos=t.currentPos?cc.v3(t.currentPos.x,t.currentPos.y):cc.v3(0,0),t.buildings){var l=t.buildings[i];for(var c in this.buildings[i]={},l){var h=new n.default;h.valueCopy(l[c]),this.buildings[i][c]=h}}for(var p in t.equipments){var u=t.equipments[p];this.equipments[p]=new Array;for(var d=0;d<u.length;d++){var f=new r.default;f.valueCopy(u[d]),this.equipments[p][d]=f}}for(var p in t.items)for(u=t.items[p],this.items[p]=new Array,d=0;d<u.length;d++){var g=new s.default;g.valueCopy(u[d]),this.items[p][d]=g}for(d=0;d<this.width;d++){this.map[d]=new Array;for(var y=0;y<this.height;y++)this.map[d][y]=new o.default(d,y,a.default.EMPTY_ROOM).initFromSave(t.map[d][y]),e&&(this.map[d][y].roomType=a.default.getTypeByName(e.roomTypes[d][y])),this.map[d][y].roomType.isEqual(a.default.START_ROOM)&&(this.map[d][y].state!=o.default.STATE_CLEAR&&(this.map[d][y].state=o.default.STATE_FOUND),this.startIndex=cc.v2(d,y)),this.map[d][y].roomType.isEqual(a.default.END_ROOM)&&(this.map[d][y].state!=o.default.STATE_CLEAR&&(this.map[d][y].state=o.default.STATE_FOUND),this.endIndex=cc.v2(d,y))}return this.endIndex.x<0&&this.endIndex.y<0&&(this.endIndex=this.startIndex.clone()),this},t.prototype.buildMap=function(t){this.map=new Array,this.id=""+t.chapter+t.index,this.width=t.width,this.height=t.height,this.buildings={},this.equipments={},this.items={};for(var e=0;e<t.width;e++){this.map[e]=new Array;for(var i=0;i<t.height;i++)this.map[e][i]=new o.default(e,i,a.default.getTypeByName(t.roomTypes[e][i])),this.map[e][i].roomType.isEqual(a.default.START_ROOM)&&(this.map[e][i].state!=o.default.STATE_CLEAR&&(this.map[e][i].state=o.default.STATE_FOUND),this.startIndex=cc.v2(e,i)),this.map[e][i].roomType.isEqual(a.default.END_ROOM)&&(this.map[e][i].state!=o.default.STATE_CLEAR&&(this.map[e][i].state=o.default.STATE_FOUND),this.endIndex=cc.v2(e,i))}this.endIndex.x<0&&this.endIndex.y<0&&(this.endIndex=this.startIndex.clone())},t.prototype.getDisPlay=function(){for(var t="",e=this.height-1;e>=0;e--){for(var i=0;i<this.width;i++)t+=this.map[i][e].roomType.NAME;t+="\n"}return t},t.prototype.getNeighborRoom=function(t,e,i){var o=t,a=e;return-1==i?this.map[o][a]:(0==i&&(a+=1),1==i&&(a-=1),2==i&&(o-=1),3==i&&(o+=1),o>=this.width||o<0||a>=this.height||a<0||i<0||i>4?null:this.map[o][a])},t.prototype.changeRoomsIsFound=function(t,e){this.changeRoomIsFound(t,e),this.changeRoomIsFound(t+1,e),this.changeRoomIsFound(t-1,e),this.changeRoomIsFound(t,e+1),this.changeRoomIsFound(t,e-1),this.changeRoomIsFound(t+1,e-1),this.changeRoomIsFound(t-1,e-1),this.changeRoomIsFound(t+1,e-1),this.changeRoomIsFound(t-1,e-1)},t.prototype.changeRoomIsFound=function(t,e){t>=this.width||t<0||e>=this.height||e<0||this.map[t][e].state!=o.default.STATE_CLEAR&&(this.map[t][e].state=o.default.STATE_FOUND)},t.isRoomEqual=function(t,e){return t.x==e.x&&t.y==e.y},t.prototype.changeAllClearRoomsReborn=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.map[t][e].isClear()&&(this.map[t][e].reborn++,this.map[t][e].isReborn=!0)},t}();i.default=l,cc._RF.pop()},{"../Data/BuildingData":"BuildingData","../Data/EquipmentData":"EquipmentData","../Data/ItemData":"ItemData","./RectRoom":"RectRoom","./RoomType":"RoomType"}],RectRoom:[function(t,e,i){"use strict";cc._RF.push(e,"d55edjfV4pLuKPki2DqAONx","RectRoom"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./RoomType"),a=t("../Utils/Random"),n=function(){function t(e,i,o){this.state=t.STATE_SLEEP,this.seed=0,this.isReborn=!1,this.reborn=0,this.x=e,this.y=i,this.roomType=o,this.seed=t.getRandomNum(0,1e8),this.init()}return t.prototype.initFromSave=function(e){if(e)return this.x=e.x,this.y=e.y,this.roomType=new o.default(0,""),this.roomType.valueCopy(e.roomType),this.state=e.state,this.reborn=e.reborn,this.isReborn=e.isReborn,this.seed=e.seed?e.seed:t.getRandomNum(0,1e8),this},t.prototype.init=function(){this.state=t.STATE_SLEEP},t.prototype.isFound=function(){return this.state==t.STATE_FOUND||this.state==t.STATE_CLEAR},t.prototype.isClear=function(){return this.state==t.STATE_CLEAR},t.getRandomNum=function(t,e){return t+Math.round(a.default.rand()*(e-t))},t.STATE_SLEEP=0,t.STATE_FOUND=1,t.STATE_CLEAR=2,t}();i.default=n,cc._RF.pop()},{"../Utils/Random":"Random","./RoomType":"RoomType"}],RoomBed:[function(t,e,i){"use strict";cc._RF.push(e,"3cd15zS7p1FoqGJnOp3C8cF","RoomBed");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/ExitData"),s=t("../Data/FromData"),l=t("../Effect/ShadowOfSight"),c=t("../EventHelper"),h=t("../Logic"),p=t("../Manager/StatusManager"),u=t("../Player"),d=t("../UI/Tips"),f=t("../Utils/AudioPlayer"),g=t("./Building"),y=cc._decorator,m=y.ccclass,v=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isWakeUp=!1,e.isFirst=!0,e.isDecorate=!1,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.lights=this.getComponentsInChildren(l.default),this.tips=this.getComponentInChildren(d.default),this.tips.tipsType=d.default.ROOM_BED,cc.director.on(c.EventHelper.PLAYER_TAPTIPS,function(e){t.node&&e.detail.tipsType==d.default.ROOM_BED&&t.enterDream(e.detail.player)})},e.prototype.init=function(t,e){this.dungeon=t,this.isDecorate=e,this.tips.node.active=!e},e.prototype.start=function(){this.node.getChildByName("sprite").getChildByName("bed").getComponent(cc.Sprite).spriteFrame=h.default.spriteFrameRes("avatarbed00"+h.default.playerData.AvatarData.organizationIndex),this.node.getChildByName("sprite").getChildByName("cover").getComponent(cc.Sprite).spriteFrame=h.default.spriteFrameRes("avatarcover00"+h.default.playerData.AvatarData.organizationIndex)},e.prototype.onCollisionEnter=function(t){if(!this.isDecorate){var e=t.node.getComponent(u.default);this.enterDream(e)}},e.prototype.enterDream=function(t){var e=this;t&&!this.isWakeUp&&this.isFirst&&(this.isFirst=!1,this.dungeon&&(this.dungeon.CameraZoom=2),t.addStatus(p.default.DIZZ,new s.default),this.scheduleOnce(function(){h.default.playerData=t.data.clone(),h.default.playerData.pos.equals(e.data.defaultPos)&&(h.default.playerData.pos.y=e.data.defaultPos.y-1),f.default.play(f.default.EXIT),h.default.loadingNextLevel(r.default.getDreamExitDataFromReal())},.5))},e.prototype.onCollisionExit=function(t){this.isDecorate||t.node.getComponent(u.default)&&!this.isWakeUp&&(this.isWakeUp=!0)},n([m],e)}(g.default));i.default=v,cc._RF.pop()},{"../Data/ExitData":"ExitData","../Data/FromData":"FromData","../Effect/ShadowOfSight":"ShadowOfSight","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Player":"Player","../UI/Tips":"Tips","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],RoomStool:[function(t,e,i){"use strict";cc._RF.push(e,"b3a88wYknRFJqEjNBOhztfv","RoomStool");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/FromData"),s=t("../EventHelper"),l=t("../Manager/StatusManager"),c=t("../UI/Tips"),h=t("../Utils/AudioPlayer"),p=t("../Utils/IndexZ"),u=t("./Building"),d=cc._decorator,f=d.ccclass,g=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mosaic=null,e.isOpen=!1,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.tips=this.getComponentInChildren(c.default),cc.director.on(s.EventHelper.PLAYER_TAPTIPS,function(e){t.node&&e.detail.tipsType==c.default.ROOM_STOOL+"x="+t.data.defaultPos.x+"y="+t.data.defaultPos.y&&t.open()})},e.prototype.init=function(t,e){this.dungeon=e,this.tips&&(this.tips.tipsType=c.default.ROOM_STOOL+"x="+t.x+"y="+t.y),this.data.defaultPos=t;var i=this.mosaic.convertToWorldSpaceAR(cc.v3(0,0));this.mosaic.parent=this.node.parent,this.mosaic.position=this.mosaic.parent.convertToNodeSpaceAR(i),this.mosaic.zIndex=p.default.OVERHEAD,this.mosaic.opacity=0},e.prototype.open=function(){var t=this;this.isOpen||(this.isOpen=!0,this.mosaic.opacity=255,this.unscheduleAllCallbacks(),this.dungeon&&this.dungeon.player.addStatus(l.default.DIZZ_LONG,new r.default),this.scheduleOnce(function(){t.mosaic.opacity=0,h.default.play(h.default.CLOSESTOOL)},5),this.scheduleOnce(function(){t.isOpen=!1},10))},n([g(cc.Node)],e.prototype,"mosaic",void 0),n([f],e)}(u.default);i.default=y,cc._RF.pop()},{"../Data/FromData":"FromData","../EventHelper":"EventHelper","../Manager/StatusManager":"StatusManager","../UI/Tips":"Tips","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./Building":"Building"}],RoomTv:[function(t,e,i){"use strict";cc._RF.push(e,"8c83fKZL65BO7yZt9toJ0M8","RoomTv");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Effect/ShadowOfSight"),s=t("../Logic"),l=t("../Player"),c=t("../Utils/AudioPlayer"),h=t("./Building"),p=cc._decorator,u=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.screen=null,e.isOpen=!1,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.lights=this.getComponentsInChildren(r.default)},e.prototype.start=function(){for(var t=0,e=this.lights;t<e.length;t++)e[t].updateRender(!1)},e.prototype.open=function(){var t=this;if(this.isOpen=!0,this.lights)for(var e=0,i=this.lights;e<i.length;e++)i[e].updateRender(!0);this.unscheduleAllCallbacks(),this.anim.stop(),this.anim.play("RoomTvOpen"),this.scheduleOnce(function(){s.default.getHalfChance()?(t.anim.play("RoomTvNoSignalIdle"),c.default.play(c.default.TVWHITE,!1,!0)):(t.anim.play("RoomTvOpenIdle"),c.default.play(c.default.TVCOLOR,!1,!0))},.5)},e.prototype.close=function(){var t=this;if(this.isOpen=!1,this.lights)for(var e=0,i=this.lights;e<i.length;e++)i[e].updateRender(!1);this.unscheduleAllCallbacks(),this.anim.stop(),this.anim.play("RoomTvClose"),c.default.stopAllEffect(),this.scheduleOnce(function(){t.anim.play("RoomTvClosedIdle")},.5)},e.prototype.onCollisionEnter=function(t){t.node.getComponent(l.default)&&this.open()},e.prototype.onCollisionExit=function(t){t.node.getComponent(l.default)&&this.close()},n([d(cc.Sprite)],e.prototype,"screen",void 0),n([u],e)}(h.default);i.default=f,cc._RF.pop()},{"../Effect/ShadowOfSight":"ShadowOfSight","../Logic":"Logic","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],RoomType:[function(t,e,i){"use strict";cc._RF.push(e,"877a0zZc/9EjpFiULm+otfY","RoomType"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){this.id=0,this.name="",this.id=t,this.name=e}return Object.defineProperty(t.prototype,"ID",{get:function(){return this.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NAME",{get:function(){return this.name},enumerable:!1,configurable:!0}),t.prototype.valueCopy=function(t){this.id=t.id,this.name=t.name},t.getIdByName=function(t){return t.charCodeAt(0)-"A".charCodeAt(0)},t.getNameById=function(t){return String.fromCharCode("A".charCodeAt(0)+t)},t.getTypeByName=function(e){return new t(t.getIdByName(e),e)},t.getTypeById=function(e){return new t(e,t.getNameById(e))},t.isDecorateRoomType=function(e){return t.START_ROOM.isNotEqual(e)&&t.TEST_ROOM.isNotEqual(e)&&t.PREPARE_ROOM.isNotEqual(e)},t.isMonsterGenerateRoom=function(e){return t.DANGER_ROOM.isEqual(e)||t.INSANE_ROOM.isEqual(e)||t.BOSS_ROOM.isEqual(e)||t.KEY_ROOM.isEqual(e)||t.LOOT_ROOM.isEqual(e)||t.NORMAL_ROOM.isEqual(e)||t.END_ROOM.isEqual(e)||t.VERTICAL_ROOM.isEqual(e)||t.HORIZONTAL_ROOM.isEqual(e)},t.prototype.isEqual=function(t){return t.ID==this.ID},t.prototype.isNotEqual=function(t){return t.ID!=this.ID},t.ELITE_ROOM=new t(0,"A"),t.BOSS_ROOM=new t(1,"B"),t.CROSS_ROOM=new t(2,"C"),t.DANGER_ROOM=new t(3,"D"),t.END_ROOM=new t(4,"E"),t.FINAL_ROOM=new t(5,"F"),t.G_ROOM=new t(6,"G"),t.HORIZONTAL_ROOM=new t(7,"H"),t.INSANE_ROOM=new t(8,"I"),t.TUTORIAL_ROOM=new t(9,"J"),t.KEY_ROOM=new t(10,"K"),t.LOOT_ROOM=new t(11,"L"),t.MERCHANT_ROOM=new t(12,"M"),t.NORMAL_ROOM=new t(13,"N"),t.EMPTY_ROOM=new t(14,"O"),t.PREPARE_ROOM=new t(15,"P"),t.Q_ROOM=new t(16,"Q"),t.REST_ROOM=new t(17,"R"),t.START_ROOM=new t(18,"S"),t.TEST_ROOM=new t(19,"T"),t.U_ROOM=new t(20,"U"),t.VERTICAL_ROOM=new t(21,"V"),t.WATER_ROOM=new t(22,"W"),t.X_ROOM=new t(23,"X"),t.HIDDEN_ROOM=new t(24,"Y"),t.Z_ROOM=new t(25,"Z"),t}();i.default=o,cc._RF.pop()},{}],SavePointData:[function(t,e,i){"use strict";cc._RF.push(e,"2940aORMiBLQ5k/LNcPv2bl","SavePointData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.x=16,this.y=16,this.chapter=0,this.level=0}return t.prototype.valueCopy=function(t){t&&(this.x=t.x||0==t.x?t.x:16,this.y=t.y||0==t.y?t.y:16,this.chapter=t.chapter?t.chapter:0,this.level=t.level?t.level:0)},t.prototype.clone=function(){var e=new t;return e.x=this.x,e.y=this.y,e.chapter=this.chapter,e.level=this.level,e},t}();i.default=o,cc._RF.pop()},{}],SavePoint:[function(t,e,i){"use strict";cc._RF.push(e,"b080bpXecxCVaM8ctiNSXZl","SavePoint");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/ExitData"),s=t("../Effect/ShadowOfSight"),l=t("../EventHelper"),c=t("../Logic"),h=t("../UI/Tips"),p=t("../Utils/AudioPlayer"),u=t("./Building"),d=cc._decorator,f=d.ccclass,g=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.lights=this.getComponentsInChildren(s.default),this.tips=this.getComponentInChildren(h.default),this.tips.tipsType=h.default.SAVE_POINT,l.EventHelper.on(l.EventHelper.PLAYER_TAPTIPS,function(e){t.node&&e.tipsType==h.default.SAVE_POINT&&t.isOpen&&t.tips.node.active&&(e.player&&(c.default.playerData=e.player.data.clone()),c.default.savePonit(t.data.defaultPos),c.default.resetData(),l.EventHelper.emit(l.EventHelper.HUD_CAMERA_ZOOM_IN,{}),p.default.play(p.default.EXIT),c.default.loadingNextLevel(r.default.getRealWorldExitDataFromDream(c.default.chapterIndex,c.default.level)))})},e.prototype.start=function(){for(var t=0,e=this.lights;t<e.length;t++)e[t].updateRender(!1)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.05&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.lights.length>0&&this.lights[0].showShadow&&this.isCheckTimeDelay(t)&&(this.lights[0].rayRadius=c.default.lerp(this.lights[0].rayRadius,300,5*t))},e.prototype.open=function(){var t=this;this.isOpen||(c.default.savePonit(this.data.defaultPos),this.isOpen=!0,this.scheduleOnce(function(){t.anim.play("SavePointActive"),t.scheduleOnce(function(){for(var e=0,i=t.lights;e<i.length;e++){var o=i[e];o.rayRadius=0,o.updateRender(!0)}t.anim.play("SavePointIdleActive"),t.tips.node.active=!0},1)},1))},n([f],e)}(u.default));i.default=g,cc._RF.pop()},{"../Data/ExitData":"ExitData","../Effect/ShadowOfSight":"ShadowOfSight","../EventHelper":"EventHelper","../Logic":"Logic","../UI/Tips":"Tips","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],Saw:[function(t,e,i){"use strict";cc._RF.push(e,"e4758hHN8ZNFpX/Yga2qrRo","Saw");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Data/DamageData"),l=t("./Building"),c=t("../Manager/StatusManager"),h=t("../Utils/Random"),p=t("../Data/FromData"),u=t("../Utils/IndexZ"),d=t("../Utils/ActorUtils"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalSpriteFrame=null,e.bloodSpriteFrame=null,e.pos=cc.v3(0,0),e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.sprite.spriteFrame=this.normalSpriteFrame},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t;var e=r.default.getPosInMap(t);this.node.position=cc.v3(e.x,e.y),this.node.zIndex=u.default.FLOOR},e.prototype.onCollisionEnter=function(t){var e=d.default.getEnemyCollisionTarget(t);if(e){var i=p.default.getClone(this.actorName(),"saw002");e.takeDamage(new s.default(1),i),h.default.rand()<.1&&e.addStatus(c.default.BLEEDING,i),this.sprite.spriteFrame=this.bloodSpriteFrame}},e.prototype.update=function(){},e.prototype.actorName=function(){return"\u952f\u9f7f\u8f6e"},n([y(cc.SpriteFrame)],e.prototype,"normalSpriteFrame",void 0),n([y(cc.SpriteFrame)],e.prototype,"bloodSpriteFrame",void 0),n([g],e)}(l.default);i.default=m,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../Manager/StatusManager":"StatusManager","../Utils/ActorUtils":"ActorUtils","../Utils/IndexZ":"IndexZ","../Utils/Random":"Random","./Building":"Building"}],Seeker:[function(t,e,i){"use strict";cc._RF.push(e,"9d901Qk1AZCcpW5rnbx33wB","Seeker");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMoving=!1,e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.rigidbody=this.getComponent(cc.RigidBody),this.node.zIndex=1e3,cc.director.on(r.EventHelper.PLAYER_MOVE,function(e){t.move(e.detail.dir,e.detail.pos,e.detail.dt)})},e.prototype.move=function(t,e){var i=e.x,o=e.y,a=Math.abs(i),n=Math.abs(o),r=a>n?a:n;r=0==r?1:r;var s=cc.v2(i,o),l=500;l<0&&(l=0),s=s.mul(l),this.rigidbody.linearVelocity=s,this.isMoving=0!=i||0!=o},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.isMoving&&cc.director.emit(r.EventHelper.CHUNK_LOAD,{detail:{pos:this.node.position.clone()}})},n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"../EventHelper":"EventHelper"}],SettingsDialog:[function(t,e,i){"use strict";cc._RF.push(e,"201faQ17bhLsoyeY0sNn6x5","SettingsDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../EventHelper"),s=t("../../Logic"),l=t("../../Utils/LocalStorage"),c=t("./BaseDialog"),h=cc._decorator,p=h.ccclass,u=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tgShadow=null,e.tgGamepad=null,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.show=function(){t.prototype.show.call(this),this.initToggle(this.tgShadow,l.default.isSwitchOpen(l.default.KEY_SWITCH_SHOW_SHADOW)),this.initToggle(this.tgGamepad,l.default.isSwitchOpen(l.default.KEY_SWITCH_SHOW_GAMEPAD))},e.prototype.initToggle=function(t,e){e?t.check():t.uncheck()},e.prototype.toggleShadow=function(t){s.default.settings.showShadow=t.isChecked,l.default.saveSwitch(l.default.KEY_SWITCH_SHOW_SHADOW,s.default.settings.showShadow)},e.prototype.toggleGamepad=function(t){s.default.settings.showGamepad=t.isChecked,l.default.saveSwitch(l.default.KEY_SWITCH_SHOW_GAMEPAD,s.default.settings.showGamepad),cc.director.emit(r.EventHelper.HUD_CONTROLLER_UPDATE_GAMEPAD)},e.prototype.close=function(){cc.director.getScheduler().setTimeScale(1),this.dismiss()},e.prototype.home=function(){s.default.saveData(),cc.director.loadScene("start")},n([u(cc.Toggle)],e.prototype,"tgShadow",void 0),n([u(cc.Toggle)],e.prototype,"tgGamepad",void 0),n([p],e)}(c.default);i.default=d,cc._RF.pop()},{"../../EventHelper":"EventHelper","../../Logic":"Logic","../../Utils/LocalStorage":"LocalStorage","./BaseDialog":"BaseDialog"}],Settings:[function(t,e,i){"use strict";cc._RF.push(e,"9f7a3vE481MQYBScX8VK6ox","Settings"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){this.showShadow=!0,this.showGamepad=!0},cc._RF.pop()},{}],ShadowOfSight:[function(t,e,i){"use strict";cc._RF.push(e,"f6922FctbtKnrAA7zoIN/Yg","ShadowOfSight");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Actor/ColliderTag"),s=t("../Logic"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ray=null,e.rayNum=180,e.rayRadius=600,e.renderColor=cc.color(255,255,255,40),e.showLight=!0,e.showShadow=!0,e.showRayCast=!1,e.isCircle=!0,e.isSector=!1,e.lightVertsArray=new Array,e.lightRects={},e.circle=cc.v3(0,0,0),e.offset=0,e.offsetPlus=!1,e.isRendered=!1,e}return a(e,t),e.prototype.onLoad=function(){this.mat=this.ray.getMaterial(0)},e.prototype.renderSightArea=function(t){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0));this.offset>20?this.offsetPlus=!1:this.offset<-20&&(this.offsetPlus=!0),this.offset=this.offsetPlus?this.offset+.1:this.offset-.1,this.ray.clear(),s.default.settings.showShadow&&this.showShadow&&(this.lightRects={},this.lightVertsArray=[],this.circle=cc.v3(0,0,0),this.showRayCast?this.drawRayByNum(e,t,this.showLight):this.drawCircle(e,t,this.showLight)),this.isRendered=!0},e.prototype.updateRender=function(t){this.isRendered=!1,this.showShadow=t},e.prototype.drawRayByNum=function(t,e,i){if(!(this.rayRadius<=0)){this.ray.lineWidth=10,this.ray.fillColor=this.renderColor;var o=2*Math.PI/this.rayNum;this.lightVertsArray=new Array,this.lightRects={};for(var a=0;a<this.rayNum;a++){var n=cc.v2(Math.cos(a*o)*this.getRadius()+t.x,Math.sin(a*o)*this.getRadius()+t.y),s=cc.director.getPhysicsManager().rayCast(t,n,cc.RayCastType.Closest);if(s.length>0&&!s[0].collider.sensor&&s[0].collider.node!=this.node.parent&&(s[0].collider.tag==r.ColliderTag.WALL||s[0].collider.tag==r.ColliderTag.BUILDING||s[0].collider.tag==r.ColliderTag.PLAYER||s[0].collider.tag==r.ColliderTag.WALL_TOP||s[0].collider.tag==r.ColliderTag.NONPLAYER)){n=s[0].point;var l=s[0].collider.node;if(l.convertToNodeSpaceAR(n).y<=0&&n.y>t.y){var c=l.convertToWorldSpaceAR(cc.v3(0,0)),h=cc.rect(c.x-l.width*l.anchorX,c.y-l.height*l.anchorY-0,l.width,l.height+0);this.lightRects[l.uuid]=h}}if(this.lightVertsArray.push(n),this.ray.lineWidth=3,this.ray.strokeColor=cc.color(0,0,0,80),i)if(0==a){var p=this.node.convertToNodeSpaceAR(n);this.ray.moveTo(p.x,p.y)}else{var u=this.node.convertToNodeSpaceAR(n);this.ray.lineTo(u.x,u.y)}}if(i){for(var d in this.ray.close(),this.ray.fill(),this.ray.fillColor.a=this.ray.fillColor.a/2,this.lightRects)h=this.lightRects[d],u=this.node.convertToNodeSpaceAR(cc.v3(h.x,h.y)),this.ray.rect(u.x,u.y,h.width,h.height),this.ray.fill();this.updateMat(this.mat,cc.v2(t.x-e.x,t.y-e.y))}}},e.prototype.drawCircle=function(t,e,i){if(!(this.rayRadius<=0)&&(this.circle=cc.v3(t.x,t.y,this.getRadius()),this.lightVertsArray=new Array,this.lightRects={},i&&this.rayRadius>0)){this.ray.lineWidth=10,this.ray.fillColor=this.renderColor;var o=this.node.convertToNodeSpaceAR(t);this.isSector?(this.ray.moveTo(o.x-this.getRadius()/8,o.y),this.ray.lineTo(o.x-this.getRadius()/2,o.y-this.getRadius()/3),this.ray.lineTo(o.x-this.getRadius()/1.5,o.y-this.getRadius()/2),this.ray.lineTo(o.x-this.getRadius()/2,o.y-this.getRadius()),this.ray.lineTo(o.x,o.y-1.2*this.getRadius()),this.ray.lineTo(o.x+this.getRadius()/2,o.y-this.getRadius()),this.ray.lineTo(o.x+this.getRadius()/1.5,o.y-this.getRadius()/2),this.ray.lineTo(o.x+this.getRadius()/2,o.y-this.getRadius()/3),this.ray.lineTo(o.x+this.getRadius()/8,o.y),this.ray.close()):this.ray.rect(o.x-this.getRadius(),o.y-this.getRadius(),2*this.getRadius(),2*this.getRadius()),this.ray.fill(),this.updateMat(this.mat,cc.v2(t.x-e.x,t.y-e.y))}},e.prototype.getRadius=function(){return this.rayRadius+this.offset},e.prototype.updateMat=function(t,e){var i=cc.view.getCanvasSize(),o=cc.view.getVisibleSize(),a=o.width/o.height,n=this.getRadius()/o.height,r=i.width/o.width;t.setProperty("screen",cc.v2(i.width,i.height)),t.setProperty("maxRadius",n),t.setProperty("whRatio",a),t.setProperty("isCircle",this.isCircle);var s=cc.v2(e.x/o.width,e.y/o.height),l=Math.abs(s.y-.5)*o.height*r/i.height;this.mat.setProperty("lightPos",cc.v2(s.x,s.y>.5?.5+l:.5-l))},n([h(cc.Graphics)],e.prototype,"ray",void 0),n([h],e.prototype,"rayRadius",void 0),n([h(cc.Color)],e.prototype,"renderColor",void 0),n([h],e.prototype,"showLight",void 0),n([h],e.prototype,"showShadow",void 0),n([h],e.prototype,"showRayCast",void 0),n([h],e.prototype,"isCircle",void 0),n([h],e.prototype,"isSector",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Logic":"Logic"}],Shield:[function(t,e,i){"use strict";cc._RF.push(e,"a9e32odPWRNMpWClq+mn20V","Shield");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./PlayerAvatar"),l=t("./Data/EquipmentData"),c=t("./EventHelper"),h=t("./Utils/IndexZ"),p=t("./Effect/BlockLight"),u=t("./Data/DamageData"),d=t("./Manager/StatusManager"),f=t("./Data/FromData"),g=t("./Manager/InventoryManager"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.blockLightPrefab=null,e.status=-1,e.data=new l.default,e.isBehind=!1,e.avatarZindex=0,e.isBehindChange=!1,e.dir=3,e.isButtonPressing=!1,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"isAniming",{get:function(){return this.status==i.STATUS_PUTDOWN||this.status==i.STATUS_PARRY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDefendOrParrying",{get:function(){return this.status==i.STATUS_DEFEND||this.status==i.STATUS_PARRY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Status",{get:function(){return this.status},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;cc.director.on(c.EventHelper.POOL_DESTORY_BLOCKLIGHT,function(e){t.destroySmoke(e.detail.targetNode)}),this.blocklightPool=new cc.NodePool},e.prototype.getBlockLight=function(t,e){var o=null;this.blocklightPool.size()>0&&(o=this.blocklightPool.get()),o&&!o.active||(o=cc.instantiate(this.blockLightPrefab)),o.parent=t,o.position=e,o.zIndex=h.default.OVERHEAD,o.scale=this.status==i.STATUS_PARRY?2:1,o.opacity=255,o.active=!0,o.getComponent(p.default).show()},e.prototype.blockDamage=function(t,e,o){if(this.status<0||this.status==i.STATUS_IDLE||this.status==i.STATUS_PUTDOWN)return 0;if(e.getTotalDamage()<=0)return 0;var a=t.node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.Vec2.ZERO));return this.getBlockLight(t.node.parent,cc.v3(a.x,a.y)),o&&(this.status==i.STATUS_PARRY&&(o.addStatus(d.default.SHIELD_PARRY,new f.default),o.takeDamage(new u.default(this.data.Common.blockDamage)),this.data.statusNameParryOther.length>0&&this.data.statusRateParry>r.default.getRandomNum(0,100)&&o.addStatus(this.data.statusNameParryOther,new f.default),this.data.statusNameParrySelf.length>0&&this.data.statusRateParry>r.default.getRandomNum(0,100)&&t.addStatus(this.data.statusNameParrySelf,new f.default)),this.status==i.STATUS_DEFEND&&(this.data.statusNameBlockOther.length>0&&this.data.statusRateBlock>r.default.getRandomNum(0,100)&&o.addStatus(this.data.statusNameBlockOther,new f.default),this.data.statusNameBlockSelf.length>0&&this.data.statusRateBlock>r.default.getRandomNum(0,100)&&t.addStatus(this.data.statusNameBlockSelf,new f.default))),this.status==i.STATUS_PARRY?i.BLOCK_PARRY:i.BLOCK_NORMAL},e.prototype.destroySmoke=function(t){t&&(t.active=!1,this.blocklightPool&&this.blocklightPool.put(t))},e.prototype.playIdle=function(){if(this.status!=i.STATUS_DEFEND&&this.status!=i.STATUS_PARRY&&this.status!=i.STATUS_IDLE){this.status=i.STATUS_IDLE,cc.log("\u7b49\u5f85 isBehind:"+this.isBehind+" zIndex:"+this.node.zIndex),this.sprite.node.stopAllActions();var t=1==this.data.isHeavy?.4:.2,e=cc.tween().to(t,{y:2}).to(t,{y:-2});cc.tween(this.sprite.node).repeatForever(e).start()}},e.prototype.playParry=function(){var t=this;if(this.status!=i.STATUS_PUTDOWN&&this.status!=i.STATUS_DEFEND&&this.status!=i.STATUS_PARRY){this.status=i.STATUS_PARRY;var e=1==this.data.isHeavy?.15:.1,o=1==this.data.isHeavy?.1:.15;cc.log("\u4e3e\u8d77 isBehind:"+this.isBehind+" zIndex:"+this.node.zIndex),cc.tween(this.node).to(e,{position:i.TRANSFORM_POS[this.dir]}).call(function(){t.node.zIndex=t.isBehind?t.avatarZindex+i.ZOFFSET:t.avatarZindex-i.ZOFFSET,t.sprite.node.color=t.isBehind?cc.Color.WHITE:cc.color(32,32,32)}).to(e,{position:i.DEFEND_POS[this.dir]}).delay(o).call(function(){t.isButtonPressing?t.playDefend():t.playPutDown()}).start()}},e.prototype.playDefend=function(){this.status!=i.STATUS_PUTDOWN&&this.status!=i.STATUS_DEFEND&&(this.status=i.STATUS_DEFEND,cc.log("\u9632\u5fa1 isBehind:"+this.isBehind+" zIndex:"+this.node.zIndex))},e.prototype.playPutDown=function(){var t=this;if(this.status!=i.STATUS_PUTDOWN&&this.status!=i.STATUS_IDLE){var e=this.isBehindChange?!this.isBehind:this.isBehind;this.status=i.STATUS_PUTDOWN;var o=1==this.data.isHeavy?.2:.1;cc.log("\u653e\u4e0b isBehind:"+this.isBehind+" isBehindTemp:"+e+" zIndex:"+this.node.zIndex),cc.tween(this.node).to(o,{position:i.TRANSFORM_POS[this.dir]}).call(function(){t.node.zIndex=e?t.avatarZindex-i.ZOFFSET:t.avatarZindex+i.ZOFFSET,t.sprite.node.color=e?cc.color(32,32,32):cc.Color.WHITE}).to(o,{position:i.DEFAULT_POS[this.dir]}).call(function(){t.playIdle()}).start()}},e.prototype.changeZIndexByDir=function(t,e){if(!this.isAniming){this.avatarZindex=t,this.dir=e;var o=this.status==i.STATUS_DEFEND,a=t-i.ZOFFSET;switch(e){case s.default.DIR_UP:a=t+(o?-i.ZOFFSET:i.ZOFFSET),this.sprite.node.color=o?cc.color(32,32,32):cc.Color.WHITE;break;case s.default.DIR_DOWN:a=t+(o?i.ZOFFSET:-i.ZOFFSET),this.sprite.node.color=o?cc.Color.WHITE:cc.color(32,32,32);break;case s.default.DIR_LEFT:case s.default.DIR_RIGHT:a=t+(o?i.ZOFFSET:-i.ZOFFSET),this.sprite.node.color=o?cc.Color.WHITE:cc.color(32,32,32)}var n=this.isBehind;this.isBehind=e!=s.default.DIR_UP,this.isBehindChange=this.isBehind!=n,this.node.zIndex=a,this.node.position=o?i.DEFEND_POS[e]:i.DEFAULT_POS[e]}},e.prototype.use=function(){this.isButtonPressing=!0,this.data.equipmetType==g.default.SHIELD&&this.status!=i.STATUS_PUTDOWN&&(this.isDefendOrParrying||this.playParry())},e.prototype.cancel=function(){this.isButtonPressing=!1,this.status==i.STATUS_DEFEND&&this.playPutDown()},e.prototype.changeRes=function(t){!t||t.length<1||(this.sprite.spriteFrame=r.default.spriteFrameRes(t),this.sprite.node.width=1==this.data.isHeavy?80:64,this.sprite.node.height=1==this.data.isHeavy?80:64,this.data.equipmetType==g.default.SHIELD&&this.playIdle())},e.BLOCK_FAILED=0,e.BLOCK_NORMAL=1,e.BLOCK_PARRY=2,e.STATUS_IDLE=0,e.STATUS_PARRY=1,e.STATUS_DEFEND=2,e.STATUS_PUTDOWN=3,e.ZOFFSET=2,e.DEFAULT_POS=[cc.v3(0,32),cc.v3(0,48),cc.v3(-8,48),cc.v3(-8,48)],e.TRANSFORM_POS=[cc.v3(32,40),cc.v3(32,40),cc.v3(10,44),cc.v3(10,44)],e.DEFEND_POS=[cc.v3(0,48),cc.v3(0,32),cc.v3(24,40),cc.v3(24,40)],n([v(cc.Sprite)],e.prototype,"sprite",void 0),n([v(cc.Prefab)],e.prototype,"blockLightPrefab",void 0),i=n([m],e)}(cc.Component);i.default=E,cc._RF.pop()},{"./Data/DamageData":"DamageData","./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./Effect/BlockLight":"BlockLight","./EventHelper":"EventHelper","./Logic":"Logic","./Manager/InventoryManager":"InventoryManager","./Manager/StatusManager":"StatusManager","./PlayerAvatar":"PlayerAvatar","./Utils/IndexZ":"IndexZ"}],Shooter:[function(t,e,i){"use strict";cc._RF.push(e,"f9805u1Wn9OeouYmQSWcHcq","Shooter");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Item/Bullet"),s=t("./Logic"),l=t("./Data/EquipmentData"),c=t("./Data/BulletData"),h=t("./Utils/AudioPlayer"),p=t("./Data/FromData"),u=t("./Data/DamageData"),d=t("./Utils/IndexZ"),f=t("./Actor/AreaOfEffect"),g=t("./Actor/ColliderTag"),y=t("./Manager/InventoryManager"),m=t("./Utils/ActorUtils"),v=cc._decorator,E=v.ccclass,_=v.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet=null,e.isAI=!1,e.isFromPlayer=!1,e.dungeon=null,e.player=null,e.isEx=!1,e.isAutoAim=!0,e.bulletName="",e.data=new l.default,e.hv=cc.v3(1,0),e.isAiming=!1,e.remoteDamagePlayer=new u.default,e.from=new p.default,e.skipTopwall=!1,e.aoePools={},e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.graphics=this.getComponent(cc.Graphics),this.bulletPool=new cc.NodePool(r.default),this.sprite=this.node.getChildByName("sprite"),this.anim=this.getComponent(cc.Animation)},e.prototype.playWalk=function(t){this.anim&&(t?this.anim.play("ShooterWalk"):(this.anim.pause(),this.sprite.y=0))},e.prototype.changeRes=function(t,e){if(this.sprite||(this.sprite=this.node.getChildByName("sprite")),this.sprite){var i=this.getSpriteFrameByName(t,e);this.sprite.getComponent(cc.Sprite).spriteFrame=i,this.sprite.width=1.5*i.getRect().width,this.sprite.height=1.5*i.getRect().height,this.sprite.anchorX=.2,1==this.data.far&&(this.sprite.width=2*this.sprite.width,this.sprite.height=2*this.sprite.height,this.sprite.anchorX=.5)}},e.prototype.changeResColor=function(t){this.sprite.color=t},e.prototype.getSpriteFrameByName=function(t,e){var i=s.default.spriteFrameRes(t+e);return i||(i=s.default.spriteFrameRes(t+"anim0")),i||(i=s.default.spriteFrameRes(t)),i},e.prototype.setHv=function(t){var e=this.hasNearEnemy();e.equals(cc.Vec3.ZERO)?this.hv=t.normalizeSelf():(this.rotateColliderManager(cc.v3(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e)},e.prototype.getAoeNode=function(t,e){var i=null;return this.aoePools[t.name]||(this.aoePools[t.name]=new cc.NodePool(f.default)),this.aoePools[t.name]&&this.aoePools[t.name].size()>0&&e&&(i=this.aoePools[t.name].get()),i&&!i.active||(i=cc.instantiate(t)),i.opacity=255,i.active=!0,i},e.prototype.destroyAoePrefab=function(t,e){this.aoePools[t.name]||(this.aoePools[t.name]=new cc.NodePool(f.default)),e.active=!1,this.aoePools[t.name]&&this.aoePools[t.name].put(e)},e.prototype.fireAoe=function(t,e,i,o,a,n){var r=this;if(!this.dungeon)return null;o||(o=0);var s=this.getAoeNode(t,n).getComponent(f.default);if(s){var l=this.node.convertToWorldSpaceAR(i||cc.v3(30,0));l=this.dungeon.node.convertToNodeSpaceAR(l),s.show(this.dungeon.node,l,this.hv,o,e,a,n,function(e){n&&r.destroyAoePrefab(t,e)})}return s},e.prototype.fireBullet=function(t,e,i,o,a,n){1==this.data.isLineAim&&this.graphics?this.aimTargetLine(t,e,i,o,a,n):this.fireBulletDo(t,e,i,o,a,n)},e.prototype.fireBulletDo=function(t,e,i,o,a,n){var r=this;this.sprite&&(this.sprite.stopAllActions(),this.sprite.position=cc.Vec3.ZERO,cc.tween(this.sprite).by(.1,{position:cc.v3(10,0)}).call(function(){r.changeRes(r.data.img,"anim1")}).by(.05,{position:cc.v3(-5,0)}).by(.05,{position:cc.v3(0,0)}).call(function(){r.changeRes(r.data.img,"anim0")}).start()),t||(t=0),this.dungeon&&(this.isAI||this.isEx||this.player.inventoryManager.equips[y.default.REMOTE].equipmetType==y.default.REMOTE)&&(this.data.remoteAudio&&this.data.remoteAudio.length>0?h.default.play(this.data.remoteAudio):h.default.play(h.default.SHOOT),this.fire(this.data.bulletType,this.bullet,this.bulletPool,t,this.hv.clone(),e,a,n),this.fireArcBullet(this.data.bulletType,e,i,a,n),this.fireLinecBullet(this.data.bulletType,t,e,i,o,a,n))},e.prototype.fireArcBullet=function(t,e,o,a,n){var r=o?this.data.bulletArcExNum+o:this.data.bulletArcExNum;if(!(r<=0)){var s=[10,-10,20,-20,30,-30,40,-40,50,-50,60,-60,-70,-70,80,-80,90,-90,100,-100,110,-110,120,-120,130,-130,140,-140,150,-150,160,-160,170,-170,180,-180];if(this.data.bulletArcExNum>s.length){var l=[0,20,45,65,90,110,135,155,180,200,225,245,270,290,315,335];this.data.bulletArcExNum==i.ARC_EX_NUM_8&&(l=[0,45,90,135,180,225,270,315,335]);for(var c=0;c<l.length;c++)this.fire(t,this.bullet,this.bulletPool,l[c],this.hv.clone(),e,a,n)}else for(c=0;c<r;c++)c<s.length&&this.fire(t,this.bullet,this.bulletPool,s[c],this.hv.clone(),e,a,n)}},e.prototype.fireLinecBullet=function(t,e,i,o,a,n,r){var s=this,l=a?this.data.bulletLineExNum+a:this.data.bulletLineExNum;0!=l&&this.schedule(function(){s.fire(t,s.bullet,s.bulletPool,e,s.hv.clone(),i,n,r),s.fireArcBullet(t,i,o,n,r)},this.data.bulletLineInterval>0?this.data.bulletLineInterval:.2,l,0)},e.prototype.fire=function(t,e,i,o,a,n,l,h){var p=null;i.size()>0&&(p=i.get()),p&&!p.active||(p=cc.instantiate(e)),p.parent=this.node;var u=this.node.convertToWorldSpaceAR(n||cc.v3(30,0));u=this.dungeon.node.convertToNodeSpaceAR(u),p.parent=this.dungeon.node,p.position=u,p.scaleX=1,p.scaleY=1,p.active=!0;var f=p.getComponent(r.default);f.shooter=this,f.node.scaleY=this.node.scaleX>0?1:-1,f.node.zIndex=d.default.OVERHEAD,f.isFromPlayer=!this.isAI||this.isFromPlayer,f.dungeon=this.dungeon,f.skipTopwall=this.skipTopwall;var g=new c.default;g.valueCopy(s.default.bullets[t]),f.isFromPlayer&&this.player&&!this.isEx&&(g.damage.physicalDamage=this.remoteDamagePlayer.physicalDamage,g.damage.isCriticalStrike=this.remoteDamagePlayer.isCriticalStrike),g.size+=this.data.bulletSize,g.speed+=this.data.bulletExSpeed,g.speed+this.data.bulletExSpeed>50&&(g.speed+=this.data.bulletExSpeed),g.from.valueCopy(this.from),f.changeBullet(g),this.bulletName=f.name+g.resName,f.enabled=!0,f.aoeData.valueCopy(h),f.aoePrefab=l,f.showBullet(cc.v3(cc.v2(a).rotateSelf(o*Math.PI/180)))},e.prototype.destroyBullet=function(t){t.active=!1;var e=t.getComponent(r.default);this.bulletPool&&e.name==this.bulletName&&this.bulletPool.put(t)},e.prototype.start=function(){},e.prototype.drawLine=function(t,e,i){this.graphics&&(this.graphics.clear(),this.graphics.fillColor=t,this.graphics.circle(0,0,i/2+1),this.graphics.circle(e,0,i/2+1),this.graphics.rect(0,-i/2,e,i),this.graphics.fill())},e.prototype.getRayCastPoint=function(t,e){var i=e||cc.v3(0,0),o=t||3e3,a=cc.v3(o,0),n=this.node.convertToWorldSpaceAR(i),r=this.node.convertToWorldSpaceAR(a),l=cc.director.getPhysicsManager().rayCast(cc.v2(n),cc.v2(r),cc.RayCastType.All),c=new Array;if(l.length>0)for(var h=0,p=l;h<p.length;h++){var u=p[h];this.isValidRayCastCollider(u.collider)&&(a=this.node.convertToNodeSpaceAR(cc.v3(u.point)),c.push(a))}for(var d=o,f=0,g=c;f<g.length;f++){var y=g[f],m=s.default.getDistance(y,i);d>=m&&(d=m,a=y)}return a},e.prototype.isValidRayCastCollider=function(t){var e=!1;return this.isAI?t.tag!=g.ColliderTag.NONPLAYER&&t.tag!=g.ColliderTag.BOSS||(e=!0):t.tag==g.ColliderTag.PLAYER&&(e=!0),t.tag==g.ColliderTag.BULLET&&(e=!0),t.sensor&&(e=!0),!e},e.prototype.aimTargetLine=function(t,e,i,o,a,n){var r=this;if(!this.isAiming&&(this.isAiming=!0,this.graphics)){var s=0,l=this.getRayCastPoint(),c=!1,h=function(){s<1&&c?(r.fireBulletDo(t,e,i,o,a,n),r.unschedule(h),r.graphics.clear(),r.isAiming=!1):r.drawLine(cc.color(255,0,0,200),l.x,s),s>10&&!c?c=!0:c?s-=1:s+=1};this.schedule(h,.02,30)}},e.prototype.drawArc=function(t){if(this.graphics&&(this.graphics.clear(),!(t<0))){var e=1e3,i=2*-t*Math.PI/360,o=2*t*Math.PI/360,a=cc.v3(e*Math.cos(i),e*Math.sin(i)),n=cc.v3(e*Math.cos(o),e*Math.sin(o));this.graphics.arc(0,0,e,2*Math.PI-i,2*Math.PI-o),this.graphics.fill(),this.graphics.moveTo(0,0),this.graphics.lineTo(a.x,a.y),this.graphics.lineTo(n.x,n.y),this.graphics.close(),this.graphics.fill()}},e.prototype.update=function(){if(!s.default.isGamePause){var t=this.hasNearEnemy();if(t.equals(cc.Vec3.ZERO)){if(0!=this.hv.x||0!=this.hv.y){var e=cc.v3(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(e)}}else this.rotateColliderManager(cc.v3(this.node.position.x+t.x,this.node.position.y+t.y)),this.hv=t}},e.prototype.getParentNode=function(){return this.parentNode?this.parentNode:this.node.parent},e.prototype.hasNearEnemy=function(){if(!this.isAutoAim)return cc.Vec3.ZERO;var t=1e3,e=cc.v3(0,0);if(this.isAI);else if(this.dungeon){var i=m.default.getNearestEnemyActor(this.player,!1,this.dungeon);if(i){var o=s.default.getDistance(this.getParentNode().position,i.node.position);if(o<600&&o<t&&!i.sc.isDied&&!i.sc.isDisguising){t=o;var a=this.node.position.clone();a.x=this.node.scaleX>0?a.x:-a.x;var n=i.node.position.clone();n.y+=32,e=n.sub(this.getParentNode().position.add(a))}}1e3!=t&&(e=e.normalizeSelf())}return e},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),i=360/(2*Math.PI),o=360-Math.atan2(e.x,e.y)*i;this.node.scaleX=this.getParentNode().scaleX>0?1:-1,this.node.scaleY=this.getParentNode().scaleX>0?1:-1,o+=90,this.node.angle=-1==this.node.scaleX?-o:o},e.DefAULT_SPEED=300,e.ARC_EX_NUM_8=80,e.ARC_EX_NUM_16=99,n([_(cc.Prefab)],e.prototype,"bullet",void 0),n([_],e.prototype,"isAI",void 0),i=n([E],e)}(cc.Component);i.default=D,cc._RF.pop()},{"./Actor/AreaOfEffect":"AreaOfEffect","./Actor/ColliderTag":"ColliderTag","./Data/BulletData":"BulletData","./Data/DamageData":"DamageData","./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./Item/Bullet":"Bullet","./Logic":"Logic","./Manager/InventoryManager":"InventoryManager","./Utils/ActorUtils":"ActorUtils","./Utils/AudioPlayer":"AudioPlayer","./Utils/IndexZ":"IndexZ"}],ShopMart:[function(t,e,i){"use strict";cc._RF.push(e,"1b8085+xzBE16cPL5KYFJeE","ShopMart");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Player"),s=t("./Building"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.open=function(){},e.prototype.close=function(){},e.prototype.onCollisionEnter=function(t){t.node.getComponent(r.default)&&this.open()},e.prototype.onCollisionExit=function(t){t.node.getComponent(r.default)&&this.close()},n([c],e)}(s.default));i.default=h,cc._RF.pop()},{"../Player":"Player","./Building":"Building"}],ShopTable:[function(t,e,i){"use strict";cc._RF.push(e,"feb404aValPAJxRKh4uvHLm","ShopTable");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("./Building"),c=t("../Utils/IndexZ"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.info=this.node.getChildByName("info"),this.label=this.info.getComponentInChildren(cc.Label)},e.prototype.start=function(){},e.prototype.showItem=function(){if(this.node.parent)if(this.data.isSaled)this.sale(!0);else{var t=this.node.parent.getComponent(r.default);if(t){var e=s.default.mapManager.getRandom4Save(s.default.mapManager.getRebornSeed(this.seed));this.data.shopType==i.EQUIPMENT?t.addEquipment(s.default.getRandomEquipType(e),r.default.getPosInMap(this.data.defaultPos),this.data.equipdata,3,this):this.data.shopType==i.ITEM&&t.addItem(r.default.getPosInMap(this.data.defaultPos),s.default.getRandomItemType(e),0,this)}this.sale(!1)}},e.prototype.setDefaultPos=function(t){this.data.defaultPos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=c.default.getActorZIndex(this.node.position)},e.prototype.sale=function(t){this.info||(this.info=this.node.getChildByName("info")),this.label||(this.label=this.info.getComponentInChildren(cc.Label)),this.data.isSaled=t,this.label.string=""+this.data.price,this.info.opacity=this.data.isSaled?0:255;var e=s.default.mapManager.getCurrentMapBuilding(this.data.defaultPos);e&&e.valueCopy(this.data)},e.EQUIPMENT=0,e.ITEM=1,i=n([p],e)}(l.default));i.default=u,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic","../Utils/IndexZ":"IndexZ","./Building":"Building"}],SlimeVenom:[function(t,e,i){"use strict";cc._RF.push(e,"a7fa4vRR+xDO6TrjB6jQViO","SlimeVenom");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Logic"),s=t("../Data/DamageData"),l=t("../Base/Actor"),c=t("../Data/FromData"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHide=!1,e.isForever=!1,e.from=c.default.getClone("\u53f2\u83b1\u59c6\u6bd2\u6db2","venom"),e.checkTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.venom1=this.node.getChildByName("sprite").getChildByName("venom1"),this.venom2=this.node.getChildByName("sprite").getChildByName("venom2"),this.venom3=this.node.getChildByName("sprite").getChildByName("venom2"),this.anim=this.getComponent(cc.Animation),this.sprite=this.node.getChildByName("sprite")},e.prototype.onEnable=function(){var t=this;this.isHide=!1,this.sprite.opacity=255,this.venom1.angle=r.default.getRandomNum(0,180),this.venom2.angle=r.default.getRandomNum(0,180),this.venom2.angle=r.default.getRandomNum(0,180),this.anim.play(),this.isForever||this.scheduleOnce(function(){t.anim&&(t.isHide=!0,t.anim.play("VenomHide"),t.scheduleOnce(function(){cc.director.emit("destoryvenom",{detail:{coinNode:t.node}})},1.5))},3),this.damagePlayer(this.from)},e.prototype.addStatus=function(){},e.prototype.getNearPlayerDistance=function(t){return r.default.getDistance(this.node.position,t.position)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){r.default.isGamePause||this.isCheckTimeDelay(t)&&this.damagePlayer(this.from)},e.prototype.damagePlayer=function(t){if(this.target&&this.getNearPlayerDistance(this.target.node)<60*this.node.scale&&this.node.active&&!this.isHide){var e=new s.default;e.magicDamage=3,this.target.takeDamage(e,t)}},e.prototype.getCenterPosition=function(){return this.node.position.clone()},e.prototype.takeDamage=function(){return!1},e.prototype.actorName=function(){return"\u53f2\u83b1\u59c6\u6bd2\u6db2"},e.prototype.takeDizz=function(){},e.prototype.updateStatus=function(){},e.prototype.hideSelf=function(){},e.prototype.updateDream=function(){return 0},e.prototype.setLinearVelocity=function(){},n([p],e)}(l.default));i.default=u,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Logic":"Logic"}],Slime:[function(t,e,i){"use strict";cc._RF.push(e,"263b6VIDCJP+LELMRjXCL3M","Slime");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../EventHelper"),l=t("../Logic"),c=t("../Dungeon"),h=t("./SlimeVenom"),p=t("../Manager/MonsterManager"),u=t("../Utils/NextStep"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Item/Item"),m=t("../Utils/IndexZ"),v=t("../Utils/ActorUtils"),E=cc._decorator,_=E.ccclass,D=E.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.venom=null,e.healthBar=null,e.isFaceRight=!0,e.isMoving=!1,e.timeDelay=0,e.isHurt=!1,e.isCrownFall=!1,e.isDashing=!1,e.currentlinearVelocitySpeed=cc.Vec2.ZERO,e.scaleSize=1,e.slimeType=0,e.meleeSkill=new u.default,e.venomTimeDelay=0,e.childSlimeTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.meleeSkill.IsExcuting=!1,this.sc.isDied=!1,this.anim=this.getComponent(cc.Animation),this.rigidbody=this.getComponent(cc.RigidBody),this.updatePlayerPos(),this.venomPool=new cc.NodePool,this.sprite=this.node.getChildByName("sprite"),this.crown=this.sprite.getChildByName("crown"),this.decorate=this.node.getChildByName("sprite").getChildByName("body").getChildByName("decorate"),this.dashlight=this.sprite.getChildByName("dashlight"),this.dashlight.opacity=0,s.EventHelper.on("destoryvenom",function(e){t.destroyVenom(e.coinNode)}),this.scheduleOnce(function(){t.sc.isShow=!0},1)},e.prototype.start=function(){t.prototype.start.call(this),this.crown&&0!=this.slimeType&&(this.crown.opacity=0),this.decorate&&this.slimeType>2&&(this.decorate.opacity=0)},e.prototype.getVenom=function(t,e){if(!(this.scaleSize<1||this.sc.isDied)){var i=null;this.venomPool.size()>0&&(i=this.venomPool.get()),i&&!i.active||(i=cc.instantiate(this.venom)),i.parent=t,i.position=e,i.scale=0==this.slimeType?1.5:1,i.getComponent(h.default).target=this.dungeon.player,i.zIndex=m.default.getActorZIndex(this.node.position),i.opacity=255,i.active=!0}},e.prototype.destroyVenom=function(t){t&&(t.active=!1,this.venomPool&&this.venomPool.put(t))},e.prototype.AnimAttacking=function(){this.meleeSkill.IsExcuting=!1;var t=64+50*this.scaleSize,e=v.default.getNearestEnemyActor(this,!0,this.dungeon);v.default.getNearestTargetDistance(this,e)<t&&e&&e.takeDamage(this.data.getAttackPoint(),f.default.getClone(this.actorName(),"bossslimehelmet"),this)},e.prototype.onCollisionEnter=function(t){var e=v.default.getEnemyCollisionTarget(t);e&&this.isDashing&&this.dungeon&&!this.isHurt&&!this.sc.isDied&&(this.isDashing=!1,this.rigidbody.linearVelocity=cc.Vec2.ZERO,e.takeDamage(this.data.getAttackPoint(),f.default.getClone(this.actorName(),"bossslimehelmet"),this))},e.prototype.isVenomTimeDelay=function(t){return this.venomTimeDelay+=t,this.venomTimeDelay>.2&&(this.venomTimeDelay=0,!0)},e.prototype.isChildSlimeTimeDelay=function(t){return this.childSlimeTimeDelay+=t,this.childSlimeTimeDelay>5&&(this.childSlimeTimeDelay=0,!0)},e.prototype.updateLogic=function(t){if(this.healthBar.node.active=!this.sc.isDied,this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,this.bossAction()),this.dashlight.opacity=0,this.dungeon&&this.isDashing&&(this.dashlight.opacity=128,this.rigidbody.linearVelocity=this.currentlinearVelocitySpeed.clone()),this.dungeon&&this.getNearPlayerDistance(this.dungeon.player.node)<64&&!this.isHurt&&(this.rigidbody.linearVelocity=cc.v2(0,0)),this.sc.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.healthBar.node.active=!this.sc.isDied,this.data.currentHealth<1&&this.killed(),this.node.scaleY=this.scaleSize,this.node.scaleX=this.isFaceRight?this.scaleSize:-this.scaleSize,this.isVenomTimeDelay(t)&&this.isMoving&&!this.meleeSkill.IsExcuting&&this.getVenom(this.node.parent,this.node.position),this.isChildSlimeTimeDelay(t)&&!this.sc.isDied&&0==this.slimeType&&this.dungeon){for(var e=0,i=0,o=this.dungeon.monsterManager.monsterList;i<o.length;i++)o[i].sc.isDied||e++;if(e<10&&this.dungeon.monsterManager.monsterList.length<50){var a=c.default.getIndexInMap(this.node.position.clone());this.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_SLIME,a,this.dungeon,!0)}}},e.prototype.takeDamage=function(t){var e=this;return!(this.sc.isDied||!this.sc.isShow||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.isHurt=!0,this.isDashing=!1,this.scheduleOnce(function(){e.node&&(e.isHurt=!1)},.1),this.anim.play("SlimeHit"),this.meleeSkill.IsExcuting=!1,this.data.currentHealth<this.data.Common.maxHealth/2&&!this.isCrownFall&&0==this.slimeType&&(this.isCrownFall=!0,this.sc.isShow=!1,this.scheduleOnce(function(){e.sc.isShow=!0,e.crown.opacity=0},1),this.anim.play("SlimeCrownFall")),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;if(!this.sc.isDied&&(this.sc.isDied=!0,this.isDashing=!1,this.anim.play("SlimeDie"),this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.dungeon)){if(0==this.slimeType){var e=l.default.mapManager.getRandom4Save(this.seed);g.default.addMonsterKillAchievement(this.data.resName),cc.director.emit(s.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:y.default.HEART}}),cc.director.emit(s.EventHelper.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:y.default.DREAM}}),this.dungeon.addEquipment(l.default.getRandomEquipType(e),c.default.getPosInMap(this.pos),null,3)}this.slimeType<i.DIVIDE_COUNT&&(cc.director.emit(s.EventHelper.DUNGEON_ADD_COIN,{detail:{pos:this.node.position,count:5}}),s.EventHelper.emit(s.EventHelper.DUNGEON_ADD_OILGOLD,{pos:this.node.position,count:100}),cc.director.emit(s.EventHelper.BOSS_ADDSLIME,{detail:{posIndex:this.pos.clone(),slimeType:this.slimeType+1}}),cc.director.emit(s.EventHelper.BOSS_ADDSLIME,{detail:{posIndex:this.pos.clone(),slimeType:this.slimeType+1}}))}},e.prototype.bossAction=function(){var t=this;if(!this.sc.isDied&&this.dungeon&&!this.isHurt){var e=cc.v3(0,0);e.x+=l.default.getRandomNum(0,2e3)-1e3,e.y+=l.default.getRandomNum(0,2e3)-1e3;var i=this.getNearPlayerDistance(this.dungeon.player.node);this.node.position=c.default.fixOuterMap(this.node.position),this.pos=c.default.getIndexInMap(this.node.position),this.changeZIndex();var o=e.clone();i<64+50*this.scaleSize&&!this.dungeon.player.sc.isDied&&!this.isDashing&&this.sc.isShow&&this.scaleSize>=1&&((o=this.dungeon.player.getCenterPosition().sub(this.node.position)).equals(cc.Vec3.ZERO)||(o=o.normalizeSelf()),this.anim.getAnimationState("SlimeAttack").isPlaying||(this.meleeSkill.IsExcuting=!0,this.anim.play("SlimeAttack")));var a=300-50*this.scaleSize;i>128+35*this.scaleSize&&!this.dungeon.player.sc.isDied&&!this.isDashing&&this.sc.isShow&&l.default.getHalfChance()&&(cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),l.default.getHalfChance()&&(o=this.dungeon.player.getCenterPosition().sub(this.node.position)),this.move(o,1.5*a),this.isDashing=!0,this.scheduleOnce(function(){t.node&&(t.isDashing=!1)},2)),l.default.getRandomNum(1,10)<3&&this.move(o,a)}},e.prototype.move=function(t,e){if(!(this.sc.isDied||this.isHurt||this.isDashing||!this.sc.isShow||this.meleeSkill.IsExcuting||t.equals(cc.Vec3.ZERO))){t=t.normalizeSelf(),this.meleeSkill.IsExcuting&&!t.equals(cc.Vec3.ZERO)&&(t=t.mul(.5)),t.equals(cc.Vec3.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a.clone(),this.currentlinearVelocitySpeed=a.clone(),this.isMoving=0!=i||0!=o,this.isMoving&&(this.isFaceRight=i>0);var n=this.anim.getAnimationState("SlimeAttack").isPlaying;this.anim.getAnimationState("SlimeIdle").isPlaying||n||this.anim.play("SlimeIdle"),this.changeZIndex()}},e.prototype.actorName=function(){return"\u53f2\u83b1\u59c6\u4e4b\u738b"},e.DIVIDE_COUNT=4,n([D(cc.Prefab)],e.prototype,"venom",void 0),i=n([_],e)}(r.default);i.default=S,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Item/Item":"Item","../Logic":"Logic","../Manager/MonsterManager":"MonsterManager","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","../Utils/NextStep":"NextStep","./Boss":"Boss","./SlimeVenom":"SlimeVenom"}],SpecialManager:[function(t,e,i){"use strict";cc._RF.push(e,"e58b4559dND3JlWZESKg4rV","SpecialManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Boss/SlimeVenom"),s=t("../Data/DamageData"),l=t("./StatusManager"),c=t("../NonPlayer"),h=t("../Utils/IndexZ"),p=t("../Actor/AreaOfEffect"),u=t("../Data/AreaOfEffectData"),d=t("../Logic"),f=t("../EventHelper"),g=t("../Utils/AudioPlayer"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aoe=null,e.venom=null,e.howl=null,e.claw=null,e.blade=null,e}var i;return a(e,t),i=e,e.prototype.clear=function(){},e.prototype.addPlacement=function(t,e,o,a,n){if(this.dungeon){var r=this.node.convertToWorldSpaceAR(cc.v3(e,0));switch(r=this.dungeon.node.convertToNodeSpaceAR(r),t){case i.AFTER_VENOM:this.addVenom(r,o,a,n);break;case i.AFTER_CLAW:this.addClaw(r,o,a,n);break;case i.AFTER_BLADE:this.addBlade(r,o,a,n);break;case i.AFTER_ASH:this.addAoe(r,(new u.default).init(.3,.3,.1,n?4:3,h.default.getActorZIndex(this.node.parent.position),!0,!0,!0,!1,!1,new s.default(2),a,[l.default.DIZZ]),["ash001","ash002","ash003","ash004"],!1,o),cc.director.emit(f.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!0}});break;case i.AFTER_ICE:g.default.play(g.default.ICEBOOM),this.addAoe(r,(new u.default).init(.8,1,.2,n?3:2,h.default.getActorZIndex(this.node.parent.position),!0,!0,!0,!1,!1,new s.default(3),a,[l.default.FROZEN]),["ice001","ice002","ice002","ice003","ice004"],!1,o),cc.director.emit(f.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}});break;case i.AFTER_DOWN:this.addAoe(r,(new u.default).init(.3,1,.1,n?2:1,h.default.getActorZIndex(this.node.parent.position),!0,!0,!0,!1,!1,new s.default(1),a,[l.default.FALLEN_DOWN]),["ash001","ash002","ash003","ash004"],!1,o),cc.director.emit(f.EventHelper.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}});break;case i.AFTER_SWORD:r.y+=32,this.addAoe(r,(new u.default).init(.4,.1,0,n?3:2,h.default.getActorZIndex(this.node.parent.position),!0,!0,!0,!1,!1,new s.default(4),a,[l.default.BLEEDING]),["specialswordlight001","specialswordlight002","specialswordlight003","specialswordlight004"],!1,o)}}},e.prototype.addEffect=function(t,e,o,a,n){if(this.dungeon){var r=this.node.convertToWorldSpaceAR(cc.v3(e,0));switch(r=this.dungeon.node.convertToNodeSpaceAR(r),t){case i.BEFORE_HOWL:this.addHowl(r,o,a,n)}}},e.prototype.addVenom=function(t,e,i,o){var a=cc.instantiate(this.venom);a.getComponent(r.default).target=this.dungeon.player,a.getComponent(r.default).isForever=!1,a.getComponent(r.default).from.valueCopy(i),a.parent=this.dungeon.node,a.position=t,a.zIndex=h.default.ACTOR,a.scale=0,cc.tween(a).to(.5,{scale:o?3:2}).start()},e.prototype.addHowl=function(t,e,i,o){var a=this.node.parent.getComponent(c.default);a&&a.addStatus(l.default.WEREWOLFDEFENCE,i);var n=cc.instantiate(this.howl);n.getComponent(p.default).show(this.dungeon.node,t,cc.v3(1,0),0,(new u.default).init(0,2,1.5,o?3:2,h.default.getActorZIndex(n.position),!0,!1,!0,!1,!1,new s.default(1),i,[l.default.DIZZ]))},e.prototype.addClaw=function(t,e,i,o){var a=cc.instantiate(this.claw);t.y+=32,a.getComponent(p.default).show(this.dungeon.node,t,cc.v3(1,0),0,(new u.default).init(0,.15,.1,o?2:1,h.default.getActorZIndex(a.position),!0,!1,!0,!1,!1,new s.default(2),i,[l.default.BLEEDING]))},e.prototype.addAoe=function(t,e,i,o,a){var n=cc.instantiate(this.aoe);t.y+=32;var r=n.getChildByName("sprite").getComponent(cc.Sprite),s=n.getComponent(cc.BoxCollider);if(i.length>0){var l=d.default.spriteFrameRes(i[0]);r.node.width=l.getRect().width,r.node.height=l.getRect().height,r.node.scale=4,r.node.scaleX=a?4:-4,s.size.width=3*r.node.width,s.size.height=3*r.node.height}for(var c=cc.tween(),h=function(t){c.then(cc.tween().delay(.2).call(function(){r.spriteFrame=d.default.spriteFrameRes(t)}))},u=0,f=i;u<f.length;u++)h(f[u]);o?cc.tween(n).repeatForever(c).start():cc.tween(n).then(c).delay(.2).call(function(){r.spriteFrame=null}).start(),n.getComponent(p.default).show(this.dungeon.node,t,cc.v3(1,0),0,e)},e.prototype.addBlade=function(t,e,i,o){var a=cc.instantiate(this.blade);t.y+=64,a.scaleX=e?1:-1,a.getComponent(p.default).show(this.dungeon.node,t,cc.v3(1,0),0,(new u.default).init(0,.2,.1,o?2:1,h.default.getActorZIndex(a.position),!0,!1,!0,!1,!1,new s.default(2),i,[]))},e.BEFORE_HOWL="special015",e.AFTER_VENOM="special019",e.AFTER_CLAW="special024",e.AFTER_BLADE="special008",e.AFTER_ASH="special030",e.AFTER_ICE="special031",e.AFTER_DOWN="special032",e.AFTER_SWORD="special033",n([v(cc.Prefab)],e.prototype,"aoe",void 0),n([v(cc.Prefab)],e.prototype,"venom",void 0),n([v(cc.Prefab)],e.prototype,"howl",void 0),n([v(cc.Prefab)],e.prototype,"claw",void 0),n([v(cc.Prefab)],e.prototype,"blade",void 0),i=n([m],e)}(cc.Component);i.default=E,cc._RF.pop()},{"../Actor/AreaOfEffect":"AreaOfEffect","../Boss/SlimeVenom":"SlimeVenom","../Data/AreaOfEffectData":"AreaOfEffectData","../Data/DamageData":"DamageData","../EventHelper":"EventHelper","../Logic":"Logic","../NonPlayer":"NonPlayer","../Utils/AudioPlayer":"AudioPlayer","../Utils/IndexZ":"IndexZ","./StatusManager":"StatusManager"}],Sphinx:[function(t,e,i){"use strict";cc._RF.push(e,"613334RiSdNUKEp1LtYmQ1e","Sphinx");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../Shooter"),l=t("../Dungeon"),c=t("../Manager/StatusManager"),h=t("../Utils/NextStep"),p=t("../Manager/MonsterManager"),u=t("../Utils/AudioPlayer"),d=t("../EventHelper"),f=t("../Data/FromData"),g=t("../Achievement"),y=cc._decorator,m=y.ccclass,v=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.stormSkill=new h.default,e.summonSkill=new h.default,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(s.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(c.default),this.shooter01.from.valueCopy(f.default.getClone(this.actorName(),"sphinxhead"))},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.sc.isDied||!this.sc.isShow||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.playHit(this.node.getChildByName("sprite")),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(g.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){!this.sc.isDied&&this.sc.isShow&&this.dungeon&&(this.changeZIndex(),this.fireStorm(),this.summonMonster())},e.prototype.summonMonster=function(){var t=this;this.dungeon.getMonsterAliveNum()>1||this.summonSkill.next(function(){cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.MELEE}}),t.summonSkill.IsExcuting=!0;var e=l.default.getIndexInMap(t.node.position.clone());t.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_SANDSTATUE,cc.v3(e.x,e.y-1),t.dungeon,!0),t.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_SANDSTATUE,cc.v3(e.x+1,e.y-1),t.dungeon,!0),t.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_SANDSTATUE,cc.v3(e.x-1,e.y-1),t.dungeon,!0),t.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_ANUBIS,cc.v3(e.x-1,e.y-2),t.dungeon,!0),t.dungeon.monsterManager.addMonsterFromData(p.default.MONSTER_ANUBIS,cc.v3(e.x+1,e.y-2),t.dungeon,!0)},15,!0)},e.prototype.fireStorm=function(){var t=this;this.stormSkill.next(function(){t.stormSkill.IsExcuting=!0,t.anim.play("SphinxStorm"),t.scheduleOnce(function(){var e=t.node.position.clone().add(t.shooter01.node.position),i=t.dungeon.player.getCenterPosition().sub(e);i.equals(cc.Vec3.ZERO)||(i=i.normalizeSelf(),t.shooter01.setHv(i),t.fireShooter(t.shooter01,"bullet023",0,-20),t.fireShooter(t.shooter01,"bullet123",0,0,0),t.fireShooter(t.shooter01,"bullet223",0,0,20))},.3),t.scheduleOnce(function(){t.stormSkill.IsExcuting=!1,t.anim.play("SphinxIdle")},2)},8,!0)},e.prototype.fireShooter=function(t,e,i,o,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a,cc.Vec3.ZERO)},e.prototype.showBoss=function(){this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied,this.rigidbody.linearVelocity=cc.Vec2.ZERO},e.prototype.actorName=function(){return"\u65af\u82ac\u514b\u65af"},n([m],e)}(r.default));i.default=v,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Manager/MonsterManager":"MonsterManager","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/NextStep":"NextStep","./Boss":"Boss"}],StackStateMachine:[function(t,e,i){"use strict";cc._RF.push(e,"9d89awtDlhAe5Rtlx6ayPx5","StackStateMachine");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=function(t){function e(e,i,o){return t.call(this,e,i,o)||this}return a(e,t),e.prototype.setInitialState=function(t){this.stateStack=new Array,this.currentState=t},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.getPreviousState=function(){return 0==this.stateStack.length?null:this.stateStack[this.stateStack.length-1]},e.prototype.changeState=function(t){this._changeState(t,!0)},e.prototype.revertToPreviousState=function(){if(0==this.stateStack.length)return!1;var t=this.stateStack.pop();return this._changeState(t,!1),!0},e.prototype._changeState=function(t,e){e&&this.currentState&&this.stateStack.push(this.currentState),this.currentState&&this.currentState.exit(this.owner),this.currentState=t,this.currentState.enter(this.owner)},e}(t("./DefaultStateMachine").default);i.default=n,cc._RF.pop()},{"./DefaultStateMachine":"DefaultStateMachine"}],Start:[function(t,e,i){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Start");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=t("./Utils/AudioPlayer"),l=cc._decorator,c=l.ccclass,h=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startButton=null,e.continueButton=null,e.cheatButton=null,e.debugButton=null,e.tourButton=null,e.cheatClickCount=0,e.debugClickCount=0,e.tourClickCount=0,e}return a(e,t),e.prototype.start=function(){var t=this;this.continueButton&&(this.continueButton.active=r.default.profileManager.hasSaveData,this.continueButton.active?this.scheduleOnce(function(){t.continueButton.getComponent(cc.Animation).play()},2):this.scheduleOnce(function(){t.startButton.getComponent(cc.Animation).play()},2))},e.prototype.startGame=function(){s.default.play(s.default.SELECT),cc.director.loadScene("pickavatar")},e.prototype.chooseChapter=function(){s.default.play(s.default.SELECT),cc.director.loadScene("chapter")},e.prototype.achievementScene=function(){s.default.play(s.default.SELECT),cc.director.loadScene("achievement")},e.prototype.continueGame=function(){r.default.resetData(),r.default.isFirst=1,s.default.play(s.default.SELECT),cc.director.loadScene("loading")},e.prototype.cheatModeChange=function(){this.cheatButton&&(this.cheatClickCount++,this.cheatClickCount>2?(this.cheatClickCount=0,r.default.isCheatMode=!0,this.cheatButton.opacity=r.default.isCheatMode?255:0):(r.default.isCheatMode=!1,this.cheatButton.opacity=0))},e.prototype.debugModeChange=function(){this.debugButton&&(this.debugClickCount++,this.debugClickCount>2?(this.debugClickCount=0,r.default.isDebug=!0,this.debugButton.opacity=r.default.isDebug?255:0,cc.director.getCollisionManager().enabledDebugDraw=!0):(r.default.isDebug=!1,this.debugButton.opacity=0,cc.director.getCollisionManager().enabledDebugDraw=!1))},e.prototype.tourChange=function(){this.tourButton&&(this.cheatClickCount++,this.cheatClickCount>2?(this.cheatClickCount=0,r.default.isTour=!0,this.tourButton.opacity=r.default.isTour?255:0):(r.default.isTour=!1,this.tourButton.opacity=0))},e.prototype.goTest=function(){cc.director.loadScene("test")},n([h(cc.Node)],e.prototype,"startButton",void 0),n([h(cc.Node)],e.prototype,"continueButton",void 0),n([h(cc.Node)],e.prototype,"cheatButton",void 0),n([h(cc.Node)],e.prototype,"debugButton",void 0),n([h(cc.Node)],e.prototype,"tourButton",void 0),n([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer"}],StateContext:[function(t,e,i){"use strict";cc._RF.push(e,"355460dkOZEM7Y62EU2S7oe","StateContext"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){this.isShow=!1,this.isDied=!1,this.isAttacking=!1,this.isDisguising=!1,this.isMoving=!1,this.isDodging=!1,this.isHurting=!1,this.isDashing=!1,this.isDizzing=!1,this.isFalling=!1,this.isBlinking=!1,this.isJumping=!1},cc._RF.pop()},{}],StateMachine:[function(t,e,i){"use strict";cc._RF.push(e,"d6268XDmGFEdZj+80HdRhZG","StateMachine"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],State:[function(t,e,i){"use strict";cc._RF.push(e,"ee6413dVQ9N85ndee/MSlIy","State"),Object.defineProperty(i,"__esModule",{value:!0}),cc._RF.pop()},{}],StatusConditionType:[function(t,e,i){"use strict";cc._RF.push(e,"cfb92WuPb1L4plYKZHdFxR/","StatusConditionType"),Object.defineProperty(i,"__esModule",{value:!0}),i.StatusConditionType=void 0,function(t){t[t.SUITS1=0]="SUITS1",t[t.SUITS2=1]="SUITS2",t[t.SUITS3=2]="SUITS3",t[t.ITEM_REMOVE=3]="ITEM_REMOVE",t[t.ITEM_TICK=4]="ITEM_TICK",t[t.ITEM_USE=5]="ITEM_USE",t[t.MELEE_ATTACK=6]="MELEE_ATTACK",t[t.MELEE_COMBO=7]="MELEE_COMBO",t[t.MELEE_KILL=8]="MELEE_KILL",t[t.REMOTE_ATTACK=9]="REMOTE_ATTACK",t[t.REMOTE_HIT=10]="REMOTE_HIT",t[t.REMOTE_KILL=11]="REMOTE_KILL",t[t.REMOTE_COMBO=12]="REMOTE_COMBO",t[t.SKILL_START=13]="SKILL_START",t[t.SKILL_END=14]="SKILL_END",t[t.SKILL_TICK=15]="SKILL_TICK",t[t.TAKE_DAMAGE=16]="TAKE_DAMAGE",t[t.AOE_HIT=17]="AOE_HIT",t[t.AOE_ADD=18]="AOE_ADD",t[t.AOE_REMOVE=19]="AOE_REMOVE",t[t.AOE_TICK=20]="AOE_TICK",t[t.AOE_KILL=21]="AOE_KILL",t[t.STATUS_KILL=22]="STATUS_KILL",t[t.STANDSTILL=23]="STANDSTILL",t[t.MOVE=24]="MOVE",t[t.DREAM_OUT=25]="DREAM_OUT",t[t.DREAM_FULL=26]="DREAM_FULL",t[t.HEALTH_OUT=27]="HEALTH_OUT",t[t.HEALTH_FULL=28]="HEALTH_FULL",t[t.HEALTH_HALF=29]="HEALTH_HALF",t[t.DISPEL=30]="DISPEL"}(i.StatusConditionType||(i.StatusConditionType={})),cc._RF.pop()},{}],StatusData:[function(t,e,i){"use strict";cc._RF.push(e,"e6cc1ffzwVEGqcTbp1oM4Mh","StatusData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./CommonData"),a=t("./FromData"),n=function(){function t(){this.id=0,this.type=0,this.nameCn="",this.nameEn="",this.duration=0,this.desc="",this.spriteFrameName="",this.physicalDamageDirect=0,this.physicalDamageOvertime=0,this.missRate=0,this.realDamageDirect=0,this.realDamageOvertime=0,this.dreamDirect=0,this.dreamOvertime=0,this.magicDamageDirect=0,this.magicDamageOvertime=0,this.dizzDurationDirect=0,this.dizzDurationOvertime=0,this.invisibleDuratonDirect=0,this.variation=0,this.finishStatus="",this.common=new o.default,this.from=new a.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"From",{get:function(){return this.from},enumerable:!1,configurable:!0}),t.prototype.valueCopy=function(t){t&&(this.common.valueCopy(t.common),this.from.valueCopy(t.from),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn,this.id=t.id?t.id:0,this.type=t.type?t.type:0,this.duration=t.duration?t.duration:0,this.spriteFrameName=t.spriteFrameName,this.desc=t.desc,this.physicalDamageDirect=t.physicalDamageDirect?t.physicalDamageDirect:0,this.physicalDamageOvertime=t.physicalDamageOvertime?t.physicalDamageOvertime:0,this.missRate=t.missRate?t.missRate:0,this.realDamageDirect=t.realDamageDirect?t.realDamageDirect:0,this.realDamageOvertime=t.realDamageOvertime?t.realDamageOvertime:0,this.magicDamageDirect=t.magicDamageDirect?t.magicDamageDirect:0,this.magicDamageOvertime=t.magicDamageOvertime?t.magicDamageOvertime:0,this.dizzDurationDirect=t.dizzDurationDirect?t.dizzDurationDirect:0,this.dizzDurationOvertime=t.dizzDurationOvertime?t.dizzDurationOvertime:0,this.invisibleDuratonDirect=t.invisibleDuratonDirect?t.invisibleDuratonDirect:0,this.dreamDirect=t.dreamDirect?t.dreamDirect:0,this.dreamOvertime=t.dreamOvertime?t.dreamOvertime:0,this.variation=t.variation?t.variation:0,this.finishStatus=t.finishStatus?t.finishStatus:"")},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.from=this.from.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.id=this.id,e.duration=this.duration,e.desc=this.desc,e.physicalDamageDirect=this.physicalDamageDirect,e.physicalDamageOvertime=this.physicalDamageOvertime,e.missRate=this.missRate,e.realDamageDirect=this.realDamageDirect,e.realDamageOvertime=this.realDamageOvertime,e.magicDamageDirect=this.magicDamageDirect,e.magicDamageOvertime=this.magicDamageOvertime,e.spriteFrameName=this.spriteFrameName,e.dizzDurationDirect=this.dizzDurationDirect,e.dizzDurationOvertime=this.dizzDurationOvertime,e.invisibleDuratonDirect=this.invisibleDuratonDirect,e.dreamDirect=this.dreamDirect,e.dreamOvertime=this.dreamOvertime,e.type=this.type,e.variation=this.variation,e.finishStatus=this.finishStatus,e},t}();i.default=n,cc._RF.pop()},{"./CommonData":"CommonData","./FromData":"FromData"}],StatusEventType:[function(t,e,i){"use strict";cc._RF.push(e,"e9268x4uqpM3ZwTAm8dK3a3","StatusEventType"),Object.defineProperty(i,"__esModule",{value:!0}),i.StatusEventType=void 0,function(t){t[t.INIT=0]="INIT",t[t.DIED=1]="DIED",t[t.ITEM_ADD=2]="ITEM_ADD",t[t.ITEM_REMOVE=3]="ITEM_REMOVE",t[t.ITEM_TICK=4]="ITEM_TICK",t[t.ITEM_USE=5]="ITEM_USE",t[t.MELEE_ATTACK=6]="MELEE_ATTACK",t[t.MELEE_COMBO=7]="MELEE_COMBO",t[t.MELEE_KILL=8]="MELEE_KILL",t[t.REMOTE_ATTACK=9]="REMOTE_ATTACK",t[t.REMOTE_HIT=10]="REMOTE_HIT",t[t.REMOTE_KILL=11]="REMOTE_KILL",t[t.REMOTE_COMBO=12]="REMOTE_COMBO",t[t.SKILL_START=13]="SKILL_START",t[t.SKILL_END=14]="SKILL_END",t[t.SKILL_TICK=15]="SKILL_TICK",t[t.TAKE_DAMAGE=16]="TAKE_DAMAGE",t[t.DODGE=17]="DODGE",t[t.BLOCK=18]="BLOCK",t[t.PRARRY=19]="PRARRY",t[t.AOE_HIT=20]="AOE_HIT",t[t.AOE_ADD=21]="AOE_ADD",t[t.AOE_REMOVE=22]="AOE_REMOVE",t[t.AOE_TICK=23]="AOE_TICK",t[t.AOE_KILL=24]="AOE_KILL",t[t.STATUS_KILL=25]="STATUS_KILL",t[t.STANDSTILL=26]="STANDSTILL",t[t.MOVE=27]="MOVE",t[t.DREAM_OUT=28]="DREAM_OUT",t[t.DREAM_FULL=29]="DREAM_FULL",t[t.HEALTH_OUT=30]="HEALTH_OUT",t[t.HEALTH_FULL=31]="HEALTH_FULL",t[t.HEALTH_HALF=32]="HEALTH_HALF",t[t.DISPEL=33]="DISPEL"}(i.StatusEventType||(i.StatusEventType={})),cc._RF.pop()},{}],StatusManager:[function(t,e,i){"use strict";cc._RF.push(e,"70cfczADURLkqYmvLLsshT9","StatusManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/StatusData"),s=t("../Logic"),l=t("../Data/FromData"),c=t("../Status/Status"),h=t("../Base/Actor"),p=cc._decorator,u=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statusPrefab=null,e.totalStatusData=new r.default,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.statusList=new Array,this.actor=this.node.parent.getComponent(h.default)},e.prototype.start=function(){},e.prototype.addCustomStatus=function(t,e){if(t){var i=new r.default;i.valueCopy(t),i.From.valueCopy(e),this.showStatus(i,!1)}},e.prototype.addStatus=function(t,e,i){if(!(t.length<1)){var o=new r.default;o.valueCopy(s.default.status[t]),o.From.valueCopy(e),this.showStatus(o,i)}},e.prototype.addStatusListFromSave=function(t){if(t&&t.length>0)for(var e=0,i=t;e<i.length;e++){var o=i[e],a=new r.default;a.valueCopy(o),a.From.valueCopy(new l.default),this.showStatus(a,!0)}},e.prototype.hasStatus=function(t){var e=!1,i=new r.default;i.valueCopy(s.default.status[t]);for(var o=this.statusList.length-1;o>=0;o--){var a=this.statusList[o];if(a&&a.node&&a.isValid&&a.isStatusRunning()&&a.data.id==i.id){e=!0;break}}return e},e.prototype.stopStatus=function(t){var e=new r.default;e.valueCopy(s.default.status[t]);for(var i=this.statusList.length-1;i>=0;i--){var o=this.statusList[i];o&&o.node&&o.isValid&&o.isStatusRunning()&&o.data.id==e.id&&o.stopStatus()}},e.prototype.stopAllStatus=function(){for(var t=this.statusList.length-1;t>=0;t--)this.statusList[t].stopStatus()},e.prototype.stopAllBuffs=function(){for(var t=this.statusList.length-1;t>=0;t--){var e=this.statusList[t];e&&e.data&&e.data.type==c.default.BUFF&&e.stopStatus()}},e.prototype.stopAllDebuffs=function(){for(var t=this.statusList.length-1;t>=0;t--){var e=this.statusList[t];e&&e.data&&e.data.type==c.default.DEBUFF&&e.stopStatus()}},e.prototype.showStatus=function(t,e){for(var i=this.statusList.length-1;i>=0;i--)(a=this.statusList[i])&&a.node&&a.isValid||this.statusList.splice(i,1);var o=!1;for(i=this.statusList.length-1;i>=0;i--){var a;if((a=this.statusList[i])&&a.node&&a.isValid&&a.isStatusRunning()&&a.data.id==t.id){a.data.duration=t.duration,a.showStatus(t,this.actor,e),o=!0;break}}if(!o){var n=cc.instantiate(this.statusPrefab);n.parent=this.node,n.active=!0;var r=n.getComponent(c.default);this.statusList.push(r),r.showStatus(t,this.actor,e)}},e.prototype.update=function(t){if(!s.default.isGamePause&&(this.node.parent&&(this.node.scaleX=this.node.parent.scaleX>0?1:-1),this.isTimeDelay(t)&&this.actor)){var e=this.updateStatus();this.actor.updateStatus(e,this.totalStatusData)}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0,!0)},e.prototype.updateStatus=function(){this.totalStatusData=new r.default;for(var t=new Array,e=this.statusList.length-1;e>=0;e--){var i=this.statusList[e];i&&i.node&&i.isValid&&(i.updateLogic(),0!=i.data.duration?(this.totalStatusData.missRate+=i.data.missRate?i.data.missRate:0,this.totalStatusData.variation+=i.data.variation?i.data.variation:0,this.totalStatusData.Common.add(i.data.Common),t.push(i.data.clone())):this.addStatus(i.data.finishStatus,i.data.From))}return t},e.FROZEN="status001",e.BURNING="status002",e.DIZZ="status003",e.TOXICOSIS="status004",e.CURSING="status005",e.BLEEDING="status006",e.ATTACKPLUS="status007",e.FASTMOVE="status008",e.FASTATTACK="status009",e.PERFECTDEFENCE="status010",e.HEALING="status011",e.RECOVERY="status012",e.STONE="status013",e.TWINE="status014",e.SHIELD_NORMAL="status015",e.SHIELD_LONG="status016",e.BOTTLE_HEALING="status017",e.TALENT_AIMED="status018",e.SHOES_SPEED="status019",e.CLOTHES_RECOVERY="status020",e.WEREWOLFDEFENCE="status021",e.GOLDAPPLE="status022",e.MAGIC_WEAPON="status023",e.MAGIC_WEAPON_STRONG="status024",e.FROZEN_STRONG="status025",e.TALENT_INVISIBLE="status026",e.SHIELD_PARRY="status027",e.TALENT_FLASH_DIZZ="status028",e.TALENT_FLASH_SPEED="status029",e.BOTTLE_REMOTE="status030",e.WINE_CLOUD="status033",e.FALLEN_DOWN="status034",e.DIZZ_LONG="status035",e.PET_DOG="status037",e.REAGENT="status038",e.REAGENT_SIDE_EFFECT="status039",n([d(cc.Prefab)],e.prototype,"statusPrefab",void 0),n([u],e)}(cc.Component);i.default=f,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/FromData":"FromData","../Data/StatusData":"StatusData","../Logic":"Logic","../Status/Status":"Status"}],Status:[function(t,e,i){"use strict";cc._RF.push(e,"71809qjadJJZIMwM9M2G6cL","Status");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/DamageData"),s=t("../Data/StatusData"),l=t("../Logic"),c=cc._decorator,h=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateRunning=!1,e.sprite=null,e.data=new s.default,e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.label=this.node.getChildByName("sprite").getChildByName("label").getComponent(cc.Label),this.anim=this.getComponent(cc.Animation)},e.prototype.start=function(){},e.prototype.showStatus=function(t,e,i){this.anim&&(this.data=t,this.actor=e,this.sprite.spriteFrame=l.default.spriteFrameRes(t.spriteFrameName),this.anim.playAdditive("StatusShow"),i||this.doStatusDamage(!0),this.stateRunning=!0,this.label.string=""+(this.data.duration>0?this.data.duration:""),this.label.node.opacity=this.data.duration<0||this.data.duration>500?0:255)},e.prototype.stopStatus=function(){this.node&&(this.data.duration=0,this.stateRunning&&this.node.destroy())},e.prototype.isStatusRunning=function(){return this.data.duration>0||-1==this.data.duration},e.prototype.doStatusDamage=function(t){if(this.data){var e=t?this.getDamageDirect():this.getDamageOverTime(),i=t?this.data.dizzDurationDirect:this.data.dizzDurationOvertime,o=t?this.data.dreamDirect:this.data.dreamOvertime;this.actor&&(0!=e.getTotalDamage()&&this.actor.takeDamage(e,this.data.From),i>0&&this.actor.takeDizz(i),o&&0!=o&&this.actor.updateDream(o),this.data.invisibleDuratonDirect>0&&this.actor.hideSelf(this.data.invisibleDuratonDirect))}},e.prototype.updateLogic=function(){var t=this;this.label.string=""+(this.data.duration>0?this.data.duration:""),this.label.node.opacity=this.data.duration<0||this.data.duration>500?0:255,this.data.duration>0&&(-1!=this.data.duration&&this.data.duration--,this.doStatusDamage(!1)),0==this.data.duration&&this.stateRunning&&(this.stateRunning=!1,this.anim.play("StatusHide"),this.scheduleOnce(function(){t.node&&t.node.destroy()},.5))},e.prototype.getDamageDirect=function(){var t=new r.default;return t.realDamage=this.data.realDamageDirect?this.data.realDamageDirect:0,t.physicalDamage=this.data.physicalDamageDirect?this.data.physicalDamageDirect:0,t.magicDamage=this.data.magicDamageDirect?this.data.magicDamageDirect:0,t},e.prototype.getDamageOverTime=function(){var t=new r.default;return t.realDamage=this.data.realDamageOvertime?this.data.realDamageOvertime:0,t.physicalDamage=this.data.physicalDamageOvertime?this.data.physicalDamageOvertime:0,t.magicDamage=this.data.magicDamageOvertime?this.data.magicDamageOvertime:0,t},e.BUFF=0,e.DEBUFF=1,n([h],e)}(cc.Component));i.default=p,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/StatusData":"StatusData","../Logic":"Logic"}],SuitData:[function(t,e,i){"use strict";cc._RF.push(e,"f9543VeOPVDfIOgvubFIjVk","SuitData");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var n=t("./BaseData"),r=t("./EquipmentData"),s=function(t){function e(){var e=t.call(this)||this;return e.nameCn="",e.nameEn="",e.suitType="",e.suitNames="",e.desc="",e.count=0,e.equipList=[],e}return a(e,t),Object.defineProperty(e.prototype,"EquipList",{get:function(){return this.equipList},enumerable:!1,configurable:!0}),e.prototype.valueCopy=function(t){if(t){for(var e=0,i=t.equipList;e<i.length;e++){var o=i[e],a=new r.default;a.valueCopy(o),this.equipList.push(a)}this.count=t.count?t.count:0,this.nameCn=t.nameCn?t.nameCn:"",this.nameEn=t.nameEn?t.nameEn:"",this.suitType=t.suitType?t.suitType:"",this.desc=t.desc?t.desc:"",this.suitNames=t.suitNames?t.suitNames:""}},e.prototype.clone=function(){for(var t=new e,i=[],o=0,a=this.equipList;o<a.length;o++){var n=a[o],s=new r.default;s.valueCopy(n),i.push(s)}return t.equipList=i,t.nameCn=this.nameCn,t.nameEn=this.nameEn,t.count=this.count,t.suitType=this.suitType,t.desc=this.desc,t.suitNames=this.suitNames,t},e}(n.default);i.default=s,cc._RF.pop()},{"./BaseData":"BaseData","./EquipmentData":"EquipmentData"}],TalentDash:[function(t,e,i){"use strict";cc._RF.push(e,"52ac4HK4rpMhYIJb8+wkG1J","TalentDash");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("./Talent"),l=t("../Item/DashShadow"),c=t("../Data/DamageData"),h=t("../Manager/StatusManager"),p=t("../Utils/AudioPlayer"),u=t("../Data/FromData"),d=t("../PlayerAvatar"),f=t("../Utils/ActorUtils"),g=cc._decorator,y=g.ccclass,m=g.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dashShadow=null,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(e){t.prototype.init.call(this,e),this.dashShadow.node.active=!1,this.node.parent=this.player.node.parent,this.dashShadow.init(this)},e.prototype.useSKill=function(){this.doSkill()},e.prototype.doSkill=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=3;this.hashTalent(s.default.DASH_13)&&(e=2);var i=1200;this.hashTalent(s.default.DASH_14)&&(i=2400),this.talentSkill.next(function(){t.talentSkill.IsExcuting=!0,cc.director.emit(r.EventHelper.PLAY_AUDIO,{detail:{name:p.default.DASH}}),t.schedule(function(){t.player.getWalkSmoke(t.node.parent,t.node.position)},.05,4,0);var e=t.player.rigidbody.linearVelocity.clone();t.player.sc.isMoving=!1,e=e.equals(cc.Vec2.ZERO)?t.player.isFaceRight?cc.v2(1,0):cc.v2(-1,0):e.normalizeSelf();var o=cc.v3(e.x,e.y);t.hashTalent(s.default.DASH_08)&&(i=100,t.showShadow(o)),t.hv=o.clone(),e=e.mul(i),t.player.rigidbody.linearVelocity=e,t.scheduleOnce(function(){t.player.rigidbody.linearVelocity=cc.Vec2.ZERO,t.player.playerAnim(d.default.STATE_IDLE,t.player.currentDir),t.IsExcuting=!1},.5)},e,!0)}},e.prototype.showShadow=function(t){this.dashShadow&&(this.dashShadow.setHv(t.clone()),this.dashShadow.show())},e.prototype.changePerformance=function(){},e.prototype.onBeginContact=function(t,e,i){this.hashTalent(s.default.DASH_02)&&!this.hashTalent(s.default.DASH_08)&&this.attacking(i,this.node)},e.prototype.attacking=function(t,e){if(t&&e.active){var i=new c.default(1);this.hashTalent(s.default.DASH_07)&&(i.realDamage=5);var o=f.default.getEnemyActorByNode(t.node,!0);o&&!o.sc.isDied&&o.takeDamage(i)&&(this.beatBack(o.node),this.addTargetAllStatus(o))}},e.prototype.beatBack=function(t){if(this.hashTalent(s.default.DASH_04)){var e=t.getComponent(cc.RigidBody),i=this.hv.clone();i=i.normalizeSelf().mul(1e3),e.applyLinearImpulse(cc.v2(i.x,i.y),e.getLocalCenter(),!0)}},e.prototype.addTargetAllStatus=function(t){this.addTargetStatus(s.default.DASH_05,t,h.default.FROZEN),this.addTargetStatus(s.default.DASH_06,t,h.default.DIZZ),this.addTargetStatus(s.default.DASH_03,t,h.default.BLEEDING)},e.prototype.addTargetStatus=function(t,e,i){this.hashTalent(t)&&e.addStatus(i,new u.default)},e.prototype.takeDamage=function(){return!1},n([m(l.default)],e.prototype,"dashShadow",void 0),n([y],e)}(s.default);i.default=v,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventHelper":"EventHelper","../Item/DashShadow":"DashShadow","../Manager/StatusManager":"StatusManager","../PlayerAvatar":"PlayerAvatar","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","./Talent":"Talent"}],TalentData:[function(t,e,i){"use strict";cc._RF.push(e,"337bcbBGB9GS4DrPZ+ZKu25","TalentData"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./CommonData"),a=function(){function t(){this.desc="",this.nameCn="",this.nameEn="",this.resName="",this.cooldown=0,this.passive=0,this.cost=1,this.secondCount=0,this.storePoint=0,this.common=new o.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!1,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.desc=t.desc?t.desc:this.desc,this.resName=t.resName?t.resName:"",this.cooldown=t.cooldown?t.cooldown:0,this.passive=t.passive?t.passive:0,this.secondCount=t.secondCount?t.secondCount:0,this.storePoint=t.storePoint||0==t.storePoint?t.storePoint:1,this.cost=t.cost||0==t.cost?t.cost:1},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.desc=this.desc,e.resName=this.resName,e.cooldown=this.cooldown,e.passive=this.passive,e.secondCount=this.secondCount,e.storePoint=this.storePoint,e.cost=this.cost,e},t}();i.default=a,cc._RF.pop()},{"./CommonData":"CommonData"}],TalentMagic:[function(t,e,i){"use strict";cc._RF.push(e,"d3909410aVM/oDLjAGklG7U","TalentMagic");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../EventHelper"),s=t("./Talent"),l=t("../Manager/StatusManager"),c=t("../Data/FromData"),h=t("./MagicCircle"),p=t("./MagicIce"),u=t("./FireGhost"),d=t("../Logic"),f=t("./IceThron"),g=t("../Utils/AudioPlayer"),y=cc._decorator,m=y.ccclass,v=y.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.magiccircle=null,e.magicice=null,e.icethron=null,e.fireGhost=null,e.magicLighteningCircle=null,e.fireGhostNum=0,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){var t=this;this.ghostPool=new cc.NodePool(u.default),cc.director.on("destoryfireghost",function(e){t.destroyGhost(e.detail.coinNode)})},e.prototype.destroyGhost=function(t){t&&(t.active=!1,this.ghostPool&&(this.ghostPool.put(t),this.fireGhostNum--,cc.log("destroyGhost")))},e.prototype.init=function(e){var o=this;this.magicLighteningCircle.opacity=0,t.prototype.init.call(this,e),this.scheduleOnce(function(){o.hashTalent(s.default.MAGIC_07)&&o.player.addStatus(o.hashTalent(i.MAGIC_06)?l.default.MAGIC_WEAPON_STRONG:l.default.MAGIC_WEAPON,new c.default),o.hashTalent(s.default.MAGIC_13)&&!o.magicice.isShow&&o.magicice.showIce(),o.hashTalent(s.default.MAGIC_10)&&o.initFireGhosts(),o.hashTalent(i.MAGIC_16)&&o.showLighteningCircle()},.2)},e.prototype.useSKill=function(){this.doSkill()},e.prototype.doSkill=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=7;this.hashTalent(s.default.MAGIC_04)&&(e=3),this.talentSkill.next(function(){t.talentSkill.IsExcuting=!0,t.magiccircle.talentMaigc=t,t.magiccircle.playMagic(t.hashTalent(s.default.MAGIC_03))},e,!0)}},e.prototype.MagicFinish=function(){var t=this;this.hashTalent(s.default.MAGIC_09)||this.hashTalent(s.default.MAGIC_08)||(this.hashTalent(s.default.MAGIC_12)?this.showIceThron():this.hashTalent(s.default.MAGIC_11)?this.showIceThron():this.hashTalent(s.default.MAGIC_15)?this.schedule(function(){t.addLighteningFall(t.hashTalent(s.default.MAGIC_06),8)},.2,this.hashTalent(s.default.MAGIC_02)?1:0):this.hashTalent(s.default.MAGIC_14)?this.schedule(function(){t.addLighteningFall(t.hashTalent(s.default.MAGIC_06),5)},.2,this.hashTalent(s.default.MAGIC_02)?1:0):this.hashTalent(s.default.MAGIC_01)&&(g.default.play(g.default.SKILL_MAGICBALL),this.fire(this.player.shooterEx,80,this.hashTalent(s.default.MAGIC_06)?"bullet135":"bullet035")))},e.prototype.showIceThron=function(){var t=this;this.scheduleOnce(function(){g.default.play(g.default.SKILL_ICETHRON)},1);var e=[0,45,90,135,180,225,270,315],i=[15,60,105,150,195,240,285,330],o=[100,150],a=[e,i],n=[e,i,e],r=[e],l=[3],c=[100];this.hashTalent(s.default.MAGIC_02)&&(r=a,l=[3,4],c=o),this.hashTalent(s.default.MAGIC_12)&&(r=a,l=[3,5],c=o,this.hashTalent(s.default.MAGIC_02)&&(r=n,l=[3,4,5],c=[100,150,200]));var h=0;this.schedule(function(){for(var e=0;e<r[h].length;e++)cc.instantiate(t.icethron).getComponent(f.default).show(t.player,r[h][e],c[h],l[h]);h++},.5,r.length-1)},e.prototype.fire=function(t,e,i){t.data.bulletType=i,t.data.bulletArcExNum=e,this.hashTalent(s.default.MAGIC_02)&&(t.data.bulletArcExNum=80==e?99:2),t.data.bulletLineExNum=0,t.fireBullet(0)},e.prototype.changePerformance=function(){},e.prototype.takeIce=function(){return!(!this.hashTalent(s.default.MAGIC_13)||!this.magicice.isShow||(this.addStatus2NearEnemy(l.default.FROZEN,300),this.magicice.breakIce(),0))},e.prototype.takeDamage=function(){return!1},e.prototype.addLighteningFall=function(t,e){r.EventHelper.emit(r.EventHelper.DUNGEON_ADD_LIGHTENINGFALL,{pos:this.getNearestEnemyPosition(),showArea:t,damage:e})},e.prototype.getNearestEnemyPosition=function(){for(var t,e=99999,i=0,o=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.monsterList;i<o.length;i++){var a=o[i];a.sc.isDied||(s=d.default.getDistance(this.node.position,a.node.position))<e&&(e=s,t=a.node)}for(var n=0,r=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.bossList;n<r.length;n++){var s,l=r[n];l.sc.isDied||(s=d.default.getDistance(this.node.position,l.node.position))<e&&(e=s,t=l.node)}return t?t.position:this.node.position.addSelf(cc.v3(d.default.getRandomNum(0,600)-300,d.default.getRandomNum(0,600)-300))},e.prototype.showLighteningCircle=function(){var t=this;this.magicLighteningCircle.opacity=128,this.magicLighteningCircle.scale=1,cc.tween(this.magicLighteningCircle).to(1,{scale:10}).call(function(){t.addStatus2NearEnemy(l.default.DIZZ,300),t.magicLighteningCircle.opacity=0,t.magicLighteningCircle.scale=1}).start()},e.prototype.initFireGhosts=function(){for(var t=this.fireGhostNum,e=0;e<5-t;e++){var i=null;this.ghostPool.size()>0&&(i=this.ghostPool.get()),i&&!i.active||(i=cc.instantiate(this.fireGhost)),this.fireGhostNum++,i.active=!0;var o=i.getComponent(u.default);this.player.node.parent.addChild(o.node),o.init(this.player,72*e)}},e.prototype.addStatus2NearEnemy=function(t,e){if(!this.player)return cc.Vec3.ZERO;for(var i=0,o=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.monsterList;i<o.length;i++){var a=o[i];d.default.getDistance(this.node.position,a.node.position)<e&&!a.sc.isDied&&!a.sc.isDisguising&&a.addStatus(t,new c.default)}for(var n=0,r=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.bossList;n<r.length;n++){var s=r[n];d.default.getDistance(this.node.position,s.node.position)<e&&!s.sc.isDied&&s.addStatus(t,new c.default)}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>10&&(this.checkTimeDelay=0,!0)},n([v(h.default)],e.prototype,"magiccircle",void 0),n([v(p.default)],e.prototype,"magicice",void 0),n([v(cc.Prefab)],e.prototype,"icethron",void 0),n([v(cc.Prefab)],e.prototype,"fireGhost",void 0),n([v(cc.Node)],e.prototype,"magicLighteningCircle",void 0),i=n([m],e)}(s.default);i.default=E,cc._RF.pop()},{"../Data/FromData":"FromData","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Utils/AudioPlayer":"AudioPlayer","./FireGhost":"FireGhost","./IceThron":"IceThron","./MagicCircle":"MagicCircle","./MagicIce":"MagicIce","./Talent":"Talent"}],TalentShield:[function(t,e,i){"use strict";cc._RF.push(e,"9db0eWCt9hLa7XLpSo6xHBj","TalentShield");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Manager/StatusManager"),s=t("../EventHelper"),l=t("../Logic"),c=t("../Data/DamageData"),h=t("./Talent"),p=t("../Utils/AudioPlayer"),u=t("../Data/FromData"),d=cc._decorator,f=d.ccclass,g=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shieldBackSprite=null,e.shieldFrontSprite=null,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){},e.prototype.init=function(e){t.prototype.init.call(this,e),this.shieldBackSprite=this.getSpriteChildSprite(["shieldback"]),this.shieldFrontSprite=this.getSpriteChildSprite(["shieldfront"]),this.shieldBackSprite.node.opacity=0,this.shieldFrontSprite.node.opacity=0,this.sprites=new Array;for(var i=[2,3,4,5,9,12,13,14],o=0;o<i.length;o++){var a=this.getSpriteChildSprite(["shieldfront","sprite"+i[o]]);a.node.opacity=0,this.sprites.push(a)}},e.prototype.changePerformance=function(){for(var t=0,e=this.sprites;t<e.length;t++)e[t].node.opacity=0;this.shieldFrontSprite.node.color=cc.color(255,255,255),this.changeRes("shield01")},e.prototype.changeRes=function(t){!t||t.length<1||(this.shieldBackSprite.spriteFrame=l.default.spriteFrameRes(t),this.shieldFrontSprite.spriteFrame=l.default.spriteFrameRes(t))},e.prototype.useSKill=function(){this.doSkill()},e.prototype.doSkill=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=7,o=1;this.hashTalent(i.SHIELD_13)&&(e=5),this.talentSkill.next(function(){var e=r.default.SHIELD_NORMAL,a=.1;t.talentSkill.IsExcuting=!0;var n=t.shieldFrontSprite.node.y;t.shieldBackSprite.node.scaleX=1,t.shieldFrontSprite.node.scaleX=0,t.shieldBackSprite.node.opacity=255,t.shieldFrontSprite.node.opacity=255,t.shieldFrontSprite.node.x=-8,t.hashTalent(i.SHIELD_14)&&(e=r.default.SHIELD_LONG,o=2),t.hashTalent(i.SHIELD_06)&&(o=0,a=0),cc.tween(t.shieldBackSprite.node).to(.1,{scaleX:0,scaleY:1}).to(.1,{position:cc.v3(-16,n)}).delay(o).to(a,{position:cc.v3(-8,n)}).to(a,{scale:1}).start(),cc.tween(t.shieldFrontSprite.node).to(.1,{scale:1}).to(.1,{position:cc.v3(8,n)}).delay(o).to(a,{position:cc.v3(-8,n)}).to(a,{scaleX:0,scaleY:1}).start(),t.player.addStatus(e,new u.default),t.scheduleOnce(function(){cc.director.emit(s.EventHelper.PLAY_AUDIO,{detail:{name:p.default.MELEE}})},.2),t.scheduleOnce(function(){t.talentSkill.IsExcuting=!1},o+.2),t.scheduleOnce(function(){t.shieldBackSprite.node.opacity=255},1)},e,!0)}},e.prototype.canAddStatus=function(t){return!this.hashTalent(i.SHIELD_04)||!(t==r.default.FROZEN||t==r.default.BURNING||t==r.default.DIZZ||t==r.default.TOXICOSIS||t==r.default.CURSING||t==r.default.BLEEDING)},e.prototype.takeDamage=function(t,e){if(e&&this.IsExcuting){if(this.hashTalent(i.SHIELD_05))return e.takeDamage(new c.default(5));if(this.hashTalent(i.SHIELD_02))return e.takeDamage(new c.default(1))}return!1},i=n([f],e)}(h.default));i.default=g,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Utils/AudioPlayer":"AudioPlayer","./Talent":"Talent"}],Talent:[function(t,e,i){"use strict";cc._RF.push(e,"11194HbWx5MlLwfYetzGt8W","Talent");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Utils/NextStep"),s=t("../Player"),l=t("../Logic"),c=t("../Data/FromData"),h=t("../EventHelper"),p=t("../Actor/AreaOfEffect"),u=t("../UI/CoolDownView"),d=cc._decorator,f=d.ccclass,g=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.talentSkill=new r.default,e.coolDownId=u.default.PROFESSION,e.checkTimeDelay=0,e}var i;return a(e,t),i=e,Object.defineProperty(e.prototype,"IsExcuting",{get:function(){return this.talentSkill.IsExcuting},set:function(t){this.talentSkill.IsExcuting=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.init=function(t){this.player=this.getComponent(s.default),this.data=t},e.prototype.initCoolDown=function(t,e){var i=this;this.talentSkill.init(!1,e,t.storePoint,t.cooldown,t.secondCount,function(e){i.updateCooldownAndHud(t.cooldown,e)})},e.prototype.useSKill=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=this.data.cooldown;this.player.data.currentDream>=this.data.cost?this.talentSkill.next(function(){t.talentSkill.IsExcuting=!0,t.player.updateDream(t.data.cost),t.doSkill(),t.updateCooldownAndHud(e,e)},e,!0,function(i){t.updateCooldownAndHud(e,i)}):cc.director.emit(h.EventHelper.HUD_SHAKE_PLAYER_DREAMBAR)}},e.prototype.refreshCooldown=function(){this.talentSkill.refreshCoolDown(),this.updateCooldownAndHud(this.data.cooldown,0)},e.prototype.cutCooldown=function(t){var e=this.talentSkill.cutCoolDown(t);this.updateCooldownAndHud(this.data.cooldown,this.talentSkill.cutCoolDown(e))},e.prototype.updateCooldownAndHud=function(t,e){this.node&&(this.data.secondCount=e,this.data.storePoint=this.talentSkill.StorePoint,h.EventHelper.emit(h.EventHelper.HUD_CONTROLLER_COOLDOWN,{id:this.coolDownId,duration:t,secondCount:e,storePoint:this.talentSkill.StorePoint,storePointMax:this.talentSkill.StorePointMax}))},e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,i=0,o=t;i<o.length;i++){var a=o[i];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.hashTalent=function(t){return this.data.resName==t},e.prototype.shoot=function(t,e,i,o,a,n){t.data.bulletType=o,t.data.bulletArcExNum=e,t.data.bulletLineExNum=i,t.fireBullet(0,null,0,0,a,n)},e.prototype.addStatus2NearEnemy=function(t,e){if(!this.player)return cc.Vec3.ZERO;for(var i=0,o=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.monsterList;i<o.length;i++){var a=o[i];l.default.getDistance(this.node.position,a.node.position)<e&&!a.sc.isDied&&!a.sc.isDisguising&&a.addStatus(t,new c.default)}for(var n=0,r=this.player.weaponRight.meleeWeapon.dungeon.monsterManager.bossList;n<r.length;n++){var s=r[n];l.default.getDistance(this.node.position,s.node.position)<e&&!s.sc.isDied&&s.addStatus(t,new c.default)}},e.prototype.addAoe=function(t,e,i,o,a,n){var r=cc.instantiate(t);e.y+=32;var s=r.getChildByName("sprite").getComponent(cc.Sprite),c=r.getComponent(cc.BoxCollider);if(o.length>0){var h=l.default.spriteFrameRes(o[0]);s.node.width=h.getRect().width,s.node.height=h.getRect().height,s.node.scale=4,s.node.scaleX=n?4:-4,c.size.width=3*s.node.width,c.size.height=3*s.node.height}for(var u=cc.tween(),d=function(t){u.then(cc.tween().delay(.2).call(function(){s.spriteFrame=l.default.spriteFrameRes(t)}))},f=0,g=o;f<g.length;f++)d(g[f]);a?cc.tween(r).repeatForever(u).start():cc.tween(r).then(u).delay(.2).call(function(){s.spriteFrame=null}).start(),r.getComponent(p.default).show(this.player.dungeon.node,e,cc.v3(1,0),0,i)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.DASH="1000000",e.SHIELD="2000000",e.MAGIC="3000000",e.ARCHER="4000000",e.DASH_01=i.DASH+1,e.DASH_02=i.DASH+2,e.DASH_03=i.DASH+3,e.DASH_04=i.DASH+4,e.DASH_05=i.DASH+5,e.DASH_06=i.DASH+6,e.DASH_07=i.DASH+7,e.DASH_08=i.DASH+8,e.DASH_09=i.DASH+9,e.DASH_10=i.DASH+10,e.DASH_11=i.DASH+11,e.DASH_12=i.DASH+12,e.DASH_13=i.DASH+13,e.DASH_14=i.DASH+14,e.SHIELD_01=i.SHIELD+1,e.SHIELD_02=i.SHIELD+2,e.SHIELD_03=i.SHIELD+3,e.SHIELD_04=i.SHIELD+4,e.SHIELD_05=i.SHIELD+5,e.SHIELD_06=i.SHIELD+6,e.SHIELD_07=i.SHIELD+7,e.SHIELD_08=i.SHIELD+8,e.SHIELD_09=i.SHIELD+9,e.SHIELD_10=i.SHIELD+10,e.SHIELD_11=i.SHIELD+11,e.SHIELD_12=i.SHIELD+12,e.SHIELD_13=i.SHIELD+13,e.SHIELD_14=i.SHIELD+14,e.MAGIC_01=i.MAGIC+1,e.MAGIC_02=i.MAGIC+2,e.MAGIC_03=i.MAGIC+3,e.MAGIC_04=i.MAGIC+4,e.MAGIC_05=i.MAGIC+5,e.MAGIC_06=i.MAGIC+6,e.MAGIC_07=i.MAGIC+7,e.MAGIC_08=i.MAGIC+8,e.MAGIC_09=i.MAGIC+9,e.MAGIC_10=i.MAGIC+10,e.MAGIC_11=i.MAGIC+11,e.MAGIC_12=i.MAGIC+12,e.MAGIC_13=i.MAGIC+13,e.MAGIC_14=i.MAGIC+14,e.MAGIC_15=i.MAGIC+15,e.MAGIC_16=i.MAGIC+16,e.TALENT_000="talent000",e.TALENT_001="talent001",e.TALENT_002="talent002",e.TALENT_003="talent003",e.TALENT_004="talent004",e.TALENT_005="talent005",e.TALENT_006="talent006",e.TALENT_007="talent007",e.TALENT_008="talent008",e.TALENT_009="talent009",e.TALENT_010="talent010",e.TALENT_011="talent011",e.TALENT_012="talent012",e.TALENT_013="talent013",e.TALENT_014="talent014",e.TALENT_015="talent015",e.TALENT_016="talent016",e.TALENT_017="talent017",e.TALENT_018="talent018",e.TALENT_019="talent019",e.TALENT_100="talent100",e.TALENT_101="talent101",e.TALENT_102="talent102",e.TALENT_103="talent103",n([f],e)}(cc.Component));i.default=g,cc._RF.pop()},{"../Actor/AreaOfEffect":"AreaOfEffect","../Data/FromData":"FromData","../EventHelper":"EventHelper","../Logic":"Logic","../Player":"Player","../UI/CoolDownView":"CoolDownView","../Utils/NextStep":"NextStep"}],TarotCard:[function(t,e,i){"use strict";cc._RF.push(e,"e4b2bYbHidG7bCWzE85sIMb","TarotCard");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Data/TarotData"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.indexLabel=null,e.anim=null,e.frontNode=null,e.backNode=null,e.data=new r.default,e}return a(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.frontNode=this.node.getChildByName("sprite").getChildByName("front"),this.backNode=this.node.getChildByName("sprite").getChildByName("back"),this.indexLabel=this.node.getChildByName("sprite").getChildByName("front").getChildByName("index").getComponent(cc.Label),this.frontNode.scaleX=0,this.backNode.scaleY=1},e.prototype.initFromGround=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotIdle")},e.prototype.showCard=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotFilpToFront")},e.prototype.coverCard=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotFilpToBack")},e.prototype.start=function(){},n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"../Data/TarotData":"TarotData"}],TarotData:[function(t,e,i){"use strict";cc._RF.push(e,"2921ee/FxFNuIPjZdXjGRw+","TarotData"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){this.nameCn="",this.nameEn="",this.desc="",this.resName="",this.index=0,this.word1="",this.word2="",this.word3="",this.word4="",this.word5="",this.word6=""}return t.prototype.valueCopy=function(t){this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.index=t.index?t.index:this.index,this.resName=t.resName?t.resName:this.resName,this.desc=t.desc},t.prototype.clone=function(){var e=new t;return e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.index=this.index,e.resName=this.resName,e.desc=this.desc,e},t}();i.default=o,cc._RF.pop()},{}],TarotManager:[function(t,e,i){"use strict";cc._RF.push(e,"b67c009qhlE0oYcKSjCxjFX","TarotManager");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Item/TarotCard"),s=t("../Dungeon"),l=t("../Utils/IndexZ"),c=cc._decorator,h=(c.ccclass,c.property),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.card=null,e}return a(e,t),e.prototype.getCard=function(t,e){var i=cc.instantiate(this.card);i.parent=this.node,i.position=s.default.getPosInMap(e),i.zIndex=l.default.getActorZIndex(i.position);var o=i.getComponent(r.default);return o.data.resName=t,o},e.THE_FOOL="tarot00",e.THE_MAGICIAN="tarot01",e.THE_HIGH_PRIESTESS="tarot02",e.THE_EMPRESS="tarot03",e.THE_EMPEROR="tarot04",e.THE_HIEROPHANT="tarot05",e.THE_LOVERS="tarot06",e.THE_CHARIOT="tarot07",e.STRENGTH="tarot08",e.THE_HERMIT="tarot09",e.THE_WHEEL_OF_FORTUNE="tarot10",e.JUSTICE="tarot11",e.THE_HANGEDMAN="tarot12",e.DEATH="tarot13",e.TEMPERANCE="tarot14",e.THE_DEVIL="tarot15",e.THE_TOWER="tarot16",e.THE_STAR="tarot17",e.THE_MOON="tarot18",e.THE_SUN="tarot19",e.JUDGEMENT="tarot20",e.THE_WORLD="tarot21",n([h(cc.Prefab)],e.prototype,"card",void 0),e}(cc.Component);i.default=p,cc._RF.pop()},{"../Dungeon":"Dungeon","../Item/TarotCard":"TarotCard","../Utils/IndexZ":"IndexZ"}],TarotTable:[function(t,e,i){"use strict";cc._RF.push(e,"f0e8dVSyEpP0bI6DNiqwoQc","TarotTable");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../EventHelper"),l=t("../UI/Tips"),c=t("./Building"),h=t("../Utils/IndexZ"),p=cc._decorator,u=p.ccclass,d=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.tips=this.node.getChildByName("Tips").getComponent(l.default),this.tips.tipsType=l.default.TAROT_TABLE,cc.director.on(s.EventHelper.PLAYER_TAPTIPS,function(e){e.detail.tipsType==l.default.TAROT_TABLE&&t.showCards()})},e.prototype.start=function(){},e.prototype.showCards=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play()},e.prototype.setPos=function(t){this.pos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=h.default.getActorZIndex(this.node.position)},n([u],e)}(c.default));i.default=d,cc._RF.pop()},{"../Dungeon":"Dungeon","../EventHelper":"EventHelper","../UI/Tips":"Tips","../Utils/IndexZ":"IndexZ","./Building":"Building"}],TestFog:[function(t,e,i){"use strict";cc._RF.push(e,"1aa806ypbFLYIf29yLJ7ObM","TestFog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.start=function(){},e.prototype.show=function(){this.mat||(this.mat=this.node.getComponent(cc.Sprite).getMaterial(0)),this.mat.setProperty("wh_ratio",this.node.width/this.node.height),this.mat.setProperty("center",cc.v2(.5,.5)),this.mat.setProperty("radius",.5)},n([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],Test:[function(t,e,i){"use strict";cc._RF.push(e,"f27abc9Kq9M9YY+mw/i2T6U","Test");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphics=null,e.camera=null,e.ray=null,e.shadow=null,e.shadowCamera=null,e.radius=200,e.playerPos=cc.v2(640,360),e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var i=e.getLocation();t.playerPos=i.clone()},this),this.node.on(cc.Node.EventType.TOUCH_START,function(e){var i=e.getLocation();t.playerPos=i.clone(),cc.log("playerPos:"+i.x+","+i.y)},this),this.ray.fillColor=cc.color(0,255,0,255),this.ray.rect(-500,-500,1e3,1e3),this.ray.fill(),this.ray.fillColor=cc.color(255,255,255,255),this.ray.rect(200,0,100,100),this.ray.fill(),this.ray.circle(0,0,200),this.ray.fill()},e.prototype.start=function(){this.mat=this.graphics.getMaterial(0),this.mat1=this.ray.getMaterial(0),this.render(this.playerPos);var t=new cc.RenderTexture;t.initWithSize(cc.visibleRect.width/8,cc.visibleRect.height/8),t.setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST),this.shadowCamera.targetTexture=t,this.shadowCamera.render(),this.shadow.spriteFrame=new cc.SpriteFrame(t)},e.prototype.render=function(t){var e=this.graphics.node.convertToNodeSpaceAR(t);this.graphics.clear(),this.graphics.fillColor=cc.color(0,255,0),this.graphics.moveTo(e.x-this.radius/4,e.y),this.graphics.lineTo(e.x-this.radius,e.y-this.radius),this.graphics.lineTo(e.x+this.radius,e.y-this.radius),this.graphics.lineTo(e.x+this.radius/4,e.y),this.graphics.close(),this.graphics.fill(),this.graphics.node.width=2*this.radius,this.graphics.node.height=2*this.radius},e.prototype.updateMat=function(t,e,i){var o=cc.view.getCanvasSize(),a=cc.view.getVisibleSize(),n=a.width/a.height,r=i/a.height,s=o.width/a.width;t.setProperty("screen",cc.v2(o.width,o.height)),t.setProperty("maxRadius",r),t.setProperty("whRatio",n),t.setProperty("isCircle",!1);var l=cc.v2(e.x/a.width,e.y/a.height),c=Math.abs(l.y-.5)*a.height*s/o.height;t.setProperty("lightPos",cc.v2(l.x,l.y>.5?.5+c:.5-c))},e.prototype.lateUpdate=function(){this.render(this.playerPos),this.updateMat(this.mat,cc.v2(this.playerPos.x-this.camera.node.x,this.playerPos.y-this.camera.node.y),this.radius)},n([l(cc.Graphics)],e.prototype,"graphics",void 0),n([l(cc.Camera)],e.prototype,"camera",void 0),n([l(cc.Graphics)],e.prototype,"ray",void 0),n([l(cc.Sprite)],e.prototype,"shadow",void 0),n([l(cc.Camera)],e.prototype,"shadowCamera",void 0),n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],Tile:[function(t,e,i){"use strict";cc._RF.push(e,"f8047r9sJ5IqqTgIdjYi6dc","Tile");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.isBroken=!1,e.isAutoShow=!0,e.timeDelay=0,e.isAnimPlaying=!1,e.isBreakingNow=!1,e.tileType="**",e.coverPrefix="",e.floorPrefix="",e}return a(e,t),e.prototype.onLoad=function(){this.isAutoShow=!0,this.anim=this.getComponent(cc.Animation),this.floor=this.node.getChildByName("sprite").getChildByName("floor").getComponent(cc.Sprite)},e.prototype.start=function(){this.changeRes(this.getRes())},e.prototype.getRes=function(){var t=this.floorPrefix+"001";switch(this.tileType){case"**":t=this.floorPrefix+"001";break;case"*0":t=this.floorPrefix+"002";break;case"*1":t=this.floorPrefix+"003";break;case"*2":t=this.floorPrefix+"001";break;case"*3":t=this.floorPrefix+"002";break;case"*4":t=this.coverPrefix+"004"}return t},e.prototype.getLabRes=function(){var t="tile_lab001";switch(this.tileType){case"**":t="tile_lab001";break;case"*0":t="tile_lab002";break;case"*1":case"*2":t="tile_lab003"}return t},e.prototype.getDirtRes=function(){var t="tile_dirt001";switch(this.tileType){case"**":t="tile_dirt001";break;case"*0":t="tile_dirt002";break;case"*1":t="tile_dirt003";break;case"*2":t="tile_dirt004"}return t},e.prototype.getDeckRes=function(){var t="tile_deck001";switch(this.tileType){case"**":t="tile_deck001";break;case"*0":t="tile_deck002";break;case"*1":t="tile_deck003";break;case"*2":t="tile_deck004"}return t},e.prototype.TileBreak=function(){},e.prototype.TileBreakFinish=function(){var t=this;this.isBroken=!0,this.isAnimPlaying=!1,this.isAutoShow&&this.scheduleOnce(function(){t.showTile()},2)},e.prototype.TileShow=function(){this.isAnimPlaying=!1},e.prototype.breakTile=function(){this.isAnimPlaying||(this.anim.play("TileBreak"),this.isBreakingNow=!0,this.isAnimPlaying=!0)},e.prototype.showTile=function(){!this.isAnimPlaying&&this.anim&&(this.anim.play("TileShow"),this.isBroken=!1,this.isBreakingNow=!1,this.isAnimPlaying=!0)},e.prototype.changeRes=function(t){this.floor.spriteFrame=r.default.spriteFrameRes(t),null==this.floor.spriteFrame&&(this.floor.spriteFrame=r.default.spriteFrameRes(this.floorPrefix+"001"))},n([c(cc.Label)],e.prototype,"label",void 0),n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./Logic":"Logic"}],Tips:[function(t,e,i){"use strict";cc._RF.push(e,"36c4bnGdrlOy4Y1XkbF9xfT","Tips");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Actor/ColliderTag"),s=t("../EventHelper"),l=cc._decorator,c=l.ccclass,h=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUse=!1,e.tipsType="",e}return a(e,t),e.prototype.onLoad=function(){this.node.opacity=0},e.prototype.start=function(){},e.prototype.next=function(t,e){var i=this;this.isUse||(this.isUse=!0,cc.director.emit(s.EventHelper.PLAYER_TAPTIPS,{detail:{tipsType:this.tipsType,isLongPress:t,player:e}}),setTimeout(function(){i.isUse=!1},.1))},e.prototype.onDestroy=function(){this.isUse=!1},e.prototype.onCollisionEnter=function(t){t.tag==r.ColliderTag.PLAYER&&(this.node.opacity=255)},e.prototype.onCollisionExit=function(t){t.tag==r.ColliderTag.PLAYER&&(this.node.opacity=0)},e.TAROT_TABLE="Tips.TAROT_TABLE",e.MART_SHELVES="Tips.MART_SHELVES",e.ROOM_STOOL="Tips.ROOM_STOOL",e.SAVE_POINT="Tips.SAVE_POINT",e.ROOM_BED="Tips.ROOM_BED",n([c],e)}(cc.Component));i.default=h,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../EventHelper":"EventHelper"}],Trap:[function(t,e,i){"use strict";cc._RF.push(e,"67e3dv84GNOwbSynhs23bOv","Trap");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Player"),l=t("../Data/DamageData"),c=t("./Building"),h=t("../Data/FromData"),p=t("../Actor/ColliderTag"),u=t("../Utils/IndexZ"),d=t("../Manager/InventoryManager"),f=cc._decorator,g=f.ccclass,y=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e.halfSpriteFrame=null,e.isOpen=!1,e.pos=cc.v3(0,0),e.timeDelay=0,e.isPlayerIn=!1,e}return a(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite")},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t,this.node.position=r.default.getPosInMap(t),this.node.zIndex=u.default.FLOOR},e.prototype.openTrap=function(){var t=this;this.isOpen||(this.isOpen=!0,this.sprite.getComponent(cc.Sprite).spriteFrame=this.openSpriteFrame,this.scheduleOnce(function(){t.isOpen=!1,t.halfSpriteFrame&&(t.sprite.getComponent(cc.Sprite).spriteFrame=t.halfSpriteFrame,t.scheduleOnce(function(){t.closeSpriteFrame&&(t.sprite.getComponent(cc.Sprite).spriteFrame=t.closeSpriteFrame)},.2))},.5))},e.prototype.onCollisionStay=function(t){if(t.tag==p.ColliderTag.PLAYER&&this.isOpen&&this.isPlayerIn){this.isOpen=!1;var e=t.getComponent(s.default);e&&e.inventoryManager.getEquipBySuit(e.inventoryManager.equips[d.default.SHOES]).ignoreTrap<1&&e.takeDamage(new l.default(1),h.default.getClone(this.actorName(),"trap001"),this)}},e.prototype.onBeginContact=function(t,e,i){i.tag==p.ColliderTag.PLAYER&&(this.isPlayerIn=!0)},e.prototype.onEndContact=function(t,e,i){i.tag==p.ColliderTag.PLAYER&&(this.isPlayerIn=!1)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>3&&(this.openTrap(),this.timeDelay=0)},e.prototype.actorName=function(){return"\u5c16\u523a"},n([y(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),n([y(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),n([y(cc.SpriteFrame)],e.prototype,"halfSpriteFrame",void 0),n([g],e)}(c.default);i.default=m,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../Manager/InventoryManager":"InventoryManager","../Player":"Player","../Utils/IndexZ":"IndexZ","./Building":"Building"}],UpgradeEquipmentDialog:[function(t,e,i){"use strict";cc._RF.push(e,"105daicC4FHDabHKJDXsptP","UpgradeEquipmentDialog");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTile=null,e.infoBase=null,e.info1=null,e.info2=null,e.info3=null,e.extraInfo=null,e.infoSuit1=null,e.infoSuit2=null,e.infoSuit3=null,e.infoDesc=null,e}return a(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.opacity=0},e.prototype.refreshDialog=function(t){this.labelTile.string=t.prefix+t.nameCn,this.labelTile.node.color=this.labelTile.node.color.fromHEX(t.titlecolor),this.infoBase.string=t.infobase,this.infoBase.node.color=this.infoBase.node.color.fromHEX(t.infobasecolor),this.info1.string=t.info1,this.info1.node.color=this.info1.node.color.fromHEX(t.infocolor1),this.info2.string=t.info2,this.info2.node.color=this.info2.node.color.fromHEX(t.infocolor2),this.info3.string=t.info3,this.info3.node.color=this.info3.node.color.fromHEX(t.infocolor3),this.extraInfo.string=t.extraInfo,this.infoSuit1.string=t.suit1,this.infoSuit1.node.color=this.infoSuit1.node.color.fromHEX(t.suitcolor1),this.infoSuit2.string=t.suit2,this.infoSuit2.node.color=this.infoSuit2.node.color.fromHEX(t.suitcolor2),this.infoSuit3.string=t.suit3,this.infoSuit3.node.color=this.infoSuit3.node.color.fromHEX(t.suitcolor3),this.infoDesc.string=t.desc,this.infoBase.node.active=this.infoBase.string.length>0,this.info1.node.active=this.info1.string.length>0,this.info2.node.active=this.info2.string.length>0,this.info3.node.active=this.info3.string.length>0,this.extraInfo.node.active=this.extraInfo.string.length>0,this.infoSuit1.node.active=this.infoSuit1.string.length>0,this.infoSuit2.node.active=this.infoSuit2.string.length>0,this.infoSuit3.node.active=this.infoSuit3.string.length>0},e.prototype.showDialog=function(){this.node.opacity=255},e.prototype.hideDialog=function(){this.node.opacity=0},e.prototype.lerp=function(t,e,i){return t+(e-t)*i},n([l(cc.Label)],e.prototype,"labelTile",void 0),n([l(cc.Label)],e.prototype,"infoBase",void 0),n([l(cc.Label)],e.prototype,"info1",void 0),n([l(cc.Label)],e.prototype,"info2",void 0),n([l(cc.Label)],e.prototype,"info3",void 0),n([l(cc.Label)],e.prototype,"extraInfo",void 0),n([l(cc.Label)],e.prototype,"infoSuit1",void 0),n([l(cc.Label)],e.prototype,"infoSuit2",void 0),n([l(cc.Label)],e.prototype,"infoSuit3",void 0),n([l(cc.Label)],e.prototype,"infoDesc",void 0),n([s],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"f719fThqrBMn6NkMcXey0jG","Utils");var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,n=a.ccclass,r=(a.property,function(){function t(){}return t.log=function(t){this.showLog&&cc.log(t)},t.clearComponentArray=function(t){for(var e=0,i=t;e<i.length;e++){var o=i[e];o&&o.isValid&&o.destroy()}},t.showLog=!1,o([n],t)}());i.default=r,cc._RF.pop()},{}],WalkSmoke:[function(t,e,i){"use strict";cc._RF.push(e,"d3d56K96jBFs6t/GiwCmf8x","WalkSmoke");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./EventHelper"),s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.start=function(){var t=this;this.scheduleOnce(function(){cc.director.emit(r.EventHelper.POOL_DESTORY_WALKSMOKE,{detail:{coinNode:t.node}})},.3)},n([l],e)}(cc.Component));i.default=c,cc._RF.pop()},{"./EventHelper":"EventHelper"}],Wall:[function(t,e,i){"use strict";cc._RF.push(e,"e7c06zRjp9J+piF+ZsFdjSH","Wall");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Dungeon"),s=t("../Logic"),l=t("./Building"),c=t("../Actor/ColliderTag"),h=cc._decorator,p=h.ccclass,u=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.half=!1,e.mapStr="##",e.wallName="",e.roofName="",e.resNameSecond="",e.type=i.TYPE_EMPTY,e.dir=0,e}var i;return a(e,t),i=e,e.prototype.onLoad=function(){this.wallsprite=this.node.getChildByName("sprite").getChildByName("wallsprite").getComponent(cc.Sprite),this.roofsprite=this.node.getChildByName("sprite").getChildByName("roofsprite").getComponent(cc.Sprite),this.shadowsprite=this.node.getChildByName("sprite").getChildByName("shadow").getComponent(cc.Sprite)},e.prototype.changeRes=function(t,e){if(this.wallsprite.spriteFrame=s.default.spriteFrameRes(t),this.roofsprite.spriteFrame=s.default.spriteFrameRes(e),this.type==i.TYPE_EMPTY)return this.node.opacity=0;this.type!=i.TYPE_OTHER1&&this.type!=i.TYPE_OTHER2||(this.roofsprite.node.opacity=0,this.wallsprite.node.height=256)},e.prototype.setPos=function(t){this.pos=t,this.node.position=r.default.getPosInMap(t)},e.prototype.start=function(){this.node.opacity=255,this.changeRes(this.wallName,this.roofName)},e.prototype.ajustSpriteShow=function(t,e,i,o){this.wallsprite||(this.wallsprite=this.node.getChildByName("sprite").getChildByName("wallsprite").getComponent(cc.Sprite),this.roofsprite=this.node.getChildByName("sprite").getChildByName("roofsprite").getComponent(cc.Sprite),this.shadowsprite=this.node.getChildByName("sprite").getChildByName("shadow").getComponent(cc.Sprite)),this.shadowsprite.node.opacity=t?80:0,this.roofsprite.node.angle=e,this.wallsprite.node.scaleX=i?-1:1,this.roofsprite.node.scaleX=o.x,this.roofsprite.node.scaleY=o.y},e.prototype.isTop=function(){return this.type==i.TYPE_NORMAL&&0==this.dir||this.type==i.TYPE_CORNER&&this.dir<2||this.type==i.TYPE_INNER&&this.dir<2||this.type==i.TYPE_INNER_CORNER&&this.dir<2||this.type==i.TYPE_CONVEX&&0==this.dir||this.type==i.TYPE_CONCAVE&&0==this.dir},e.prototype.isSide=function(){return this.type==i.TYPE_NORMAL&&this.dir>1},e.prototype.init=function(t,e,o){this.mapStr=t;var a=parseInt(t[2]);this.dir=a;var n=!1;switch(t[1]){case"#":this.type=i.TYPE_EMPTY;break;case"0":this.type=i.TYPE_OTHER1;break;case"1":this.type=i.TYPE_OTHER2;break;case"a":this.type=i.TYPE_NORMAL;break;case"b":this.type=i.TYPE_CORNER;break;case"c":this.type=i.TYPE_INNER;break;case"d":this.type=i.TYPE_CONVEX;break;case"e":this.type=i.TYPE_CONCAVE;break;case"f":this.type=i.TYPE_INNER_CORNER;break;case"g":this.type=i.TYPE_TWO_SIDES;break;case"h":this.type=i.TYPE_ALONE;break;case"i":this.type=i.TYPE_ROOF;break;case"j":this.type=i.TYPE_NORMAL,n=!0;break;case"k":this.type=i.TYPE_CORNER,n=!0;break;case"l":this.type=i.TYPE_INNER,n=!0;break;case"m":this.type=i.TYPE_CONVEX,n=!0;break;case"n":this.type=i.TYPE_CONCAVE,n=!0;break;case"o":this.type=i.TYPE_INNER_CORNER,n=!0;break;case"p":this.type=i.TYPE_TWO_SIDES,n=!0;break;case"q":this.type=i.TYPE_ALONE,n=!0;break;case"r":this.type=i.TYPE_ROOF,n=!0}var r=n?e.wallRes2:e.wallRes1,s="roof"+r+"anim008";switch(this.type){case i.TYPE_EMPTY:break;case i.TYPE_OTHER1:this.wallName=e.wallRes3;break;case i.TYPE_OTHER2:this.wallName=e.wallRes4;break;case i.TYPE_NORMAL:this.roofName="roof"+r+"anim000",this.wallName="wall"+r+"anim001";break;case i.TYPE_CORNER:this.roofName="roof"+r+"anim001",this.wallName=s;break;case i.TYPE_INNER:this.roofName="roof"+r+"anim002",this.wallName="wall"+r+"anim002";break;case i.TYPE_CONVEX:this.roofName="roof"+r+"anim003",this.wallName="wall"+r+"anim000";break;case i.TYPE_CONCAVE:this.roofName="roof"+r+"anim004",this.wallName=s;break;case i.TYPE_INNER_CORNER:this.roofName="roof"+r+"anim005",this.wallName="wall"+r+"anim002";break;case i.TYPE_TWO_SIDES:this.roofName="roof"+r+"anim006",this.wallName="wall"+r+"anim001";break;case i.TYPE_ALONE:this.roofName="roof"+r+"anim007",this.wallName="wall"+r+"anim000";break;case i.TYPE_ROOF:this.roofName=s,this.wallName=s}var l=!1,h=0,p=cc.v3(1,1),u=!1;switch(a){case 0:this.ajustSpriteShow(!0,h,l,p);break;case 1:this.isInnerOrCorner(this.type)?(l=!0,p=cc.v3(-1,1),u=!0):this.type==i.TYPE_TWO_SIDES?h=90:(this.wallName=s,p=cc.v3(1,-1)),this.ajustSpriteShow(u,h,l,p);break;case 2:this.isInnerOrCorner(this.type)?(p=cc.v3(1,-1),this.wallName=s):(this.type==i.TYPE_CONVEX&&(this.wallName="wall"+r+"anim002"),h=90),this.ajustSpriteShow(!1,h,l,p);break;case 3:this.isInnerOrCorner(this.type)?(p=cc.v3(-1,-1),this.wallName=s):(this.type==i.TYPE_CONVEX&&(this.wallName="wall"+r+"anim002",l=!0),h=-90),this.ajustSpriteShow(!1,h,l,p)}this.isTop()&&(this.getComponent(cc.PhysicsBoxCollider).tag=c.ColliderTag.WALL_TOP),o&&(this.node.removeComponent(cc.PhysicsBoxCollider),this.node.removeComponent(cc.RigidBody),this.node.removeComponent(cc.BoxCollider))},e.prototype.isInnerOrCorner=function(t){return t==i.TYPE_INNER||t==i.TYPE_CORNER||t==i.TYPE_INNER_CORNER},e.prototype.onCollisionEnter=function(t){this.type==i.TYPE_EMPTY||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.type==i.TYPE_OTHER1||this.type==i.TYPE_OTHER2?this.wallsprite.node.opacity=180:this.roofsprite.node.opacity=180)},e.prototype.onCollisionStay=function(t){this.type==i.TYPE_EMPTY||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.type==i.TYPE_OTHER1||this.type==i.TYPE_OTHER2?this.wallsprite.node.opacity=180:this.roofsprite.node.opacity=180)},e.prototype.onCollisionExit=function(t){this.type==i.TYPE_EMPTY||t.tag!=c.ColliderTag.PLAYER&&t.tag!=c.ColliderTag.NONPLAYER||(this.type==i.TYPE_OTHER1||this.type==i.TYPE_OTHER2?this.wallsprite.node.opacity=255:this.roofsprite.node.opacity=255)},e.TYPE_EMPTY=-1,e.TYPE_NORMAL=0,e.TYPE_CORNER=1,e.TYPE_INNER=2,e.TYPE_CONVEX=3,e.TYPE_CONCAVE=4,e.TYPE_INNER_CORNER=5,e.TYPE_TWO_SIDES=6,e.TYPE_ALONE=7,e.TYPE_ROOF=8,e.TYPE_OTHER1=9,e.TYPE_OTHER2=10,i=n([p],e)}(l.default));i.default=u,cc._RF.pop()},{"../Actor/ColliderTag":"ColliderTag","../Dungeon":"Dungeon","../Logic":"Logic","./Building":"Building"}],WarMachine:[function(t,e,i){"use strict";cc._RF.push(e,"e27dcjzJmBGK54bflNR6COZ","WarMachine");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Boss"),s=t("../Data/DamageData"),l=t("../Shooter"),c=t("../Dungeon"),h=t("../Logic"),p=t("../Manager/StatusManager"),u=t("../Utils/AudioPlayer"),d=t("../EventHelper"),f=t("../Data/FromData"),g=t("../Achievement"),y=t("../Utils/ActorUtils"),m=cc._decorator,v=m.ccclass,E=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.timeDelay=0,e.isMoving=!1,e.isMissileCoolDown=!1,e.isGatlingCoolDown=!1,e.isMainGunCoolDown=!1,e.actionCount=0,e.actionTimeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){this.sc.isDied=!1,this.sc.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(l.default),this.shooter02=this.node.getChildByName("Shooter02").getComponent(l.default),this.shooter03=this.node.getChildByName("Shooter03").getComponent(l.default),this.shooter04=this.node.getChildByName("Shooter04").getComponent(l.default),this.shooter05=this.node.getChildByName("Shooter05").getComponent(l.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(p.default);var t=f.default.getClone(this.actorName(),"bossmachinehead");this.shooter01.from.valueCopy(t),this.shooter02.from.valueCopy(t),this.shooter03.from.valueCopy(t),this.shooter04.from.valueCopy(t),this.shooter05.from.valueCopy(t)},e.prototype.start=function(){this.initGuns()},e.prototype.takeDamage=function(t){return!(this.sc.isDied||!this.sc.isShow||(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.MONSTER_HIT}}),0))},e.prototype.killed=function(){var t=this;this.sc.isDied||(this.anim&&this.anim.pause(),g.default.addMonsterKillAchievement(this.data.resName),this.sc.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.sc.isDied&&this.sc.isShow&&this.dungeon){this.changeZIndex();var t=this.data.currentHealth<this.data.Common.maxHealth/2;if(this.dungeon&&h.default.getChance(90)&&this.fireMainGun(),this.getNearPlayerDistance(this.dungeon.player.node)<300?this.fireMissile(t):h.default.getChance(20)&&this.fireMissile(t),this.fireGatling(t),t){this.actionCount++;var e=cc.v3(1,0);this.actionCount>10&&(cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.MELEE}}),e=cc.v3(-1,0)),this.actionCount>20&&(cc.director.emit(d.EventHelper.PLAY_AUDIO,{detail:{name:u.default.MELEE}}),this.actionCount=0),e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf(),this.move(e,600))}this.shooter01.setHv(cc.v3(0,-1));var i=this.node.position.clone().add(this.shooter01.node.position),o=this.dungeon.player.getCenterPosition().sub(i);o.equals(cc.Vec3.ZERO)||(o=o.normalizeSelf(),this.shooter01.setHv(o))}else this.actionCount=0},e.prototype.initGuns=function(){this.isMainGunCoolDown=!1,this.isGatlingCoolDown=!1,this.isMissileCoolDown=!1,this.shooter01.setHv(cc.v3(0,-1)),this.shooter02.setHv(cc.v3(0,-1)),this.shooter03.setHv(cc.v3(0,-1)),this.shooter04.setHv(cc.v3(0,-1)),this.shooter05.setHv(cc.v3(0,-1));var t=this.node.position.clone().add(this.shooter01.node.position),e=this.dungeon.player.getCenterPosition().sub(t);e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf(),this.shooter01.setHv(e))},e.prototype.fireMainGun=function(){var t=this;this.isMainGunCoolDown||(this.isMainGunCoolDown=!0,this.anim.play("WarMachineMainGunShoot"),this.scheduleOnce(function(){t.isMainGunCoolDown=!1},10))},e.prototype.MainGunShootFinish=function(){this.shooter01.setHv(cc.v3(0,-1));var t=this.node.position.clone().add(this.shooter01.node.position),e=this.dungeon.player.getCenterPosition().sub(t);e.equals(cc.Vec3.ZERO)||(e=e.normalizeSelf(),this.shooter01.setHv(e),this.fireShooter(this.shooter01,"bullet016",0,0,0,cc.v3(48,0))),this.anim.play("WarMachineIdle")},e.prototype.fireGatling=function(t){var e=this;if(!this.isGatlingCoolDown){this.isGatlingCoolDown=!0,this.shooter02.setHv(cc.v3(0,-1)),this.shooter03.setHv(cc.v3(0,-1)),this.shooter02.data.bulletLineInterval=.5,this.shooter03.data.bulletLineInterval=.5;var i=6,o=h.default.getRandomNum(0,15);o=h.default.getHalfChance()?o:-o,t?(this.fireShooter(this.shooter02,"bullet111",0,4),this.fireShooter(this.shooter03,"bullet111",0,4),i=3):(this.fireShooter(this.shooter02,"bullet111",2,2),this.fireShooter(this.shooter03,"bullet111",2,2)),this.scheduleOnce(function(){e.isGatlingCoolDown=!1},i)}},e.prototype.fireMissile=function(t){var e=this;this.isMissileCoolDown||(this.isMissileCoolDown=!0,this.shooter04.setHv(cc.v3(0,-1)),this.shooter05.setHv(cc.v3(0,-1)),this.shooter04.data.bulletLineInterval=.5,this.shooter05.data.bulletLineInterval=.5,this.fireShooter(this.shooter04,"bullet015",2,t?1:0),this.fireShooter(this.shooter05,"bullet015",2,t?1:0),this.scheduleOnce(function(){e.isMissileCoolDown=!1},t?8:16))},e.prototype.fireShooter=function(t,e,i,o,a,n){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=i,t.data.bulletLineExNum=o,t.fireBullet(a,n)},e.prototype.showBoss=function(){this.initGuns(),this.sc.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.sc.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.updateLogic=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.sc.isDied},e.prototype.move=function(t,e){if(!this.sc.isDied){t.equals(cc.Vec3.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var i=t.x,o=t.y,a=(Math.abs(i),Math.abs(o),cc.v2(i,o));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=i||0!=o,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t){var e=y.default.getEnemyCollisionTarget(t);if(e&&!this.sc.isDied){var i=new s.default;i.physicalDamage=5,e.takeDamage(i,f.default.getClone(this.actorName(),"bossmachinehead"),this)}},e.prototype.actorName=function(){return"\u6218\u4e89\u673a\u5668"},n([E(cc.Label)],e.prototype,"label",void 0),n([E],e.prototype,"text",void 0),n([v],e)}(r.default);i.default=_,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventHelper":"EventHelper","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/ActorUtils":"ActorUtils","../Utils/AudioPlayer":"AudioPlayer","./Boss":"Boss"}],WordManager:[function(t,e,i){"use strict";cc._RF.push(e,"0c333CGNPJP0ov5KegA/Xzf","WordManager"),Object.defineProperty(i,"__esModule",{value:!0});i.default=function(){},cc._RF.pop()},{}],WorldLoader:[function(t,e,i){"use strict";cc._RF.push(e,"1da44Z4XqpEhJs0KUhYRpQR","WorldLoader"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Data/ChapterData"),a=t("../Data/LevelData"),n=t("../Logic"),r=function(){function t(){this.worldMap=[],this.realWorldMap=new o.default(99),this.isloaded=!1,this.isloaded00=!1,this.isloaded01=!1,this.isloaded02=!1,this.isloaded03=!1,this.isloaded04=!1,this.isloaded05=!1,this.isloaded99=!1,this.isloaded=!1}return t.prototype.loadWorld=function(){if(this.worldMap.length>0)this.isloaded=!0;else{this.worldMap=new Array;for(var t=0;t<6;t++){var e=new o.default(t);this.worldMap.push(e)}this.loadTileSets()}},t.prototype.loadTileSets=function(){var t=this;cc.resources.load("Data/world/tilesets",function(e,i){if(e)cc.error(e);else{cc.log("tilesets loaded");for(var o={},a=0,n=i.json.tiles;a<n.length;a++){var r=n[a];o[r.id]=r.type}t.loadTiledMaps(o)}})},t.prototype.loadTiledMaps=function(t){var e=this;cc.resources.loadDir("Data/world/tiledmap",cc.JsonAsset,function(i,o){for(var n=0,r=o;n<r.length;n++){var s=r[n],l=s.name.split("_"),c=parseInt(l[1]),h=99==c?e.realWorldMap:e.worldMap[c],p=s.json.layers[0].properties;if(!p.width){p=new a.default;for(var u=0,d=s.json.layers[0].properties;u<d.length;u++){var f=d[u];f.name&&(p[f.name]=f.value)}}for(var g=new Array,y=new Array,m=p.width*p.roomWidth,v=p.height*p.roomHeight,E=0;E<v;E++){g[E]=new Array,y[E]=new Array;for(var _=0;_<m;_++){var D=s.json.layers[0].data[E*m+_];g[E][_]=t[D-1];var S=s.json.layers[1].data[E*m+_];y[E][_]=t[S-1]}}var R=new Array,T=new Array;for(E=0;E<g[0].length;E++)for(R[E]=new Array,T[E]=new Array,_=0;_<g.length;_++)R[E][g.length-1-_]=g[_][E],T[E][y.length-1-_]=y[_][E];p.map=R;var O=new Array,C=new Array,A=new Array;for(E=0;E<p.width;E++)for(O[E]=new Array,C[E]=new Array,A[E]=new Array,_=0;_<p.height;_++)O[E][_]=T[E*p.roomWidth][_*p.roomHeight],C[E][_]=T[E*p.roomWidth+1][_*p.roomHeight],A[E][_]=T[E*p.roomWidth+2][_*p.roomHeight];p.roomTypes=O,p.minimap=C,p.minimaplock=A;var L=new a.default;L.valueCopy(p),h.list.push(L)}e.realWorldMap.list.sort(function(t,e){return t.index-e.index});for(var P=0,b=e.worldMap;P<b.length;P++)b[P].list.sort(function(t,e){return t.index-e.index});e.isloaded=!0,cc.log("world loaded")})},t.prototype.getChapterLength=function(){return this.worldMap.length},t.prototype.getChapterData=function(t){return t>=99?this.realWorldMap:this.worldMap[t]},t.prototype.getLevelList=function(t){return this.getChapterData(t).list},t.prototype.getLevelData=function(t,e){var i=this.getLevelList(t);return i.length<1?null:(i[e].chapter=t,i[e])},t.prototype.getCurrentLevelData=function(){return this.getLevelData(n.default.chapterIndex,n.default.level)},t}();i.default=r,cc._RF.pop()},{"../Data/ChapterData":"ChapterData","../Data/LevelData":"LevelData","../Logic":"Logic"}],WxHelper:[function(t,e,i){"use strict";cc._RF.push(e,"4e113prls5Op7r/tgtPErZz","WxHelper");var o,a=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Logic"),s=cc._decorator,l=s.ccclass,c=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wx=window.wx,e.user=null,e.startButtonNode=null,e.rankList=null,e.rankListOpen=!1,e}return a(e,t),e.prototype.start=function(){if(this.rankList&&(this.CloseDialog(),this.rankList.node.active=this.rankListOpen),this.wx)if(this.startButtonNode){var t=cc.size(this.startButtonNode.width+10,this.startButtonNode.height+10),e=cc.view.getFrameSize(),i=cc.director.getWinSize(),o=(.5*i.width+this.startButtonNode.x-.5*t.width)/i.width*e.width,a=(.5*i.height-this.startButtonNode.y-.5*t.height)/i.height*e.height,n=t.width/i.width*e.width,r=t.height/i.height*e.height,s=this.wx.createUserInfoButton({type:"text",text:"",style:{left:o,top:a,width:n,height:r,lineHeight:0,backgroundColor:"",color:"#000000",textAlign:"center",fontSize:10,borderRadius:3}}),l=this,c=null;s.onTap(function(t){if(c)s.hide();else switch(t.errMsg){case"getUserInfo:ok":s.hide(),cc.sys.localStorage.setItem("hasUserInfo","1");var e=(c=t.userInfo).nickName,i=c.avatarUrl;l.setUserConfig(e,i),l.wx.getOpenDataContext().postMessage({message:"User info get success."});default:console.error(t.errMsg)}}),"1"==cc.sys.localStorage.getItem("hasUserInfo")&&s.hide()}else this.saveRankData()},e.prototype.setUserConfig=function(t,e){if(this.user){var i=this.user.getChildByName("mask").getComponentInChildren(cc.Sprite);this.user.getChildByName("userName").getComponent(cc.Label).string=t,cc.loader.load({url:e,type:"png"},function(t,e){t&&console.error(t),i.spriteFrame=new cc.SpriteFrame(e)})}},e.prototype.CloseDialog=function(){this.wx&&this.node&&this.rankList&&this.rankList.node&&(this.rankList.node.active=!1,this.wx.getOpenDataContext().postMessage({message:"close"}))},e.prototype.OpenDialog=function(){this.wx&&this.rankList&&(this.rankList.node.active=!0,this.saveRankData())},e.prototype.saveRankData=function(){if(this.wx){var t=this;t.wx.setUserCloudStorage({KVDataList:[{key:"score",value:r.default.coins+""}],success:function(e){console.log("score"+r.default.coins),console.log(e),t.wx.getOpenDataContext().postMessage({message:"updateMaxScore"})},fail:function(t){console.log("failed"+r.default.coins),console.log(t)}})}else console.log("wx is empty")},n([c(cc.Node)],e.prototype,"user",void 0),n([c(cc.Node)],e.prototype,"startButtonNode",void 0),n([c(cc.WXSubContextView)],e.prototype,"rankList",void 0),n([c],e.prototype,"rankListOpen",void 0),n([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./Logic":"Logic"}],use_reversed_rotateBy:[function(t,e){"use strict";cc._RF.push(e,"20f25G5HaZKk4Y2GuqawsGN","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}]},{},["Achievement","ActorAttackBox","AreaDetector","AreaOfEffect","ColliderTag","NonPlayerActorState","Actor","BaseNonPlayerActorState","StateContext","DefaultStateMachine","FsmEvent","StackStateMachine","State","StateMachine","Boss","BossAttackCollider","Captain","CaptainSword","Dragon","Dryad","DryadGrass","EvilEye","IceDemon","IceDemonThron","Kraken","KrakenSwingHand","Rah","Slime","SlimeVenom","Sphinx","WarMachine","AirExit","Box","Building","Chest","DecorationFloor","Door","Emplacement","EnergyShield","ExitDoor","FallStone","FootBoard","HitBuilding","InteractBuilding","LightBuilding","MagicLightening","MartCashier","MartShelves","MgCrack","MgWentLine","MonsterGenerator","MushRoomChild","Portal","RoomBed","RoomStool","RoomTv","SavePoint","Saw","ShopMart","ShopTable","TarotTable","Trap","Wall","CameraControl","Chapter","CoinCount","Controller","AchievementData","AreaOfEffectData","AttributeData","AvatarData","BaseData","BuildingData","BulletData","ChapterData","ChunkData","CommonData","DamageData","DungeonStyleData","EquipmentData","EquipmentDescData","EquipmentStringData","ExitData","FromData","GoodsData","GroundOilGoldData","InventoryData","ItemData","LevelData","LightPointData","MapData","MapManagerData","NonPlayerData","OilGoldData","PlayerData","ProfessionData","ProfileData","SavePointData","StatusData","SuitData","TalentData","TarotData","Dungeon","BlockLight","Light","ShadowOfSight","Equipment","EquipmentDialog","UpgradeEquipmentDialog","EventHelper","Game","GameFinish","GameOver","HealthBar","Inventory","Bullet","Coin","DashShadow","Goods","Item","ItemDialog","OilGold","TarotCard","JoyController","Joystick","KeyboardController","Loading","Logic","BaseManager","BuildingManager","DungeonStyleManager","EquipmentManager","FloatingLabelManager","InventoryManager","ItemManager","LightManager","LoadingManager","MapManager","MonsterManager","MonsterRandomAttr","NonPlayerManager","ProfileManager","SpecialManager","StatusManager","TarotManager","WordManager","Chunk","ChunkLookCamera","ChunkWorld","Seeker","WorldLoader","MeleeWeapon","MeleeWeaponChild","MiniMap","Settings","NonPlayer","OilGoldCount","OilLake","PerlinNoise2D","Player","PlayerAvatar","PlayerWeapon","RectDoor","RectDungeon","RectRoom","RoomType","Shield","Shooter","Start","Status","StatusConditionType","StatusEventType","FireGhost","IceThron","MagicCircle","MagicIce","OrganizationTalent","ProfessionTalent","Talent","TalentDash","TalentMagic","TalentShield","Test","Tile","AttributeSelector","BrightnessBar","CoolDownView","CutScene","FloatingLabel","GameHud","InventoryItem","PaletteSelector","ParallaxBackground","PickAvatar","PlayerInfoDialog","TestFog","Tips","BaseDialog","InventoryDialog","MartShelvesDialog","SettingsDialog","ActorUtils","AudioPlayer","IndexZ","LocalStorage","NextStep","Random","Random4Save","Utils","WalkSmoke","WxHelper","use_reversed_rotateBy"]);